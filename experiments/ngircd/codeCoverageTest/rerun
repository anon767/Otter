TOPDIR=~/t
LIBCDIR=$TOPDIR/libc
MOCKEDDIR=./mockedFns
CILLY="env CILLY_DONT_COMPILE_AFTER_MERGE=1 ../../../cil/bin/cilly --merge --useLogicalOperators -D_FILE_OFFSET_BITS=64 -U __OPTIMIZE__ --warnall"

# 
echo "--> Merging ngIRCd sources"
cd ../src && make merge && cd ../codeCoverageTest
# 
echo "--> Merging ngIRCd with mockedFns"
$CILLY --out=ngircd_comb.c -I $LIBCDIR -I $MOCKEDDIR otherFiles/libc_comb.c $MOCKEDDIR/*.c ngircd.c
#
echo "--> Doing symbolic execution"
$CILLY -I $MOCKEDDIR --doexecute --covStats=ngircd.stats otherFiles/symtest1.c  --lineCov $*
