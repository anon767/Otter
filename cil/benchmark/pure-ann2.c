/* Generated by 'cilly --dodsum' in CIL output mode */
/* Generated by CIL v. 1.3.1 */
/* print_CIL_Input is false */

#line 213 "/usr/lib/gcc-lib/i386-redhat-linux/3.2.3/include/stddef.h"
typedef unsigned int size_t;
#line 182 "/usr/include/bits/types.h"
typedef int __ssize_t;
#line 110 "/usr/include/sys/types.h"
typedef __ssize_t ssize_t;
#line 41 "/usr/include/bits/types.h"
typedef unsigned char __uint8_t;
#line 44 "/usr/include/bits/types.h"
typedef int __int32_t;
#line 45 "/usr/include/bits/types.h"
typedef unsigned int __uint32_t;
#line 136 "/usr/include/bits/types.h"
typedef unsigned long long __dev_t;
#line 137 "/usr/include/bits/types.h"
typedef unsigned int __uid_t;
#line 138 "/usr/include/bits/types.h"
typedef unsigned int __gid_t;
#line 139 "/usr/include/bits/types.h"
typedef unsigned long __ino_t;
#line 140 "/usr/include/bits/types.h"
typedef unsigned long long __ino64_t;
#line 141 "/usr/include/bits/types.h"
typedef unsigned int __mode_t;
#line 142 "/usr/include/bits/types.h"
typedef unsigned int __nlink_t;
#line 143 "/usr/include/bits/types.h"
typedef long __off_t;
#line 144 "/usr/include/bits/types.h"
typedef long long __off64_t;
#line 145 "/usr/include/bits/types.h"
typedef int __pid_t;
#line 147 "/usr/include/bits/types.h"
typedef long __clock_t;
#line 149 "/usr/include/bits/types.h"
typedef unsigned long long __rlim64_t;
#line 151 "/usr/include/bits/types.h"
typedef long __time_t;
#line 152 "/usr/include/bits/types.h"
typedef unsigned int __useconds_t;
#line 153 "/usr/include/bits/types.h"
typedef long __suseconds_t;
#line 166 "/usr/include/bits/types.h"
typedef long __blksize_t;
#line 172 "/usr/include/bits/types.h"
typedef long long __blkcnt64_t;
#line 176 "/usr/include/bits/types.h"
typedef unsigned long long __fsblkcnt64_t;
#line 180 "/usr/include/bits/types.h"
typedef unsigned long long __fsfilcnt64_t;
#line 194 "/usr/include/bits/types.h"
typedef unsigned int __socklen_t;
#line 46 "/usr/include/stdio.h"
struct _IO_FILE;
#line 46
struct _IO_FILE;
#line 46 "/usr/include/stdio.h"
typedef struct _IO_FILE FILE;
#line 43 "/usr/lib/gcc-lib/i386-redhat-linux/3.2.3/include/stdarg.h"
typedef __builtin_va_list __gnuc_va_list;
#line 173 "/usr/include/libio.h"
typedef void _IO_lock_t;
#line 179 "/usr/include/libio.h"
struct _IO_marker {
   struct _IO_marker *_next ;
   struct _IO_FILE *_sbuf ;
   int _pos ;
};
#line 264 "/usr/include/libio.h"
struct _IO_FILE {
   int _flags ;
   char *_IO_read_ptr ;
   char *_IO_read_end ;
   char *_IO_read_base ;
   char *_IO_write_base ;
   char *_IO_write_ptr ;
   char *_IO_write_end ;
   char *_IO_buf_base ;
   char *_IO_buf_end ;
   char *_IO_save_base ;
   char *_IO_backup_base ;
   char *_IO_save_end ;
   struct _IO_marker *_markers ;
   struct _IO_FILE *_chain ;
   int _fileno ;
   int _flags2 ;
   __off_t _old_offset ;
   unsigned short _cur_column ;
   signed char _vtable_offset ;
   char _shortbuf[1] ;
   _IO_lock_t *_lock ;
   __off64_t _offset ;
   void *__pad1 ;
   void *__pad2 ;
   int _mode ;
   char _unused2[(int )(15U * sizeof(int ) - 2U * sizeof(void *))] ;
};
#line 77 "/usr/include/stdio.h"
typedef __gnuc_va_list va_list;
#line 52 "/usr/include/sys/types.h"
typedef __ino64_t ino_t;
#line 62 "/usr/include/sys/types.h"
typedef __dev_t dev_t;
#line 67 "/usr/include/sys/types.h"
typedef __gid_t gid_t;
#line 72 "/usr/include/sys/types.h"
typedef __mode_t mode_t;
#line 82 "/usr/include/sys/types.h"
typedef __uid_t uid_t;
#line 90 "/usr/include/sys/types.h"
typedef __off64_t off_t;
#line 100 "/usr/include/sys/types.h"
typedef __pid_t pid_t;
#line 76 "/usr/include/time.h"
typedef __time_t time_t;
#line 23 "/usr/include/bits/sigset.h"
typedef int __sig_atomic_t;
#line 28 "/usr/include/bits/sigset.h"
struct __anonstruct___sigset_t_17 {
   unsigned long __val[(int )(1024U / (8U * sizeof(unsigned long )))] ;
};
#line 28 "/usr/include/bits/sigset.h"
typedef struct __anonstruct___sigset_t_17 __sigset_t;
#line 38 "/usr/include/sys/select.h"
typedef __sigset_t sigset_t;
#line 118 "/usr/include/time.h"
struct timespec {
   __time_t tv_sec ;
   long tv_nsec ;
};
#line 69 "/usr/include/bits/time.h"
struct timeval {
   __time_t tv_sec ;
   __suseconds_t tv_usec ;
};
#line 55 "/usr/include/sys/select.h"
typedef long __fd_mask;
#line 67 "/usr/include/sys/select.h"
struct __anonstruct_fd_set_18 {
   __fd_mask fds_bits[(int )(1024U / (8U * sizeof(__fd_mask )))] ;
};
#line 67 "/usr/include/sys/select.h"
typedef struct __anonstruct_fd_set_18 fd_set;
#line 41 "/usr/include/signal.h"
typedef __sig_atomic_t sig_atomic_t;
#line 33 "/usr/include/bits/siginfo.h"
union sigval {
   int sival_int ;
   void *sival_ptr ;
};
#line 33 "/usr/include/bits/siginfo.h"
typedef union sigval sigval_t;
#line 51 "/usr/include/bits/siginfo.h"
struct __anonstruct__kill_29 {
   __pid_t si_pid ;
   __uid_t si_uid ;
};
#line 51 "/usr/include/bits/siginfo.h"
struct __anonstruct__timer_30 {
   int si_tid ;
   int si_overrun ;
   sigval_t si_sigval ;
};
#line 51 "/usr/include/bits/siginfo.h"
struct __anonstruct__rt_31 {
   __pid_t si_pid ;
   __uid_t si_uid ;
   sigval_t si_sigval ;
};
#line 51 "/usr/include/bits/siginfo.h"
struct __anonstruct__sigchld_32 {
   __pid_t si_pid ;
   __uid_t si_uid ;
   int si_status ;
   __clock_t si_utime ;
   __clock_t si_stime ;
};
#line 51 "/usr/include/bits/siginfo.h"
struct __anonstruct__sigfault_33 {
   void *si_addr ;
};
#line 51 "/usr/include/bits/siginfo.h"
struct __anonstruct__sigpoll_34 {
   long si_band ;
   int si_fd ;
};
#line 51 "/usr/include/bits/siginfo.h"
union __anonunion__sifields_28 {
   int _pad[(int )(128U / sizeof(int ) - 3U)] ;
   struct __anonstruct__kill_29 _kill ;
   struct __anonstruct__timer_30 _timer ;
   struct __anonstruct__rt_31 _rt ;
   struct __anonstruct__sigchld_32 _sigchld ;
   struct __anonstruct__sigfault_33 _sigfault ;
   struct __anonstruct__sigpoll_34 _sigpoll ;
};
#line 51 "/usr/include/bits/siginfo.h"
struct siginfo {
   int si_signo ;
   int si_errno ;
   int si_code ;
   union __anonunion__sifields_28 _sifields ;
};
#line 51 "/usr/include/bits/siginfo.h"
typedef struct siginfo siginfo_t;
#line 25 "/usr/include/bits/sigaction.h"
union __anonunion___sigaction_handler_46 {
   void (*sa_handler)(int  ) ;
   void (*sa_sigaction)(int  , siginfo_t * , void * ) ;
};
#line 25 "/usr/include/bits/sigaction.h"
struct sigaction {
   union __anonunion___sigaction_handler_46 __sigaction_handler ;
   __sigset_t sa_mask ;
   int sa_flags ;
   void (*sa_restorer)(void) ;
};
#line 243 "/usr/include/unistd.h"
typedef __socklen_t socklen_t;
#line 56 "/usr/include/sys/time.h"
struct timezone {
   int tz_minuteswest ;
   int tz_dsttime ;
};
#line 62 "/usr/include/sys/time.h"
typedef struct timezone * __restrict  __timezone_ptr_t;
#line 131 "/usr/include/time.h"
struct tm {
   int tm_sec ;
   int tm_min ;
   int tm_hour ;
   int tm_mday ;
   int tm_mon ;
   int tm_year ;
   int tm_wday ;
   int tm_yday ;
   int tm_isdst ;
   long tm_gmtoff ;
   char const   *tm_zone ;
};
#line 36 "/usr/include/bits/stat.h"
struct stat {
   __dev_t st_dev ;
   unsigned short __pad1 ;
   __ino_t __st_ino ;
   __mode_t st_mode ;
   __nlink_t st_nlink ;
   __uid_t st_uid ;
   __gid_t st_gid ;
   __dev_t st_rdev ;
   unsigned short __pad2 ;
   __off64_t st_size ;
   __blksize_t st_blksize ;
   __blkcnt64_t st_blocks ;
   struct timespec st_atim ;
   struct timespec st_mtim ;
   struct timespec st_ctim ;
   __ino64_t st_ino ;
};
#line 29 "/usr/include/bits/sockaddr.h"
typedef unsigned short sa_family_t;
#line 145 "/usr/include/bits/socket.h"
struct sockaddr {
   sa_family_t sa_family ;
   char sa_data[14] ;
};
#line 162 "/usr/include/bits/socket.h"
struct sockaddr_storage {
   sa_family_t ss_family ;
   __uint32_t __ss_align ;
   char __ss_padding[(int )(128U - 2U * sizeof(__uint32_t ))] ;
};
#line 87 "/usr/include/sys/socket.h"
struct sockaddr_in;
#line 87
struct sockaddr_in;
#line 87
struct sockaddr_in6;
#line 87
struct sockaddr_in6;
#line 49 "/usr/include/stdint.h"
typedef unsigned char uint8_t;
#line 50 "/usr/include/stdint.h"
typedef unsigned short uint16_t;
#line 52 "/usr/include/stdint.h"
typedef unsigned int uint32_t;
#line 92 "/usr/include/netinet/in.h"
typedef uint16_t in_port_t;
#line 136 "/usr/include/netinet/in.h"
typedef uint32_t in_addr_t;
#line 137 "/usr/include/netinet/in.h"
struct in_addr {
   in_addr_t s_addr ;
};
#line 193 "/usr/include/netinet/in.h"
union __anonunion_in6_u_60 {
   uint8_t u6_addr8[16] ;
   uint16_t u6_addr16[8] ;
   uint32_t u6_addr32[4] ;
};
#line 193 "/usr/include/netinet/in.h"
struct in6_addr {
   union __anonunion_in6_u_60 in6_u ;
};
#line 219 "/usr/include/netinet/in.h"
struct sockaddr_in {
   sa_family_t sin_family ;
   in_port_t sin_port ;
   struct in_addr sin_addr ;
   unsigned char sin_zero[(int )(((sizeof(struct sockaddr ) - sizeof(unsigned short )) -
                                  sizeof(in_port_t )) - sizeof(struct in_addr ))] ;
};
#line 233 "/usr/include/netinet/in.h"
struct sockaddr_in6 {
   sa_family_t sin6_family ;
   in_port_t sin6_port ;
   uint32_t sin6_flowinfo ;
   struct in6_addr sin6_addr ;
   uint32_t sin6_scope_id ;
};
#line 32 "/usr/include/bits/resource.h"
enum __rlimit_resource {
    RLIMIT_CPU = 0,
    RLIMIT_FSIZE = 1,
    RLIMIT_DATA = 2,
    RLIMIT_STACK = 3,
    RLIMIT_CORE = 4,
    RLIMIT_RSS = 5,
    RLIMIT_NOFILE = 7,
    RLIMIT_OFILE = 7,
    RLIMIT_AS = 9,
    RLIMIT_NPROC = 6,
    RLIMIT_MEMLOCK = 8,
    RLIMIT_LOCKS = 10,
    RLIMIT_NLIMITS = 11,
    RLIM_NLIMITS = 11
};
#line 109 "/usr/include/bits/resource.h"
typedef __rlim64_t rlim_t;
#line 115 "/usr/include/bits/resource.h"
struct rlimit {
   rlim_t rlim_cur ;
   rlim_t rlim_max ;
};
#line 39 "/usr/include/sys/resource.h"
typedef enum __rlimit_resource __rlimit_resource_t;
#line 50 "/usr/include/pwd.h"
struct passwd {
   char *pw_name ;
   char *pw_passwd ;
   __uid_t pw_uid ;
   __gid_t pw_gid ;
   char *pw_gecos ;
   char *pw_dir ;
   char *pw_shell ;
};
#line 538 "/usr/include/netdb.h"
struct addrinfo {
   int ai_flags ;
   int ai_family ;
   int ai_socktype ;
   int ai_protocol ;
   socklen_t ai_addrlen ;
   struct sockaddr *ai_addr ;
   char *ai_canonname ;
   struct addrinfo *ai_next ;
};
#line 58 "/usr/include/bits/statvfs.h"
struct statvfs64 {
   unsigned long f_bsize ;
   unsigned long f_frsize ;
   __fsblkcnt64_t f_blocks ;
   __fsblkcnt64_t f_bfree ;
   __fsblkcnt64_t f_bavail ;
   __fsfilcnt64_t f_files ;
   __fsfilcnt64_t f_ffree ;
   __fsfilcnt64_t f_favail ;
   unsigned long f_fsid ;
   int __f_unused ;
   unsigned long f_flag ;
   unsigned long f_namemax ;
   int __f_spare[6] ;
};
#line 38 "/usr/include/utime.h"
struct utimbuf {
   __time_t actime ;
   __time_t modtime ;
};
#line 69 "/usr/include/sys/syslog.h"
struct _code {
   char *c_name ;
   int c_val ;
};
#line 69 "/usr/include/sys/syslog.h"
typedef struct _code CODE;
#line 267 "ftpd.h"
struct AuthResult_ {
   int auth_ok ;
   uid_t uid ;
   gid_t gid ;
   char const   *dir ;
   int slow_tilde_expansion ;
};
#line 267 "ftpd.h"
typedef struct AuthResult_ AuthResult;
#line 102 "/usr/include/getopt.h"
struct option {
   char const   *name ;
   int has_arg ;
   int *flag ;
   int val ;
};
#line 57 "ftpd_p.h"
struct reply {
   struct reply *next ;
   char line[1] ;
};
#line 246 "ftpd_p.h"
struct Authentication_ {
   char const   *name ;
   void (*parse)(char const   *file ) ;
   void (*check)(AuthResult *result , char const   *account , char const   *password ,
                 struct sockaddr_storage  const  *sa , struct sockaddr_storage  const  *peer ) ;
   void (*exit)(void) ;
};
#line 246 "ftpd_p.h"
typedef struct Authentication_ Authentication;
#line 285 "ftpd_p.h"
struct Authentications_ {
   Authentication const   *auth ;
   char *conf_file ;
   struct Authentications_ *next ;
};
#line 285 "ftpd_p.h"
typedef struct Authentications_ Authentications;
#line 394 "ftpd.c"
union __anonunion___u_69 {
   unsigned int __ui ;
   unsigned short __usi ;
   unsigned char __uc ;
};
#line 451 "ftpd.c"
union __anonunion___u_70 {
   unsigned int __ui ;
   unsigned short __usi ;
   unsigned char __uc ;
};
#line 498 "ftpd.c"
union __anonunion___u_71 {
   unsigned int __ui ;
   unsigned short __usi ;
   unsigned char __uc ;
};
#line 922 "ftpd.c"
union __anonunion___u_72 {
   unsigned int __ui ;
   unsigned short __usi ;
   unsigned char __uc ;
};
#line 2173 "ftpd.c"
union __anonunion___u_73 {
   unsigned int __ui ;
   unsigned short __usi ;
   unsigned char __uc ;
};
#line 2365 "ftpd.c"
union __anonunion___u_74 {
   unsigned int __ui ;
   unsigned short __usi ;
   unsigned char __uc ;
};
#line 2538 "ftpd.c"
union __anonunion___u_75 {
   unsigned int __ui ;
   unsigned short __usi ;
   unsigned char __uc ;
};
#line 4665 "ftpd.c"
union __anonunion___u_76 {
   unsigned int __ui ;
   unsigned short __usi ;
   unsigned char __uc ;
};
#line 4797 "ftpd.c"
union __anonunion___u_77 {
   unsigned int __ui ;
   unsigned short __usi ;
   unsigned char __uc ;
};
#line 4896 "ftpd.c"
union __anonunion___u_78 {
   unsigned int __ui ;
   unsigned short __usi ;
   unsigned char __uc ;
};
#line 40 "/usr/include/shadow.h"
struct spwd {
   char *sp_namp ;
   char *sp_pwdp ;
   long sp_lstchg ;
   long sp_min ;
   long sp_max ;
   long sp_warn ;
   long sp_inact ;
   long sp_expire ;
   unsigned long sp_flag ;
};
#line 77 "/usr/include/sys/types.h"
typedef __nlink_t nlink_t;
#line 43 "/usr/include/grp.h"
struct group {
   char *gr_name ;
   char *gr_passwd ;
   __gid_t gr_gid ;
   char **gr_mem ;
};
#line 296 "ftpd.h"
struct PureFileInfo_ {
   char **names_pnt ;
   size_t name_offset ;
   off_t size ;
   time_t mtime ;
   mode_t mode ;
   nlink_t nlink ;
   uid_t uid ;
   gid_t gid ;
};
#line 296 "ftpd.h"
typedef struct PureFileInfo_ PureFileInfo;
#line 23 "/usr/include/bits/dirent.h"
struct dirent {
   __ino64_t d_ino ;
   __off64_t d_off ;
   unsigned short d_reclen ;
   unsigned char d_type ;
   char d_name[256] ;
};
#line 128 "/usr/include/dirent.h"
struct __dirstream;
#line 128
struct __dirstream;
#line 128 "/usr/include/dirent.h"
typedef struct __dirstream DIR;
#line 13 "ls_p.h"
struct filename {
   struct filename *down ;
   struct filename *right ;
   int top ;
   char line[1] ;
};
#line 24 "ls_p.h"
struct userid {
   struct userid *next ;
   uid_t uid ;
   char *name ;
};
#line 30 "ls_p.h"
struct groupid {
   struct groupid *next ;
   gid_t gid ;
   char *name ;
};
#line 37 "bsd-glob.h"
struct __anonstruct_glob_t_67 {
   unsigned long gl_maxfiles ;
   int gl_maxdepth ;
   int gl_pathc ;
   int gl_matchc ;
   int gl_offs ;
   int gl_flags ;
   char **gl_pathv ;
   int (*gl_errfunc)(char const   * , int  ) ;
   void (*gl_closedir)(void * ) ;
   struct dirent *(*gl_readdir)(void * ) ;
   void *(*gl_opendir)(char const   * ) ;
   int (*gl_lstat)(char const   * , struct stat * ) ;
   int (*gl_stat)(char const   * , struct stat * ) ;
};
#line 37 "bsd-glob.h"
typedef struct __anonstruct_glob_t_67 glob_t;
#line 468 "ls.c"
union __anonunion___u_68 {
   unsigned int __ui ;
   unsigned short __usi ;
   unsigned char __uc ;
};
#line 101 "bsd-glob.c"
typedef unsigned short Char;
#line 44 "/usr/include/sys/capability.h"
struct _cap_struct;
#line 44
struct _cap_struct;
#line 44 "/usr/include/sys/capability.h"
typedef struct _cap_struct *cap_t;
#line 52 "/usr/include/sys/capability.h"
typedef int cap_value_t;
#line 57
enum __anonenum_cap_flag_t_67 {
    CAP_EFFECTIVE = 0,
    CAP_PERMITTED = 1,
    CAP_INHERITABLE = 2
};
#line 57 "/usr/include/sys/capability.h"
typedef enum __anonenum_cap_flag_t_67 cap_flag_t;
#line 66
enum __anonenum_cap_flag_value_t_68 {
    CAP_CLEAR = 0,
    CAP_SET = 1
};
#line 66 "/usr/include/sys/capability.h"
typedef enum __anonenum_cap_flag_value_t_68 cap_flag_value_t;
#line 6 "dynamic.h"
struct IPTrack_ {
   struct sockaddr_storage ip ;
   pid_t pid ;
};
#line 6 "dynamic.h"
typedef struct IPTrack_ IPTrack;
#line 16 "puredb_read.h"
typedef unsigned int puredb_u32_t;
#line 23 "puredb_read.h"
struct PureDB_ {
   unsigned char *map ;
   int fd ;
   puredb_u32_t size ;
};
#line 23 "puredb_read.h"
typedef struct PureDB_ PureDB;
#line 68 "/usr/include/assert.h"
extern  __attribute__((__noreturn__)) void __assert_fail(char const   *__assertion ,
                                                         char const   *__file , unsigned int __line ,
                                                         char const   *__function ) ;
#line 1 "cil-5BGQzUBp.o"
/* #pragma merger(0,"/tmp/cil-ZAh40RuI.i","") */
#line 1 "src/fakesnprintf.o_saved.c"
/* #pragma merger(112422800,"./fakesnprintf.i","-g,-O2") */
#line 1 "cil-fbZVFWbz.o"
/* #pragma merger(0,"/tmp/cil-hqvRT8o1.i","") */
#line 1 "src/mysnprintf.o_saved.c"
/* #pragma merger(112422800,"./mysnprintf.i","-g,-O2") */
#line 1 "cil-lWXRxErj.o"
/* #pragma merger(0,"/tmp/cil-kFnOE7i0.i","") */
#line 1 "src/bsd-getopt_long.o_saved.c"
/* #pragma merger(112422801,"./bsd-getopt_long.i","-g,-O2") */
#line 1 "cil-WAD25yiK.o"
/* #pragma merger(0,"/tmp/cil-Omcjv0zh.i","") */
#line 1 "src/pure_ftpd-daemons.o_saved.c"
/* #pragma merger(112422802,"./daemons.i","-g,-O2") */
#line 179 "/usr/include/stdlib.h"
__inline static unsigned long strtoul(char const   * __restrict  __nptr , char ** __restrict  __endptr ,
                                      int __base ) ;
#line 280
extern unsigned long __strtoul_internal(char const   * __restrict  __nptr , char ** __restrict  __endptr ,
                                        int __base , int __group ) ;
#line 319 "/usr/include/stdlib.h"
__inline static unsigned long strtoul(char const   * __restrict  __nptr , char ** __restrict  __endptr ,
                                      int __base ) 
{ unsigned long tmp ;

  {
  {
#line 323
  tmp = __strtoul_internal(__nptr, __endptr, __base, 0);
  }
#line 323
  return (tmp);
}
}
#line 42 "/usr/include/string.h"
extern void *memmove(void *__dest , void const   *__src , size_t __n ) ;
#line 38 "/usr/include/bits/errno.h"
extern int *__errno_location(void)  __attribute__((__const__)) ;
#line 305 "/usr/include/unistd.h"
extern int close(int __fd ) ;
#line 312
extern ssize_t read(int __fd , void *__buf , size_t __nbytes ) ;
#line 75 "/usr/include/fcntl.h"
extern int open(char const   *__file , int __oflag  , ...)  __asm__("open64")  ;
#line 371 "ftpd.h"
unsigned int daemons(unsigned short server_port ) ;
#line 12 "daemons.c"
static unsigned int count(unsigned short server_port , char const   *file ) 
{ int f ;
  int r ;
  int c ;
  int b ;
  int e ;
  unsigned int d ;
  char buf[2049] ;
  ssize_t tmp ;
  int *tmp___0 ;
  int tmp___1 ;
  unsigned long tmp___2 ;
  unsigned long tmp___3 ;

  {
  {
#line 17
  b = 0;
#line 18
  e = 0;
#line 19
  d = 0U;
#line 22
  f = open(file, 0);
  }
#line 22
  if (f == -1) {
#line 23
    return (0U);
  }
#line 25
  buf[2048] = 0;
  {
#line 27
  while (1) {
    while_0_continue: /* CIL Label */ ;
    {
#line 28
    while (1) {
      while_1_continue: /* CIL Label */ ;
      {
#line 28
      tmp = read(f, (void *)(buf + e), 2048U - (unsigned int )e);
#line 28
      r = tmp;
      }
#line 28
      if (r < 0) {
        {
#line 28
        tmp___0 = __errno_location();
        }
#line 28
        if (! ((*tmp___0) == 4)) {
          goto while_1_break;
        }
      } else {
        goto while_1_break;
      }
    }
    while_1_break: /* CIL Label */ ;
    }
#line 30
    if (r <= 0) {
      goto while_0_break;
    }
#line 33
    e += r;
#line 39
    c = b;
    {
#line 40
    while (1) {
      while_2_continue: /* CIL Label */ ;
#line 40
      if (c < e) {
#line 40
        if (! ((int )buf[c] != 10)) {
          goto while_2_break;
        }
      } else {
        goto while_2_break;
      }
#line 41
      c ++;
    }
    while_2_break: /* CIL Label */ ;
    }
    {
#line 43
    while (1) {
      while_3_continue: /* CIL Label */ ;
#line 43
      if (! (c < e)) {
        goto while_3_break;
      }
#line 44
      tmp___1 = c;
#line 44
      c ++;
#line 44
      buf[tmp___1] = 0;
      {
#line 45
      while (1) {
        while_4_continue: /* CIL Label */ ;
#line 45
        if (b < c) {
#line 45
          if ((int )buf[b] != 58) {
#line 45
            if (! ((int )buf[b] != 10)) {
              goto while_4_break;
            }
          } else {
            goto while_4_break;
          }
        } else {
          goto while_4_break;
        }
#line 46
        b ++;
      }
      while_4_break: /* CIL Label */ ;
      }
#line 48
      if (b < c) {
#line 48
        if ((int )buf[b] == 58) {
#line 49
          b ++;
          {
#line 50
          while (1) {
            while_5_continue: /* CIL Label */ ;
#line 50
            if (b < e) {
#line 50
              if (! ((int )buf[b] != 58)) {
                goto while_5_break;
              }
            } else {
              goto while_5_break;
            }
#line 51
            b ++;
          }
          while_5_break: /* CIL Label */ ;
          }
          {
#line 53
          b ++;
#line 54
          tmp___3 = strtoul((char const   */* __restrict  */)(buf + b), (char **/* __restrict  */)((void *)0),
                            16);
          }
#line 54
          if (tmp___3 == (unsigned long )server_port) {
            {
#line 56
            while (1) {
              while_6_continue: /* CIL Label */ ;
#line 56
              if (b < e) {
#line 56
                if (! ((int )buf[b] != 58)) {
                  goto while_6_break;
                }
              } else {
                goto while_6_break;
              }
#line 57
              b ++;
            }
            while_6_break: /* CIL Label */ ;
            }
#line 59
            if ((int )buf[b] == 58) {
#line 60
              b ++;
              {
#line 61
              while (1) {
                while_7_continue: /* CIL Label */ ;
#line 61
                if (b < e) {
#line 61
                  if (! ((int )buf[b] != 32)) {
                    goto while_7_break;
                  }
                } else {
                  goto while_7_break;
                }
#line 62
                b ++;
              }
              while_7_break: /* CIL Label */ ;
              }
#line 64
              if ((int )buf[b] == 32) {
                {
#line 65
                b ++;
#line 66
                tmp___2 = strtoul((char const   */* __restrict  */)(buf + b), (char **/* __restrict  */)((void *)0),
                                  16);
                }
#line 66
                if (tmp___2 == 1UL) {
#line 67
                  d ++;
                }
              }
            }
          }
        }
      }
#line 73
      b = c;
      {
#line 74
      while (1) {
        while_8_continue: /* CIL Label */ ;
#line 74
        if (c < e) {
#line 74
          if (! ((int )buf[c] != 10)) {
            goto while_8_break;
          }
        } else {
          goto while_8_break;
        }
#line 75
        c ++;
      }
      while_8_break: /* CIL Label */ ;
      }
    }
    while_3_break: /* CIL Label */ ;
    }
#line 78
    if (e > b) {
      {
#line 79
      memmove((void *)(buf), (void const   *)(buf + b), (unsigned int )(e - b));
      }
    }
#line 81
    e -= b;
#line 82
    b = 0;
  }
  while_0_break: /* CIL Label */ ;
  }
  {
#line 84
  close(f);
  }
#line 86
  return (d);
}
}
#line 89 "daemons.c"
unsigned int daemons(unsigned short server_port ) 
{ unsigned int nbcnx ;
  unsigned int tmp ;

  {
  {
#line 93
  nbcnx = count(server_port, "/proc/net/tcp");
#line 94
  tmp = count(server_port, "/proc/net/tcp6");
#line 94
  nbcnx += tmp;
  }
#line 96
  return (nbcnx);
}
}
#line 1 "cil-iP3lo0qB.o"
/* #pragma merger(0,"/tmp/cil-RDUZZX8r.i","") */
#line 1 "src/pure_ftpd-ftpd.o_saved.c"
/* #pragma merger(112422803,"./ftpd.i","-g,-O2") */
#line 143 "/usr/include/stdio.h"
extern struct _IO_FILE *stdout ;
#line 156
extern int rename(char const   *__old , char const   *__new ) ;
#line 208
extern int fclose(FILE *__stream ) ;
#line 213
extern int fflush(FILE *__stream ) ;
#line 254
extern FILE *fopen(char const   * __restrict  __filename , char const   * __restrict  __modes )  __asm__("fopen64")  ;
#line 329
extern int printf(char const   * __restrict  __format  , ...) ;
#line 353
extern int snprintf(char * __restrict  __s , size_t __maxlen , char const   * __restrict  __format 
                    , ...) ;
#line 357
extern int vsnprintf(char * __restrict  __s , size_t __maxlen , char const   * __restrict  __format ,
                     __gnuc_va_list __arg ) ;
#line 403
extern int sscanf(char const   * __restrict  __s , char const   * __restrict  __format 
                  , ...) ;
#line 528
extern char *fgets(char * __restrict  __s , int __n , FILE * __restrict  __stream ) ;
#line 591
extern int puts(char const   *__s ) ;
#line 742
extern void perror(char const   *__s ) ;
#line 144 "/usr/include/stdlib.h"
__inline static int atoi(char const   *__nptr )  __attribute__((__pure__)) ;
#line 159
__inline static double strtod(char const   * __restrict  __nptr , char ** __restrict  __endptr ) ;
#line 176
__inline static long strtol(char const   * __restrict  __nptr , char ** __restrict  __endptr ,
                            int __base ) ;
#line 204
__inline static unsigned long long strtoull(char const   * __restrict  __nptr , char ** __restrict  __endptr ,
                                            int __base ) ;
#line 264
extern double __strtod_internal(char const   * __restrict  __nptr , char ** __restrict  __endptr ,
                                int __group ) ;
#line 274
extern long __strtol_internal(char const   * __restrict  __nptr , char ** __restrict  __endptr ,
                              int __base , int __group ) ;
#line 295
extern unsigned long long __strtoull_internal(char const   * __restrict  __nptr ,
                                              char ** __restrict  __endptr , int __base ,
                                              int __group ) ;
#line 308 "/usr/include/stdlib.h"
__inline static double strtod(char const   * __restrict  __nptr , char ** __restrict  __endptr ) 
{ double tmp ;

  {
  {
#line 311
  tmp = __strtod_internal(__nptr, __endptr, 0);
  }
#line 311
  return (tmp);
}
}
#line 313 "/usr/include/stdlib.h"
__inline static long strtol(char const   * __restrict  __nptr , char ** __restrict  __endptr ,
                            int __base ) 
{ long tmp ;

  {
  {
#line 317
  tmp = __strtol_internal(__nptr, __endptr, __base, 0);
  }
#line 317
  return (tmp);
}
}
#line 365 "/usr/include/stdlib.h"
__inline static unsigned long long strtoull(char const   * __restrict  __nptr , char ** __restrict  __endptr ,
                                            int __base ) 
{ unsigned long long tmp ;

  {
  {
#line 369
  tmp = __strtoull_internal(__nptr, __endptr, __base, 0);
  }
#line 369
  return (tmp);
}
}
#line 380
__inline static int atoi(char const   *__nptr )  __attribute__((__pure__)) ;
#line 380 "/usr/include/stdlib.h"
__inline static int atoi(char const   *__nptr ) 
{ long tmp ;

  {
  {
#line 383
  tmp = strtol((char const   */* __restrict  */)__nptr, (char **/* __restrict  */)((char **)((void *)0)),
               10);
  }
#line 383
  return ((int )tmp);
}
}
#line 109 "/usr/include/sys/select.h"
extern int select(int __nfds , fd_set * __restrict  __readfds , fd_set * __restrict  __writefds ,
                  fd_set * __restrict  __exceptfds , struct timeval * __restrict  __timeout ) ;
#line 423 "/usr/include/stdlib.h"
extern long random(void) ;
#line 426
extern void srandom(unsigned int __seed ) ;
#line 556
extern void *malloc(size_t __size )  __attribute__((__malloc__)) ;
#line 569
extern void free(void *__ptr ) ;
#line 594
extern  __attribute__((__noreturn__)) void abort(void) ;
#line 612
extern  __attribute__((__noreturn__)) void exit(int __status ) ;
#line 916
extern int getloadavg(double *__loadavg , int __nelem ) ;
#line 125 "/usr/include/locale.h"
extern char *setlocale(int __category , char const   *__locale ) ;
#line 38 "/usr/include/string.h"
extern void *memcpy(void * __restrict  __dest , void const   * __restrict  __src ,
                    size_t __n ) ;
#line 61
extern int memcmp(void const   *__s1 , void const   *__s2 , size_t __n )  __attribute__((__pure__)) ;
#line 85
extern char *strncpy(char * __restrict  __dest , char const   * __restrict  __src ,
                     size_t __n ) ;
#line 96
extern int strcmp(char const   *__s1 , char const   *__s2 )  __attribute__((__pure__)) ;
#line 99
extern int strncmp(char const   *__s1 , char const   *__s2 , size_t __n )  __attribute__((__pure__)) ;
#line 162
extern char *strchr(char const   *__s , int __c )  __attribute__((__pure__)) ;
#line 164
extern char *strrchr(char const   *__s , int __c )  __attribute__((__pure__)) ;
#line 186
extern char *strstr(char const   *__haystack , char const   *__needle )  __attribute__((__pure__)) ;
#line 230
extern size_t strlen(char const   *__s )  __attribute__((__pure__)) ;
#line 243
extern char *strerror(int __errnum ) ;
#line 287
extern int strcasecmp(char const   *__s1 , char const   *__s2 )  __attribute__((__pure__)) ;
#line 291
extern int strncasecmp(char const   *__s1 , char const   *__s2 , size_t __n )  __attribute__((__pure__)) ;
#line 1216 "/usr/include/bits/string2.h"
extern char *__strdup(char const   *__string )  __attribute__((__malloc__)) ;
#line 81 "/usr/include/ctype.h"
extern unsigned short const   **__ctype_b_loc(void)  __attribute__((__const__)) ;
#line 83
extern __int32_t const   **__ctype_tolower_loc(void)  __attribute__((__const__)) ;
#line 116
__inline static int tolower(int __c ) ;
#line 190 "/usr/include/ctype.h"
__inline static int tolower(int __c ) 
{ __int32_t tmp___0 ;
  __int32_t const   **tmp___1 ;

  {
#line 193
  if (__c >= -128) {
#line 193
    if (__c < 256) {
      {
#line 193
      tmp___1 = __ctype_tolower_loc();
#line 193
      tmp___0 = (*((*tmp___1) + __c));
      }
    } else {
#line 193
      tmp___0 = (int )((int const   )__c);
    }
  } else {
#line 193
    tmp___0 = (int )((int const   )__c);
  }
#line 193
  return (tmp___0);
}
}
#line 214 "/usr/include/signal.h"
extern int sigemptyset(sigset_t *__set ) ;
#line 220
extern int sigaddset(sigset_t *__set , int __signo ) ;
#line 246
extern int sigprocmask(int __how , sigset_t const   * __restrict  __set , sigset_t * __restrict  __oset ) ;
#line 257
extern int sigaction(int __sig , struct sigaction  const  * __restrict  __act , struct sigaction * __restrict  __oact ) ;
#line 289 "/usr/include/unistd.h"
extern __off64_t lseek(int __fd , __off64_t __offset , int __whence )  __asm__("lseek64")  ;
#line 318
extern ssize_t write(int __fd , void const   *__buf , size_t __n ) ;
#line 378
extern unsigned int alarm(unsigned int __seconds ) ;
#line 390
extern unsigned int sleep(unsigned int __seconds ) ;
#line 405
extern int usleep(__useconds_t __useconds ) ;
#line 418
extern int chown(char const   *__file , __uid_t __owner , __gid_t __group ) ;
#line 434
extern int chdir(char const   *__path ) ;
#line 448
extern char *getcwd(char *__buf , size_t __size ) ;
#line 469
extern int dup2(int __fd , int __fd2 ) ;
#line 474
extern char **environ ;
#line 519
extern  __attribute__((__noreturn__)) void _exit(int __status ) ;
#line 534
extern long sysconf(int __name )  __attribute__((__const__)) ;
#line 543
extern __pid_t getpid(void) ;
#line 605
extern __pid_t setsid(void) ;
#line 616
extern __uid_t geteuid(void) ;
#line 627
extern int getgroups(int __size , __gid_t *__list ) ;
#line 655
extern int setgid(__gid_t __gid ) ;
#line 665
extern int setegid(__gid_t __gid ) ;
#line 690
extern __pid_t fork(void) ;
#line 711
extern int isatty(int __fd ) ;
#line 722
extern int link(char const   *__from , char const   *__to ) ;
#line 736
extern int unlink(char const   *__name ) ;
#line 739
extern int rmdir(char const   *__path ) ;
#line 55 "/usr/include/getopt.h"
extern char *optarg ;
#line 844 "/usr/include/unistd.h"
extern int chroot(char const   *__path ) ;
#line 872
extern int getpagesize(void)  __attribute__((__const__)) ;
#line 896
extern int ftruncate(int __fd , __off64_t __length )  __asm__("ftruncate64")  ;
#line 72 "/usr/include/sys/time.h"
extern int gettimeofday(struct timeval * __restrict  __tv , __timezone_ptr_t __tz ) ;
#line 184 "/usr/include/time.h"
extern time_t time(time_t *__timer ) ;
#line 191
extern time_t mktime(struct tm *__tp ) ;
#line 197
extern size_t strftime(char * __restrict  __s , size_t __maxsize , char const   * __restrict  __format ,
                       struct tm  const  * __restrict  __tp ) ;
#line 229
extern struct tm *gmtime(time_t const   *__timer ) ;
#line 233
extern struct tm *localtime(time_t const   *__timer ) ;
#line 283
extern void tzset(void) ;
#line 215 "/usr/include/sys/stat.h"
__inline static int stat(char const   * __restrict  __path , struct stat * __restrict  __statbuf )  __asm__("stat64")  ;
#line 219
__inline static int fstat(int __fd , struct stat *__statbuf )  __asm__("fstat64")  ;
#line 239
__inline static int lstat(char const   * __restrict  __path , struct stat * __restrict  __statbuf )  __asm__("lstat64")  ;
#line 255
extern int chmod(char const   *__file , __mode_t __mode ) ;
#line 266
extern int fchmod(int __fd , __mode_t __mode ) ;
#line 272
extern __mode_t umask(__mode_t __mask ) ;
#line 281
extern int mkdir(char const   *__path , __mode_t __mode ) ;
#line 326
extern int __fxstat(int __ver , int __fildes , struct stat *__stat_buf )  __asm__("__fxstat64")  ;
#line 329
extern int __xstat(int __ver , char const   *__filename , struct stat *__stat_buf )  __asm__("__xstat64")  ;
#line 331
extern int __lxstat(int __ver , char const   *__filename , struct stat *__stat_buf )  __asm__("__lxstat64")  ;
#line 356
__inline static int stat(char const   * __restrict  __path , struct stat * __restrict  __statbuf )  __asm__("stat64")  ;
#line 356 "/usr/include/sys/stat.h"
__inline static int stat(char const   * __restrict  __path , struct stat * __restrict  __statbuf ) 
{ int tmp ;

  {
  {
#line 359
  tmp = __xstat(3, (char const   *)__path, (struct stat *)__statbuf);
  }
#line 359
  return (tmp);
}
}
#line 363
__inline static int lstat(char const   * __restrict  __path , struct stat * __restrict  __statbuf )  __asm__("lstat64")  ;
#line 363 "/usr/include/sys/stat.h"
__inline static int lstat(char const   * __restrict  __path , struct stat * __restrict  __statbuf ) 
{ int tmp ;

  {
  {
#line 366
  tmp = __lxstat(3, (char const   *)__path, (struct stat *)__statbuf);
  }
#line 366
  return (tmp);
}
}
#line 370
__inline static int fstat(int __fd , struct stat *__statbuf )  __asm__("fstat64")  ;
#line 370 "/usr/include/sys/stat.h"
__inline static int fstat(int __fd , struct stat *__statbuf ) 
{ int tmp ;

  {
  {
#line 372
  tmp = __fxstat(3, __fd, __statbuf);
  }
#line 372
  return (tmp);
}
}
#line 63 "/usr/include/fcntl.h"
extern int fcntl(int __fd , int __cmd  , ...) ;
#line 100 "/usr/include/sys/socket.h"
extern int socket(int __domain , int __type , int __protocol ) ;
#line 110
extern int bind(int __fd , struct sockaddr  const  * __restrict  __addr , socklen_t __len ) ;
#line 114
extern int getsockname(int __fd , struct sockaddr * __restrict  __addr , socklen_t * __restrict  __len ) ;
#line 124
extern int connect(int __fd , struct sockaddr  const  * __restrict  __addr , socklen_t __len ) ;
#line 128
extern int getpeername(int __fd , struct sockaddr * __restrict  __addr , socklen_t * __restrict  __len ) ;
#line 192
extern int setsockopt(int __fd , int __level , int __optname , void const   *__optval ,
                      socklen_t __optlen ) ;
#line 199
extern int listen(int __fd , int __n ) ;
#line 209
extern int accept(int __fd , struct sockaddr * __restrict  __addr , socklen_t * __restrict  __addr_len ) ;
#line 218
extern int shutdown(int __fd , int __how ) ;
#line 62 "/usr/include/sys/mman.h"
extern void *mmap(void *__addr , size_t __len , int __prot , int __flags , int __fd ,
                  __off64_t __offset )  __asm__("mmap64")  ;
#line 77
extern int munmap(void *__addr , size_t __len ) ;
#line 75 "/usr/include/sys/resource.h"
extern int setrlimit(__rlimit_resource_t __resource , struct rlimit  const  *__rlimits )  __asm__("setrlimit64")  ;
#line 111 "/usr/include/pwd.h"
extern struct passwd *getpwuid(__uid_t __uid ) ;
#line 117
extern struct passwd *getpwnam(char const   *__name ) ;
#line 178 "/usr/include/grp.h"
extern int setgroups(size_t __n , __gid_t const   *__groups ) ;
#line 199
extern int initgroups(char const   *__user , __gid_t __group ) ;
#line 59 "/usr/include/arpa/inet.h"
extern int inet_pton(int __af , char const   * __restrict  __cp , void * __restrict  __buf ) ;
#line 611 "/usr/include/netdb.h"
extern int getaddrinfo(char const   * __restrict  __name , char const   * __restrict  __service ,
                       struct addrinfo  const  * __restrict  __req , struct addrinfo ** __restrict  __pai ) ;
#line 617
extern void freeaddrinfo(struct addrinfo *__ai ) ;
#line 626
extern int getnameinfo(struct sockaddr  const  * __restrict  __sa , socklen_t __salen ,
                       char * __restrict  __host , socklen_t __hostlen , char * __restrict  __serv ,
                       socklen_t __servlen , unsigned int __flags ) ;
#line 65 "/usr/include/sys/statvfs.h"
extern int statvfs64(char const   * __restrict  __file , struct statvfs64 * __restrict  __buf ) ;
#line 46 "/usr/include/utime.h"
extern int utime(char const   *__file , struct utimbuf  const  *__file_times ) ;
#line 29 "/usr/include/sys/fsuid.h"
extern int setfsuid(__uid_t __uid ) ;
#line 32
extern int setfsgid(__gid_t __gid ) ;
#line 74 "/usr/include/sys/syslog.h"
CODE prioritynames[13]  = 
#line 74
  {      {(char *)"alert", 1}, 
        {(char *)"crit", 2}, 
        {(char *)"debug", 7}, 
        {(char *)"emerg", 0}, 
        {(char *)"err", 3}, 
        {(char *)"error", 3}, 
        {(char *)"info", 6}, 
        {(char *)"none", 16}, 
        {(char *)"notice", 5}, 
        {(char *)"panic", 0}, 
        {(char *)"warn", 4}, 
        {(char *)"warning", 4}, 
        {(char *)((void *)0), -1}};
#line 122 "/usr/include/sys/syslog.h"
CODE facilitynames[23]  = 
#line 122
  {      {(char *)"auth", 32}, 
        {(char *)"authpriv", 80}, 
        {(char *)"cron", 72}, 
        {(char *)"daemon", 24}, 
        {(char *)"ftp", 88}, 
        {(char *)"kern", 0}, 
        {(char *)"lpr", 48}, 
        {(char *)"mail", 16}, 
        {(char *)"mark", 192}, 
        {(char *)"news", 56}, 
        {(char *)"security", 32}, 
        {(char *)"syslog", 40}, 
        {(char *)"user", 8}, 
        {(char *)"uucp", 64}, 
        {(char *)"local0", 128}, 
        {(char *)"local1", 136}, 
        {(char *)"local2", 144}, 
        {(char *)"local3", 152}, 
        {(char *)"local4", 160}, 
        {(char *)"local5", 168}, 
        {(char *)"local6", 176}, 
        {(char *)"local7", 184}, 
        {(char *)((void *)0), -1}};
#line 175
extern void closelog(void) ;
#line 181
extern void openlog(char const   *__ident , int __option , int __facility ) ;
#line 190
extern void syslog(int __pri , char const   *__fmt  , ...) ;
#line 318 "ftpd.h"
int safe_write(int fd , void const   *buf_ , size_t count___0 ) ;
#line 320
void parser(void) ;
#line 321
void stripctrl(char *buf , size_t len ) ;
#line 322
void dobanner(int type___0 ) ;
#line 323
void douser(char const   *username ) ;
#line 324
void dopass(char *password ) ;
#line 325
void docwd(char const   *dir ) ;
#line 326
void doretr(char *name ) ;
#line 327
void dorest(char const   *name ) ;
#line 328
void dodele(char *name ) ;
#line 329
void dostor(char *name , int append , int autorename___0 ) ;
#line 330
void domkd(char *name ) ;
#line 331
void dormd(char *name ) ;
#line 332
void domdtm(char const   *name ) ;
#line 333
void dosize(char const   *name ) ;
#line 334
void doeprt(char *p ) ;
#line 335
void doport(char const   *arg ) ;
#line 336
void doport2(struct sockaddr_storage a , unsigned int p ) ;
#line 338
void doesta(void) ;
#line 339
void doestp(void) ;
#line 341
void dopasv(int psvtype ) ;
#line 342
void doopts(char *args ) ;
#line 343
void dochmod(char *name , mode_t mode ) ;
#line 344
void doutime(char *name , char const   *wanted_time ) ;
#line 345
void error(int n , char const   *msg ) ;
#line 346
void domode(char const   *arg ) ;
#line 347
void dostru(char const   *arg ) ;
#line 348
void dotype(char const   *arg ) ;
#line 349
void donoop(void) ;
#line 350
void dornfr(char *name ) ;
#line 351
void dornto(char *name ) ;
#line 352
void dostou(void) ;
#line 353
void dofeat(void) ;
#line 354
void domlst(char const   *file ) ;
#line 355
void dositetime(void) ;
#line 363
void opendata(void) ;
#line 364
void closedata(void) ;
#line 365
void addreply(int code , char const   *line  , ...) ;
#line 367
void addreply_noformat(int code , char const   *line ) ;
#line 368
void doreply(void) ;
#line 372
void logfile(int crit , char const   *format  , ...) ;
#line 374
void die(int err , int priority , char const   *format  , ...) ;
#line 376
void die_mem(void) ;
#line 377
void setprocessname(char const   *title ) ;
#line 378
int modernformat(char const   *file , char *target , size_t target_size ) ;
#line 381
char const   *getgroup(gid_t gid ) ;
#line 382
char const   *getname(uid_t uid ) ;
#line 383
unsigned int zrand(void) ;
#line 384
void simplify(char *subdir ) ;
#line 385
int checkprintable(char const   *s ) ;
#line 386
void delete_atomic_file(void) ;
#line 4 "log_unix.h"
void pw_unix_check(AuthResult *result , char const   *account___0 , char const   *password ,
                   struct sockaddr_storage  const  *sa , struct sockaddr_storage  const  *peer___0 ) ;
#line 160 "/usr/include/getopt.h"
extern int getopt_long(int ___argc , char * const  *___argv , char const   *__shortopts ,
                       struct option  const  *__longopts , int *__longind ) ;
#line 135 "/usr/include/sys/wait.h"
extern __pid_t waitpid(__pid_t __pid , int *__stat_loc , int __options ) ;
#line 49 "ftpd_p.h"
static sig_atomic_t volatile   stop_server  ;
#line 50 "ftpd_p.h"
static char const   *standalone_port  =    "21";
#line 51 "ftpd_p.h"
static char const   *standalone_ip  ;
#line 52 "ftpd_p.h"
static unsigned int volatile   nb_children  ;
#line 53 "ftpd_p.h"
static int volatile   listenfd  =    (int volatile   )-1;
#line 54 "ftpd_p.h"
static int volatile   listenfd6  =    (int volatile   )-1;
#line 62 "ftpd_p.h"
static char const   *GETOPT_OPTIONS  =    "0146Aa:bc:BC:dDeEf:g:GhHiI:jk:Kl:L:Mm:Np:P:rRsS:u:U:V:wWxXzZ";
#line 112 "ftpd_p.h"
static struct option long_options[47]  = 
#line 112
  {      {"notruncate", 0, (int *)((void *)0), '0'}, 
        {"logpid", 0, (int *)((void *)0), '1'}, 
        {"ipv4only", 0, (int *)((void *)0), '4'}, 
        {"ipv6only", 0, (int *)((void *)0), '6'}, 
        {"chrooteveryone", 0, (int *)((void *)0), 'A'}, 
        {"trustedgid", 1, (int *)((void *)0), 'a'}, 
        {"brokenclientscompatibility", 0, (int *)((void *)0), 'b'}, 
        {"daemonize", 0, (int *)((void *)0), 'B'}, 
        {"maxclientsperip", 1, (int *)((void *)0), 'C'}, 
        {"maxclientsnumber", 1, (int *)((void *)0), 'c'}, 
        {"verboselog", 0, (int *)((void *)0), 'd'}, 
        {"displaydotfiles", 0, (int *)((void *)0), 'D'}, 
        {"anonymousonly", 0, (int *)((void *)0), 'e'}, 
        {"noanonymous", 0, (int *)((void *)0), 'E'}, 
        {"syslogfacility", 1, (int *)((void *)0), 'f'}, 
        {"pidfile", 1, (int *)((void *)0), 'g'}, 
        {"norename", 0, (int *)((void *)0), 'G'}, 
        {"help", 0, (int *)((void *)0), 'h'}, 
        {"dontresolve", 0, (int *)((void *)0), 'H'}, 
        {"maxidletime", 1, (int *)((void *)0), 'I'}, 
        {"anonymouscantupload", 0, (int *)((void *)0), 'i'}, 
        {"createhomedir", 0, (int *)((void *)0), 'j'}, 
        {"keepallfiles", 0, (int *)((void *)0), 'K'}, 
        {"maxdiskusagepct", 1, (int *)((void *)0), 'k'}, 
        {"login", 1, (int *)((void *)0), 'l'}, 
        {"limitrecursion", 1, (int *)((void *)0), 'L'}, 
        {"anonymouscancreatedirs", 0, (int *)((void *)0), 'M'}, 
        {"maxload", 1, (int *)((void *)0), 'm'}, 
        {"natmode", 0, (int *)((void *)0), 'N'}, 
        {"passiveportrange", 1, (int *)((void *)0), 'p'}, 
        {"forcepassiveip", 1, (int *)((void *)0), 'P'}, 
        {"autorename", 0, (int *)((void *)0), 'r'}, 
        {"nochmod", 0, (int *)((void *)0), 'R'}, 
        {"antiwarez", 0, (int *)((void *)0), 's'}, 
        {"bind", 1, (int *)((void *)0), 'S'}, 
        {"anonymousbandwidth", 1, (int *)((void *)0), 't'}, 
        {"userbandwidth", 1, (int *)((void *)0), 'T'}, 
        {"umask", 1, (int *)((void *)0), 'U'}, 
        {"minuid", 1, (int *)((void *)0), 'u'}, 
        {"trustedip", 1, (int *)((void *)0), 'V'}, 
        {"allowuserfxp", 0, (int *)((void *)0), 'w'}, 
        {"allowanonymousfxp", 0, (int *)((void *)0), 'W'}, 
        {"prohibitdotfileswrite", 0, (int *)((void *)0), 'x'}, 
        {"prohibitdotfilesread", 0, (int *)((void *)0), 'X'}, 
        {"allowdotfiles", 0, (int *)((void *)0), 'z'}, 
        {"customerproof", 0, (int *)((void *)0), 'Z'}, 
        {(char const   *)((void *)0), 0, (int *)((void *)0), 0}};
#line 230 "ftpd_p.h"
static char **argv0  ;
#line 231 "ftpd_p.h"
static int argv_lth  ;
#line 256 "ftpd_p.h"
static Authentication auth_list[2]  = {      {"unix", (void (*)(char const   *file ))((void *)0), & pw_unix_check, (void (*)(void))((void *)0)}, 
        {(char const   *)((void *)0),
      (void (*)(char const   *file ))((void *)0), (void (*)(AuthResult *result , char const   *account ,
                                                            char const   *password ,
                                                            struct sockaddr_storage  const  *sa ,
                                                            struct sockaddr_storage  const  *peer ))((void *)0),
      (void (*)(void))((void *)0)}};
#line 291 "ftpd_p.h"
static Authentications *first_authentications  ;
#line 291 "ftpd_p.h"
static Authentications *last_authentications  ;
#line 304 "ftpd_p.h"
static struct reply *firstreply  ;
#line 305 "ftpd_p.h"
static struct reply *lastreply  ;
#line 11 "dynamic.h"
void iptrack_delete_pid(pid_t pid ) ;
#line 12
unsigned int iptrack_get(struct sockaddr_storage  const  *ip ) ;
#line 13
void iptrack_free(void) ;
#line 14
void iptrack_add(struct sockaddr_storage  const  *ip , pid_t pid ) ;
#line 12 "globals.h"
unsigned long long downloaded  ;
#line 13 "globals.h"
unsigned long long uploaded  ;
#line 14 "globals.h"
signed char anon_only  ;
#line 15 "globals.h"
struct sockaddr_storage *trustedip  ;
#line 16 "globals.h"
signed char volatile   logging  ;
#line 23 "globals.h"
signed char allowfxp  ;
#line 24 "globals.h"
signed char passive  ;
#line 25 "globals.h"
int datafd  =    -1;
#line 26 "globals.h"
struct sockaddr_storage ctrlconn  ;
#line 27 "globals.h"
signed char v6ready  ;
#line 28 "globals.h"
signed char no_ipv4  ;
#line 29 "globals.h"
unsigned int const   cmdsize  =    (unsigned int const   )4112U;
#line 30 "globals.h"
char cmd[4128]  ;
#line 31 "globals.h"
char wd[4097]  ;
#line 32 "globals.h"
char *root_directory  ;
#line 33 "globals.h"
signed char loggedin  ;
#line 34 "globals.h"
char account[128]  ;
#line 35 "globals.h"
char *renamefrom  ;
#line 36 "globals.h"
unsigned short serverport  ;
#line 37 "globals.h"
signed char userchroot  ;
#line 38 "globals.h"
signed char chrooted  ;
#line 39 "globals.h"
uid_t chroot_trustedgid  ;
#line 40 "globals.h"
signed char broken_client_compat  ;
#line 41 "globals.h"
uid_t warez  ;
#line 42 "globals.h"
signed char debug  ;
#line 43 "globals.h"
signed char guest  ;
#line 44 "globals.h"
uid_t useruid  ;
#line 45 "globals.h"
signed char candownload  ;
#line 46 "globals.h"
double load  ;
#line 47 "globals.h"
time_t noopidle  =    -1L;
#line 48 "globals.h"
unsigned int firstport  =    1024U;
#line 49 "globals.h"
unsigned int lastport  =    65534U;
#line 50 "globals.h"
signed char dot_write_ok  =    1;
#line 51 "globals.h"
signed char dot_read_ok  =    1;
#line 52 "globals.h"
signed char dot_read_anon_ok  ;
#line 54 "globals.h"
signed char type  =    1;
#line 63 "globals.h"
off_t restartat  ;
#line 64 "globals.h"
unsigned long idletime  =    900UL;
#line 65 "globals.h"
double idletime_noop  ;
#line 66 "globals.h"
signed char resolve_hostnames  =    1;
#line 67 "globals.h"
int allow_anon_mkdir  ;
#line 68 "globals.h"
unsigned int max_ls_files  =    2000U;
#line 69 "globals.h"
unsigned int max_ls_depth  =    5U;
#line 70 "globals.h"
char *fortunes_file  ;
#line 71 "globals.h"
char host[1025]  ;
#line 72 "globals.h"
int replycode  ;
#line 73 "globals.h"
signed char force_ls_a  ;
#line 74 "globals.h"
struct sockaddr_storage peer  ;
#line 75 "globals.h"
struct sockaddr_storage force_passive_ip  ;
#line 76 "globals.h"
char const   *force_passive_ip_s  ;
#line 77 "globals.h"
unsigned short peerdataport  ;
#line 78 "globals.h"
double maxload  ;
#line 79 "globals.h"
unsigned int maxusers  =    50U;
#line 84 "globals.h"
int iptropy  ;
#line 85 "globals.h"
int volatile   xferfd  =    (int volatile   )-1;
#line 87 "globals.h"
unsigned int maxip  ;
#line 90 "globals.h"
signed char standalone  ;
#line 92 "globals.h"
signed char epsv_all  ;
#line 93 "globals.h"
double maxdiskusagepct  ;
#line 94 "globals.h"
signed char disallow_passive  ;
#line 95 "globals.h"
mode_t u_mask  =    91U;
#line 96 "globals.h"
mode_t u_mask_d  =    18U;
#line 97 "globals.h"
signed char state_needs_update  =    1;
#line 98 "globals.h"
signed char no_syslog  ;
#line 99 "globals.h"
int syslog_facility  =    88;
#line 100 "globals.h"
signed char autorename  ;
#line 101 "globals.h"
signed char anon_noupload  ;
#line 102 "globals.h"
signed char nochmod  ;
#line 103 "globals.h"
signed char keepallfiles  ;
#line 106 "globals.h"
signed char modern_listings  ;
#line 110 "globals.h"
signed char daemonize  ;
#line 126 "globals.h"
signed char create_home  ;
#line 127 "globals.h"
signed char disallow_rename  ;
#line 128 "globals.h"
signed char no_truncate  ;
#line 130 "globals.h"
size_t page_size  ;
#line 131 "globals.h"
size_t map_size  ;
#line 132 "globals.h"
size_t dl_chunk_size  ;
#line 133 "globals.h"
size_t ul_chunk_size  ;
#line 134 "globals.h"
int log_pid  ;
#line 149 "globals.h"
char const   *months[12]  = 
#line 149
  {      "Jan",      "Feb",      "Mar",      "Apr", 
        "May",      "Jun",      "Jul",      "Aug", 
        "Sep",      "Oct",      "Nov",      "Dec"};
#line 156 "globals.h"
AuthResult authresult  ;
#line 157 "globals.h"
time_t session_start_time  ;
#line 160 "globals.h"
char const   *pid_file  =    "/var/run/pure-ftpd.pid";
#line 163 "globals.h"
signed char be_customer_proof  ;
#line 169 "globals.h"
char *atomic_prefix  ;
#line 4 "caps.h"
void drop_login_caps(void) ;
#line 5
void set_initial_caps(void) ;
#line 67 "ftpd.c"
int safe_write(int fd , void const   *buf_ , size_t count___0 ) 
{ ssize_t written ;
  register char const   *buf ;
  int *tmp ;
  int *tmp___0 ;

  {
#line 70
  buf = (char const   *)buf_;
  {
#line 72
  while (1) {
    while_9_continue: /* CIL Label */ ;
#line 72
    if (! (count___0 > 0U)) {
      goto while_9_break;
    }
    {
#line 73
    while (1) {
      while_10_continue: /* CIL Label */ ;
      {
#line 74
      written = write(fd, (void const   *)buf, count___0);
      }
#line 74
      if (written <= 0) {
        {
#line 75
        tmp___0 = __errno_location();
        }
#line 75
        if ((*tmp___0) == 11) {
          {
#line 76
          sleep(1U);
          }
        } else {
          {
#line 77
          tmp = __errno_location();
          }
#line 77
          if ((*tmp) != 4) {
#line 78
            return (-1);
          }
        }
        goto __Cont;
      }
      goto while_10_break;
      __Cont: ;
    }
    while_10_break: /* CIL Label */ ;
    }
#line 84
    buf += written;
#line 85
    count___0 -= (unsigned int )written;
  }
  while_9_break: /* CIL Label */ ;
  }
#line 87
  return (0);
}
}
#line 90 "ftpd.c"
static void overlapcpy(char *d , char const   *s ) 
{ char *tmp ;
  char const   *tmp___0 ;

  {
  {
#line 92
  while (1) {
    while_11_continue: /* CIL Label */ ;
#line 92
    if (! ((int const   )(*s) != 0)) {
      goto while_11_break;
    }
#line 93
    tmp = d;
#line 93
    d ++;
#line 93
    tmp___0 = s;
#line 93
    s ++;
#line 93
    (*tmp) = (char )(*tmp___0);
  }
  while_11_break: /* CIL Label */ ;
  }
#line 95
  (*d) = 0;
#line 96
  return;
}
}
#line 98 "ftpd.c"
static void safe_fd_set(int fd , fd_set *fds ) 
{ 

  {
#line 100
  if (fd == -1) {
#line 101
    return;
  }
#line 103
  __asm__  volatile   ("btsl %1,%0": "=m" (fds->fds_bits[(unsigned int )fd / (8U *
                                                                              sizeof(__fd_mask ))]): "r" ((unsigned int )fd %
                                                                                                          (8U *
                                                                                                           sizeof(__fd_mask ))): "cc",
                       "memory");
#line 104
  return;
}
}
#line 106 "ftpd.c"
static int safe_fd_isset(int fd , fd_set const   *fds ) 
{ register char __result ;

  {
#line 108
  if (fd == -1) {
#line 109
    return (0);
  }
#line 111
  __asm__  volatile   ("btl %1,%2 ; setcb %b0": "=q" (__result): "r" ((unsigned int )fd %
                                                                      (8U * sizeof(__fd_mask ))),
                       "m" (fds->fds_bits[(unsigned int )fd / (8U * sizeof(__fd_mask ))]): "cc");
#line 111
  return ((int )__result);
}
}
#line 114 "ftpd.c"
void simplify(char *subdir ) 
{ char *a ;
  int tmp___10 ;
  size_t __s1_len___0 ;
  size_t __s2_len___0 ;
  int tmp___15 ;
  size_t tmp___16 ;
  int tmp___17 ;
  int tmp___18 ;
  int tmp___32 ;
  size_t __s1_len___2 ;
  size_t __s2_len___2 ;
  int tmp___37 ;
  size_t tmp___38 ;
  int tmp___39 ;
  int tmp___40 ;
  char *nextcomponent ;
  size_t tmp___43 ;

  {
#line 118
  if ((unsigned int )subdir == (unsigned int )((void *)0)) {
#line 119
    return;
  } else {
#line 118
    if ((int )(*subdir) == 0) {
#line 119
      return;
    }
  }
  {
#line 121
  while (1) {
    while_12_continue: /* CIL Label */ ;
    {
#line 121
    a = strstr((char const   *)subdir, "//");
    }
#line 121
    if (! ((unsigned int )a != (unsigned int )((void *)0))) {
      goto while_12_break;
    }
    {
#line 122
    overlapcpy(a, (char const   *)(a + 1));
    }
  }
  while_12_break: /* CIL Label */ ;
  }
  {
#line 124
  while (1) {
    while_13_continue: /* CIL Label */ ;
    {
#line 124
    a = strstr((char const   *)subdir, "/./");
    }
#line 124
    if (! ((unsigned int )a != (unsigned int )((void *)0))) {
      goto while_13_break;
    }
    {
#line 125
    overlapcpy(a, (char const   *)(a + 2));
    }
  }
  while_13_break: /* CIL Label */ ;
  }
  {
#line 127
  while (1) {
    while_14_continue: /* CIL Label */ ;
#line 127
    if (0) {
#line 127
      if (0) {
        {
#line 127
        __s1_len___0 = strlen((char const   *)subdir);
#line 127
        __s2_len___0 = strlen("../");
        }
#line 127
        if (! ((unsigned int )((void const   *)(subdir + 1)) - (unsigned int )((void const   *)subdir) ==
               1U)) {
          goto _L___2;
        } else {
#line 127
          if (__s1_len___0 >= 4U) {
            _L___2: 
#line 127
            if (! ((unsigned int )((void const   *)("../" + 1)) - (unsigned int )((void const   *)"../") ==
                   1U)) {
#line 127
              tmp___18 = 1;
            } else {
#line 127
              if (__s2_len___0 >= 4U) {
#line 127
                tmp___18 = 1;
              } else {
#line 127
                tmp___18 = 0;
              }
            }
          } else {
#line 127
            tmp___18 = 0;
          }
        }
#line 127
        if (tmp___18) {
#line 127
          if (__s1_len___0 < __s2_len___0) {
#line 127
            tmp___16 = __s1_len___0;
          } else {
#line 127
            tmp___16 = __s2_len___0;
          }
          {
#line 127
          tmp___15 = memcmp((void const   *)((char const   *)subdir), (void const   *)"../",
                            tmp___16 + 1U);
          }
        } else {
          {
#line 127
          tmp___17 = strcmp((char const   *)subdir, "../");
#line 127
          tmp___15 = tmp___17;
          }
        }
      } else {
        {
#line 127
        tmp___17 = strcmp((char const   *)subdir, "../");
#line 127
        tmp___15 = tmp___17;
        }
      }
#line 127
      tmp___10 = tmp___15;
    } else {
      {
#line 127
      tmp___10 = strncmp((char const   *)subdir, "../", 3U);
      }
    }
#line 127
    if (! (tmp___10 == 0)) {
      goto while_14_break;
    }
#line 128
    subdir += 3;
  }
  while_14_break: /* CIL Label */ ;
  }
  {
#line 130
  a = strstr((char const   *)subdir, "/../");
  }
#line 131
  if ((unsigned int )a != (unsigned int )((void *)0)) {
#line 132
    if ((unsigned int )a == (unsigned int )subdir) {
      {
#line 133
      while (1) {
        while_15_continue: /* CIL Label */ ;
#line 133
        if (0) {
#line 133
          if (0) {
            {
#line 133
            __s1_len___2 = strlen((char const   *)subdir);
#line 133
            __s2_len___2 = strlen("/../");
            }
#line 133
            if (! ((unsigned int )((void const   *)(subdir + 1)) - (unsigned int )((void const   *)subdir) ==
                   1U)) {
              goto _L___6;
            } else {
#line 133
              if (__s1_len___2 >= 4U) {
                _L___6: 
#line 133
                if (! ((unsigned int )((void const   *)("/../" + 1)) - (unsigned int )((void const   *)"/../") ==
                       1U)) {
#line 133
                  tmp___40 = 1;
                } else {
#line 133
                  if (__s2_len___2 >= 4U) {
#line 133
                    tmp___40 = 1;
                  } else {
#line 133
                    tmp___40 = 0;
                  }
                }
              } else {
#line 133
                tmp___40 = 0;
              }
            }
#line 133
            if (tmp___40) {
#line 133
              if (__s1_len___2 < __s2_len___2) {
#line 133
                tmp___38 = __s1_len___2;
              } else {
#line 133
                tmp___38 = __s2_len___2;
              }
              {
#line 133
              tmp___37 = memcmp((void const   *)((char const   *)subdir), (void const   *)"/../",
                                tmp___38 + 1U);
              }
            } else {
              {
#line 133
              tmp___39 = strcmp((char const   *)subdir, "/../");
#line 133
              tmp___37 = tmp___39;
              }
            }
          } else {
            {
#line 133
            tmp___39 = strcmp((char const   *)subdir, "/../");
#line 133
            tmp___37 = tmp___39;
            }
          }
#line 133
          tmp___32 = tmp___37;
        } else {
          {
#line 133
          tmp___32 = strncmp((char const   *)subdir, "/../", 4U);
          }
        }
#line 133
        if (! (tmp___32 == 0)) {
          goto while_15_break;
        }
        {
#line 134
        overlapcpy(subdir, (char const   *)(subdir + 3));
        }
      }
      while_15_break: /* CIL Label */ ;
      }
      {
#line 136
      a = strstr((char const   *)subdir, "/../");
      }
    }
    {
#line 138
    while (1) {
      while_16_continue: /* CIL Label */ ;
#line 138
      if (! ((unsigned int )a != (unsigned int )((void *)0))) {
        goto while_16_break;
      }
#line 139
      nextcomponent = a + 4;
#line 140
      if ((unsigned int )a != (unsigned int )subdir) {
#line 140
        if ((int )(*a) == 47) {
#line 141
          a --;
        }
      }
      {
#line 143
      while (1) {
        while_17_continue: /* CIL Label */ ;
#line 143
        if ((unsigned int )a != (unsigned int )subdir) {
#line 143
          if (! ((int )(*a) != 47)) {
            goto while_17_break;
          }
        } else {
          goto while_17_break;
        }
#line 144
        a --;
      }
      while_17_break: /* CIL Label */ ;
      }
#line 146
      if ((int )(*a) == 47) {
#line 147
        a ++;
      }
      {
#line 149
      overlapcpy(a, (char const   *)nextcomponent);
#line 150
      a = strstr((char const   *)subdir, "/../");
      }
    }
    while_16_break: /* CIL Label */ ;
    }
  }
#line 153
  a = subdir;
#line 154
  if ((int )(*a) == 46) {
#line 155
    a ++;
#line 156
    if ((int )(*a) == 0) {
#line 157
      return;
    }
#line 159
    if ((int )(*a) == 47) {
      {
#line 160
      while (1) {
        while_18_continue: /* CIL Label */ ;
#line 160
        if (! ((int )(*a) == 47)) {
          goto while_18_break;
        }
#line 161
        a ++;
      }
      while_18_break: /* CIL Label */ ;
      }
      {
#line 163
      overlapcpy(subdir, (char const   *)a);
      }
    }
  }
#line 166
  if ((int )(*a) == 0) {
#line 167
    return;
  }
  {
#line 169
  tmp___43 = strlen((char const   *)subdir);
#line 169
  a = (subdir + tmp___43) - 1U;
  }
#line 170
  if ((int )(*a) != 46) {
#line 171
    return;
  } else {
#line 170
    if ((unsigned int )a == (unsigned int )subdir) {
#line 171
      return;
    }
  }
#line 173
  a --;
#line 174
  if ((int )(*a) == 47) {
#line 175
    (*(a + 1)) = 0;
#line 176
    return;
  } else {
#line 174
    if ((unsigned int )a == (unsigned int )subdir) {
#line 175
      (*(a + 1)) = 0;
#line 176
      return;
    }
  }
#line 178
  if ((int )(*a) != 46) {
#line 179
    return;
  } else {
#line 178
    if ((unsigned int )a == (unsigned int )subdir) {
#line 179
      return;
    }
  }
#line 181
  a --;
#line 182
  if ((int )(*a) != 47) {
#line 183
    return;
  }
  {
#line 185
  (*a) = 0;
#line 186
  a = strrchr((char const   *)subdir, '/');
  }
#line 186
  if ((unsigned int )a == (unsigned int )((void *)0)) {
#line 187
    (*subdir) = (char )'/';
#line 188
    (*(subdir + 1)) = 0;
#line 189
    return;
  }
#line 191
  (*(a + 1)) = 0;
#line 192
  return;
}
}
#line 194 "ftpd.c"
int checkprintable(char const   *s ) 
{ register int ret ;
  register unsigned char c ;

  {
#line 196
  ret = 0;
  {
#line 199
  while (1) {
    while_19_continue: /* CIL Label */ ;
#line 199
    c = (unsigned char )(*s);
#line 199
    if (! ((unsigned int )c != 0U)) {
      goto while_19_break;
    }
#line 200
    if ((int )c == 127) {
#line 201
      ret --;
      goto while_19_break;
    } else {
#line 200
      if ((unsigned int )c < 32U) {
#line 201
        ret --;
        goto while_19_break;
      }
    }
#line 204
    s ++;
  }
  while_19_break: /* CIL Label */ ;
  }
#line 207
  return (ret);
}
}
#line 210 "ftpd.c"
void die(int err , int priority , char const   *format  , ...) 
{ va_list va ;
  char line[4608] ;

  {
  {
#line 215
  __builtin_stdarg_start(va, format);
#line 219
  vsnprintf((char */* __restrict  */)(line), sizeof(line), (char const   */* __restrict  */)format,
            va);
#line 228
  printf((char const   */* __restrict  */)"%d %s\r\n", err, line);
#line 231
  fflush(stdout);
#line 232
  logfile(priority, "%s", line);
#line 233
  __builtin_va_end(va);
  }
  {
#line 234
  while (1) {
    while_20_continue: /* CIL Label */ ;
    {
#line 234
    delete_atomic_file();
#line 234
    _exit(- priority - 1);
    }
    goto while_20_break;
  }
  while_20_break: /* CIL Label */ ;
  }
#line 235
  return;
}
}
#line 237 "ftpd.c"
void die_mem(void) 
{ 

  {
  {
#line 239
  die(421, 3, "Out of memory");
  }
#line 240
  return;
}
}
#line 242 "ftpd.c"
static void sigurg(int sig ) 
{ int olderrno ;
  int readen ;
  unsigned char fodder ;
  int *tmp ;
  int *tmp___0 ;
  int *tmp___1 ;

  {
#line 249
  if (xferfd == -1) {
#line 250
    return;
  }
  {
#line 252
  tmp = __errno_location();
#line 252
  olderrno = (*tmp);
#line 253
  closedata();
#line 257
  addreply_noformat(426, "Transfer aborted");
#line 258
  doreply();
  }
  {
#line 259
  while (1) {
    while_21_continue: /* CIL Label */ ;
    {
#line 260
    readen = read(0, (void *)(& fodder), 1U);
    }
#line 260
    if (readen < 0) {
      {
#line 260
      tmp___0 = __errno_location();
      }
#line 260
      if ((*tmp___0) == 4) {
        goto __Cont;
      }
    }
    __Cont: 
#line 259
    if (readen > 0) {
#line 259
      if (! ((int )fodder != 10)) {
        goto while_21_break;
      }
    } else {
      goto while_21_break;
    }
  }
  while_21_break: /* CIL Label */ ;
  }
  {
#line 265
  addreply_noformat(226, "Transfer aborted");
#line 266
  doreply();
#line 270
  tmp___1 = __errno_location();
#line 270
  (*tmp___1) = olderrno;
  }
#line 271
  return;
}
}
#line 273 "ftpd.c"
static void sigalarm(int sig ) 
{ 

  {
  {
#line 279
  die(421, 6, "Timeout");
  }
#line 280
  return;
}
}
#line 283 "ftpd.c"
static void sigchild(int sig ) 
{ int olderrno ;
  int *tmp ;
  pid_t pid ;
  int *tmp___0 ;

  {
  {
#line 285
  tmp = __errno_location();
#line 285
  olderrno = (*tmp);
  }
  {
#line 290
  while (1) {
    while_22_continue: /* CIL Label */ ;
    {
#line 290
    pid = waitpid(-1, (int *)((void *)0), 1);
    }
#line 290
    if (! (pid > 0)) {
      goto while_22_break;
    }
#line 291
    if (nb_children > 0U) {
#line 292
      nb_children --;
    }
    {
#line 297
    iptrack_delete_pid(pid);
    }
  }
  while_22_break: /* CIL Label */ ;
  }
  {
#line 310
  tmp___0 = __errno_location();
#line 310
  (*tmp___0) = olderrno;
  }
#line 311
  return;
}
}
#line 314 "ftpd.c"
static void sigterm_client(int sig ) 
{ 

  {
  {
#line 321
  while (1) {
    while_23_continue: /* CIL Label */ ;
    {
#line 321
    delete_atomic_file();
#line 321
    _exit(0);
    }
    goto while_23_break;
  }
  while_23_break: /* CIL Label */ ;
  }
#line 322
  return;
}
}
#line 325 "ftpd.c"
static void sigterm(int sig ) 
{ int olderrno ;
  int *tmp ;
  int *tmp___0 ;

  {
  {
#line 327
  tmp = __errno_location();
#line 327
  olderrno = (*tmp);
#line 330
  stop_server = (int volatile   )1;
  }
#line 331
  if (listenfd != -1) {
    {
#line 332
    shutdown((int )listenfd, 2);
#line 333
    close((int )listenfd);
    }
  }
#line 335
  if (listenfd6 != -1) {
    {
#line 336
    shutdown((int )listenfd6, 2);
#line 337
    close((int )listenfd6);
    }
  }
  {
#line 339
  tmp___0 = __errno_location();
#line 339
  (*tmp___0) = olderrno;
  }
#line 340
  return;
}
}
#line 342 "ftpd.c"
static void set_cloexec_flag(int fd ) 
{ 

  {
  {
#line 344
  fcntl(fd, 2, 1);
  }
#line 345
  return;
}
}
#line 348 "ftpd.c"
static void clearargs(int argc , char **argv ) 
{ int i ;
  size_t tmp ;
  size_t tmp___0 ;
  char **new_environ ;
  unsigned int env_nb ;
  char *tmp___11 ;

  {
#line 354
  i = 0;
  {
#line 354
  while (1) {
    while_24_continue: /* CIL Label */ ;
#line 354
    if (! ((unsigned int )(*(environ + i)) != (unsigned int )((void *)0))) {
      goto while_24_break;
    }
#line 354
    i ++;
  }
  while_24_break: /* CIL Label */ ;
  }
#line 355
  argv0 = argv;
#line 356
  if (i > 0) {
    {
#line 357
    tmp = strlen((char const   *)(*(environ + (i - 1))));
#line 357
    argv_lth = ((*(environ + (i - 1))) + tmp) - (*(argv0 + 0));
    }
  } else {
    {
#line 359
    tmp___0 = strlen((char const   *)(*(argv0 + (argc - 1))));
#line 359
    argv_lth = ((*(argv0 + (argc - 1))) + tmp___0) - (*(argv0 + 0));
    }
  }
#line 361
  if ((unsigned int )environ != (unsigned int )((void *)0)) {
#line 363
    env_nb = 0U;
    {
#line 365
    while (1) {
      while_25_continue: /* CIL Label */ ;
#line 365
      if (! ((unsigned int )(*(environ + env_nb)) != (unsigned int )((void *)0))) {
        goto while_25_break;
      }
#line 366
      env_nb ++;
    }
    while_25_break: /* CIL Label */ ;
    }
    {
#line 368
    new_environ = (char **)malloc((1U + env_nb) * sizeof(char *));
    }
#line 368
    if ((unsigned int )new_environ == (unsigned int )((void *)0)) {
      {
#line 369
      abort();
      }
    }
#line 371
    (*(new_environ + env_nb)) = (char *)((void *)0);
    {
#line 372
    while (1) {
      while_26_continue: /* CIL Label */ ;
#line 372
      if (! (env_nb > 0U)) {
        goto while_26_break;
      }
      {
#line 373
      env_nb --;
#line 375
      tmp___11 = __strdup((char const   *)(*(environ + env_nb)));
#line 375
      (*(new_environ + env_nb)) = tmp___11;
      }
    }
    while_26_break: /* CIL Label */ ;
    }
#line 377
    environ = new_environ;
  }
#line 384
  return;
}
}
#line 386 "ftpd.c"
void setprocessname(char const   *title ) 
{ void *__s ;
  void *__s___0 ;
  union __anonunion___u_69 *__u ;
  __uint8_t __c ;
  void *__s___1 ;

  {
#line 393
  if ((unsigned int )argv0 != (unsigned int )((void *)0)) {
#line 394
    if (0) {
#line 394
      if (argv_lth == 1) {
#line 394
        __s___1 = (void *)(*(argv0 + 0));
#line 394
        (*((__uint8_t *)__s___1)) = 0;
      } else {
#line 394
        __s___0 = (void *)(*(argv0 + 0));
#line 394
        __u = (union __anonunion___u_69 *)__s___0;
#line 394
        __c = 0;
#line 395
        if ((int )((unsigned int )argv_lth) == 15) {
          goto switch_27_15;
        } else {
#line 395
          if ((int )((unsigned int )argv_lth) == 11) {
            goto switch_27_11;
          } else {
#line 395
            if ((int )((unsigned int )argv_lth) == 7) {
              goto switch_27_7;
            } else {
#line 395
              if ((int )((unsigned int )argv_lth) == 3) {
                goto switch_27_3;
              } else {
#line 395
                if ((int )((unsigned int )argv_lth) == 14) {
                  goto switch_27_14;
                } else {
#line 395
                  if ((int )((unsigned int )argv_lth) == 10) {
                    goto switch_27_10;
                  } else {
#line 395
                    if ((int )((unsigned int )argv_lth) == 6) {
                      goto switch_27_6;
                    } else {
#line 395
                      if ((int )((unsigned int )argv_lth) == 2) {
                        goto switch_27_2;
                      } else {
#line 395
                        if ((int )((unsigned int )argv_lth) == 13) {
                          goto switch_27_13;
                        } else {
#line 395
                          if ((int )((unsigned int )argv_lth) == 9) {
                            goto switch_27_9;
                          } else {
#line 395
                            if ((int )((unsigned int )argv_lth) == 5) {
                              goto switch_27_5;
                            } else {
#line 395
                              if ((int )((unsigned int )argv_lth) == 1) {
                                goto switch_27_1;
                              } else {
#line 395
                                if ((int )((unsigned int )argv_lth) == 16) {
                                  goto switch_27_16;
                                } else {
#line 395
                                  if ((int )((unsigned int )argv_lth) == 12) {
                                    goto switch_27_12;
                                  } else {
#line 395
                                    if ((int )((unsigned int )argv_lth) == 8) {
                                      goto switch_27_8;
                                    } else {
#line 395
                                      if ((int )((unsigned int )argv_lth) == 4) {
                                        goto switch_27_4;
                                      } else {
#line 395
                                        if ((int )((unsigned int )argv_lth) == 0) {
                                          goto switch_27_0;
                                        } else {
#line 394
                                          if (0) {
                                            switch_27_15: /* CIL Label */ 
#line 394
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 394
                                            __u = (union __anonunion___u_69 *)((void *)__u +
                                                                               4);
                                            switch_27_11: /* CIL Label */ 
#line 394
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 394
                                            __u = (union __anonunion___u_69 *)((void *)__u +
                                                                               4);
                                            switch_27_7: /* CIL Label */ 
#line 394
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 394
                                            __u = (union __anonunion___u_69 *)((void *)__u +
                                                                               4);
                                            switch_27_3: /* CIL Label */ 
#line 394
                                            __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                           257);
#line 394
                                            __u = (union __anonunion___u_69 *)((void *)__u +
                                                                               2);
#line 394
                                            __u->__uc = __c;
                                            goto switch_27_break;
                                            switch_27_14: /* CIL Label */ 
#line 394
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 394
                                            __u = (union __anonunion___u_69 *)((void *)__u +
                                                                               4);
                                            switch_27_10: /* CIL Label */ 
#line 394
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 394
                                            __u = (union __anonunion___u_69 *)((void *)__u +
                                                                               4);
                                            switch_27_6: /* CIL Label */ 
#line 394
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 394
                                            __u = (union __anonunion___u_69 *)((void *)__u +
                                                                               4);
                                            switch_27_2: /* CIL Label */ 
#line 394
                                            __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                           257);
                                            goto switch_27_break;
                                            switch_27_13: /* CIL Label */ 
#line 394
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 394
                                            __u = (union __anonunion___u_69 *)((void *)__u +
                                                                               4);
                                            switch_27_9: /* CIL Label */ 
#line 394
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 394
                                            __u = (union __anonunion___u_69 *)((void *)__u +
                                                                               4);
                                            switch_27_5: /* CIL Label */ 
#line 394
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 394
                                            __u = (union __anonunion___u_69 *)((void *)__u +
                                                                               4);
                                            switch_27_1: /* CIL Label */ 
#line 394
                                            __u->__uc = __c;
                                            goto switch_27_break;
                                            switch_27_16: /* CIL Label */ 
#line 394
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 394
                                            __u = (union __anonunion___u_69 *)((void *)__u +
                                                                               4);
                                            switch_27_12: /* CIL Label */ 
#line 394
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 394
                                            __u = (union __anonunion___u_69 *)((void *)__u +
                                                                               4);
                                            switch_27_8: /* CIL Label */ 
#line 394
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 394
                                            __u = (union __anonunion___u_69 *)((void *)__u +
                                                                               4);
                                            switch_27_4: /* CIL Label */ 
#line 394
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
                                            switch_27_0: /* CIL Label */ ;
                                            goto switch_27_break;
                                          } else {
                                            switch_27_break: /* CIL Label */ ;
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    } else {
      {
#line 394
      __s = (void *)(*(argv0 + 0));
#line 394
      __builtin_memset(__s, '\000', argv_lth);
      }
    }
    {
#line 395
    strncpy((char */* __restrict  */)(*(argv0 + 0)), (char const   */* __restrict  */)title,
            (unsigned int )(argv_lth - 2));
#line 396
    (*(argv0 + 1)) = (char *)((void *)0);
    }
  }
#line 406
  return;
}
}
#line 413 "ftpd.c"
static int checkvalidaddr(struct sockaddr_storage  const  *addr ) 
{ register unsigned int __v ;
  register unsigned int __x ;
  register unsigned int __v___0 ;
  register unsigned int __x___0 ;
  register unsigned int __v___1 ;
  register unsigned int __x___1 ;
  register unsigned int __v___2 ;
  register unsigned int __x___2 ;
  register unsigned int __v___3 ;
  register unsigned int __x___3 ;

  {
#line 415
  if ((unsigned int )addr == (unsigned int )((struct sockaddr_storage  const  *)0)) {
    {
#line 416
    __assert_fail("0", "ftpd.c", 416U, "checkvalidaddr");
    }
#line 417
    return (0);
  }
#line 422
  if ((int const   )addr->ss_family == 10) {
#line 423
    if ((int const   )(*((uint8_t const   *)(& ((struct sockaddr_in6 *)addr)->sin6_addr) +
                         0)) == 255) {
#line 425
      return (0);
    } else {
#line 423
      if ((*((uint32_t const   *)(& ((struct sockaddr_in6 *)addr)->sin6_addr) + 0)) ==
          0U) {
#line 423
        if ((*((uint32_t const   *)(& ((struct sockaddr_in6 *)addr)->sin6_addr) +
               1)) == 0U) {
#line 423
          if ((*((uint32_t const   *)(& ((struct sockaddr_in6 *)addr)->sin6_addr) +
                 2)) == 0U) {
#line 423
            if ((*((uint32_t const   *)(& ((struct sockaddr_in6 *)addr)->sin6_addr) +
                   3)) == 0U) {
#line 425
              return (0);
            }
          }
        }
      }
    }
#line 427
    return (1);
  } else {
#line 428
    if ((int const   )addr->ss_family == 2) {
#line 429
      __x = ((struct sockaddr_in *)addr)->sin_addr.s_addr;
#line 429
      __asm__  ("rorw $8, %w0;"
                "rorl $16, %0;"
                "rorw $8, %w0": "=r" (__v): "0" (__x): "cc");
#line 433
      if (__v == 0U) {
#line 434
        return (0);
      } else {
#line 430
        __x___0 = ((struct sockaddr_in *)addr)->sin_addr.s_addr;
#line 430
        __asm__  ("rorw $8, %w0;"
                  "rorl $16, %0;"
                  "rorw $8, %w0": "=r" (__v___0): "0" (__x___0): "cc");
#line 433
        if (__v___0 == 4294967295U) {
#line 434
          return (0);
        } else {
#line 431
          __x___1 = ((struct sockaddr_in *)addr)->sin_addr.s_addr;
#line 431
          __asm__  ("rorw $8, %w0;"
                    "rorl $16, %0;"
                    "rorw $8, %w0": "=r" (__v___1): "0" (__x___1): "cc");
#line 433
          if (__v___1 == 4294967295U) {
#line 434
            return (0);
          } else {
#line 432
            __x___2 = ((struct sockaddr_in *)addr)->sin_addr.s_addr;
#line 432
            __asm__  ("rorw $8, %w0;"
                      "rorl $16, %0;"
                      "rorw $8, %w0": "=r" (__v___2): "0" (__x___2): "cc");
#line 433
            if ((__v___2 & 4026531840U) == 3758096384U) {
#line 434
              return (0);
            } else {
#line 433
              __x___3 = ((struct sockaddr_in *)addr)->sin_addr.s_addr;
#line 433
              __asm__  ("rorw $8, %w0;"
                        "rorl $16, %0;"
                        "rorw $8, %w0": "=r" (__v___3): "0" (__x___3): "cc");
#line 433
              if ((__v___3 & 4026531840U) == 4026531840U) {
#line 434
                return (0);
              }
            }
          }
        }
      }
#line 436
      return (1);
    }
  }
#line 438
  return (0);
}
}
#line 443 "ftpd.c"
static void fourinsix(struct sockaddr_storage *v6 ) 
{ struct sockaddr_storage v4 ;
  register unsigned int __v ;
  register unsigned int __x ;
  int tmp ;
  void *__s ;
  void *__s___0 ;
  union __anonunion___u_70 *__u ;
  __uint8_t __c ;
  void *__s___1 ;

  {
#line 448
  if ((int )v6ready == 0) {
#line 449
    return;
  } else {
#line 448
    if ((int )v6->ss_family != 10) {
#line 449
      return;
    } else {
#line 448
      if ((*((uint32_t const   *)(& ((struct sockaddr_in6 *)v6)->sin6_addr) + 0)) ==
          0U) {
#line 448
        if ((*((uint32_t const   *)(& ((struct sockaddr_in6 *)v6)->sin6_addr) + 1)) ==
            0U) {
#line 448
          __x = 65535U;
#line 448
          __asm__  ("rorw $8, %w0;"
                    "rorl $16, %0;"
                    "rorw $8, %w0": "=r" (__v): "0" (__x): "cc");
#line 448
          if ((*((uint32_t const   *)(& ((struct sockaddr_in6 *)v6)->sin6_addr) +
                 2)) == (uint32_t const   )__v) {
#line 448
            tmp = 1;
          } else {
#line 448
            tmp = 0;
          }
        } else {
#line 448
          tmp = 0;
        }
      } else {
#line 448
        tmp = 0;
      }
#line 448
      if (tmp == 0) {
#line 449
        return;
      }
    }
  }
#line 451
  if (sizeof(v4) <= 16U) {
#line 451
    if (sizeof(v4) == 1U) {
#line 451
      __s___1 = (void *)(& v4);
#line 451
      (*((__uint8_t *)__s___1)) = 0;
    } else {
#line 451
      __s___0 = (void *)(& v4);
#line 451
      __u = (union __anonunion___u_70 *)__s___0;
#line 451
      __c = 0;
#line 452
      if ((int )sizeof(v4) == 15) {
        goto switch_28_15;
      } else {
#line 452
        if ((int )sizeof(v4) == 11) {
          goto switch_28_11;
        } else {
#line 452
          if ((int )sizeof(v4) == 7) {
            goto switch_28_7;
          } else {
#line 452
            if ((int )sizeof(v4) == 3) {
              goto switch_28_3;
            } else {
#line 452
              if ((int )sizeof(v4) == 14) {
                goto switch_28_14;
              } else {
#line 452
                if ((int )sizeof(v4) == 10) {
                  goto switch_28_10;
                } else {
#line 452
                  if ((int )sizeof(v4) == 6) {
                    goto switch_28_6;
                  } else {
#line 452
                    if ((int )sizeof(v4) == 2) {
                      goto switch_28_2;
                    } else {
#line 452
                      if ((int )sizeof(v4) == 13) {
                        goto switch_28_13;
                      } else {
#line 452
                        if ((int )sizeof(v4) == 9) {
                          goto switch_28_9;
                        } else {
#line 452
                          if ((int )sizeof(v4) == 5) {
                            goto switch_28_5;
                          } else {
#line 452
                            if ((int )sizeof(v4) == 1) {
                              goto switch_28_1;
                            } else {
#line 452
                              if ((int )sizeof(v4) == 16) {
                                goto switch_28_16;
                              } else {
#line 452
                                if ((int )sizeof(v4) == 12) {
                                  goto switch_28_12;
                                } else {
#line 452
                                  if ((int )sizeof(v4) == 8) {
                                    goto switch_28_8;
                                  } else {
#line 452
                                    if ((int )sizeof(v4) == 4) {
                                      goto switch_28_4;
                                    } else {
#line 452
                                      if ((int )sizeof(v4) == 0) {
                                        goto switch_28_0;
                                      } else {
#line 451
                                        if (0) {
                                          switch_28_15: /* CIL Label */ 
#line 451
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 451
                                          __u = (union __anonunion___u_70 *)((void *)__u +
                                                                             4);
                                          switch_28_11: /* CIL Label */ 
#line 451
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 451
                                          __u = (union __anonunion___u_70 *)((void *)__u +
                                                                             4);
                                          switch_28_7: /* CIL Label */ 
#line 451
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 451
                                          __u = (union __anonunion___u_70 *)((void *)__u +
                                                                             4);
                                          switch_28_3: /* CIL Label */ 
#line 451
                                          __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                         257);
#line 451
                                          __u = (union __anonunion___u_70 *)((void *)__u +
                                                                             2);
#line 451
                                          __u->__uc = __c;
                                          goto switch_28_break;
                                          switch_28_14: /* CIL Label */ 
#line 451
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 451
                                          __u = (union __anonunion___u_70 *)((void *)__u +
                                                                             4);
                                          switch_28_10: /* CIL Label */ 
#line 451
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 451
                                          __u = (union __anonunion___u_70 *)((void *)__u +
                                                                             4);
                                          switch_28_6: /* CIL Label */ 
#line 451
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 451
                                          __u = (union __anonunion___u_70 *)((void *)__u +
                                                                             4);
                                          switch_28_2: /* CIL Label */ 
#line 451
                                          __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                         257);
                                          goto switch_28_break;
                                          switch_28_13: /* CIL Label */ 
#line 451
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 451
                                          __u = (union __anonunion___u_70 *)((void *)__u +
                                                                             4);
                                          switch_28_9: /* CIL Label */ 
#line 451
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 451
                                          __u = (union __anonunion___u_70 *)((void *)__u +
                                                                             4);
                                          switch_28_5: /* CIL Label */ 
#line 451
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 451
                                          __u = (union __anonunion___u_70 *)((void *)__u +
                                                                             4);
                                          switch_28_1: /* CIL Label */ 
#line 451
                                          __u->__uc = __c;
                                          goto switch_28_break;
                                          switch_28_16: /* CIL Label */ 
#line 451
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 451
                                          __u = (union __anonunion___u_70 *)((void *)__u +
                                                                             4);
                                          switch_28_12: /* CIL Label */ 
#line 451
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 451
                                          __u = (union __anonunion___u_70 *)((void *)__u +
                                                                             4);
                                          switch_28_8: /* CIL Label */ 
#line 451
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 451
                                          __u = (union __anonunion___u_70 *)((void *)__u +
                                                                             4);
                                          switch_28_4: /* CIL Label */ 
#line 451
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
                                          switch_28_0: /* CIL Label */ ;
                                          goto switch_28_break;
                                        } else {
                                          switch_28_break: /* CIL Label */ ;
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  } else {
    {
#line 451
    __s = (void *)(& v4);
#line 451
    __builtin_memset(__s, '\000', (int )sizeof(v4));
    }
  }
  {
#line 452
  v4.ss_family = 2;
#line 453
  memcpy((void */* __restrict  */)(& ((struct sockaddr_in *)(& v4))->sin_addr.s_addr),
         (void const   */* __restrict  */)((unsigned char *)(& ((struct sockaddr_in6 *)v6)->sin6_addr.in6_u.u6_addr8) +
                                           12), sizeof(((struct sockaddr_in *)(& v4))->sin_addr.s_addr));
#line 456
  ((struct sockaddr_in *)(& v4))->sin_port = ((struct sockaddr_in6 *)v6)->sin6_port;
#line 458
  (*v6) = v4;
  }
#line 459
  return;
}
}
#line 463 "ftpd.c"
static int addrcmp(struct sockaddr_storage  const  *s1 , struct sockaddr_storage  const  *s2 ) 
{ 

  {
#line 466
  if ((int const   )s1->ss_family == 10) {
#line 467
    if ((int const   )s2->ss_family != 10) {
#line 468
      return (1);
    }
#line 470
    if ((*((uint32_t const   *)(& ((struct sockaddr_in6 *)s1)->sin6_addr) + 0)) ==
        (*((uint32_t const   *)(& ((struct sockaddr_in6 *)s2)->sin6_addr) + 0))) {
#line 470
      if ((*((uint32_t const   *)(& ((struct sockaddr_in6 *)s1)->sin6_addr) + 1)) ==
          (*((uint32_t const   *)(& ((struct sockaddr_in6 *)s2)->sin6_addr) + 1))) {
#line 470
        if ((*((uint32_t const   *)(& ((struct sockaddr_in6 *)s1)->sin6_addr) + 2)) ==
            (*((uint32_t const   *)(& ((struct sockaddr_in6 *)s2)->sin6_addr) + 2))) {
#line 470
          if ((*((uint32_t const   *)(& ((struct sockaddr_in6 *)s1)->sin6_addr) +
                 3)) == (*((uint32_t const   *)(& ((struct sockaddr_in6 *)s2)->sin6_addr) +
                           3))) {
#line 471
            return (0);
          } else {
#line 473
            return (1);
          }
        } else {
#line 473
          return (1);
        }
      } else {
#line 473
        return (1);
      }
    } else {
#line 473
      return (1);
    }
  } else {
#line 475
    if ((int const   )s1->ss_family == 2) {
#line 476
      if ((int const   )s2->ss_family != 2) {
#line 477
        return (1);
      }
#line 479
      if (((struct sockaddr_in *)s1)->sin_addr.s_addr == ((struct sockaddr_in *)s2)->sin_addr.s_addr) {
#line 480
        return (0);
      } else {
#line 482
        return (1);
      }
    }
  }
#line 485
  return (-1);
}
}
#line 488 "ftpd.c"
static int generic_aton(char const   *src , struct sockaddr_storage *a ) 
{ int tmp ;
  int tmp___0 ;
  void *__s ;
  void *__s___0 ;
  union __anonunion___u_71 *__u ;
  __uint8_t __c ;
  void *__s___1 ;

  {
  {
#line 490
  tmp = inet_pton(10, (char const   */* __restrict  */)src, (void */* __restrict  */)(& ((struct sockaddr_in6 *)a)->sin6_addr.in6_u.u6_addr8));
  }
#line 490
  if (tmp > 0) {
#line 491
    a->ss_family = 10;
#line 492
    return (0);
  }
  {
#line 494
  tmp___0 = inet_pton(2, (char const   */* __restrict  */)src, (void */* __restrict  */)(& ((struct sockaddr_in *)a)->sin_addr.s_addr));
  }
#line 494
  if (tmp___0 > 0) {
#line 495
    a->ss_family = 2;
#line 496
    return (0);
  }
#line 498
  if (sizeof((*a)) <= 16U) {
#line 498
    if (sizeof((*a)) == 1U) {
#line 498
      __s___1 = (void *)a;
#line 498
      (*((__uint8_t *)__s___1)) = 0;
    } else {
#line 498
      __s___0 = (void *)a;
#line 498
      __u = (union __anonunion___u_71 *)__s___0;
#line 498
      __c = 0;
#line 499
      if ((int )sizeof((*a)) == 15) {
        goto switch_29_15;
      } else {
#line 499
        if ((int )sizeof((*a)) == 11) {
          goto switch_29_11;
        } else {
#line 499
          if ((int )sizeof((*a)) == 7) {
            goto switch_29_7;
          } else {
#line 499
            if ((int )sizeof((*a)) == 3) {
              goto switch_29_3;
            } else {
#line 499
              if ((int )sizeof((*a)) == 14) {
                goto switch_29_14;
              } else {
#line 499
                if ((int )sizeof((*a)) == 10) {
                  goto switch_29_10;
                } else {
#line 499
                  if ((int )sizeof((*a)) == 6) {
                    goto switch_29_6;
                  } else {
#line 499
                    if ((int )sizeof((*a)) == 2) {
                      goto switch_29_2;
                    } else {
#line 499
                      if ((int )sizeof((*a)) == 13) {
                        goto switch_29_13;
                      } else {
#line 499
                        if ((int )sizeof((*a)) == 9) {
                          goto switch_29_9;
                        } else {
#line 499
                          if ((int )sizeof((*a)) == 5) {
                            goto switch_29_5;
                          } else {
#line 499
                            if ((int )sizeof((*a)) == 1) {
                              goto switch_29_1;
                            } else {
#line 499
                              if ((int )sizeof((*a)) == 16) {
                                goto switch_29_16;
                              } else {
#line 499
                                if ((int )sizeof((*a)) == 12) {
                                  goto switch_29_12;
                                } else {
#line 499
                                  if ((int )sizeof((*a)) == 8) {
                                    goto switch_29_8;
                                  } else {
#line 499
                                    if ((int )sizeof((*a)) == 4) {
                                      goto switch_29_4;
                                    } else {
#line 499
                                      if ((int )sizeof((*a)) == 0) {
                                        goto switch_29_0;
                                      } else {
#line 498
                                        if (0) {
                                          switch_29_15: /* CIL Label */ 
#line 498
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 498
                                          __u = (union __anonunion___u_71 *)((void *)__u +
                                                                             4);
                                          switch_29_11: /* CIL Label */ 
#line 498
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 498
                                          __u = (union __anonunion___u_71 *)((void *)__u +
                                                                             4);
                                          switch_29_7: /* CIL Label */ 
#line 498
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 498
                                          __u = (union __anonunion___u_71 *)((void *)__u +
                                                                             4);
                                          switch_29_3: /* CIL Label */ 
#line 498
                                          __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                         257);
#line 498
                                          __u = (union __anonunion___u_71 *)((void *)__u +
                                                                             2);
#line 498
                                          __u->__uc = __c;
                                          goto switch_29_break;
                                          switch_29_14: /* CIL Label */ 
#line 498
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 498
                                          __u = (union __anonunion___u_71 *)((void *)__u +
                                                                             4);
                                          switch_29_10: /* CIL Label */ 
#line 498
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 498
                                          __u = (union __anonunion___u_71 *)((void *)__u +
                                                                             4);
                                          switch_29_6: /* CIL Label */ 
#line 498
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 498
                                          __u = (union __anonunion___u_71 *)((void *)__u +
                                                                             4);
                                          switch_29_2: /* CIL Label */ 
#line 498
                                          __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                         257);
                                          goto switch_29_break;
                                          switch_29_13: /* CIL Label */ 
#line 498
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 498
                                          __u = (union __anonunion___u_71 *)((void *)__u +
                                                                             4);
                                          switch_29_9: /* CIL Label */ 
#line 498
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 498
                                          __u = (union __anonunion___u_71 *)((void *)__u +
                                                                             4);
                                          switch_29_5: /* CIL Label */ 
#line 498
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 498
                                          __u = (union __anonunion___u_71 *)((void *)__u +
                                                                             4);
                                          switch_29_1: /* CIL Label */ 
#line 498
                                          __u->__uc = __c;
                                          goto switch_29_break;
                                          switch_29_16: /* CIL Label */ 
#line 498
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 498
                                          __u = (union __anonunion___u_71 *)((void *)__u +
                                                                             4);
                                          switch_29_12: /* CIL Label */ 
#line 498
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 498
                                          __u = (union __anonunion___u_71 *)((void *)__u +
                                                                             4);
                                          switch_29_8: /* CIL Label */ 
#line 498
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 498
                                          __u = (union __anonunion___u_71 *)((void *)__u +
                                                                             4);
                                          switch_29_4: /* CIL Label */ 
#line 498
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
                                          switch_29_0: /* CIL Label */ ;
                                          goto switch_29_break;
                                        } else {
                                          switch_29_break: /* CIL Label */ ;
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  } else {
    {
#line 498
    __s = (void *)a;
#line 498
    __builtin_memset(__s, '\000', (int )sizeof((*a)));
    }
  }
#line 500
  return (-1);
}
}
#line 503 "ftpd.c"
void logfile(int crit , char const   *format  , ...) 
{ char const   *urgency ;
  va_list va ;
  char line[4608] ;
  char const   *tmp ;
  char const   *tmp___0 ;

  {
#line 513
  if ((int )no_syslog != 0) {
#line 514
    return;
  }
  {
#line 516
  __builtin_stdarg_start(va, format);
#line 517
  vsnprintf((char */* __restrict  */)(line), sizeof(line), (char const   */* __restrict  */)format,
            va);
  }
#line 519
  if (crit == 6) {
    goto switch_30_6;
  } else {
#line 522
    if (crit == 4) {
      goto switch_30_4;
    } else {
#line 525
      if (crit == 3) {
        goto switch_30_3;
      } else {
#line 528
        if (crit == 5) {
          goto switch_30_5;
        } else {
#line 531
          if (crit == 7) {
            goto switch_30_7;
          } else {
            {
            goto switch_30_default;
#line 518
            if (0) {
              switch_30_6: /* CIL Label */ 
#line 520
              urgency = "[INFO] ";
              goto switch_30_break;
              switch_30_4: /* CIL Label */ 
#line 523
              urgency = "[WARNING] ";
              goto switch_30_break;
              switch_30_3: /* CIL Label */ 
#line 526
              urgency = "[ERROR] ";
              goto switch_30_break;
              switch_30_5: /* CIL Label */ 
#line 529
              urgency = "[NOTICE] ";
              goto switch_30_break;
              switch_30_7: /* CIL Label */ 
#line 532
              urgency = "[DEBUG] ";
              goto switch_30_break;
              switch_30_default: /* CIL Label */ 
#line 535
              urgency = "";
            } else {
              switch_30_break: /* CIL Label */ ;
            }
            }
          }
        }
      }
    }
  }
#line 540
  if ((int )host[0] != 0) {
#line 540
    tmp = (char const   *)(host);
  } else {
#line 540
    tmp = "?";
  }
#line 540
  if ((int )loggedin != 0) {
#line 540
    if ((int )account[0] != 0) {
#line 540
      tmp___0 = (char const   *)(account);
    } else {
#line 540
      tmp___0 = "?";
    }
  } else {
#line 540
    tmp___0 = "?";
  }
  {
#line 540
  syslog(crit, "(%s@%s) %s%s", tmp___0, tmp, urgency, line);
#line 547
  __builtin_va_end(va);
  }
#line 549
  return;
}
}
#line 557 "ftpd.c"
static unsigned int open_max(void) 
{ long z ;
  long tmp ;

  {
  {
#line 561
  tmp = sysconf(4);
#line 561
  z = tmp;
  }
#line 561
  if (z < 0L) {
    {
#line 562
    perror("_SC_OPEN_MAX");
    }
    {
#line 563
    while (1) {
      while_31_continue: /* CIL Label */ ;
      {
#line 563
      delete_atomic_file();
#line 563
      _exit(1);
      }
      goto while_31_break;
    }
    while_31_break: /* CIL Label */ ;
    }
  }
#line 565
  return ((unsigned int )z);
}
}
#line 602 "ftpd.c"
static void addreply_newline(char const   *str , size_t size ) 
{ struct reply *newline ;

  {
  {
#line 606
  newline = (struct reply *)malloc((unsigned int )(& ((struct reply *)0)->line) +
                                   size);
  }
#line 606
  if ((unsigned int )newline == (unsigned int )((void *)0)) {
    {
#line 608
    die_mem();
    }
  }
#line 610
  if ((unsigned int )firstreply == (unsigned int )((void *)0)) {
#line 611
    firstreply = newline;
  } else {
#line 613
    lastreply->next = newline;
  }
  {
#line 615
  newline->next = (struct reply *)((void *)0);
#line 616
  lastreply = newline;
#line 617
  memcpy((void */* __restrict  */)(newline->line), (void const   */* __restrict  */)str,
         size);
  }
#line 618
  return;
}
}
#line 620 "ftpd.c"
void addreply_noformat(int code , char const   *line ) 
{ size_t tmp ;

  {
#line 622
  if (code != 0) {
#line 623
    replycode = code;
  }
  {
#line 625
  tmp = strlen(line);
#line 625
  addreply_newline(line, tmp + 1U);
  }
#line 626
  return;
}
}
#line 628 "ftpd.c"
void addreply(int code , char const   *line  , ...) 
{ register char *a ;
  register char *b ;
  va_list ap ;
  int last ;
  char buf[4146] ;
  char *tmp___0 ;

  {
#line 636
  if (code != 0) {
#line 637
    replycode = code;
  }
  {
#line 639
  __builtin_stdarg_start(ap, line);
#line 640
  vsnprintf((char */* __restrict  */)(buf), sizeof(buf), (char const   */* __restrict  */)line,
            ap);
#line 641
  __builtin_va_end(ap);
#line 642
  last = 0;
#line 643
  a = buf;
  }
  {
#line 644
  while (1) {
    while_32_continue: /* CIL Label */ ;
    {
#line 645
    tmp___0 = strchr((char const   *)a, '\n');
#line 645
    b = tmp___0;
    }
#line 646
    if ((unsigned int )b != (unsigned int )((void *)0)) {
#line 647
      (*b) = 0;
    } else {
#line 649
      b = a;
      {
#line 650
      while (1) {
        while_33_continue: /* CIL Label */ ;
#line 650
        if (! ((int )(*b) != 0)) {
          goto while_33_break;
        }
#line 651
        b ++;
      }
      while_33_break: /* CIL Label */ ;
      }
#line 653
      last ++;
    }
    {
#line 655
    addreply_newline((char const   *)a, (unsigned int )(b - a) + 1U);
    }
#line 656
    if (last != 0) {
      goto while_32_break;
    }
#line 659
    a = b + 1;
  }
  while_32_break: /* CIL Label */ ;
  }
#line 661
  return;
}
}
#line 663 "ftpd.c"
void doreply(void) 
{ register struct reply *scannedentry ;
  register struct reply *nextentry ;
  int optval ;
  int tmp ;
  int tmp___0 ;
  int optval___0 ;

  {
#line 668
  scannedentry = firstreply;
#line 668
  if ((unsigned int )scannedentry == (unsigned int )((void *)0)) {
#line 669
    return;
  }
  {
#line 671
  while (1) {
    while_34_continue: /* CIL Label */ ;
    {
#line 671
    optval = 1;
#line 671
    setsockopt(1, 6, 3, (void const   *)(& optval), sizeof(optval));
    }
    goto while_34_break;
  }
  while_34_break: /* CIL Label */ ;
  }
  {
#line 672
  while (1) {
    while_35_continue: /* CIL Label */ ;
#line 673
    nextentry = scannedentry->next;
#line 684
    if ((unsigned int )nextentry == (unsigned int )((void *)0)) {
#line 684
      tmp = ' ';
    } else {
#line 684
      tmp = '-';
    }
    {
#line 684
    printf((char const   */* __restrict  */)"%3d%c%s\r\n", replycode, tmp, scannedentry->line);
    }
#line 687
    if ((int volatile   )logging > 1) {
#line 688
      if ((unsigned int )nextentry == (unsigned int )((void *)0)) {
#line 688
        tmp___0 = ' ';
      } else {
#line 688
        tmp___0 = '-';
      }
      {
#line 688
      logfile(7, "%3d%c%s", replycode, tmp___0, scannedentry->line);
      }
    }
#line 672
    scannedentry = nextentry;
#line 672
    if (! ((unsigned int )scannedentry != (unsigned int )((void *)0))) {
      goto while_35_break;
    }
  }
  while_35_break: /* CIL Label */ ;
  }
  {
#line 692
  fflush(stdout);
  }
  {
#line 693
  while (1) {
    while_36_continue: /* CIL Label */ ;
    {
#line 693
    optval___0 = 0;
#line 693
    setsockopt(1, 6, 3, (void const   *)(& optval___0), sizeof(optval___0));
    }
    goto while_36_break;
  }
  while_36_break: /* CIL Label */ ;
  }
#line 696
  scannedentry = firstreply;
  {
#line 697
  while (1) {
    while_37_continue: /* CIL Label */ ;
    {
#line 698
    nextentry = scannedentry->next;
#line 699
    free((void *)scannedentry);
#line 697
    scannedentry = nextentry;
    }
#line 697
    if (! ((unsigned int )scannedentry != (unsigned int )((void *)0))) {
      goto while_37_break;
    }
  }
  while_37_break: /* CIL Label */ ;
  }
#line 701
  lastreply = (struct reply *)((void *)0);
#line 701
  firstreply = lastreply;
#line 702
  return;
}
}
#line 708 "ftpd.c"
static int checknamesanity(char const   *name , int dot_ok ) 
{ register char const   *namepnt ;
  char *tmp ;

  {
#line 719
  if ((unsigned int )name == (unsigned int )((void *)0)) {
#line 720
    return (-1);
  } else {
#line 719
    if ((int const   )(*name) == 0) {
#line 720
      return (-1);
    }
  }
#line 723
  if ((int const   )(*(name + 0)) == 46) {
#line 723
    if ((int const   )(*(name + 1)) == 0) {
#line 724
      return (0);
    } else {
#line 723
      if ((int const   )(*(name + 1)) == 46) {
#line 723
        if ((int const   )(*(name + 2)) == 0) {
#line 724
          return (0);
        }
      }
    }
  }
  {
#line 726
  namepnt = name;
#line 738
  tmp = strstr(namepnt, ".pureftpd-");
  }
#line 738
  if ((unsigned int )tmp != (unsigned int )((void *)0)) {
#line 739
    return (-1);
  }
  {
#line 741
  while (1) {
    while_38_continue: /* CIL Label */ ;
#line 741
    if (! ((int const   )(*namepnt) != 0)) {
      goto while_38_break;
    }
#line 742
    if ((int const   )(*namepnt) == 127) {
#line 743
      return (-1);
    } else {
#line 742
      if ((unsigned int )((unsigned char )(*namepnt)) < 32U) {
#line 743
        return (-1);
      } else {
#line 742
        if ((int const   )(*namepnt) == 92) {
#line 743
          return (-1);
        }
      }
    }
#line 745
    if (dot_ok == 0) {
#line 746
      if ((int const   )(*namepnt) == 47) {
#line 747
        namepnt ++;
      } else {
#line 748
        if ((unsigned int )namepnt != (unsigned int )name) {
#line 749
          namepnt ++;
          goto while_38_continue;
        }
      }
#line 752
      if ((int const   )(*(namepnt + 0)) == 0) {
#line 753
        return (0);
      }
#line 755
      if ((int const   )(*(namepnt + 0)) == 46) {
#line 756
        if ((int const   )(*(namepnt + 1)) == 0) {
#line 757
          return (0);
        }
#line 759
        if ((int const   )(*(namepnt + 1)) == 46) {
#line 760
          if ((int const   )(*(namepnt + 2)) == 0) {
#line 761
            return (0);
          }
#line 763
          if ((int const   )(*(namepnt + 2)) != 47) {
#line 764
            return (-1);
          }
        } else {
#line 766
          if ((int const   )(*(namepnt + 1)) != 47) {
#line 767
            return (-1);
          }
        }
      }
#line 770
      if ((unsigned int )namepnt != (unsigned int )name) {
        goto while_38_continue;
      }
    }
#line 774
    namepnt ++;
  }
  while_38_break: /* CIL Label */ ;
  }
#line 776
  return (0);
}
}
#line 779 "ftpd.c"
static void do_ipv6_port(char *p , char delim ) 
{ char *deb ;
  struct sockaddr_storage a ;
  char *tmp___0 ;
  int tmp___1 ;
  char *tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;

  {
#line 784
  deb = p;
  {
#line 785
  while (1) {
    while_39_continue: /* CIL Label */ ;
#line 785
    if ((*p)) {
      {
#line 785
      tmp___0 = strchr("0123456789abcdefABCDEF:", (int )(*p));
      }
#line 785
      if (! ((unsigned int )tmp___0 != (unsigned int )((void *)0))) {
        goto while_39_break;
      }
    } else {
      goto while_39_break;
    }
#line 786
    p ++;
  }
  while_39_break: /* CIL Label */ ;
  }
#line 788
  if ((int )(*p) != (int )delim) {
    goto nope;
  } else {
    {
#line 788
    tmp___1 = atoi((char const   *)(p + 1));
    }
#line 788
    if (tmp___1 == 0) {
      nope: 
      {
#line 790
      close(datafd);
#line 791
      datafd = -1;
#line 792
      addreply_noformat(501, "Syntax error in IP address");
      }
#line 793
      return;
    }
  }
  {
#line 795
  tmp___2 = p;
#line 795
  p ++;
#line 795
  (*tmp___2) = 0;
#line 796
  tmp___3 = generic_aton((char const   *)deb, & a);
  }
#line 796
  if (tmp___3 != 0) {
    goto nope;
  }
  {
#line 799
  tmp___4 = atoi((char const   *)p);
#line 799
  doport2(a, (unsigned int )tmp___4);
  }
#line 800
  return;
}
}
#line 803 "ftpd.c"
void doesta(void) 
{ struct sockaddr_storage dataconn ;
  socklen_t socksize ;
  char hbuf[1025] ;
  char pbuf[32] ;
  int tmp ;
  unsigned int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
#line 810
  if ((int )passive != 0) {
    {
#line 811
    addreply_noformat(520, "Active mode is disabled");
    }
#line 812
    return;
  } else {
#line 810
    if (datafd == -1) {
      {
#line 811
      addreply_noformat(520, "Active mode is disabled");
      }
#line 812
      return;
    }
  }
#line 814
  if (xferfd == -1) {
    {
#line 815
    opendata();
    }
#line 816
    if (xferfd == -1) {
      {
#line 817
      addreply_noformat(425, "Can\'t create the data socket");
      }
#line 818
      return;
    }
  }
  {
#line 821
  socksize = sizeof(dataconn);
#line 822
  tmp = getsockname((int )xferfd, (struct sockaddr */* __restrict  */)((struct sockaddr *)(& dataconn)),
                    (socklen_t */* __restrict  */)(& socksize));
  }
#line 822
  if (tmp < 0) {
    {
#line 826
    addreply_noformat(425, "Unable to identify the local data socket");
#line 827
    closedata();
    }
#line 828
    return;
  } else {
#line 822
    if ((int )dataconn.ss_family == 2) {
#line 822
      tmp___0 = sizeof(struct sockaddr_in );
    } else {
#line 822
      tmp___0 = sizeof(struct sockaddr_in6 );
    }
    {
#line 822
    tmp___1 = getnameinfo((struct sockaddr  const  */* __restrict  */)((struct sockaddr *)(& dataconn)),
                          tmp___0, (char */* __restrict  */)(hbuf), sizeof(hbuf),
                          (char */* __restrict  */)(pbuf), sizeof(pbuf), 3U);
    }
#line 822
    if (tmp___1 != 0) {
      {
#line 826
      addreply_noformat(425, "Unable to identify the local data socket");
#line 827
      closedata();
      }
#line 828
      return;
    }
  }
#line 830
  if ((int )dataconn.ss_family == 10) {
#line 830
    tmp___2 = '2';
  } else {
#line 830
    tmp___2 = '1';
  }
  {
#line 830
  addreply(225, "Connected from (|%c|%s|%s|)", tmp___2, hbuf, pbuf);
  }
#line 832
  return;
}
}
#line 834 "ftpd.c"
void doestp(void) 
{ struct sockaddr_storage dataconn ;
  socklen_t socksize ;
  char hbuf[1025] ;
  char pbuf[32] ;
  int tmp ;
  unsigned int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
#line 841
  if ((int )passive == 0) {
    {
#line 842
    addreply_noformat(520, "Unable to open a passive connection");
    }
#line 843
    return;
  } else {
#line 841
    if (datafd == -1) {
      {
#line 842
      addreply_noformat(520, "Unable to open a passive connection");
      }
#line 843
      return;
    }
  }
#line 845
  if (xferfd == -1) {
    {
#line 846
    opendata();
    }
#line 847
    if (xferfd == -1) {
      {
#line 848
      addreply_noformat(425, "Can\'t create the data socket");
      }
#line 849
      return;
    }
  }
  {
#line 852
  socksize = sizeof(dataconn);
#line 853
  tmp = getpeername((int )xferfd, (struct sockaddr */* __restrict  */)((struct sockaddr *)(& dataconn)),
                    (socklen_t */* __restrict  */)(& socksize));
  }
#line 853
  if (tmp < 0) {
    {
#line 857
    addreply_noformat(425, "Unable to identify the local data socket");
#line 858
    closedata();
    }
#line 859
    return;
  } else {
#line 853
    if ((int )dataconn.ss_family == 2) {
#line 853
      tmp___0 = sizeof(struct sockaddr_in );
    } else {
#line 853
      tmp___0 = sizeof(struct sockaddr_in6 );
    }
    {
#line 853
    tmp___1 = getnameinfo((struct sockaddr  const  */* __restrict  */)((struct sockaddr *)(& dataconn)),
                          tmp___0, (char */* __restrict  */)(hbuf), sizeof(hbuf),
                          (char */* __restrict  */)(pbuf), sizeof(pbuf), 3U);
    }
#line 853
    if (tmp___1 != 0) {
      {
#line 857
      addreply_noformat(425, "Unable to identify the local data socket");
#line 858
      closedata();
      }
#line 859
      return;
    }
  }
#line 861
  if ((int )dataconn.ss_family == 10) {
#line 861
    tmp___2 = '2';
  } else {
#line 861
    tmp___2 = '1';
  }
  {
#line 861
  addreply(225, "Connected to (|%c|%s|%s|)", tmp___2, hbuf, pbuf);
  }
#line 863
  return;
}
}
#line 866 "ftpd.c"
void doeprt(char *p ) 
{ char delim ;
  int family ;
  char *tmp ;
  unsigned short const   **tmp___0 ;
  unsigned int a1 ;
  unsigned int a2 ;
  unsigned int a3 ;
  unsigned int a4 ;
  unsigned int port ;
  int tmp___1 ;
  int tmp___2 ;
  char *tmp___4 ;
  unsigned short const   **tmp___6 ;
  struct sockaddr_storage a ;
  void *__s ;
  void *__s___0 ;
  union __anonunion___u_72 *__u ;
  __uint8_t __c ;
  void *__s___1 ;
  register unsigned int __v ;
  register unsigned int __x ;

  {
  {
#line 871
  tmp = p;
#line 871
  p ++;
#line 871
  delim = (*tmp);
#line 872
  family = atoi((char const   *)p);
  }
  {
#line 873
  while (1) {
    while_40_continue: /* CIL Label */ ;
    {
#line 873
    tmp___0 = __ctype_b_loc();
    }
#line 873
    if (! ((int const   )(*((*tmp___0) + (int )((unsigned char )(*p)))) & 2048)) {
      goto while_40_break;
    }
#line 874
    p ++;
  }
  while_40_break: /* CIL Label */ ;
  }
#line 876
  if ((int )(*p) == (int )delim) {
#line 877
    p ++;
  } else {
    {
#line 879
    addreply_noformat(501, "Syntax error in IP address");
    }
#line 880
    return;
  }
#line 882
  if (family == 2) {
#line 882
    if (v6ready) {
      {
#line 883
      do_ipv6_port(p, delim);
      }
#line 884
      return;
    }
  }
#line 886
  if (family != 1) {
#line 887
    if (v6ready) {
      {
#line 888
      addreply_noformat(522, "Only IPv4 and IPv6 are supported (1,2)");
      }
    } else {
      {
#line 890
      addreply_noformat(522, "Only IPv4 is supported (1)");
      }
    }
#line 892
    return;
  }
  {
#line 896
  port = 0U;
#line 900
  tmp___1 = sscanf((char const   */* __restrict  */)p, (char const   */* __restrict  */)"%u,%u,%u,%u",
                   & a1, & a2, & a3, & a4);
  }
#line 900
  if (tmp___1 != 4) {
    {
#line 900
    tmp___2 = sscanf((char const   */* __restrict  */)p, (char const   */* __restrict  */)"%u.%u.%u.%u",
                     & a1, & a2, & a3, & a4);
    }
#line 900
    if (tmp___2 != 4) {
      {
#line 904
      addreply_noformat(501, "Syntax error in IP address");
      }
#line 905
      return;
    } else {
      goto _L;
    }
  } else {
    _L: 
#line 900
    if (a1 > 255U) {
      {
#line 904
      addreply_noformat(501, "Syntax error in IP address");
      }
#line 905
      return;
    } else {
#line 900
      if (a2 > 255U) {
        {
#line 904
        addreply_noformat(501, "Syntax error in IP address");
        }
#line 905
        return;
      } else {
#line 900
        if (a3 > 255U) {
          {
#line 904
          addreply_noformat(501, "Syntax error in IP address");
          }
#line 905
          return;
        } else {
#line 900
          if (a4 > 255U) {
            {
#line 904
            addreply_noformat(501, "Syntax error in IP address");
            }
#line 905
            return;
          } else {
#line 900
            if ((((a1 | a2) | a3) | a4) == 0U) {
              {
#line 904
              addreply_noformat(501, "Syntax error in IP address");
              }
#line 905
              return;
            }
          }
        }
      }
    }
  }
  {
#line 907
  while (1) {
    while_41_continue: /* CIL Label */ ;
#line 907
    if ((*p)) {
      {
#line 907
      tmp___4 = strchr("0123456789.,", (int )(*p));
      }
#line 907
      if (! tmp___4) {
        goto while_41_break;
      }
    } else {
      goto while_41_break;
    }
#line 908
    p ++;
  }
  while_41_break: /* CIL Label */ ;
  }
#line 910
  if ((int )(*p) == (int )delim) {
    {
#line 911
    p ++;
#line 911
    port = (unsigned int )atoi((char const   *)p);
    }
    {
#line 912
    while (1) {
      while_42_continue: /* CIL Label */ ;
#line 912
      if ((*p)) {
        {
#line 912
        tmp___6 = __ctype_b_loc();
        }
#line 912
        if (! ((int const   )(*((*tmp___6) + (int )((unsigned char )(*p)))) & 2048)) {
          goto while_42_break;
        }
      } else {
        goto while_42_break;
      }
#line 913
      p ++;
    }
    while_42_break: /* CIL Label */ ;
    }
  }
#line 916
  if ((int )(*p) != (int )delim) {
    {
#line 917
    addreply_noformat(501, "Syntax error in IP address");
    }
#line 918
    return;
  } else {
#line 916
    if (port > 65535U) {
      {
#line 917
      addreply_noformat(501, "Syntax error in IP address");
      }
#line 918
      return;
    } else {
#line 916
      if (port <= 0U) {
        {
#line 917
        addreply_noformat(501, "Syntax error in IP address");
        }
#line 918
        return;
      } else {
#line 922
        if (sizeof(a) <= 16U) {
#line 922
          if (sizeof(a) == 1U) {
#line 922
            __s___1 = (void *)(& a);
#line 922
            (*((__uint8_t *)__s___1)) = 0;
          } else {
#line 922
            __s___0 = (void *)(& a);
#line 922
            __u = (union __anonunion___u_72 *)__s___0;
#line 922
            __c = 0;
#line 923
            if ((int )sizeof(a) == 15) {
              goto switch_43_15;
            } else {
#line 923
              if ((int )sizeof(a) == 11) {
                goto switch_43_11;
              } else {
#line 923
                if ((int )sizeof(a) == 7) {
                  goto switch_43_7;
                } else {
#line 923
                  if ((int )sizeof(a) == 3) {
                    goto switch_43_3;
                  } else {
#line 923
                    if ((int )sizeof(a) == 14) {
                      goto switch_43_14;
                    } else {
#line 923
                      if ((int )sizeof(a) == 10) {
                        goto switch_43_10;
                      } else {
#line 923
                        if ((int )sizeof(a) == 6) {
                          goto switch_43_6;
                        } else {
#line 923
                          if ((int )sizeof(a) == 2) {
                            goto switch_43_2;
                          } else {
#line 923
                            if ((int )sizeof(a) == 13) {
                              goto switch_43_13;
                            } else {
#line 923
                              if ((int )sizeof(a) == 9) {
                                goto switch_43_9;
                              } else {
#line 923
                                if ((int )sizeof(a) == 5) {
                                  goto switch_43_5;
                                } else {
#line 923
                                  if ((int )sizeof(a) == 1) {
                                    goto switch_43_1;
                                  } else {
#line 923
                                    if ((int )sizeof(a) == 16) {
                                      goto switch_43_16;
                                    } else {
#line 923
                                      if ((int )sizeof(a) == 12) {
                                        goto switch_43_12;
                                      } else {
#line 923
                                        if ((int )sizeof(a) == 8) {
                                          goto switch_43_8;
                                        } else {
#line 923
                                          if ((int )sizeof(a) == 4) {
                                            goto switch_43_4;
                                          } else {
#line 923
                                            if ((int )sizeof(a) == 0) {
                                              goto switch_43_0;
                                            } else {
#line 922
                                              if (0) {
                                                switch_43_15: /* CIL Label */ 
#line 922
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 922
                                                __u = (union __anonunion___u_72 *)((void *)__u +
                                                                                   4);
                                                switch_43_11: /* CIL Label */ 
#line 922
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 922
                                                __u = (union __anonunion___u_72 *)((void *)__u +
                                                                                   4);
                                                switch_43_7: /* CIL Label */ 
#line 922
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 922
                                                __u = (union __anonunion___u_72 *)((void *)__u +
                                                                                   4);
                                                switch_43_3: /* CIL Label */ 
#line 922
                                                __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                               257);
#line 922
                                                __u = (union __anonunion___u_72 *)((void *)__u +
                                                                                   2);
#line 922
                                                __u->__uc = __c;
                                                goto switch_43_break;
                                                switch_43_14: /* CIL Label */ 
#line 922
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 922
                                                __u = (union __anonunion___u_72 *)((void *)__u +
                                                                                   4);
                                                switch_43_10: /* CIL Label */ 
#line 922
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 922
                                                __u = (union __anonunion___u_72 *)((void *)__u +
                                                                                   4);
                                                switch_43_6: /* CIL Label */ 
#line 922
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 922
                                                __u = (union __anonunion___u_72 *)((void *)__u +
                                                                                   4);
                                                switch_43_2: /* CIL Label */ 
#line 922
                                                __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                               257);
                                                goto switch_43_break;
                                                switch_43_13: /* CIL Label */ 
#line 922
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 922
                                                __u = (union __anonunion___u_72 *)((void *)__u +
                                                                                   4);
                                                switch_43_9: /* CIL Label */ 
#line 922
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 922
                                                __u = (union __anonunion___u_72 *)((void *)__u +
                                                                                   4);
                                                switch_43_5: /* CIL Label */ 
#line 922
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 922
                                                __u = (union __anonunion___u_72 *)((void *)__u +
                                                                                   4);
                                                switch_43_1: /* CIL Label */ 
#line 922
                                                __u->__uc = __c;
                                                goto switch_43_break;
                                                switch_43_16: /* CIL Label */ 
#line 922
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 922
                                                __u = (union __anonunion___u_72 *)((void *)__u +
                                                                                   4);
                                                switch_43_12: /* CIL Label */ 
#line 922
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 922
                                                __u = (union __anonunion___u_72 *)((void *)__u +
                                                                                   4);
                                                switch_43_8: /* CIL Label */ 
#line 922
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 922
                                                __u = (union __anonunion___u_72 *)((void *)__u +
                                                                                   4);
                                                switch_43_4: /* CIL Label */ 
#line 922
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
                                                switch_43_0: /* CIL Label */ ;
                                                goto switch_43_break;
                                              } else {
                                                switch_43_break: /* CIL Label */ ;
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        } else {
          {
#line 922
          __s = (void *)(& a);
#line 922
          __builtin_memset(__s, '\000', (int )sizeof(a));
          }
        }
        {
#line 923
        a.ss_family = 2;
#line 925
        __x = (((a1 << 24) | (a2 << 16)) | (a3 << 8)) | a4;
#line 925
        __asm__  ("rorw $8, %w0;"
                  "rorl $16, %0;"
                  "rorw $8, %w0": "=r" (__v): "0" (__x): "cc");
#line 925
        ((struct sockaddr_in *)(& a))->sin_addr.s_addr = __v;
#line 927
        doport2(a, port);
        }
      }
    }
  }
#line 930
  return;
}
}
#line 932 "ftpd.c"
void stripctrl(char *buf , size_t len ) 
{ 

  {
#line 934
  if (len <= 0U) {
#line 935
    return;
  }
  {
#line 937
  while (1) {
    while_44_continue: /* CIL Label */ ;
#line 938
    len --;
#line 939
    if ((int )(*(buf + len)) == 127) {
      goto _L;
    } else {
#line 939
      if ((unsigned int )((unsigned char )(*(buf + len))) < 32U) {
        _L: 
#line 939
        if ((int )(*(buf + len)) != 0) {
#line 939
          if ((int )(*(buf + len)) != 10) {
#line 941
            (*(buf + len)) = (char )'_';
          }
        }
      }
    }
#line 937
    if (! (len != 0U)) {
      goto while_44_break;
    }
  }
  while_44_break: /* CIL Label */ ;
  }
#line 944
  return;
}
}
#line 953 "ftpd.c"
void dobanner(int type___0 ) 
{ char buffer[512] ;
  FILE *msg ;
  size_t buflen ;
  unsigned int nblines ;
  char *tmp ;

  {
#line 958
  nblines = 100U;
#line 961
  if (type___0 == 0) {
    goto switch_45_0;
  } else {
#line 970
    if (type___0 == 1) {
      goto switch_45_1;
    } else {
      {
      goto switch_45_default;
#line 960
      if (0) {
        switch_45_0: /* CIL Label */ 
        {
#line 962
        msg = fopen((char const   */* __restrict  */)".banner", (char const   */* __restrict  */)"r");
        }
#line 962
        if ((unsigned int )msg == (unsigned int )((void *)0)) {
#line 967
          return;
        }
        goto switch_45_break;
        switch_45_1: /* CIL Label */ 
        {
#line 971
        msg = fopen((char const   */* __restrict  */)".message", (char const   */* __restrict  */)"r");
        }
#line 971
        if ((unsigned int )msg == (unsigned int )((void *)0)) {
#line 972
          return;
        }
        goto switch_45_break;
        switch_45_default: /* CIL Label */ ;
#line 976
        return;
      } else {
        switch_45_break: /* CIL Label */ ;
      }
      }
    }
  }
  {
#line 979
  while (1) {
    while_46_continue: /* CIL Label */ ;
    {
#line 979
    tmp = fgets((char */* __restrict  */)(buffer), (int )sizeof(buffer), (FILE */* __restrict  */)msg);
    }
#line 979
    if ((unsigned int )tmp != (unsigned int )((void *)0)) {
#line 979
      if (! (nblines > 0U)) {
        goto while_46_break;
      }
    } else {
      goto while_46_break;
    }
    {
#line 980
    nblines --;
#line 981
    buflen = strlen((char const   *)(buffer));
    }
#line 981
    if (buflen > 0U) {
#line 982
      buflen --;
      {
#line 983
      while (1) {
        while_47_continue: /* CIL Label */ ;
#line 983
        if (! ((int )buffer[buflen] == 10)) {
#line 983
          if (! ((int )buffer[buflen] == 13)) {
            goto while_47_break;
          }
        }
#line 984
        buffer[buflen] = 0;
#line 985
        if (buflen == 0U) {
          goto while_47_break;
        }
#line 988
        buflen --;
      }
      while_47_break: /* CIL Label */ ;
      }
      {
#line 990
      stripctrl(buffer, buflen);
      }
    }
    {
#line 992
    addreply_noformat(0, (char const   *)(buffer));
    }
  }
  while_46_break: /* CIL Label */ ;
  }
  {
#line 994
  fclose(msg);
  }
#line 995
  return;
}
}
#line 1001 "ftpd.c"
int modernformat(char const   *file , char *target , size_t target_size ) 
{ char const   *ft ;
  struct tm *t ;
  struct stat st ;
  int ret ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;

  {
  if (0 == target) {
    INV2: /* CIL Label */ 
    assert(0);
  }
  if (4352 != target_size) {
    INV1: /* CIL Label */ 
    assert(0);
  }
  {
#line 1007
  ret = 0;
#line 1009
  tmp = stat((char const   */* __restrict  */)file, (struct stat */* __restrict  */)(& st));
  }
#line 1009
  if (tmp != 0) {
#line 1011
    return (-1);
  } else {
    {
#line 1009
    t = gmtime((time_t const   *)(& st.st_mtim.tv_sec));
    }
#line 1009
    if (! t) {
#line 1011
      return (-1);
    }
  }
#line 1013
  if ((st.st_mode & 61440U) == 32768U) {
#line 1014
    ft = "file";
  } else {
#line 1015
    if ((st.st_mode & 61440U) == 16384U) {
#line 1016
      ret = 1;
#line 1017
      ft = "dir";
#line 1018
      if ((int const   )(*file) == 46) {
#line 1019
        if ((int const   )(*(file + 1)) == 46) {
#line 1019
          if ((int const   )(*(file + 2)) == 0) {
#line 1020
            ft = "pdir";
          } else {
            goto _L;
          }
        } else {
          _L: 
#line 1021
          if ((int const   )(*(file + 1)) == 0) {
#line 1022
            ft = "cdir";
          }
        }
      } else {
#line 1024
        if ((int const   )(*file) == 47) {
#line 1024
          if ((int const   )(*(file + 1)) == 0) {
#line 1025
            ft = "pdir";
          }
        }
      }
    } else {
#line 1028
      ft = "unknown";
    }
  }
#line 1030
  if ((int )guest != 0) {
#line 1031
    if (ret) {
#line 1031
      tmp___0 = 'd';
    } else {
#line 1031
      tmp___0 = 'e';
    }
    {
#line 1031
    tmp___1 = snprintf((char */* __restrict  */)target, target_size, (char const   */* __restrict  */)"type=%s;siz%c=%llu;modify=%04d%02d%02d%02d%02d%02d;UNIX.mode=0%o;unique=%xg%llx; %s",
                       ft, tmp___0, (unsigned long long )st.st_size, t->tm_year +
                                                                     1900, t->tm_mon +
                                                                           1, t->tm_mday,
                       t->tm_hour, t->tm_min, t->tm_sec, st.st_mode & 4095U, (unsigned int )st.st_dev,
                       st.st_ino, file);
    }
#line 1031
    if (tmp___1 >= (int )target_size) {
      {
#line 1042
      while (1) {
        while_48_continue: /* CIL Label */ ;
        {
#line 1042
        delete_atomic_file();
#line 1042
        _exit(1);
        }
        goto while_48_break;
      }
      while_48_break: /* CIL Label */ ;
      }
    }
  } else {
#line 1045
    if (ret) {
#line 1045
      tmp___2 = 'd';
    } else {
#line 1045
      tmp___2 = 'e';
    }
    {
#line 1045
    tmp___3 = snprintf((char */* __restrict  */)target, target_size, (char const   */* __restrict  */)"type=%s;siz%c=%llu;modify=%04d%02d%02d%02d%02d%02d;UNIX.mode=0%o;UNIX.uid=%lld;UNIX.gid=%lld;unique=%xg%llx; %s",
                       ft, tmp___2, (unsigned long long )st.st_size, t->tm_year +
                                                                     1900, t->tm_mon +
                                                                           1, t->tm_mday,
                       t->tm_hour, t->tm_min, t->tm_sec, st.st_mode & 4095U, (unsigned long long )st.st_uid,
                       (unsigned long long )st.st_gid, (unsigned int )st.st_dev, st.st_ino,
                       file);
    }
#line 1045
    if (tmp___3 >= (int )target_size) {
      {
#line 1058
      while (1) {
        while_49_continue: /* CIL Label */ ;
        {
#line 1058
        delete_atomic_file();
#line 1058
        _exit(1);
        }
        goto while_49_break;
      }
      while_49_break: /* CIL Label */ ;
      }
    }
  }
#line 1061
  return (ret);
}
}
#line 1066 "ftpd.c"
void domlst(char const   *file ) 
{ char line[4352] ;
  int tmp ;
  
 CHECK1: assert(0);
  {
  {
#line 1068
  line[0] = (char )'B';
#line 1068
  line[1] = (char )'e';
#line 1068
  line[2] = (char )'g';
#line 1068
  line[3] = (char )'i';
#line 1068
  line[4] = (char )'n';
#line 1068
  line[5] = (char )'\r';
#line 1068
  line[6] = (char )'\n';
#line 1068
  line[7] = (char )'\000';
#line 1070
  tmp = modernformat(file, line + (sizeof("Begin\r\n") - 1U), sizeof(line) - (sizeof("Begin\r\n") -
                                                                              1U));
  }
#line 1070
  if (tmp >= 0) {
    {
#line 1072
    addreply_noformat(0, (char const   *)(line));
#line 1073
    addreply_noformat(250, "End.");
    }
  } else {
    {
#line 1075
    addreply_noformat(550, "Can\'t check for file existence");
    }
  }
#line 1077
  return;
}
}
#line 1079 "ftpd.c"
void donoop(void) 
{ 

  {
  {
#line 1084
  addreply_noformat(200, "Zzz...");
  }
#line 1086
  return;
}
}
#line 1090 "ftpd.c"
void dositetime(void) 
{ char tmp[64] ;
  struct tm  const  *tm ;
  time_t now ;

  {
  {
#line 1096
  now = time((time_t *)((void *)0));
  }
#line 1096
  if (now == -1L) {
    {
#line 1097
    addreply_noformat(550, "time()");
    }
#line 1098
    return;
  } else {
    {
#line 1096
    tm = localtime((time_t const   *)(& now));
    }
#line 1096
    if ((unsigned int )tm == (unsigned int )((void *)0)) {
      {
#line 1097
      addreply_noformat(550, "time()");
      }
#line 1098
      return;
    }
  }
  {
#line 1100
  strftime((char */* __restrict  */)(tmp), sizeof(tmp), (char const   */* __restrict  */)"%Y-%m-%d %H:%M:%S",
           (struct tm  const  */* __restrict  */)tm);
#line 1101
  addreply_noformat(211, (char const   *)(tmp));
  }
#line 1102
  return;
}
}
#line 1104 "ftpd.c"
static int doinitsupgroups(char const   *user , uid_t uid , gid_t gid ) 
{ int tmp ;
  struct passwd  const  *lpwd ;

  {
  {
#line 1108
  tmp = setgroups(1U, (__gid_t const   *)(& gid));
  }
#line 1108
  if (tmp != 0) {
#line 1109
    return (-1);
  }
#line 1115
  if ((unsigned int )user == (unsigned int )((void *)0)) {
    {
#line 1116
    lpwd = getpwuid(uid);
    }
#line 1118
    if ((unsigned int )lpwd != (unsigned int )((void *)0)) {
#line 1118
      if ((unsigned int )lpwd->pw_name != (unsigned int )((void *)0)) {
#line 1119
        user = (char const   *)lpwd->pw_name;
      } else {
#line 1121
        return (0);
      }
    } else {
#line 1121
      return (0);
    }
  }
  {
#line 1124
  initgroups(user, gid);
  }
#line 1134
  return (0);
}
}
#line 1137 "ftpd.c"
void douser(char const   *username ) 
{ struct passwd *pw ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  char *hd ;
  size_t rd_len ;
  size_t tmp___4 ;
  int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  int tmp___20 ;
  int tmp___21 ;
  char *tmp___22 ;

  {
#line 1141
  if (loggedin) {
#line 1142
    if (username) {
#line 1143
      if (! guest) {
        {
#line 1144
        addreply_noformat(530, "You\'re already logged in");
        }
      } else {
#line 1145
        if (broken_client_compat) {
          {
#line 1146
          addreply_noformat(331, "Any password will work");
          }
        } else {
          {
#line 1148
          addreply_noformat(230, "Anonymous user logged in");
#line 1149
          dot_read_ok = dot_read_anon_ok;
#line 1150
          dot_write_ok = 0;
          }
        }
      }
    }
#line 1153
    return;
  }
#line 1155
  if ((int )anon_only <= 0) {
#line 1155
    if ((unsigned int )username != (unsigned int )((void *)0)) {
#line 1155
      if ((int const   )(*username) != 0) {
        {
#line 1155
        tmp___20 = strcasecmp(username, "ftp");
        }
#line 1155
        if (tmp___20) {
          {
#line 1155
          tmp___21 = strcasecmp(username, "anonymous");
          }
#line 1155
          if (tmp___21) {
            {
#line 1157
            strncpy((char */* __restrict  */)(account), (char const   */* __restrict  */)username,
                    sizeof(account) - 1U);
#line 1158
            account[sizeof(account) - 1U] = 0;
#line 1159
            addreply(331, "User %s OK. Password required", account);
#line 1160
            loggedin = 0;
            }
          } else {
            goto _L___3;
          }
        } else {
          goto _L___3;
        }
      } else {
        goto _L___3;
      }
    } else {
      goto _L___3;
    }
  } else {
    _L___3: 
#line 1161
    if ((int )anon_only < 0) {
#line 1162
      if ((int )broken_client_compat != 0) {
        {
#line 1163
        addreply(331, "User %s OK. Password required", username);
        }
#line 1164
        return;
      } else {
        {
#line 1166
        die(530, 7, "This is a private system - No anonymous login");
        }
      }
    } else {
#line 1173
      if ((int )chrooted != 0) {
        {
#line 1174
        die(421, 7, "We can\'t do that in the current session");
        }
      }
      {
#line 1206
      pw = getpwnam("ftp");
      }
#line 1206
      if ((unsigned int )pw == (unsigned int )((void *)0)) {
        goto cantsec;
      } else {
#line 1206
        if (pw->pw_uid == 0U) {
          goto cantsec;
        } else {
#line 1206
          if (pw->pw_gid == 0U) {
            goto cantsec;
          } else {
            {
#line 1206
            tmp___0 = doinitsupgroups("ftp", 4294967295U, pw->pw_gid);
            }
#line 1206
            if (tmp___0 != 0) {
              goto cantsec;
            } else {
              {
#line 1206
              tmp___1 = setgid(pw->pw_gid);
              }
#line 1206
              if (tmp___1) {
                goto cantsec;
              } else {
                {
#line 1206
                tmp___2 = setegid(pw->pw_gid);
                }
#line 1206
                if (tmp___2) {
                  cantsec: 
                  {
#line 1211
                  die(421, 3, "Unable to set up secure anonymous FTP");
                  }
                }
              }
            }
          }
        }
      }
#line 1228
      if ((unsigned int )pw->pw_dir == (unsigned int )((void *)0)) {
        goto cantsec;
      } else {
#line 1228
        if ((int )(*(pw->pw_dir)) != 47) {
          goto cantsec;
        }
      }
      {
#line 1231
      hd = strstr((char const   *)pw->pw_dir, "/./");
      }
#line 1231
      if ((unsigned int )hd != (unsigned int )((void *)0)) {
        {
#line 1232
        rd_len = (unsigned int )(hd - pw->pw_dir) + sizeof("/");
#line 1233
        root_directory = (char *)malloc(rd_len);
        }
#line 1233
        if ((unsigned int )root_directory == (unsigned int )((void *)0)) {
          goto cantsec;
        }
        {
#line 1236
        memcpy((void */* __restrict  */)root_directory, (void const   */* __restrict  */)pw->pw_dir,
               rd_len);
#line 1237
        (*(root_directory + (rd_len - 1U))) = 0;
#line 1238
        hd += 2;
        }
      } else {
        {
#line 1240
        tmp___4 = strlen((char const   *)pw->pw_dir);
#line 1240
        rd_len = tmp___4 + sizeof("/");
#line 1241
        root_directory = (char *)malloc(rd_len);
        }
#line 1241
        if ((unsigned int )root_directory == (unsigned int )((void *)0)) {
          goto cantsec;
        }
        {
#line 1244
        snprintf((char */* __restrict  */)root_directory, rd_len, (char const   */* __restrict  */)"%s/",
                 pw->pw_dir);
#line 1245
        hd = (char *)"/";
        }
      }
      {
#line 1247
      tmp___6 = chdir((char const   *)root_directory);
      }
#line 1247
      if (tmp___6) {
        goto cantsec;
      } else {
        {
#line 1247
        tmp___7 = chroot((char const   *)root_directory);
        }
#line 1247
        if (tmp___7) {
          goto cantsec;
        } else {
          {
#line 1247
          tmp___8 = chdir((char const   *)hd);
          }
#line 1247
          if (tmp___8) {
            goto cantsec;
          }
        }
      }
      {
#line 1250
      logfile(6, "Anonymous user logged in");
#line 1265
      chrooted = 1;
#line 1266
      authresult.uid = pw->pw_uid;
#line 1267
      authresult.gid = pw->pw_gid;
#line 1268
      authresult.dir = __strdup((char const   *)pw->pw_dir);
      }
#line 1268
      if ((unsigned int )authresult.dir == (unsigned int )((void *)0)) {
        {
#line 1269
        die_mem();
        }
      }
#line 1283
      if (authresult.uid > 0U) {
        {
#line 1290
        setfsgid(authresult.gid);
#line 1291
        setfsuid(authresult.uid);
        }
      }
      {
#line 1302
      drop_login_caps();
#line 1306
      dobanner(0);
      }
#line 1309
      if (broken_client_compat) {
        {
#line 1310
        addreply_noformat(331, "Any password will work");
        }
      } else {
        {
#line 1312
        addreply_noformat(230, "Anonymous user logged in");
        }
      }
      {
#line 1314
      dot_write_ok = 0;
#line 1315
      dot_read_ok = dot_read_anon_ok;
#line 1316
      strncpy((char */* __restrict  */)(account), (char const   */* __restrict  */)"ftp",
              sizeof(account) - 1U);
#line 1317
      account[sizeof(account) - 1U] = 0;
#line 1328
      guest = 1;
#line 1328
      loggedin = guest;
      }
    }
  }
  {
#line 1333
  tmp___22 = getcwd(wd, sizeof(wd) - 1U);
  }
#line 1333
  if ((unsigned int )tmp___22 == (unsigned int )((void *)0)) {
#line 1334
    wd[0] = (char )'/';
#line 1335
    wd[1] = 0;
  }
#line 1340
  return;
}
}
#line 1342 "ftpd.c"
static AuthResult pw_check(char const   *account___0 , char const   *password , struct sockaddr_storage  const  *sa ,
                           struct sockaddr_storage  const  *peer___0 ) 
{ Authentications *auth_scan ;
  AuthResult result ;

  {
#line 1346
  auth_scan = first_authentications;
#line 1349
  result.auth_ok = -1;
  {
#line 1350
  while (1) {
    while_50_continue: /* CIL Label */ ;
#line 1350
    if (! ((unsigned int )auth_scan != (unsigned int )((void *)0))) {
      goto while_50_break;
    }
    {
#line 1369
    ((*((auth_scan->auth)->check)))(& result, account___0, password, sa, peer___0);
    }
#line 1370
    if (result.auth_ok < 0) {
      goto while_50_break;
    } else {
#line 1372
      if (result.auth_ok > 0) {
#line 1423
        return (result);
      }
    }
#line 1425
    auth_scan = auth_scan->next;
  }
  while_50_break: /* CIL Label */ ;
  }
#line 1428
  return (result);
}
}
#line 1436 "ftpd.c"
static int check_trustedgroup(uid_t uid , gid_t gid ) 
{ gid_t *alloca_suppgroups ;
  int n ;
  int n2 ;
  int result ;

  {
#line 1441
  result = 0;
#line 1443
  if (uid == 0U) {
#line 1444
    return (1);
  }
#line 1446
  if ((int )userchroot == 2) {
#line 1447
    return (0);
  }
#line 1449
  if (gid == chroot_trustedgid) {
#line 1450
    return (1);
  }
  {
#line 1453
  n = getgroups(0, (__gid_t *)((void *)0));
  }
#line 1453
  if (n <= 0) {
#line 1454
    return (0);
  }
  {
#line 1456
  alloca_suppgroups = (gid_t *)__builtin_alloca((unsigned int )n * sizeof((*alloca_suppgroups)));
  }
#line 1456
  if ((unsigned int )alloca_suppgroups == (unsigned int )((void *)0)) {
    {
#line 1458
    die_mem();
    }
  }
  {
#line 1460
  n2 = getgroups(n, alloca_suppgroups);
  }
#line 1462
  if (n2 < n) {
#line 1463
    n = n2;
  }
#line 1465
  result = 0;
  {
#line 1466
  while (1) {
    while_51_continue: /* CIL Label */ ;
#line 1466
    if (! (n != 0)) {
      goto while_51_break;
    }
#line 1467
    n --;
#line 1468
    if ((*(alloca_suppgroups + n)) == chroot_trustedgid) {
#line 1469
      result = 1;
      goto while_51_break;
    }
  }
  while_51_break: /* CIL Label */ ;
  }
  {
#line 1473
  while (1) {
    while_52_continue: /* CIL Label */ ;
    goto while_52_break;
  }
  while_52_break: /* CIL Label */ ;
  }
#line 1476
  return (result);
}
}
#line 1483 "ftpd.c"
static int create_home_and_chdir(char const   *home ) 
{ char *pathcomp ;
  char *z ;
  size_t len ;
  char delim ;
  int tmp ;
  size_t tmp___0 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;

  {
#line 1488
  delim = (char )'/';
#line 1490
  if ((unsigned int )home == (unsigned int )((void *)0)) {
#line 1491
    return (-1);
  } else {
#line 1490
    if ((int const   )(*home) != 47) {
#line 1491
      return (-1);
    }
  }
  {
#line 1493
  tmp = chdir(home);
  }
#line 1493
  if (tmp == 0) {
#line 1494
    return (0);
  }
#line 1496
  if ((int )create_home == 0) {
#line 1497
    return (-1);
  }
  {
#line 1499
  tmp___0 = strlen(home);
#line 1499
  len = tmp___0 + 1U;
  }
#line 1500
  if (len < 2U) {
#line 1501
    return (-1);
  } else {
#line 1500
    if ((int const   )(*home) != (int const   )delim) {
#line 1501
      return (-1);
    }
  }
  {
#line 1503
  pathcomp = (char *)__builtin_alloca(len);
  }
#line 1503
  if ((unsigned int )pathcomp == (unsigned int )((void *)0)) {
#line 1504
    return (-1);
  }
  {
#line 1506
  memcpy((void */* __restrict  */)pathcomp, (void const   */* __restrict  */)home,
         len);
#line 1507
  z = pathcomp;
  }
  {
#line 1508
  while (1) {
    while_53_continue: /* CIL Label */ ;
#line 1509
    z ++;
#line 1510
    if ((int )(*z) == 0) {
      goto while_53_break;
    }
#line 1513
    if ((int )(*z) == (int )delim) {
#line 1514
      (*z) = 0;
#line 1515
      if ((int )(*(z + 1)) == 0) {
        goto while_53_break;
      }
      {
#line 1518
      mkdir((char const   *)pathcomp, 493U);
#line 1519
      (*z) = delim;
      }
    }
  }
  while_53_break: /* CIL Label */ ;
  }
  {
#line 1522
  while (1) {
    while_54_continue: /* CIL Label */ ;
    goto while_54_break;
  }
  while_54_break: /* CIL Label */ ;
  }
  {
#line 1523
  mkdir(home, 448U);
#line 1524
  tmp___2 = chdir(home);
  }
#line 1524
  if (tmp___2 != 0) {
#line 1525
    return (-1);
  }
  {
#line 1527
  tmp___3 = chmod(home, 493U & ~ u_mask_d);
  }
#line 1527
  if (tmp___3 < 0) {
#line 1529
    return (-1);
  } else {
    {
#line 1527
    tmp___4 = chown(home, authresult.uid, authresult.gid);
    }
#line 1527
    if (tmp___4 < 0) {
#line 1529
      return (-1);
    }
  }
  {
#line 1532
  tmp___5 = chdir(home);
  }
#line 1532
  return (tmp___5);
}
}
#line 1537 "ftpd.c"
static unsigned int tapping  ;
#line 1535 "ftpd.c"
void dopass(char *password ) 
{ gid_t *groups ;
  char *hd ;
  int ngroups ;
  int ngroups_max ;
  register char volatile   *password_ ;
  char volatile   *tmp ;
  unsigned int tmp___0 ;
  int tmp___1 ;
  char *tmp___11 ;
  int tmp___12 ;
  int tmp___13 ;
  int tmp___14 ;
  int tmp___15 ;
  char *tmp___16 ;
  int tmp___17 ;
  int tmp___18 ;
  int tmp___19 ;
  char reply[207] ;
  char const   *q ;
  size_t p ;
  int tmp___21 ;
  size_t tmp___22 ;
  size_t tmp___23 ;
  size_t tmp___24 ;
  char const   *tmp___25 ;
  int tmp___26 ;
  int tmp___27 ;
  size_t rd_len ;
  size_t tmp___28 ;
  int tmp___30 ;
  char *tmp___31 ;

  {
#line 1538
  groups = (gid_t *)((void *)0);
#line 1542
  ngroups_max = 32;
#line 1550
  if ((int )loggedin != 0) {
#line 1551
    if ((int )guest != 0) {
      {
#line 1552
      addreply_noformat(230, "Any password will work");
      }
    } else {
      {
#line 1557
      addreply_noformat(530, "We can\'t do that in the current session");
      }
    }
#line 1559
    return;
  }
#line 1561
  if ((int )account[0] == 0) {
    {
#line 1562
    addreply_noformat(530, "Please tell me who you are");
    }
#line 1563
    return;
  }
  {
#line 1565
  authresult = pw_check((char const   *)(account), (char const   *)password, (struct sockaddr_storage  const  *)(& ctrlconn),
                        (struct sockaddr_storage  const  *)(& peer));
#line 1568
  password_ = (char volatile   *)password;
  }
  {
#line 1570
  while (1) {
    while_55_continue: /* CIL Label */ ;
#line 1570
    if (! ((int volatile   )(*password_) != 0)) {
      goto while_55_break;
    }
#line 1571
    tmp = password_;
#line 1571
    password_ ++;
#line 1571
    (*tmp) = (char volatile   )0;
  }
  while_55_break: /* CIL Label */ ;
  }
#line 1574
  if (authresult.auth_ok != 1) {
    {
#line 1575
    addreply_noformat(530, "Login authentication failed");
#line 1576
    doreply();
    }
#line 1577
    if (tapping >= 5U) {
      toomanytries: 
      {
#line 1579
      logfile(3, "Too many authentication failures");
      }
      {
#line 1580
      while (1) {
        while_56_continue: /* CIL Label */ ;
        {
#line 1580
        delete_atomic_file();
#line 1580
        _exit(1);
        }
        goto while_56_break;
      }
      while_56_break: /* CIL Label */ ;
      }
    }
    {
#line 1582
    logfile(4, "Authentication failed for user [%s]", account);
    }
    randomsleep: 
    {
#line 1584
    tapping ++;
#line 1585
    tmp___0 = zrand();
#line 1585
    usleep((unsigned int )((unsigned long )tmp___0 % 3000000UL));
#line 1586
    usleep((unsigned int )((unsigned long )tapping * 3000000UL));
    }
#line 1587
    return;
  }
#line 1589
  if (authresult.uid < useruid) {
    {
#line 1590
    logfile(4, "Can\'t login as [%s]: account disabled", account);
    }
#line 1591
    if (tapping >= 5U) {
      goto toomanytries;
    }
    {
#line 1594
    addreply_noformat(530, "Sorry, but I can\'t trust you");
    }
    goto randomsleep;
  }
  {
#line 1607
  getname(authresult.uid);
#line 1609
  tmp___1 = doinitsupgroups((char const   *)(account), 4294967295U, authresult.gid);
  }
#line 1609
  if (tmp___1 != 0) {
    {
#line 1619
    die(421, 4, "Sorry, but I can\'t trust you");
    }
  }
  {
#line 1624
  tmp___11 = __strdup(authresult.dir);
#line 1624
  root_directory = tmp___11;
  }
#line 1624
  if ((unsigned int )root_directory == (unsigned int )((void *)0)) {
    {
#line 1625
    die_mem();
    }
  }
  {
#line 1627
  hd = strstr((char const   *)root_directory, "/./");
  }
#line 1628
  if ((unsigned int )hd != (unsigned int )((void *)0)) {
#line 1629
    hd ++;
#line 1629
    (*hd) = 0;
#line 1630
    hd ++;
#line 1631
    if ((int )chrooted != 0) {
      {
#line 1632
      die(421, 7, "We can\'t do that in the current session");
      }
    }
    {
#line 1634
    tmp___12 = create_home_and_chdir((char const   *)root_directory);
    }
#line 1634
    if (tmp___12) {
      {
#line 1636
      die(421, 3, "Home directory not available - aborting");
      }
    } else {
      {
#line 1634
      tmp___13 = chroot((char const   *)root_directory);
      }
#line 1634
      if (tmp___13) {
        {
#line 1636
        die(421, 3, "Home directory not available - aborting");
        }
      } else {
        {
#line 1634
        tmp___14 = chdir((char const   *)hd);
        }
#line 1634
        if (tmp___14) {
          {
#line 1636
          die(421, 3, "Home directory not available - aborting");
          }
        }
      }
    }
#line 1638
    chrooted = 1;
  } else {
    {
#line 1650
    free((void *)root_directory);
#line 1651
    root_directory = (char *)"/";
#line 1652
    tmp___15 = create_home_and_chdir(authresult.dir);
    }
#line 1652
    if (tmp___15) {
      {
#line 1653
      die(421, 3, "Home directory not available - aborting");
      }
    }
  }
  {
#line 1656
  tmp___16 = getcwd(wd, sizeof(wd) - 1U);
  }
#line 1656
  if ((unsigned int )tmp___16 == (unsigned int )((void *)0)) {
#line 1657
    wd[0] = (char )'/';
#line 1658
    wd[1] = 0;
  }
  {
#line 1661
  setfsuid(authresult.uid);
#line 1664
  tmp___17 = setgid(authresult.gid);
  }
#line 1664
  if (tmp___17) {
    goto _L;
  } else {
    {
#line 1664
    tmp___18 = setegid(authresult.gid);
    }
#line 1664
    if (tmp___18) {
      _L: 
      {
#line 1666
      while (1) {
        while_57_continue: /* CIL Label */ ;
        {
#line 1666
        delete_atomic_file();
#line 1666
        _exit(1);
        }
        goto while_57_break;
      }
      while_57_break: /* CIL Label */ ;
      }
    }
  }
  {
#line 1674
  tmp___19 = check_trustedgroup(authresult.uid, authresult.gid);
  }
#line 1674
  if (tmp___19 != 0) {
#line 1675
    userchroot = 0;
#line 1676
    dot_read_ok = 1;
#line 1676
    dot_write_ok = dot_read_ok;
#line 1677
    keepallfiles = 0;
  }
#line 1690
  if ((int )loggedin == 0) {
#line 1691
    candownload = 1;
  }
  {
#line 1704
  ngroups = getgroups(0, (__gid_t *)((void *)0));
  }
#line 1705
  if (ngroups > ngroups_max) {
#line 1706
    ngroups_max = ngroups;
  }
  {
#line 1715
  groups = (gid_t *)malloc(sizeof(gid_t ) * (unsigned int )ngroups_max);
  }
#line 1715
  if ((unsigned int )groups == (unsigned int )((void *)0)) {
    {
#line 1716
    die_mem();
    }
  }
  {
#line 1718
  ngroups = getgroups(ngroups_max, groups);
  }
#line 1719
  if ((int )guest == 0) {
#line 1719
    if (ngroups > 0) {
      {
#line 1724
      tmp___21 = snprintf((char */* __restrict  */)(reply), sizeof(reply), (char const   */* __restrict  */)"User %s has group access to: ",
                          account);
      }
#line 1724
      if (tmp___21 >= (int )sizeof(reply)) {
        {
#line 1727
        while (1) {
          while_58_continue: /* CIL Label */ ;
          {
#line 1727
          delete_atomic_file();
#line 1727
          _exit(1);
          }
          goto while_58_break;
        }
        while_58_break: /* CIL Label */ ;
        }
      }
      {
#line 1729
      p = strlen((char const   *)(reply));
      }
      {
#line 1730
      while (1) {
        while_59_continue: /* CIL Label */ ;
#line 1731
        ngroups --;
#line 1732
        if (ngroups != 0) {
#line 1732
          if ((*(groups + ngroups)) == (*(groups + 0))) {
            goto __Cont;
          } else {
            goto _L___0;
          }
        } else {
          _L___0: 
          {
#line 1732
          q = getgroup((*(groups + ngroups)));
          }
#line 1732
          if ((unsigned int )q == (unsigned int )((void *)0)) {
            goto __Cont;
          }
        }
        {
#line 1736
        tmp___22 = strlen(q);
        }
#line 1736
        if (p + tmp___22 > 75U) {
          {
#line 1737
          reply[p] = 0;
#line 1738
          addreply(0, "%s", reply);
#line 1739
          reply[0] = 0;
#line 1740
          p = 0U;
          }
        }
#line 1742
        tmp___23 = p;
#line 1742
        p ++;
#line 1742
        reply[tmp___23] = (char )' ';
        {
#line 1743
        while (1) {
          while_60_continue: /* CIL Label */ ;
#line 1743
          if ((int const   )(*q) != 0) {
#line 1743
            if (! (p < sizeof(reply))) {
              goto while_60_break;
            }
          } else {
            goto while_60_break;
          }
#line 1744
          tmp___24 = p;
#line 1744
          p ++;
#line 1744
          tmp___25 = q;
#line 1744
          q ++;
#line 1744
          reply[tmp___24] = (char )(*tmp___25);
        }
        while_60_break: /* CIL Label */ ;
        }
        __Cont: 
#line 1730
        if (! (ngroups > 0)) {
          goto while_59_break;
        }
      }
      while_59_break: /* CIL Label */ ;
      }
      {
#line 1747
      reply[p] = 0;
#line 1748
      addreply(0, "%s", reply);
      }
    }
  }
  {
#line 1750
  free((void *)groups);
  }
#line 1752
  if ((int )guest == 0) {
#line 1752
    if ((int )allowfxp == 1) {
      {
#line 1753
      addreply_noformat(0, "This server supports FXP transfers");
      }
    }
  }
#line 1760
  if ((int )userchroot != 0) {
#line 1760
    if ((int )chrooted == 0) {
      {
#line 1767
      tmp___26 = chdir((char const   *)(wd));
      }
#line 1767
      if (tmp___26) {
        {
#line 1778
        die(421, 3, "Unable to set up a secure chroot() jail");
        }
      } else {
        {
#line 1767
        tmp___27 = chroot((char const   *)(wd));
        }
#line 1767
        if (tmp___27) {
          {
#line 1778
          die(421, 3, "Unable to set up a secure chroot() jail");
          }
        }
      }
      {
#line 1796
      drop_login_caps();
#line 1798
      chrooted = 1;
#line 1805
      tmp___28 = strlen((char const   *)(wd));
#line 1805
      rd_len = tmp___28 + sizeof("/");
#line 1807
      root_directory = (char *)malloc(rd_len);
      }
#line 1807
      if ((unsigned int )root_directory == (unsigned int )((void *)0)) {
        {
#line 1808
        die_mem();
        }
      }
      {
#line 1810
      snprintf((char */* __restrict  */)root_directory, rd_len, (char const   */* __restrict  */)"%s/",
               wd);
#line 1812
      wd[0] = (char )'/';
#line 1813
      wd[1] = 0;
#line 1814
      tmp___30 = chdir((char const   *)(wd));
      }
#line 1814
      if (tmp___30) {
        {
#line 1815
        while (1) {
          while_61_continue: /* CIL Label */ ;
          {
#line 1815
          delete_atomic_file();
#line 1815
          _exit(1);
          }
          goto while_61_break;
        }
        while_61_break: /* CIL Label */ ;
        }
      }
      {
#line 1822
      addreply(230, "OK. Current restricted directory is %s", wd);
      }
    } else {
      {
#line 1830
      addreply(230, "OK. Current directory is %s", wd);
      }
    }
  } else {
    {
#line 1830
    addreply(230, "OK. Current directory is %s", wd);
    }
  }
  {
#line 1833
  logfile(6, "%s is now logged in", account);
#line 1844
  loggedin = 1;
#line 1845
  tmp___31 = getcwd(wd, sizeof(wd) - 1U);
  }
#line 1845
  if ((unsigned int )tmp___31 == (unsigned int )((void *)0)) {
#line 1846
    wd[0] = (char )'/';
#line 1847
    wd[1] = 0;
  }
  {
#line 1850
  dobanner(0);
  }
#line 1858
  return;
}
}
#line 1863 "ftpd.c"
static unsigned long failures  =    0UL;
#line 1860 "ftpd.c"
void docwd(char const   *dir ) 
{ char const   *where ;
  char buffer[4352] ;
  struct passwd  const  *pw ;
  char const   *tmp ;
  char *bufpnt ;
  size_t s ;
  char const   *dirscan ;
  char *tmp___5 ;
  char const   *tmp___6 ;
  char const   *tmp___7 ;
  int tmp___9 ;
  int *tmp___10 ;
  char *tmp___11 ;
  int tmp___12 ;
  int tmp___13 ;
  int tmp___14 ;
  int tmp___15 ;
  char *tmp___16 ;

  {
#line 1871
  if ((int )loggedin == 0) {
    goto kaboom;
  }
#line 1879
  where = dir;
#line 1880
  if ((unsigned int )dir == (unsigned int )((void *)0)) {
    goto gohome;
  } else {
#line 1880
    if ((int const   )(*dir) == 0) {
      goto gohome;
    }
  }
#line 1883
  if ((int const   )(*dir) == 126) {
#line 1886
    if ((int const   )(*(dir + 1)) == 0) {
      gohome: 
#line 1888
      if ((int )chrooted != 0) {
#line 1888
        tmp = "/";
      } else {
#line 1888
        tmp = authresult.dir;
      }
      {
#line 1888
      strncpy((char */* __restrict  */)(buffer), (char const   */* __restrict  */)tmp,
              sizeof(buffer));
#line 1890
      buffer[sizeof(buffer) - 1U] = 0;
#line 1891
      where = (char const   *)(buffer);
      }
    } else {
#line 1893
      bufpnt = buffer;
#line 1894
      s = sizeof(buffer);
#line 1895
      dirscan = dir + 1;
      {
#line 1897
      while (1) {
        while_62_continue: /* CIL Label */ ;
#line 1897
        if ((int const   )(*dirscan) != 0) {
#line 1897
          if (! ((int const   )(*dirscan) != 47)) {
            goto while_62_break;
          }
        } else {
          goto while_62_break;
        }
#line 1898
        s --;
#line 1898
        if (s <= 0U) {
          goto kaboom;
        }
#line 1901
        tmp___5 = bufpnt;
#line 1901
        bufpnt ++;
#line 1901
        tmp___6 = dirscan;
#line 1901
        dirscan ++;
#line 1901
        (*tmp___5) = (char )(*tmp___6);
      }
      while_62_break: /* CIL Label */ ;
      }
#line 1903
      (*bufpnt) = 0;
#line 1904
      if ((int )buffer[0] == 0) {
#line 1905
        if ((int )chrooted != 0) {
#line 1905
          tmp___7 = "/";
        } else {
#line 1905
          tmp___7 = authresult.dir;
        }
        {
#line 1905
        snprintf((char */* __restrict  */)(buffer), sizeof(buffer), (char const   */* __restrict  */)"%s%s",
                 tmp___7, dirscan);
#line 1907
        where = (char const   *)(buffer);
        }
      } else {
#line 1908
        if (authresult.slow_tilde_expansion == 0) {
#line 1909
          if (! ((int )chrooted != 0)) {
#line 1909
            if (! ((int )guest != 0)) {
              {
#line 1909
              pw = getpwnam((char const   *)(buffer));
              }
#line 1909
              if (! ((unsigned int )pw == (unsigned int )((void *)0))) {
#line 1909
                if (! ((unsigned int )pw->pw_dir == (unsigned int )((void *)0))) {
                  {
#line 1913
                  snprintf((char */* __restrict  */)(buffer), sizeof(buffer), (char const   */* __restrict  */)"%s%s",
                           pw->pw_dir, dirscan);
#line 1914
                  where = (char const   *)(buffer);
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  {
#line 1919
  tmp___9 = checknamesanity(where, (int )dot_read_ok);
  }
#line 1919
  if (tmp___9 != 0) {
    {
#line 1920
    addreply(550, "Prohibited file name: %s", where);
    }
#line 1921
    return;
  }
  {
#line 1923
  tmp___13 = chdir(where);
  }
#line 1923
  if (tmp___13 != 0) {
    {
#line 1937
    tmp___10 = __errno_location();
#line 1937
    tmp___11 = strerror((*tmp___10));
#line 1937
    tmp___12 = snprintf((char */* __restrict  */)(buffer), sizeof(buffer), (char const   */* __restrict  */)"Can\'t change directory to %s: %s",
                        dir, tmp___11);
    }
#line 1937
    if (tmp___12 >= (int )sizeof(buffer)) {
      {
#line 1940
      while (1) {
        while_63_continue: /* CIL Label */ ;
        {
#line 1940
        delete_atomic_file();
#line 1940
        _exit(1);
        }
        goto while_63_break;
      }
      while_63_break: /* CIL Label */ ;
      }
    }
    {
#line 1942
    logfile(6, "%s", buffer);
#line 1943
    addreply(550, "%s", buffer);
    }
#line 1947
    if (failures >= 50UL) {
      {
#line 1948
      while (1) {
        while_64_continue: /* CIL Label */ ;
        {
#line 1948
        delete_atomic_file();
#line 1948
        _exit(1);
        }
        goto while_64_break;
      }
      while_64_break: /* CIL Label */ ;
      }
    }
    {
#line 1950
    usleep((unsigned int )(failures * 100000UL));
#line 1951
    failures ++;
    }
#line 1955
    return;
  }
  {
#line 1963
  failures = 0UL;
#line 1964
  dobanner(1);
#line 1966
  tmp___16 = getcwd(wd, sizeof(wd) - 1U);
  }
#line 1966
  if ((unsigned int )tmp___16 == (unsigned int )((void *)0)) {
#line 1967
    if ((int const   )(*dir) == 47) {
      {
#line 1968
      tmp___14 = snprintf((char */* __restrict  */)(wd), sizeof(wd), (char const   */* __restrict  */)"%s",
                          dir);
      }
#line 1968
      if (tmp___14 >= (int )sizeof(wd)) {
        {
#line 1969
        while (1) {
          while_65_continue: /* CIL Label */ ;
          {
#line 1969
          delete_atomic_file();
#line 1969
          _exit(1);
          }
          goto while_65_break;
        }
        while_65_break: /* CIL Label */ ;
        }
      }
    } else {
      {
#line 1972
      tmp___15 = snprintf((char */* __restrict  */)(wd), sizeof(wd), (char const   */* __restrict  */)"%s/%s",
                          wd, dir);
      }
#line 1972
      if (tmp___15 >= (int )sizeof(wd)) {
        kaboom: 
        {
#line 1975
        die(421, 3, "Path too long");
        }
      }
    }
  }
  {
#line 1984
  addreply(250, "OK. Current directory is %s", wd);
  }
#line 1986
  return;
}
}
#line 1988 "ftpd.c"
static void iptropize(struct sockaddr_storage  const  *ss ) 
{ size_t t ;
  register unsigned char const   *s ;
  unsigned char const   *tmp ;

  {
  {
#line 1990
  t = sizeof((*ss));
#line 1991
  s = (unsigned char const   *)ss;
#line 1993
  iptropy = getpid();
  }
  {
#line 1994
  while (1) {
    while_66_continue: /* CIL Label */ ;
#line 1995
    iptropy += iptropy << 5;
#line 1996
    tmp = s;
#line 1996
    s ++;
#line 1996
    iptropy ^= (int )(*tmp);
#line 1994
    t --;
#line 1994
    if (! (t > 0U)) {
      goto while_66_break;
    }
  }
  while_66_break: /* CIL Label */ ;
  }
#line 1998
  return;
}
}
#line 2018 "ftpd.c"
unsigned int zrand(void) 
{ int fd ;
  int ret ;
  long tmp ;
  ssize_t tmp___0 ;

  {
#line 2023
  if ((int )chrooted != 0) {
    goto nax;
  } else {
    {
#line 2023
    fd = open("/dev/urandom", 2048);
    }
#line 2023
    if (fd == -1) {
      nax: 
      {
#line 2036
      tmp = random();
      }
#line 2036
      return ((unsigned int )(tmp ^ (long )iptropy));
    }
  }
  {
#line 2041
  tmp___0 = read(fd, (void *)(& ret), sizeof(ret));
  }
#line 2041
  if (tmp___0 != (int )sizeof(ret)) {
    {
#line 2042
    close(fd);
    }
    goto nax;
  }
  {
#line 2045
  close(fd);
  }
#line 2046
  return ((unsigned int )(ret ^ iptropy));
}
}
#line 2049 "ftpd.c"
static void keepalive(int fd , int keep ) 
{ 

  {
  {
#line 2053
  setsockopt(fd, 1, 9, (void const   *)((char *)(& keep)), sizeof(keep));
  }
#line 2056
  return;
}
}
#line 2062 "ftpd.c"
void dopasv(int psvtype ) 
{ struct sockaddr_storage dataconn ;
  unsigned long a ;
  unsigned int p ;
  int on ;
  unsigned int firstporttried ;
  unsigned int tmp ;
  int tmp___0 ;
  register unsigned short __v ;
  register unsigned short __x ;
  register unsigned short __v___0 ;
  register unsigned short __x___0 ;
  unsigned int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  register unsigned int __v___1 ;
  register unsigned int __x___1 ;
  register unsigned int __v___2 ;
  register unsigned int __x___2 ;

  {
#line 2065
  a = 0UL;
#line 2070
  if ((int )loggedin == 0) {
    {
#line 2071
    addreply_noformat(530, "You aren\'t logged in");
    }
#line 2072
    return;
  }
#line 2074
  if (datafd != -1) {
    {
#line 2075
    close(datafd);
#line 2076
    datafd = -1;
    }
  }
  {
#line 2078
  fourinsix(& ctrlconn);
  }
#line 2079
  if ((int )ctrlconn.ss_family == 10) {
#line 2079
    if (psvtype == 0) {
      {
#line 2080
      addreply_noformat(425, "You cannot use PASV on IPv6 connections. Use EPSV instead.");
      }
#line 2081
      return;
    }
  }
  {
#line 2083
  tmp = zrand();
#line 2083
  firstporttried = firstport + tmp % ((lastport - firstport) + 1U);
#line 2084
  p = firstporttried;
#line 2085
  datafd = socket((int )ctrlconn.ss_family, 1, 6);
  }
#line 2086
  if (datafd == -1) {
    {
#line 2087
    error(425, "Unable to open a passive connection");
    }
#line 2088
    return;
  }
  {
#line 2090
  on = 1;
#line 2091
  tmp___0 = setsockopt(datafd, 1, 2, (void const   *)((char *)(& on)), sizeof(on));
  }
#line 2091
  if (tmp___0 < 0) {
    {
#line 2093
    error(421, "setsockopt");
    }
#line 2094
    return;
  }
#line 2096
  dataconn = ctrlconn;
  {
#line 2097
  while (1) {
    while_67_continue: /* CIL Label */ ;
#line 2098
    if ((int )dataconn.ss_family == 10) {
#line 2099
      __x = (unsigned short )p;
#line 2099
      __asm__  ("rorw $8, %w0": "=r" (__v): "0" (__x): "cc");
#line 2099
      ((struct sockaddr_in6 *)(& dataconn))->sin6_port = __v;
    } else {
#line 2101
      __x___0 = (unsigned short )p;
#line 2101
      __asm__  ("rorw $8, %w0": "=r" (__v___0): "0" (__x___0): "cc");
#line 2101
      ((struct sockaddr_in *)(& dataconn))->sin_port = __v___0;
    }
#line 2103
    if ((int )dataconn.ss_family == 2) {
#line 2103
      tmp___1 = sizeof(struct sockaddr_in );
    } else {
#line 2103
      tmp___1 = sizeof(struct sockaddr_in6 );
    }
    {
#line 2103
    tmp___2 = bind(datafd, (struct sockaddr  const  */* __restrict  */)((struct sockaddr *)(& dataconn)),
                   tmp___1);
    }
#line 2103
    if (tmp___2 == 0) {
      goto while_67_break;
    }
#line 2107
    p --;
#line 2108
    if (p < firstport) {
#line 2109
      p = lastport;
    }
#line 2111
    if (p == firstporttried) {
      {
#line 2112
      close(datafd);
#line 2113
      datafd = -1;
#line 2114
      addreply_noformat(425, "All reserved TCP ports are busy");
      }
#line 2115
      return;
    }
  }
  while_67_break: /* CIL Label */ ;
  }
  {
#line 2118
  alarm((unsigned int )idletime);
#line 2119
  tmp___3 = listen(datafd, 8);
  }
#line 2119
  if (tmp___3 < 0) {
    {
#line 2120
    close(datafd);
#line 2121
    datafd = -1;
#line 2122
    error(425, "Unable to identify the local data socket");
    }
#line 2123
    return;
  }
#line 2126
  if (psvtype == 0) {
    goto switch_68_0;
  } else {
#line 2148
    if (psvtype == 1) {
      goto switch_68_1;
    } else {
#line 2151
      if (psvtype == 2) {
        goto switch_68_2;
      } else {
        {
        goto switch_68_default;
#line 2125
        if (0) {
          switch_68_0: /* CIL Label */ ;
#line 2127
          if ((int )force_passive_ip.ss_family == 0) {
#line 2128
            __x___1 = ((struct sockaddr_in *)(& dataconn))->sin_addr.s_addr;
#line 2128
            __asm__  ("rorw $8, %w0;"
                      "rorl $16, %0;"
                      "rorw $8, %w0": "=r" (__v___1): "0" (__x___1): "cc");
#line 2128
            a = (unsigned long )__v___1;
          } else {
#line 2129
            if ((int )force_passive_ip.ss_family == 10) {
              {
#line 2130
              close(datafd);
#line 2131
              datafd = -1;
#line 2132
              addreply_noformat(425, "Please use an IPv6-conformant client with EPSV support");
              }
#line 2133
              return;
            } else {
#line 2134
              if ((int )force_passive_ip.ss_family == 2) {
#line 2135
                __x___2 = ((struct sockaddr_in *)(& force_passive_ip))->sin_addr.s_addr;
#line 2135
                __asm__  ("rorw $8, %w0;"
                          "rorl $16, %0;"
                          "rorw $8, %w0": "=r" (__v___2): "0" (__x___2): "cc");
#line 2135
                a = (unsigned long )__v___2;
              } else {
                {
#line 2137
                while (1) {
                  while_69_continue: /* CIL Label */ ;
                  {
#line 2137
                  delete_atomic_file();
#line 2137
                  _exit(1);
                  }
                  goto while_69_break;
                }
                while_69_break: /* CIL Label */ ;
                }
              }
            }
          }
          {
#line 2144
          addreply(227, "Entering Passive Mode (%lu,%lu,%lu,%lu,%u,%u)", (a >> 24) &
                                                                         255UL, (a >>
                                                                                 16) &
                                                                                255UL,
                   (a >> 8) & 255UL, a & 255UL, (p >> 8) & 255U, p & 255U);
          }
          goto switch_68_break;
          switch_68_1: /* CIL Label */ 
          {
#line 2149
          addreply(229, "Extended Passive mode OK (|||%u|)", p);
          }
          goto switch_68_break;
          switch_68_2: /* CIL Label */ 
          {
#line 2152
          addreply(227, "%u", p);
          }
          goto switch_68_break;
          switch_68_default: /* CIL Label */ ;
          {
#line 2155
          while (1) {
            while_70_continue: /* CIL Label */ ;
            {
#line 2155
            delete_atomic_file();
#line 2155
            _exit(1);
            }
            goto while_70_break;
          }
          while_70_break: /* CIL Label */ ;
          }
        } else {
          switch_68_break: /* CIL Label */ ;
        }
        }
      }
    }
  }
#line 2157
  passive = 1;
#line 2158
  return;
}
}
#line 2160 "ftpd.c"
void doport(char const   *arg ) 
{ unsigned int a1 ;
  unsigned int a2 ;
  unsigned int a3 ;
  unsigned int a4 ;
  unsigned int p1 ;
  unsigned int p2 ;
  struct sockaddr_storage a ;
  int tmp ;
  void *__s ;
  void *__s___0 ;
  union __anonunion___u_73 *__u ;
  __uint8_t __c ;
  void *__s___1 ;
  register unsigned int __v ;
  register unsigned int __x ;

  {
  {
#line 2165
  tmp = sscanf((char const   */* __restrict  */)arg, (char const   */* __restrict  */)"%u,%u,%u,%u,%u,%u",
               & a1, & a2, & a3, & a4, & p1, & p2);
  }
#line 2165
  if (6 != tmp) {
    {
#line 2170
    addreply_noformat(501, "Syntax error in IP address");
    }
#line 2171
    return;
  } else {
#line 2165
    if (a1 > 255U) {
      {
#line 2170
      addreply_noformat(501, "Syntax error in IP address");
      }
#line 2171
      return;
    } else {
#line 2165
      if (a2 > 255U) {
        {
#line 2170
        addreply_noformat(501, "Syntax error in IP address");
        }
#line 2171
        return;
      } else {
#line 2165
        if (a3 > 255U) {
          {
#line 2170
          addreply_noformat(501, "Syntax error in IP address");
          }
#line 2171
          return;
        } else {
#line 2165
          if (a4 > 255U) {
            {
#line 2170
            addreply_noformat(501, "Syntax error in IP address");
            }
#line 2171
            return;
          } else {
#line 2165
            if (p1 > 255U) {
              {
#line 2170
              addreply_noformat(501, "Syntax error in IP address");
              }
#line 2171
              return;
            } else {
#line 2165
              if (p2 > 255U) {
                {
#line 2170
                addreply_noformat(501, "Syntax error in IP address");
                }
#line 2171
                return;
              } else {
#line 2165
                if ((((a1 | a2) | a3) | a4) == 0U) {
                  {
#line 2170
                  addreply_noformat(501, "Syntax error in IP address");
                  }
#line 2171
                  return;
                } else {
#line 2165
                  if ((p1 | p2) == 0U) {
                    {
#line 2170
                    addreply_noformat(501, "Syntax error in IP address");
                    }
#line 2171
                    return;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
#line 2173
  if (sizeof(a) <= 16U) {
#line 2173
    if (sizeof(a) == 1U) {
#line 2173
      __s___1 = (void *)(& a);
#line 2173
      (*((__uint8_t *)__s___1)) = 0;
    } else {
#line 2173
      __s___0 = (void *)(& a);
#line 2173
      __u = (union __anonunion___u_73 *)__s___0;
#line 2173
      __c = 0;
#line 2174
      if ((int )sizeof(a) == 15) {
        goto switch_71_15;
      } else {
#line 2174
        if ((int )sizeof(a) == 11) {
          goto switch_71_11;
        } else {
#line 2174
          if ((int )sizeof(a) == 7) {
            goto switch_71_7;
          } else {
#line 2174
            if ((int )sizeof(a) == 3) {
              goto switch_71_3;
            } else {
#line 2174
              if ((int )sizeof(a) == 14) {
                goto switch_71_14;
              } else {
#line 2174
                if ((int )sizeof(a) == 10) {
                  goto switch_71_10;
                } else {
#line 2174
                  if ((int )sizeof(a) == 6) {
                    goto switch_71_6;
                  } else {
#line 2174
                    if ((int )sizeof(a) == 2) {
                      goto switch_71_2;
                    } else {
#line 2174
                      if ((int )sizeof(a) == 13) {
                        goto switch_71_13;
                      } else {
#line 2174
                        if ((int )sizeof(a) == 9) {
                          goto switch_71_9;
                        } else {
#line 2174
                          if ((int )sizeof(a) == 5) {
                            goto switch_71_5;
                          } else {
#line 2174
                            if ((int )sizeof(a) == 1) {
                              goto switch_71_1;
                            } else {
#line 2174
                              if ((int )sizeof(a) == 16) {
                                goto switch_71_16;
                              } else {
#line 2174
                                if ((int )sizeof(a) == 12) {
                                  goto switch_71_12;
                                } else {
#line 2174
                                  if ((int )sizeof(a) == 8) {
                                    goto switch_71_8;
                                  } else {
#line 2174
                                    if ((int )sizeof(a) == 4) {
                                      goto switch_71_4;
                                    } else {
#line 2174
                                      if ((int )sizeof(a) == 0) {
                                        goto switch_71_0;
                                      } else {
#line 2173
                                        if (0) {
                                          switch_71_15: /* CIL Label */ 
#line 2173
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2173
                                          __u = (union __anonunion___u_73 *)((void *)__u +
                                                                             4);
                                          switch_71_11: /* CIL Label */ 
#line 2173
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2173
                                          __u = (union __anonunion___u_73 *)((void *)__u +
                                                                             4);
                                          switch_71_7: /* CIL Label */ 
#line 2173
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2173
                                          __u = (union __anonunion___u_73 *)((void *)__u +
                                                                             4);
                                          switch_71_3: /* CIL Label */ 
#line 2173
                                          __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                         257);
#line 2173
                                          __u = (union __anonunion___u_73 *)((void *)__u +
                                                                             2);
#line 2173
                                          __u->__uc = __c;
                                          goto switch_71_break;
                                          switch_71_14: /* CIL Label */ 
#line 2173
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2173
                                          __u = (union __anonunion___u_73 *)((void *)__u +
                                                                             4);
                                          switch_71_10: /* CIL Label */ 
#line 2173
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2173
                                          __u = (union __anonunion___u_73 *)((void *)__u +
                                                                             4);
                                          switch_71_6: /* CIL Label */ 
#line 2173
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2173
                                          __u = (union __anonunion___u_73 *)((void *)__u +
                                                                             4);
                                          switch_71_2: /* CIL Label */ 
#line 2173
                                          __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                         257);
                                          goto switch_71_break;
                                          switch_71_13: /* CIL Label */ 
#line 2173
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2173
                                          __u = (union __anonunion___u_73 *)((void *)__u +
                                                                             4);
                                          switch_71_9: /* CIL Label */ 
#line 2173
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2173
                                          __u = (union __anonunion___u_73 *)((void *)__u +
                                                                             4);
                                          switch_71_5: /* CIL Label */ 
#line 2173
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2173
                                          __u = (union __anonunion___u_73 *)((void *)__u +
                                                                             4);
                                          switch_71_1: /* CIL Label */ 
#line 2173
                                          __u->__uc = __c;
                                          goto switch_71_break;
                                          switch_71_16: /* CIL Label */ 
#line 2173
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2173
                                          __u = (union __anonunion___u_73 *)((void *)__u +
                                                                             4);
                                          switch_71_12: /* CIL Label */ 
#line 2173
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2173
                                          __u = (union __anonunion___u_73 *)((void *)__u +
                                                                             4);
                                          switch_71_8: /* CIL Label */ 
#line 2173
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2173
                                          __u = (union __anonunion___u_73 *)((void *)__u +
                                                                             4);
                                          switch_71_4: /* CIL Label */ 
#line 2173
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
                                          switch_71_0: /* CIL Label */ ;
                                          goto switch_71_break;
                                        } else {
                                          switch_71_break: /* CIL Label */ ;
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  } else {
    {
#line 2173
    __s = (void *)(& a);
#line 2173
    __builtin_memset(__s, '\000', (int )sizeof(a));
    }
  }
  {
#line 2174
  a.ss_family = 2;
#line 2176
  __x = (((a1 << 24) | (a2 << 16)) | (a3 << 8)) | a4;
#line 2176
  __asm__  ("rorw $8, %w0;"
            "rorl $16, %0;"
            "rorw $8, %w0": "=r" (__v): "0" (__x): "cc");
#line 2176
  ((struct sockaddr_in *)(& a))->sin_addr.s_addr = __v;
#line 2178
  doport2(a, (p1 << 8) | p2);
  }
#line 2179
  return;
}
}
#line 2188
static int doport3(int protocol ) ;
#line 2188 "ftpd.c"
static unsigned short const   portlist[10]  = 
#line 2188
  {      (unsigned short const   )20,      (unsigned short const   )2U,      (unsigned short const   )3U,      (unsigned short const   )4U, 
        (unsigned short const   )5U,      (unsigned short const   )6U,      (unsigned short const   )10U,      (unsigned short const   )14U, 
        (unsigned short const   )16U,      (unsigned short const   )0U};
#line 2183 "ftpd.c"
static int doport3(int protocol ) 
{ struct sockaddr_storage dataconn ;
  unsigned short const   *portlistpnt ;
  int on ;
  register unsigned short __v ;
  register unsigned short __x ;
  register unsigned short __v___0 ;
  register unsigned short __x___0 ;
  unsigned int tmp ;
  int tmp___0 ;

  {
  {
#line 2189
  portlistpnt = portlist;
#line 2202
  datafd = socket(protocol, 1, 6);
  }
#line 2202
  if (datafd == -1) {
    data_socket_error: 
    {
#line 2212
    close(datafd);
#line 2213
    datafd = -1;
#line 2214
    error(425, "Can\'t create the data socket");
    }
#line 2216
    return (-1);
  }
  {
#line 2218
  on = 1;
#line 2223
  setsockopt(datafd, 1, 2, (void const   *)((char *)(& on)), sizeof(on));
#line 2226
  memcpy((void */* __restrict  */)(& dataconn), (void const   */* __restrict  */)(& ctrlconn),
         sizeof(dataconn));
  }
  {
#line 2227
  while (1) {
    while_72_continue: /* CIL Label */ ;
#line 2228
    if ((int )dataconn.ss_family == 10) {
#line 2229
      __x = (unsigned short )(*portlistpnt);
#line 2229
      __asm__  ("rorw $8, %w0": "=r" (__v): "0" (__x): "cc");
#line 2229
      ((struct sockaddr_in6 *)(& dataconn))->sin6_port = __v;
    } else {
#line 2231
      __x___0 = (unsigned short )(*portlistpnt);
#line 2231
      __asm__  ("rorw $8, %w0": "=r" (__v___0): "0" (__x___0): "cc");
#line 2231
      ((struct sockaddr_in *)(& dataconn))->sin_port = __v___0;
    }
#line 2233
    if ((int )dataconn.ss_family == 2) {
#line 2233
      tmp = sizeof(struct sockaddr_in );
    } else {
#line 2233
      tmp = sizeof(struct sockaddr_in6 );
    }
    {
#line 2233
    tmp___0 = bind(datafd, (struct sockaddr  const  */* __restrict  */)((struct sockaddr *)(& dataconn)),
                   tmp);
    }
#line 2233
    if (tmp___0 == 0) {
      goto while_72_break;
    }
#line 2240
    if ((int const   )(*portlistpnt) == 0) {
      goto data_socket_error;
    }
#line 2243
    portlistpnt ++;
  }
  while_72_break: /* CIL Label */ ;
  }
#line 2255
  return (0);
}
}
#line 2274 "ftpd.c"
void doport2(struct sockaddr_storage a , unsigned int p ) 
{ int tmp ;
  int tmp___0 ;
  char hbuf[1025] ;
  char peerbuf[1025] ;
  unsigned int tmp___1 ;
  int tmp___2 ;
  unsigned int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;

  {
#line 2276
  if ((int )loggedin == 0) {
    {
#line 2277
    addreply_noformat(530, "You aren\'t logged in");
    }
#line 2278
    return;
  }
#line 2280
  if ((int )epsv_all != 0) {
    {
#line 2281
    addreply_noformat(501, "Active mode is disabled");
    }
#line 2282
    return;
  }
#line 2284
  if (datafd != -1) {
    {
#line 2285
    close(datafd);
#line 2286
    datafd = -1;
    }
  }
#line 2288
  if (p < 1024U) {
    {
#line 2289
    addreply_noformat(501, "Sorry, but I won\'t connect to ports < 1024");
    }
#line 2290
    return;
  }
#line 2292
  if ((int )a.ss_family == 10) {
#line 2292
    tmp = 10;
  } else {
#line 2292
    tmp = 2;
  }
  {
#line 2292
  tmp___0 = doport3(tmp);
  }
#line 2292
  if (tmp___0 != 0) {
#line 2293
    return;
  }
  {
#line 2295
  peerdataport = (unsigned short )p;
#line 2296
  tmp___5 = addrcmp((struct sockaddr_storage  const  *)(& a), (struct sockaddr_storage  const  *)(& peer));
  }
#line 2296
  if (tmp___5 != 0) {
#line 2300
    if ((int )a.ss_family == 2) {
#line 2300
      tmp___1 = sizeof(struct sockaddr_in );
    } else {
#line 2300
      tmp___1 = sizeof(struct sockaddr_in6 );
    }
    {
#line 2300
    tmp___2 = getnameinfo((struct sockaddr  const  */* __restrict  */)((struct sockaddr *)(& a)),
                          tmp___1, (char */* __restrict  */)(hbuf), sizeof(hbuf),
                          (char */* __restrict  */)((void *)0), 0U, 1U);
    }
#line 2300
    if (tmp___2 != 0) {
      goto hu;
    } else {
#line 2300
      if ((int )peer.ss_family == 2) {
#line 2300
        tmp___3 = sizeof(struct sockaddr_in );
      } else {
#line 2300
        tmp___3 = sizeof(struct sockaddr_in6 );
      }
      {
#line 2300
      tmp___4 = getnameinfo((struct sockaddr  const  */* __restrict  */)((struct sockaddr *)(& peer)),
                            tmp___3, (char */* __restrict  */)(peerbuf), sizeof(peerbuf),
                            (char */* __restrict  */)((void *)0), 0U, 1U);
      }
#line 2300
      if (tmp___4 != 0) {
        goto hu;
      }
    }
#line 2308
    if ((int )allowfxp == 0) {
      goto hu;
    } else {
#line 2308
      if ((int )allowfxp == 1) {
#line 2308
        if ((int )guest != 0) {
          hu: 
          {
#line 2310
          close(datafd);
#line 2311
          datafd = -1;
#line 2312
          addreply(500, "I won\'t open a connection to %s (only to %s)", hbuf, peerbuf);
          }
#line 2313
          return;
        } else {
          {
#line 2315
          addreply(0, "FXP transfer: from %s to %s", peerbuf, hbuf);
#line 2316
          memcpy((void */* __restrict  */)(& peer), (void const   */* __restrict  */)(& a),
                 sizeof(a));
          }
        }
      } else {
        {
#line 2315
        addreply(0, "FXP transfer: from %s to %s", peerbuf, hbuf);
#line 2316
        memcpy((void */* __restrict  */)(& peer), (void const   */* __restrict  */)(& a),
               sizeof(a));
        }
      }
    }
  }
  {
#line 2319
  passive = 0;
#line 2321
  addreply_noformat(200, "PORT command successful");
  }
#line 2322
  return;
}
}
#line 2325 "ftpd.c"
void closedata(void) 
{ int volatile   tmp_xferfd ;

  {
  {
#line 2327
  tmp_xferfd = xferfd;
#line 2329
  xferfd = (int volatile   )-1;
#line 2330
  close((int )tmp_xferfd);
  }
#line 2331
  return;
}
}
#line 2333 "ftpd.c"
void opendata(void) 
{ struct sockaddr_storage dataconn ;
  int fd ;
  socklen_t socksize ;
  fd_set rs ;
  struct timeval tv ;
  int __d0 ;
  int __d1 ;
  int tmp ;
  void *__s ;
  void *__s___0 ;
  union __anonunion___u_74 *__u ;
  __uint8_t __c ;
  void *__s___1 ;
  int tmp___0 ;
  struct sockaddr_storage peer2 ;
  unsigned long tries ;
  register unsigned short __v ;
  register unsigned short __x ;
  register unsigned short __v___0 ;
  register unsigned short __x___0 ;
  int *tmp___1 ;
  int *tmp___2 ;
  int *tmp___3 ;
  int *tmp___4 ;
  char *tmp___5 ;
  unsigned int tmp___6 ;
  int tmp___7 ;
  int fodder ;

  {
#line 2339
  if (xferfd != -1) {
    {
#line 2340
    closedata();
    }
  }
#line 2342
  if (datafd == -1) {
    {
#line 2343
    addreply_noformat(425, "No data connection");
    }
#line 2344
    return;
  }
#line 2347
  if ((int )passive != 0) {
    {
#line 2351
    alarm((unsigned int )idletime);
    }
    {
#line 2353
    while (1) {
      while_73_continue: /* CIL Label */ ;
      {
#line 2354
      while (1) {
        while_74_continue: /* CIL Label */ ;
#line 2354
        __asm__  volatile   ("cld; rep; stosl": "=c" (__d0), "=D" (__d1): "a" (0),
                             "0" (sizeof(fd_set ) / sizeof(__fd_mask )), "1" (& rs.fds_bits[0]): "memory");
        goto while_74_break;
      }
      while_74_break: /* CIL Label */ ;
      }
      {
#line 2355
      __asm__  volatile   ("btsl %1,%0": "=m" (rs.fds_bits[(unsigned int )datafd /
                                                           (8U * sizeof(__fd_mask ))]): "r" ((unsigned int )datafd %
                                                                                             (8U *
                                                                                              sizeof(__fd_mask ))): "cc",
                           "memory");
#line 2356
      tv.tv_sec = (long )idletime;
#line 2357
      tv.tv_usec = 0L;
#line 2360
      tmp = select(datafd + 1, (fd_set */* __restrict  */)(& rs), (fd_set */* __restrict  */)((void *)0),
                   (fd_set */* __restrict  */)((void *)0), (struct timeval */* __restrict  */)(& tv));
      }
#line 2360
      if (tmp <= 0) {
        {
#line 2361
        die(421, 6, "Timeout (no new data for %lu seconds)", idletime);
        }
      }
#line 2364
      socksize = sizeof(dataconn);
#line 2365
      if (sizeof(dataconn) <= 16U) {
#line 2365
        if (sizeof(dataconn) == 1U) {
#line 2365
          __s___1 = (void *)(& dataconn);
#line 2365
          (*((__uint8_t *)__s___1)) = 0;
        } else {
#line 2365
          __s___0 = (void *)(& dataconn);
#line 2365
          __u = (union __anonunion___u_74 *)__s___0;
#line 2365
          __c = 0;
#line 2366
          if ((int )sizeof(dataconn) == 15) {
            goto switch_75_15;
          } else {
#line 2366
            if ((int )sizeof(dataconn) == 11) {
              goto switch_75_11;
            } else {
#line 2366
              if ((int )sizeof(dataconn) == 7) {
                goto switch_75_7;
              } else {
#line 2366
                if ((int )sizeof(dataconn) == 3) {
                  goto switch_75_3;
                } else {
#line 2366
                  if ((int )sizeof(dataconn) == 14) {
                    goto switch_75_14;
                  } else {
#line 2366
                    if ((int )sizeof(dataconn) == 10) {
                      goto switch_75_10;
                    } else {
#line 2366
                      if ((int )sizeof(dataconn) == 6) {
                        goto switch_75_6;
                      } else {
#line 2366
                        if ((int )sizeof(dataconn) == 2) {
                          goto switch_75_2;
                        } else {
#line 2366
                          if ((int )sizeof(dataconn) == 13) {
                            goto switch_75_13;
                          } else {
#line 2366
                            if ((int )sizeof(dataconn) == 9) {
                              goto switch_75_9;
                            } else {
#line 2366
                              if ((int )sizeof(dataconn) == 5) {
                                goto switch_75_5;
                              } else {
#line 2366
                                if ((int )sizeof(dataconn) == 1) {
                                  goto switch_75_1;
                                } else {
#line 2366
                                  if ((int )sizeof(dataconn) == 16) {
                                    goto switch_75_16;
                                  } else {
#line 2366
                                    if ((int )sizeof(dataconn) == 12) {
                                      goto switch_75_12;
                                    } else {
#line 2366
                                      if ((int )sizeof(dataconn) == 8) {
                                        goto switch_75_8;
                                      } else {
#line 2366
                                        if ((int )sizeof(dataconn) == 4) {
                                          goto switch_75_4;
                                        } else {
#line 2366
                                          if ((int )sizeof(dataconn) == 0) {
                                            goto switch_75_0;
                                          } else {
#line 2365
                                            if (0) {
                                              switch_75_15: /* CIL Label */ 
#line 2365
                                              __u->__ui = (unsigned int )((int )__c *
                                                                          16843009);
#line 2365
                                              __u = (union __anonunion___u_74 *)((void *)__u +
                                                                                 4);
                                              switch_75_11: /* CIL Label */ 
#line 2365
                                              __u->__ui = (unsigned int )((int )__c *
                                                                          16843009);
#line 2365
                                              __u = (union __anonunion___u_74 *)((void *)__u +
                                                                                 4);
                                              switch_75_7: /* CIL Label */ 
#line 2365
                                              __u->__ui = (unsigned int )((int )__c *
                                                                          16843009);
#line 2365
                                              __u = (union __anonunion___u_74 *)((void *)__u +
                                                                                 4);
                                              switch_75_3: /* CIL Label */ 
#line 2365
                                              __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                             257);
#line 2365
                                              __u = (union __anonunion___u_74 *)((void *)__u +
                                                                                 2);
#line 2365
                                              __u->__uc = __c;
                                              goto switch_75_break;
                                              switch_75_14: /* CIL Label */ 
#line 2365
                                              __u->__ui = (unsigned int )((int )__c *
                                                                          16843009);
#line 2365
                                              __u = (union __anonunion___u_74 *)((void *)__u +
                                                                                 4);
                                              switch_75_10: /* CIL Label */ 
#line 2365
                                              __u->__ui = (unsigned int )((int )__c *
                                                                          16843009);
#line 2365
                                              __u = (union __anonunion___u_74 *)((void *)__u +
                                                                                 4);
                                              switch_75_6: /* CIL Label */ 
#line 2365
                                              __u->__ui = (unsigned int )((int )__c *
                                                                          16843009);
#line 2365
                                              __u = (union __anonunion___u_74 *)((void *)__u +
                                                                                 4);
                                              switch_75_2: /* CIL Label */ 
#line 2365
                                              __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                             257);
                                              goto switch_75_break;
                                              switch_75_13: /* CIL Label */ 
#line 2365
                                              __u->__ui = (unsigned int )((int )__c *
                                                                          16843009);
#line 2365
                                              __u = (union __anonunion___u_74 *)((void *)__u +
                                                                                 4);
                                              switch_75_9: /* CIL Label */ 
#line 2365
                                              __u->__ui = (unsigned int )((int )__c *
                                                                          16843009);
#line 2365
                                              __u = (union __anonunion___u_74 *)((void *)__u +
                                                                                 4);
                                              switch_75_5: /* CIL Label */ 
#line 2365
                                              __u->__ui = (unsigned int )((int )__c *
                                                                          16843009);
#line 2365
                                              __u = (union __anonunion___u_74 *)((void *)__u +
                                                                                 4);
                                              switch_75_1: /* CIL Label */ 
#line 2365
                                              __u->__uc = __c;
                                              goto switch_75_break;
                                              switch_75_16: /* CIL Label */ 
#line 2365
                                              __u->__ui = (unsigned int )((int )__c *
                                                                          16843009);
#line 2365
                                              __u = (union __anonunion___u_74 *)((void *)__u +
                                                                                 4);
                                              switch_75_12: /* CIL Label */ 
#line 2365
                                              __u->__ui = (unsigned int )((int )__c *
                                                                          16843009);
#line 2365
                                              __u = (union __anonunion___u_74 *)((void *)__u +
                                                                                 4);
                                              switch_75_8: /* CIL Label */ 
#line 2365
                                              __u->__ui = (unsigned int )((int )__c *
                                                                          16843009);
#line 2365
                                              __u = (union __anonunion___u_74 *)((void *)__u +
                                                                                 4);
                                              switch_75_4: /* CIL Label */ 
#line 2365
                                              __u->__ui = (unsigned int )((int )__c *
                                                                          16843009);
                                              switch_75_0: /* CIL Label */ ;
                                              goto switch_75_break;
                                            } else {
                                              switch_75_break: /* CIL Label */ ;
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      } else {
        {
#line 2365
        __s = (void *)(& dataconn);
#line 2365
        __builtin_memset(__s, '\000', (int )sizeof(dataconn));
        }
      }
      {
#line 2366
      fd = accept(datafd, (struct sockaddr */* __restrict  */)((struct sockaddr *)(& dataconn)),
                  (socklen_t */* __restrict  */)(& socksize));
      }
#line 2366
      if (fd == -1) {
        nope: 
        {
#line 2369
        close(datafd);
#line 2370
        datafd = -1;
#line 2371
        error(421, "The connection couldn\'t be accepted");
        }
#line 2372
        return;
      }
#line 2374
      if ((int )dataconn.ss_family != 2) {
#line 2374
        if ((int )dataconn.ss_family != 10) {
          {
#line 2376
          close(fd);
          }
          goto nope;
        }
      }
      {
#line 2379
      fourinsix(& dataconn);
#line 2380
      tmp___0 = addrcmp((struct sockaddr_storage  const  *)(& peer), (struct sockaddr_storage  const  *)(& dataconn));
      }
#line 2380
      if (tmp___0 == 0) {
        goto while_73_break;
      }
#line 2383
      if ((int )allowfxp == 0) {
        {
#line 2384
        shutdown(fd, 2);
#line 2385
        close(fd);
        }
      } else {
#line 2383
        if ((int )allowfxp == 1) {
#line 2383
          if ((int )guest != 0) {
            {
#line 2384
            shutdown(fd, 2);
#line 2385
            close(fd);
            }
          } else {
            goto while_73_break;
          }
        } else {
          goto while_73_break;
        }
      }
    }
    while_73_break: /* CIL Label */ ;
    }
    {
#line 2390
    addreply_noformat(150, "Accepted data connection");
    }
  } else {
#line 2393
    tries = 1UL + idletime / 2UL;
#line 2395
    peer2 = peer;
#line 2396
    if ((int )peer.ss_family == 10) {
#line 2397
      __x = peerdataport;
#line 2397
      __asm__  ("rorw $8, %w0": "=r" (__v): "0" (__x): "cc");
#line 2397
      ((struct sockaddr_in6 *)(& peer2))->sin6_port = __v;
    } else {
#line 2399
      __x___0 = peerdataport;
#line 2399
      __asm__  ("rorw $8, %w0": "=r" (__v___0): "0" (__x___0): "cc");
#line 2399
      ((struct sockaddr_in *)(& peer2))->sin_port = __v___0;
    }
    again: 
#line 2402
    if ((int )peer2.ss_family == 2) {
#line 2402
      tmp___6 = sizeof(struct sockaddr_in );
    } else {
#line 2402
      tmp___6 = sizeof(struct sockaddr_in6 );
    }
    {
#line 2402
    tmp___7 = connect(datafd, (struct sockaddr  const  */* __restrict  */)((struct sockaddr *)(& peer2)),
                      tmp___6);
    }
#line 2402
    if (tmp___7 != 0) {
      {
#line 2404
      tmp___1 = __errno_location();
      }
#line 2404
      if ((*tmp___1) == 11) {
        goto _L;
      } else {
        {
#line 2404
        tmp___2 = __errno_location();
        }
#line 2404
        if ((*tmp___2) == 4) {
          goto _L;
        } else {
          {
#line 2404
          tmp___3 = __errno_location();
          }
#line 2404
          if ((*tmp___3) == 98) {
            _L: 
#line 2404
            if (tries > 0UL) {
              {
#line 2409
              tries --;
#line 2410
              usleep(1000000U);
              }
              goto again;
            }
          }
        }
      }
      {
#line 2413
      tmp___4 = __errno_location();
#line 2413
      tmp___5 = strerror((*tmp___4));
#line 2413
      addreply(425, "Could not open data connection to port %d: %s", peerdataport,
               tmp___5);
#line 2415
      close(datafd);
#line 2416
      datafd = -1;
      }
#line 2417
      return;
    }
    {
#line 2419
    fd = datafd;
#line 2420
    datafd = -1;
#line 2421
    addreply(150, "Connecting to port %d", peerdataport);
    }
  }
  {
#line 2427
  fodder = 8;
#line 2428
  setsockopt(fd, 0, 1, (void const   *)((char *)(& fodder)), sizeof(fodder));
#line 2438
  fodder = 65536;
#line 2441
  setsockopt(fd, 1, 7, (void const   *)((char *)(& fodder)), sizeof(fodder));
#line 2444
  setsockopt(fd, 1, 8, (void const   *)((char *)(& fodder)), sizeof(fodder));
#line 2448
  keepalive(fd, 1);
#line 2451
  xferfd = (int volatile   )fd;
  }
#line 2452
  return;
}
}
#line 2457 "ftpd.c"
static dev_t root_st_dev  ;
#line 2458 "ftpd.c"
static ino_t root_st_ino  ;
#line 2455 "ftpd.c"
void dochmod(char *name , mode_t mode ) 
{ struct stat st2 ;
  int fd ;
  int tmp ;
  struct stat st ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int *tmp___3 ;
  char *tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;

  {
  if (4095 > mode) {
    INV3: /* CIL Label */ 
    assert(0);
  }
#line 2460
  fd = -1;
#line 2462
  if ((int )nochmod != 0) {
#line 2462
    if (authresult.uid != 0U) {
      {
#line 2463
      addreply(550, "Could not change perms on %s", name);
      }
#line 2464
      return;
    }
  }
#line 2467
  if ((int )guest != 0) {
    {
#line 2468
    addreply_noformat(550, "Anonymous users can not change perms");
    }
#line 2469
    return;
  }
#line 2472
  if ((unsigned int )name == (unsigned int )((void *)0)) {
    {
#line 2473
    addreply_noformat(501, "No file name");
    }
#line 2474
    return;
  } else {
#line 2472
    if ((int )(*name) == 0) {
      {
#line 2473
      addreply_noformat(501, "No file name");
      }
#line 2474
      return;
    }
  }
  {
#line 2476
  tmp = checknamesanity((char const   *)name, (int )dot_write_ok);
  }
#line 2476
  if (tmp != 0) {
    {
#line 2477
    addreply(550, "Prohibited file name: %s", name);
    }
#line 2478
    return;
  }
  {
#line 2480
  fd = open((char const   *)name, 0);
  }
#line 2481
  if (fd == -1) {
    goto failure;
  }
#line 2484
  if ((root_st_dev | root_st_ino) == 0ULL) {
    {
#line 2487
    tmp___0 = stat((char const   */* __restrict  */)"/", (struct stat */* __restrict  */)(& st));
    }
#line 2487
    if (tmp___0 != 0) {
      goto failure;
    }
#line 2490
    root_st_dev = st.st_dev;
#line 2491
    root_st_ino = st.st_ino;
  }
  {
#line 2493
  tmp___1 = fstat(fd, & st2);
  }
#line 2493
  if (tmp___1 != 0) {
    goto failure;
  }
#line 2501
  if (st2.st_ino == root_st_ino) {
#line 2501
    if (st2.st_dev == root_st_dev) {
#line 2502
      mode |= 448U;
    } else {
      goto _L;
    }
  } else {
    _L: 
#line 2503
    if ((int )be_customer_proof != 0) {
#line 2504
      if ((st2.st_mode & 61440U) == 16384U) {
#line 2504
        tmp___2 = 448;
      } else {
#line 2504
        tmp___2 = 384;
      }
#line 2504
      mode |= (unsigned int )tmp___2;
    }
  }
  {
#line 2506
  tmp___5 = fchmod(fd, mode);
  }
#line 2506
  if (tmp___5 < 0) {
    {
#line 2506
    tmp___6 = chmod((char const   *)name, mode);
    }
#line 2506
    if (tmp___6 < 0) {
      failure: 
#line 2508
      if (fd != -1) {
        {
#line 2509
        close(fd);
        }
      }
      {
#line 2511
      tmp___3 = __errno_location();
#line 2511
      tmp___4 = strerror((*tmp___3));
#line 2511
      addreply(550, "Could not change perms on %s: %s", name, tmp___4);
      }
#line 2512
      return;
    }
  }
  {
#line 2514
  close(fd);
#line 2515
  addreply(200, "Permissions changed on %s", name);
  }
#line 2516
  return;
}
}
#line 2518 "ftpd.c"
void doutime(char *name , char const   *wanted_time ) 
{ struct tm tm ;
  time_t ts ;
  struct utimbuf tb ;
  int tmp ;
  void *__s ;
  void *__s___0 ;
  union __anonunion___u_75 *__u ;
  __uint8_t __c ;
  void *__s___1 ;
  int *tmp___0 ;
  char *tmp___1 ;
  int tmp___2 ;

  {
  if (0 == name) {
    INV4: /* CIL Label */ 
    assert(0);
  }
#line 2525
  if ((int )guest != 0) {
    {
#line 2526
    addreply_noformat(550, "Anonymous users can not change perms");
    }
#line 2527
    return;
  }
#line 2530
  if ((unsigned int )name == (unsigned int )((void *)0)) {
    {
#line 2531
    addreply_noformat(501, "No file name");
    }
#line 2532
    return;
  } else {
#line 2530
    if ((int )(*name) == 0) {
      {
#line 2531
      addreply_noformat(501, "No file name");
      }
#line 2532
      return;
    }
  }
  {
#line 2534
  tmp = checknamesanity((char const   *)name, (int )dot_write_ok);
  }
#line 2534
  if (tmp != 0) {
    {
#line 2535
    addreply(550, "Prohibited file name: %s", name);
    }
#line 2536
    return;
  }
#line 2538
  if (sizeof(tm) <= 16U) {
#line 2538
    if (sizeof(tm) == 1U) {
#line 2538
      __s___1 = (void *)(& tm);
#line 2538
      (*((__uint8_t *)__s___1)) = 0;
    } else {
#line 2538
      __s___0 = (void *)(& tm);
#line 2538
      __u = (union __anonunion___u_75 *)__s___0;
#line 2538
      __c = 0;
#line 2539
      if ((int )sizeof(tm) == 15) {
        goto switch_76_15;
      } else {
#line 2539
        if ((int )sizeof(tm) == 11) {
          goto switch_76_11;
        } else {
#line 2539
          if ((int )sizeof(tm) == 7) {
            goto switch_76_7;
          } else {
#line 2539
            if ((int )sizeof(tm) == 3) {
              goto switch_76_3;
            } else {
#line 2539
              if ((int )sizeof(tm) == 14) {
                goto switch_76_14;
              } else {
#line 2539
                if ((int )sizeof(tm) == 10) {
                  goto switch_76_10;
                } else {
#line 2539
                  if ((int )sizeof(tm) == 6) {
                    goto switch_76_6;
                  } else {
#line 2539
                    if ((int )sizeof(tm) == 2) {
                      goto switch_76_2;
                    } else {
#line 2539
                      if ((int )sizeof(tm) == 13) {
                        goto switch_76_13;
                      } else {
#line 2539
                        if ((int )sizeof(tm) == 9) {
                          goto switch_76_9;
                        } else {
#line 2539
                          if ((int )sizeof(tm) == 5) {
                            goto switch_76_5;
                          } else {
#line 2539
                            if ((int )sizeof(tm) == 1) {
                              goto switch_76_1;
                            } else {
#line 2539
                              if ((int )sizeof(tm) == 16) {
                                goto switch_76_16;
                              } else {
#line 2539
                                if ((int )sizeof(tm) == 12) {
                                  goto switch_76_12;
                                } else {
#line 2539
                                  if ((int )sizeof(tm) == 8) {
                                    goto switch_76_8;
                                  } else {
#line 2539
                                    if ((int )sizeof(tm) == 4) {
                                      goto switch_76_4;
                                    } else {
#line 2539
                                      if ((int )sizeof(tm) == 0) {
                                        goto switch_76_0;
                                      } else {
#line 2538
                                        if (0) {
                                          switch_76_15: /* CIL Label */ 
#line 2538
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2538
                                          __u = (union __anonunion___u_75 *)((void *)__u +
                                                                             4);
                                          switch_76_11: /* CIL Label */ 
#line 2538
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2538
                                          __u = (union __anonunion___u_75 *)((void *)__u +
                                                                             4);
                                          switch_76_7: /* CIL Label */ 
#line 2538
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2538
                                          __u = (union __anonunion___u_75 *)((void *)__u +
                                                                             4);
                                          switch_76_3: /* CIL Label */ 
#line 2538
                                          __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                         257);
#line 2538
                                          __u = (union __anonunion___u_75 *)((void *)__u +
                                                                             2);
#line 2538
                                          __u->__uc = __c;
                                          goto switch_76_break;
                                          switch_76_14: /* CIL Label */ 
#line 2538
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2538
                                          __u = (union __anonunion___u_75 *)((void *)__u +
                                                                             4);
                                          switch_76_10: /* CIL Label */ 
#line 2538
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2538
                                          __u = (union __anonunion___u_75 *)((void *)__u +
                                                                             4);
                                          switch_76_6: /* CIL Label */ 
#line 2538
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2538
                                          __u = (union __anonunion___u_75 *)((void *)__u +
                                                                             4);
                                          switch_76_2: /* CIL Label */ 
#line 2538
                                          __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                         257);
                                          goto switch_76_break;
                                          switch_76_13: /* CIL Label */ 
#line 2538
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2538
                                          __u = (union __anonunion___u_75 *)((void *)__u +
                                                                             4);
                                          switch_76_9: /* CIL Label */ 
#line 2538
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2538
                                          __u = (union __anonunion___u_75 *)((void *)__u +
                                                                             4);
                                          switch_76_5: /* CIL Label */ 
#line 2538
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2538
                                          __u = (union __anonunion___u_75 *)((void *)__u +
                                                                             4);
                                          switch_76_1: /* CIL Label */ 
#line 2538
                                          __u->__uc = __c;
                                          goto switch_76_break;
                                          switch_76_16: /* CIL Label */ 
#line 2538
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2538
                                          __u = (union __anonunion___u_75 *)((void *)__u +
                                                                             4);
                                          switch_76_12: /* CIL Label */ 
#line 2538
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2538
                                          __u = (union __anonunion___u_75 *)((void *)__u +
                                                                             4);
                                          switch_76_8: /* CIL Label */ 
#line 2538
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 2538
                                          __u = (union __anonunion___u_75 *)((void *)__u +
                                                                             4);
                                          switch_76_4: /* CIL Label */ 
#line 2538
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
                                          switch_76_0: /* CIL Label */ ;
                                          goto switch_76_break;
                                        } else {
                                          switch_76_break: /* CIL Label */ ;
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  } else {
    {
#line 2538
    __s = (void *)(& tm);
#line 2538
    __builtin_memset(__s, '\000', (int )sizeof(tm));
    }
  }
  {
#line 2539
  sscanf((char const   */* __restrict  */)wanted_time, (char const   */* __restrict  */)"%4u%2u%2u%2u%2u%2u",
         & tm.tm_year, & tm.tm_mon, & tm.tm_mday, & tm.tm_hour, & tm.tm_min, & tm.tm_sec);
#line 2541
  tm.tm_mon --;
#line 2542
  tm.tm_year -= 1900;
  }
#line 2543
  if (tm.tm_mon < 0) {
    {
#line 2545
    addreply_noformat(501, "Can\'t get a time stamp");
    }
#line 2546
    return;
  } else {
#line 2543
    if (tm.tm_year <= 0) {
      {
#line 2545
      addreply_noformat(501, "Can\'t get a time stamp");
      }
#line 2546
      return;
    } else {
      {
#line 2543
      ts = mktime(& tm);
      }
#line 2543
      if (ts == -1L) {
        {
#line 2545
        addreply_noformat(501, "Can\'t get a time stamp");
        }
#line 2546
        return;
      }
    }
  }
  {
#line 2548
  tb.modtime = ts;
#line 2548
  tb.actime = tb.modtime;
#line 2549
  tmp___2 = utime((char const   *)name, (struct utimbuf  const  *)(& tb));
  }
#line 2549
  if (tmp___2 < 0) {
    {
#line 2550
    tmp___0 = __errno_location();
#line 2550
    tmp___1 = strerror((*tmp___0));
#line 2550
    addreply(550, "utime(%s): %s", name, tmp___1);
    }
  } else {
    {
#line 2552
    addreply_noformat(250, "UTIME OK");
    }
  }
#line 2554
  return;
}
}
#line 2557 "ftpd.c"
void dodele(char *name ) 
{ int tmp ;
  int *tmp___0 ;
  int tmp___1 ;
  int *tmp___2 ;
  char *tmp___3 ;

  {
#line 2560
  if ((int )guest != 0) {
    {
#line 2561
    addreply_noformat(550, "Anonymous users can not delete files");
    }
#line 2562
    return;
  }
#line 2565
  if ((unsigned int )name == (unsigned int )((void *)0)) {
    {
#line 2566
    addreply_noformat(501, "No file name");
    }
#line 2567
    return;
  } else {
#line 2565
    if ((int )(*name) == 0) {
      {
#line 2566
      addreply_noformat(501, "No file name");
      }
#line 2567
      return;
    }
  }
  {
#line 2569
  tmp = checknamesanity((char const   *)name, (int )dot_write_ok);
  }
#line 2569
  if (tmp != 0) {
    {
#line 2570
    addreply(550, "Prohibited file name: %s", name);
    }
#line 2571
    return;
  }
#line 2573
  if ((int )keepallfiles != 0) {
    {
#line 2575
    tmp___0 = __errno_location();
#line 2575
    (*tmp___0) = 1;
    }
    goto denied;
  }
  {
#line 2660
  tmp___1 = unlink((char const   *)name);
  }
#line 2660
  if (tmp___1 < 0) {
    goto denied;
  }
  {
#line 2664
  addreply(250, "Deleted %s", name);
#line 2665
  logfile(5, "Deleted %s", name);
  }
#line 2666
  return;
  denied: 
  {
#line 2669
  tmp___2 = __errno_location();
#line 2669
  tmp___3 = strerror((*tmp___2));
#line 2669
  addreply(550, "Could not delete %s: %s", name, tmp___3);
  }
#line 2670
  return;
}
}
#line 2673 "ftpd.c"
static ssize_t doasciiwrite(int fd , char const   *buf , size_t size ) 
{ char *asciibuf ;
  register char *asciibufpnt ;
  size_t z ;
  int writeret ;
  char *tmp___0 ;
  char *tmp___1 ;

  {
#line 2677
  z = 0U;
#line 2680
  if (size <= 0U) {
#line 2681
    return (0);
  }
#line 2683
  if (size > 65536U) {
#line 2685
    return (-1);
  } else {
    {
#line 2683
    asciibuf = (char *)__builtin_alloca(131072U);
    }
#line 2683
    if ((unsigned int )asciibuf == (unsigned int )((void *)0)) {
#line 2685
      return (-1);
    }
  }
#line 2687
  asciibufpnt = asciibuf;
  {
#line 2688
  while (1) {
    while_77_continue: /* CIL Label */ ;
#line 2689
    if ((int const   )(*(buf + z)) == 10) {
#line 2690
      tmp___0 = asciibufpnt;
#line 2690
      asciibufpnt ++;
#line 2690
      (*tmp___0) = (char )'\r';
    }
#line 2692
    tmp___1 = asciibufpnt;
#line 2692
    asciibufpnt ++;
#line 2692
    (*tmp___1) = (char )(*(buf + z));
#line 2693
    z ++;
#line 2688
    if (! (z < size)) {
      goto while_77_break;
    }
  }
  while_77_break: /* CIL Label */ ;
  }
  {
#line 2695
  writeret = safe_write(fd, (void const   *)asciibuf, (unsigned int )(asciibufpnt -
                                                                      asciibuf));
  }
  {
#line 2696
  while (1) {
    while_78_continue: /* CIL Label */ ;
    goto while_78_break;
  }
  while_78_break: /* CIL Label */ ;
  }
#line 2697
  if (writeret < 0) {
#line 2698
    return (-1);
  }
#line 2700
  return ((int )size);
}
}
#line 2704 "ftpd.c"
static double get_usec_time(void) 
{ struct timeval tv ;
  struct timezone tz ;
  int tmp ;

  {
  {
#line 2709
  tmp = gettimeofday((struct timeval */* __restrict  */)(& tv), (struct timezone */* __restrict  */)(& tz));
  }
#line 2709
  if (tmp < 0) {
#line 2710
    return (0.0);
  }
#line 2712
  return ((double )tv.tv_sec + (double )tv.tv_usec / 1000000.0);
}
}
#line 2715 "ftpd.c"
static void displayrate(char const   *word , off_t size , double started , char const   *name ,
                        int up ) 
{ double ended ;
  double t ;
  double speed ;
  char speedstring[64] ;
  char const   *tmp___0 ;
  size_t tmp___1 ;
  char const   *tmp___2 ;
  int tmp___3 ;

  {
  {
#line 2724
  ended = get_usec_time();
#line 2726
  t = ended - started;
#line 2727
  addreply_noformat(226, "File successfully transferred");
  }
#line 2728
  if (t > 0.0) {
#line 2728
    if (size > 0LL) {
#line 2729
      speed = (double )size / t;
    } else {
#line 2731
      speed = 0.0;
    }
  } else {
#line 2731
    speed = 0.0;
  }
#line 2733
  if (speed > 524288.0) {
    {
#line 2734
    addreply(0, "%.3f seconds (measured here), %.2f Mbytes per second", t, speed /
                                                                           1048576.0);
    }
  } else {
#line 2735
    if (speed > 512.0) {
      {
#line 2736
      addreply(0, "%.3f seconds (measured here), %.2f Kbytes per second", t, speed /
                                                                             1024.0);
      }
    } else {
#line 2737
      if (speed > 0.1) {
        {
#line 2738
        addreply(0, "%.3f seconds (measured here), %.2f bytes per second", t, speed);
        }
      }
    }
  }
  {
#line 2740
  tmp___3 = snprintf((char */* __restrict  */)(speedstring), sizeof(speedstring),
                     (char const   */* __restrict  */)" (%llu bytes, %.2fKB/sec)",
                     (unsigned long long )size, speed / 1024.0);
  }
#line 2740
  if (! (tmp___3 >= (int )sizeof(speedstring))) {
#line 2744
    if ((int const   )(*name) != 47) {
#line 2744
      if (! wd[0]) {
#line 2744
        tmp___0 = "/";
      } else {
        {
#line 2744
        tmp___1 = strlen((char const   *)(wd));
        }
#line 2744
        if ((int )wd[tmp___1 - 1U] != 47) {
#line 2744
          tmp___0 = "/";
        } else {
#line 2744
          tmp___0 = "";
        }
      }
    } else {
#line 2744
      tmp___0 = "";
    }
#line 2744
    if ((int const   )(*name) == 47) {
#line 2744
      tmp___2 = "";
    } else {
#line 2744
      tmp___2 = (char const   *)(wd);
    }
    {
#line 2744
    logfile(5, "%s%s%s%s %s %s", root_directory, tmp___2, tmp___0, name, word, speedstring);
    }
  }
#line 2817
  return;
}
}
#line 2819 "ftpd.c"
static void displayopenfailure(char const   *name ) 
{ char buffer[4138] ;
  int e ;
  int *tmp ;
  int tmp___0 ;
  int *tmp___1 ;

  {
  {
#line 2822
  tmp = __errno_location();
#line 2822
  e = (*tmp);
#line 2824
  tmp___0 = snprintf((char */* __restrict  */)(buffer), sizeof(buffer), (char const   */* __restrict  */)"Can\'t open %s",
                     name);
  }
#line 2824
  if (tmp___0 >= (int )sizeof(buffer)) {
    {
#line 2826
    while (1) {
      while_79_continue: /* CIL Label */ ;
      {
#line 2826
      delete_atomic_file();
#line 2826
      _exit(1);
      }
      goto while_79_break;
    }
    while_79_break: /* CIL Label */ ;
    }
  }
  {
#line 2828
  tmp___1 = __errno_location();
#line 2828
  (*tmp___1) = e;
#line 2829
  error(550, (char const   *)(buffer));
  }
#line 2830
  return;
}
}
#line 2832 "ftpd.c"
void doretr(char *name ) 
{ int f ;
  off_t s ;
  off_t skip ;
  off_t o ;
  struct stat st ;
  char *p ;
  char *buf ;
  off_t left ;
  double started ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  time_t tmp___2 ;
  int optval ;
  ssize_t w ;
  int *tmp___4 ;
  fd_set rs ;
  fd_set ws ;
  struct timeval tv ;
  int __d0 ;
  int __d1 ;
  int __d0___0 ;
  int __d1___0 ;
  int tmp___5 ;
  int tmp___6 ;
  register char __result ;
  int *tmp___7 ;
  int optval___0 ;
  ssize_t w___0 ;
  fd_set rs___0 ;
  fd_set ws___0 ;
  struct timeval tv___0 ;
  int __d0___1 ;
  int __d1___1 ;
  int __d0___2 ;
  int __d1___2 ;
  int tmp___9 ;
  int tmp___10 ;
  register char __result___0 ;
  int *tmp___11 ;
  int *tmp___12 ;

  {
#line 2847
  if (! candownload) {
    {
#line 2848
    addreply(550, "The load was %3.2f when you connected. We do not allow downloads\nby anonymous users when the load is that high. Uploads are always\nallowed.",
             load);
    }
    goto end;
  }
#line 2852
  if ((int )type < 1) {
    {
#line 2853
    addreply_noformat(503, "ASCII resume is unsafe, please delete the file first");
    }
    goto end;
  } else {
#line 2852
    if ((int )type == 1) {
#line 2852
      if (restartat > 1LL) {
        {
#line 2853
        addreply_noformat(503, "ASCII resume is unsafe, please delete the file first");
        }
        goto end;
      }
    }
  }
  {
#line 2857
  tmp = checknamesanity((char const   *)name, (int )dot_read_ok);
  }
#line 2857
  if (tmp != 0) {
    {
#line 2858
    addreply(550, "Prohibited file name: %s", name);
    }
    goto end;
  }
  {
#line 2861
  f = open((char const   *)name, 0);
  }
#line 2861
  if (f == -1) {
    {
#line 2862
    displayopenfailure((char const   *)name);
    }
    goto end;
  }
  {
#line 2865
  tmp___0 = fstat(f, & st);
  }
#line 2865
  if (tmp___0 < 0) {
    stat_failure: 
    {
#line 2867
    close(f);
#line 2868
    error(451, "Can\'t find file size");
    }
    goto end;
  }
#line 2871
  if ((st.st_mode & 61440U) == 40960U) {
    {
#line 2872
    tmp___1 = stat((char const   */* __restrict  */)name, (struct stat */* __restrict  */)(& st));
    }
#line 2872
    if (tmp___1 < 0) {
      goto stat_failure;
    }
  }
#line 2876
  if (restartat) {
#line 2876
    if (restartat > st.st_size) {
      {
#line 2877
      close(f);
#line 2878
      addreply(451, "Restart offset %lld is too large for file size %lld.\nRestart offset reset to 0",
               restartat, st.st_size);
      }
      goto end;
    }
  }
#line 2882
  if (! ((st.st_mode & 61440U) == 32768U)) {
    {
#line 2888
    close(f);
#line 2889
    addreply_noformat(550, "I can only retrieve regular files");
    }
    goto end;
  } else {
#line 2882
    if (st.st_size != st.st_size) {
      {
#line 2888
      close(f);
#line 2889
      addreply_noformat(550, "I can only retrieve regular files");
      }
      goto end;
    }
  }
#line 2892
  if (warez != 0U) {
#line 2892
    if (st.st_uid == warez) {
#line 2892
      if ((int )guest != 0) {
        {
#line 2893
        close(f);
#line 2894
        addreply(550, "This file has been uploaded by an anonymous user. It has not\nyet been approved for downloading by the site administrators.");
        }
        goto end;
      }
    }
  }
  {
#line 2909
  opendata();
  }
#line 2910
  if (xferfd == -1) {
    {
#line 2911
    close(f);
    }
    goto end;
  }
#line 2914
  if (restartat > st.st_size) {
    {
#line 2916
    addreply_noformat(226, "Nothing left to download");
#line 2917
    close(f);
#line 2918
    closedata();
    }
    goto end;
  }
  {
#line 2937
  tmp___2 = time((time_t *)((void *)0));
  }
#line 2937
  if (tmp___2 % 100L == 0L) {
    {
#line 2938
    addreply_noformat(0, "The computer is your friend. Trust the computer");
    }
  }
#line 2941
  if (st.st_size - restartat > 4096LL) {
    {
#line 2942
    addreply(0, "%.1f kbytes to download", (double )(st.st_size - restartat) / 1024.0);
    }
  }
  {
#line 2944
  doreply();
#line 2945
  state_needs_update = 1;
#line 2946
  setprocessname("pure-ftpd (DOWNLOAD)");
#line 2969
  alarm(86400U);
#line 2970
  started = get_usec_time();
  }
#line 2973
  if ((int )type == 2) {
#line 2976
    o = restartat;
    {
#line 2977
    while (1) {
      while_80_continue: /* CIL Label */ ;
      {
#line 2977
      optval = 1;
#line 2977
      setsockopt((int )xferfd, 6, 3, (void const   *)(& optval), sizeof(optval));
      }
      goto while_80_break;
    }
    while_80_break: /* CIL Label */ ;
    }
#line 3115
    o = restartat & (long long )(~ (map_size - 1U));
#line 3116
    skip = restartat - o;
    {
#line 3117
    while (1) {
      while_81_continue: /* CIL Label */ ;
#line 3117
      if (! (o < st.st_size)) {
        goto while_81_break;
      }
#line 3124
      left = st.st_size - o;
#line 3125
      if (left > (long long )dl_chunk_size) {
#line 3126
        left = (long long )dl_chunk_size;
      }
      {
#line 3128
      buf = (char *)mmap((void *)0, (unsigned int )left, 1, 1, f, o);
      }
#line 3129
      if ((unsigned int )buf == (unsigned int )((char *)((void *)-1))) {
        {
#line 3130
        closedata();
#line 3131
        close(f);
#line 3132
        error(451, "Unable to map the file into memory");
        }
        goto end;
      }
#line 3135
      p = buf;
#line 3136
      o += left;
#line 3137
      s = left;
      {
#line 3138
      while (1) {
        while_82_continue: /* CIL Label */ ;
#line 3138
        if (! (left > skip)) {
          goto while_82_break;
        }
        {
#line 3141
        while (1) {
          while_83_continue: /* CIL Label */ ;
          {
#line 3141
          w = write((int )xferfd, (void const   *)(p + skip), (unsigned int )(left -
                                                                              skip));
          }
#line 3141
          if (w < 0) {
            {
#line 3141
            tmp___4 = __errno_location();
            }
#line 3141
            if (! ((*tmp___4) == 4)) {
              goto while_83_break;
            }
          } else {
            goto while_83_break;
          }
        }
        while_83_break: /* CIL Label */ ;
        }
#line 3143
        if (w < 0) {
          {
#line 3144
          tmp___7 = __errno_location();
          }
#line 3144
          if ((*tmp___7) == 11) {
#line 3144
            if (xferfd != -1) {
              {
#line 3150
              while (1) {
                while_84_continue: /* CIL Label */ ;
#line 3150
                __asm__  volatile   ("cld; rep; stosl": "=c" (__d0), "=D" (__d1): "a" (0),
                                     "0" (sizeof(fd_set ) / sizeof(__fd_mask )), "1" (& rs.fds_bits[0]): "memory");
                goto while_84_break;
              }
              while_84_break: /* CIL Label */ ;
              }
              {
#line 3151
              while (1) {
                while_85_continue: /* CIL Label */ ;
#line 3151
                __asm__  volatile   ("cld; rep; stosl": "=c" (__d0___0), "=D" (__d1___0): "a" (0),
                                     "0" (sizeof(fd_set ) / sizeof(__fd_mask )), "1" (& ws.fds_bits[0]): "memory");
                goto while_85_break;
              }
              while_85_break: /* CIL Label */ ;
              }
              {
#line 3152
              __asm__  volatile   ("btsl %1,%0": "=m" (rs.fds_bits[0U / (8U * sizeof(__fd_mask ))]): "r" (0U %
                                                                                                          (8U *
                                                                                                           sizeof(__fd_mask ))): "cc",
                                   "memory");
#line 3153
              safe_fd_set((int )xferfd, & ws);
#line 3154
              tv.tv_sec = (long )idletime;
#line 3155
              tv.tv_usec = 0L;
              }
#line 3158
              if (xferfd == -1) {
                {
#line 3160
                munmap((void *)buf, (unsigned int )s);
#line 3161
                close(f);
#line 3162
                closedata();
#line 3163
                addreply_noformat(426, "Transfer aborted");
                }
                goto end;
              } else {
                {
#line 3156
                tmp___6 = select((int )(xferfd + 1), (fd_set */* __restrict  */)(& rs),
                                 (fd_set */* __restrict  */)(& ws), (fd_set */* __restrict  */)((void *)0),
                                 (struct timeval */* __restrict  */)(& tv));
                }
#line 3158
                if (tmp___6 <= 0) {
                  {
#line 3160
                  munmap((void *)buf, (unsigned int )s);
#line 3161
                  close(f);
#line 3162
                  closedata();
#line 3163
                  addreply_noformat(426, "Transfer aborted");
                  }
                  goto end;
                } else {
#line 3158
                  __asm__  volatile   ("btl %1,%2 ; setcb %b0": "=q" (__result): "r" (0U %
                                                                                      (8U *
                                                                                       sizeof(__fd_mask ))),
                                       "m" (rs.fds_bits[0U / (8U * sizeof(__fd_mask ))]): "cc");
#line 3158
                  if (__result) {
                    {
#line 3160
                    munmap((void *)buf, (unsigned int )s);
#line 3161
                    close(f);
#line 3162
                    closedata();
#line 3163
                    addreply_noformat(426, "Transfer aborted");
                    }
                    goto end;
                  } else {
                    {
#line 3165
                    tmp___5 = safe_fd_isset((int )xferfd, (fd_set const   *)(& ws));
                    }
#line 3165
                    if (! tmp___5) {
                      {
#line 3167
                      die(421, 6, "Timeout (no new data for %lu seconds)", idletime);
                      }
                    }
                  }
                }
              }
#line 3170
              w = 0;
            } else {
              goto _L;
            }
          } else {
            _L: 
            {
#line 3172
            close(f);
            }
#line 3173
            if (xferfd != -1) {
              {
#line 3174
              closedata();
#line 3175
              addreply_noformat(450, "Error during write to data connection");
#line 3176
              logfile(6, "Transfer aborted");
              }
            }
            goto end;
          }
        }
#line 3181
        downloaded += (unsigned long long )w;
#line 3182
        left -= (long long )w;
#line 3183
        p += w;
      }
      while_82_break: /* CIL Label */ ;
      }
      {
#line 3204
      skip = 0LL;
#line 3205
      munmap((void *)buf, (unsigned int )s);
      }
    }
    while_81_break: /* CIL Label */ ;
    }
  } else {
#line 3211
    o = restartat & (long long )(~ (map_size - 1U));
#line 3212
    skip = restartat - o;
    {
#line 3213
    while (1) {
      while_86_continue: /* CIL Label */ ;
      {
#line 3213
      optval___0 = 1;
#line 3213
      setsockopt((int )xferfd, 6, 3, (void const   *)(& optval___0), sizeof(optval___0));
      }
      goto while_86_break;
    }
    while_86_break: /* CIL Label */ ;
    }
    {
#line 3214
    while (1) {
      while_87_continue: /* CIL Label */ ;
#line 3214
      if (! (o < st.st_size)) {
        goto while_87_break;
      }
#line 3220
      left = st.st_size - o;
#line 3221
      if (left > (long long )dl_chunk_size) {
#line 3222
        left = (long long )dl_chunk_size;
      }
#line 3224
      if (left > 65536LL) {
#line 3225
        left = 65536LL;
      }
      {
#line 3227
      buf = (char *)mmap((void *)0, (unsigned int )left, 1, 1, f, o);
      }
#line 3228
      if ((unsigned int )buf == (unsigned int )((char *)((void *)-1))) {
        {
#line 3229
        closedata();
#line 3230
        close(f);
#line 3231
        error(451, "Unable to map the file into memory");
        }
        goto end;
      }
#line 3234
      p = buf;
#line 3235
      o += left;
#line 3236
      s = left;
      {
#line 3237
      while (1) {
        while_88_continue: /* CIL Label */ ;
#line 3237
        if (! (left > skip)) {
          goto while_88_break;
        }
        {
#line 3239
        w___0 = doasciiwrite((int )xferfd, (char const   *)p + skip, (unsigned int )(left -
                                                                                     skip));
        }
#line 3241
        if (w___0 < 0) {
#line 3242
          if (xferfd != -1) {
            {
#line 3242
            tmp___11 = __errno_location();
            }
#line 3242
            if ((*tmp___11) == 11) {
              goto _L___1;
            } else {
              {
#line 3242
              tmp___12 = __errno_location();
              }
#line 3242
              if ((*tmp___12) == 4) {
                _L___1: 
                {
#line 3248
                while (1) {
                  while_89_continue: /* CIL Label */ ;
#line 3248
                  __asm__  volatile   ("cld; rep; stosl": "=c" (__d0___1), "=D" (__d1___1): "a" (0),
                                       "0" (sizeof(fd_set ) / sizeof(__fd_mask )),
                                       "1" (& rs___0.fds_bits[0]): "memory");
                  goto while_89_break;
                }
                while_89_break: /* CIL Label */ ;
                }
                {
#line 3249
                while (1) {
                  while_90_continue: /* CIL Label */ ;
#line 3249
                  __asm__  volatile   ("cld; rep; stosl": "=c" (__d0___2), "=D" (__d1___2): "a" (0),
                                       "0" (sizeof(fd_set ) / sizeof(__fd_mask )),
                                       "1" (& ws___0.fds_bits[0]): "memory");
                  goto while_90_break;
                }
                while_90_break: /* CIL Label */ ;
                }
                {
#line 3250
                __asm__  volatile   ("btsl %1,%0": "=m" (rs___0.fds_bits[0U / (8U *
                                                                               sizeof(__fd_mask ))]): "r" (0U %
                                                                                                           (8U *
                                                                                                            sizeof(__fd_mask ))): "cc",
                                     "memory");
#line 3251
                safe_fd_set((int )xferfd, & ws___0);
#line 3252
                tv___0.tv_sec = (long )idletime;
#line 3253
                tv___0.tv_usec = 0L;
                }
#line 3256
                if (xferfd == -1) {
                  {
#line 3258
                  munmap((void *)buf, (unsigned int )s);
#line 3259
                  closedata();
#line 3260
                  close(f);
#line 3261
                  addreply_noformat(426, "Transfer aborted");
                  }
                  goto end;
                } else {
                  {
#line 3254
                  tmp___10 = select((int )(xferfd + 1), (fd_set */* __restrict  */)(& rs___0),
                                    (fd_set */* __restrict  */)(& ws___0), (fd_set */* __restrict  */)((void *)0),
                                    (struct timeval */* __restrict  */)(& tv___0));
                  }
#line 3256
                  if (tmp___10 <= 0) {
                    {
#line 3258
                    munmap((void *)buf, (unsigned int )s);
#line 3259
                    closedata();
#line 3260
                    close(f);
#line 3261
                    addreply_noformat(426, "Transfer aborted");
                    }
                    goto end;
                  } else {
#line 3256
                    __asm__  volatile   ("btl %1,%2 ; setcb %b0": "=q" (__result___0): "r" (0U %
                                                                                            (8U *
                                                                                             sizeof(__fd_mask ))),
                                         "m" (rs___0.fds_bits[0U / (8U * sizeof(__fd_mask ))]): "cc");
#line 3256
                    if (__result___0) {
                      {
#line 3258
                      munmap((void *)buf, (unsigned int )s);
#line 3259
                      closedata();
#line 3260
                      close(f);
#line 3261
                      addreply_noformat(426, "Transfer aborted");
                      }
                      goto end;
                    } else {
                      {
#line 3263
                      tmp___9 = safe_fd_isset((int )xferfd, (fd_set const   *)(& ws___0));
                      }
#line 3263
                      if (! tmp___9) {
                        {
#line 3265
                        die(421, 6, "Timeout (no new data for %lu seconds)", idletime);
                        }
                      }
                    }
                  }
                }
#line 3268
                w___0 = 0;
              } else {
                goto _L___0;
              }
            }
          } else {
            _L___0: 
            {
#line 3270
            close(f);
            }
#line 3271
            if (xferfd != -1) {
              {
#line 3272
              closedata();
#line 3273
              addreply_noformat(450, "Error during write to data connection");
#line 3274
              logfile(6, "Transfer aborted");
              }
            }
            goto end;
          }
        }
#line 3279
        downloaded += (unsigned long long )w___0;
#line 3280
        left -= (long long )w___0;
#line 3281
        p += w___0;
      }
      while_88_break: /* CIL Label */ ;
      }
      {
#line 3301
      skip = 0LL;
#line 3302
      munmap((void *)buf, (unsigned int )s);
      }
    }
    while_87_break: /* CIL Label */ ;
    }
  }
  {
#line 3306
  close(f);
#line 3307
  closedata();
#line 3308
  displayrate("downloaded", st.st_size - restartat, started, (char const   *)name,
              0);
  }
  end: 
#line 3310
  restartat = 0LL;
#line 3311
  return;
}
}
#line 3313 "ftpd.c"
void dorest(char const   *name ) 
{ char *endptr ;

  {
  {
#line 3317
  restartat = (off_t )strtoull((char const   */* __restrict  */)name, (char **/* __restrict  */)(& endptr),
                               10);
  }
#line 3318
  if ((int )(*endptr) != 0) {
    {
#line 3319
    restartat = 0LL;
#line 3320
    addreply(501, "REST needs a numeric parameter\nRestart offset reset to 0");
    }
  } else {
#line 3318
    if (restartat < 0LL) {
      {
#line 3319
      restartat = 0LL;
#line 3320
      addreply(501, "REST needs a numeric parameter\nRestart offset reset to 0");
      }
    } else {
#line 3322
      if ((int )type == 1) {
#line 3322
        if (restartat != 0LL) {
          {
#line 3326
          addreply(350, "Restarting at %lld. But we\'re in ASCII mode", restartat);
          }
        } else {
          goto _L;
        }
      } else {
        _L: 
#line 3330
        if (restartat != 0LL) {
          {
#line 3331
          logfile(5, "Restarting at %lld", restartat);
          }
        }
        {
#line 3333
        addreply(350, "Restarting at %lld", restartat);
        }
      }
    }
  }
#line 3336
  return;
}
}
#line 3338 "ftpd.c"
void domkd(char *name ) 
{ int tmp ;
  int tmp___0 ;

  {
#line 3345
  if ((int )guest != 0) {
#line 3345
    if (allow_anon_mkdir == 0) {
      {
#line 3346
      addreply_noformat(550, "Sorry, anonymous users are not allowed to create directories");
      }
#line 3347
      return;
    }
  }
  {
#line 3349
  tmp = checknamesanity((char const   *)name, (int )dot_write_ok);
  }
#line 3349
  if (tmp != 0) {
    {
#line 3350
    addreply_noformat(550, "Prohibited directory name");
    }
#line 3351
    return;
  }
  {
#line 3360
  tmp___0 = mkdir((char const   *)name, 511U & ~ u_mask_d);
  }
#line 3360
  if (tmp___0 < 0) {
    {
#line 3364
    error(550, "Can\'t create directory");
    }
  } else {
    {
#line 3366
    addreply(257, "\"%s\" : The directory was successfully created", name);
    }
  }
#line 3372
  return;
}
}
#line 3374 "ftpd.c"
void dormd(char *name ) 
{ int tmp ;
  int tmp___0 ;

  {
#line 3382
  if ((int )guest != 0) {
    {
#line 3383
    addreply_noformat(550, "Sorry, anonymous users are not allowed to remove directories");
    }
#line 3384
    return;
  }
  {
#line 3387
  tmp = checknamesanity((char const   *)name, (int )dot_write_ok);
  }
#line 3387
  if (tmp != 0) {
    {
#line 3388
    addreply_noformat(550, "Prohibited directory name");
    }
#line 3389
    return;
  }
  {
#line 3391
  tmp___0 = rmdir((char const   *)name);
  }
#line 3391
  if (tmp___0 < 0) {
    {
#line 3392
    error(550, "Can\'t remove directory");
    }
  } else {
    {
#line 3398
    addreply_noformat(250, "The directory was successfully removed");
    }
  }
#line 3400
  return;
}
}
#line 3403 "ftpd.c"
void dofeat(void) 
{ char feat[186] ;

  {
#line 3442
  feat[0] = (char )'E';
#line 3442
  feat[1] = (char )'x';
#line 3442
  feat[2] = (char )'t';
#line 3442
  feat[3] = (char )'e';
#line 3442
  feat[4] = (char )'n';
#line 3442
  feat[5] = (char )'s';
#line 3442
  feat[6] = (char )'i';
#line 3442
  feat[7] = (char )'o';
#line 3442
  feat[8] = (char )'n';
#line 3442
  feat[9] = (char )'s';
#line 3442
  feat[10] = (char )' ';
#line 3442
  feat[11] = (char )'s';
#line 3442
  feat[12] = (char )'u';
#line 3442
  feat[13] = (char )'p';
#line 3442
  feat[14] = (char )'p';
#line 3442
  feat[15] = (char )'o';
#line 3442
  feat[16] = (char )'r';
#line 3442
  feat[17] = (char )'t';
#line 3442
  feat[18] = (char )'e';
#line 3442
  feat[19] = (char )'d';
#line 3442
  feat[20] = (char )':';
#line 3442
  feat[21] = (char )'\r';
#line 3442
  feat[22] = (char )'\n';
#line 3442
  feat[23] = (char )' ';
#line 3442
  feat[24] = (char )'E';
#line 3442
  feat[25] = (char )'P';
#line 3442
  feat[26] = (char )'R';
#line 3442
  feat[27] = (char )'T';
#line 3442
  feat[28] = (char )'\r';
#line 3442
  feat[29] = (char )'\n';
#line 3442
  feat[30] = (char )' ';
#line 3442
  feat[31] = (char )'I';
#line 3442
  feat[32] = (char )'D';
#line 3442
  feat[33] = (char )'L';
#line 3442
  feat[34] = (char )'E';
#line 3442
  feat[35] = (char )'\r';
#line 3442
  feat[36] = (char )'\n';
#line 3442
  feat[37] = (char )' ';
#line 3442
  feat[38] = (char )'M';
#line 3442
  feat[39] = (char )'D';
#line 3442
  feat[40] = (char )'T';
#line 3442
  feat[41] = (char )'M';
#line 3442
  feat[42] = (char )'\r';
#line 3442
  feat[43] = (char )'\n';
#line 3442
  feat[44] = (char )' ';
#line 3442
  feat[45] = (char )'S';
#line 3442
  feat[46] = (char )'I';
#line 3442
  feat[47] = (char )'Z';
#line 3442
  feat[48] = (char )'E';
#line 3442
  feat[49] = (char )'\r';
#line 3442
  feat[50] = (char )'\n';
#line 3442
  feat[51] = (char )' ';
#line 3442
  feat[52] = (char )'R';
#line 3442
  feat[53] = (char )'E';
#line 3442
  feat[54] = (char )'S';
#line 3442
  feat[55] = (char )'T';
#line 3442
  feat[56] = (char )' ';
#line 3442
  feat[57] = (char )'S';
#line 3442
  feat[58] = (char )'T';
#line 3442
  feat[59] = (char )'R';
#line 3442
  feat[60] = (char )'E';
#line 3442
  feat[61] = (char )'A';
#line 3442
  feat[62] = (char )'M';
#line 3442
  feat[63] = (char )'\r';
#line 3442
  feat[64] = (char )'\n';
#line 3442
  feat[65] = (char )' ';
#line 3442
  feat[66] = (char )'M';
#line 3442
  feat[67] = (char )'L';
#line 3442
  feat[68] = (char )'S';
#line 3442
  feat[69] = (char )'T';
#line 3442
  feat[70] = (char )' ';
#line 3442
  feat[71] = (char )'t';
#line 3442
  feat[72] = (char )'y';
#line 3442
  feat[73] = (char )'p';
#line 3442
  feat[74] = (char )'e';
#line 3442
  feat[75] = (char )'*';
#line 3442
  feat[76] = (char )';';
#line 3442
  feat[77] = (char )'s';
#line 3442
  feat[78] = (char )'i';
#line 3442
  feat[79] = (char )'z';
#line 3442
  feat[80] = (char )'e';
#line 3442
  feat[81] = (char )'*';
#line 3442
  feat[82] = (char )';';
#line 3442
  feat[83] = (char )'s';
#line 3442
  feat[84] = (char )'i';
#line 3442
  feat[85] = (char )'z';
#line 3442
  feat[86] = (char )'d';
#line 3442
  feat[87] = (char )'*';
#line 3442
  feat[88] = (char )';';
#line 3442
  feat[89] = (char )'m';
#line 3442
  feat[90] = (char )'o';
#line 3442
  feat[91] = (char )'d';
#line 3442
  feat[92] = (char )'i';
#line 3442
  feat[93] = (char )'f';
#line 3442
  feat[94] = (char )'y';
#line 3442
  feat[95] = (char )'*';
#line 3442
  feat[96] = (char )';';
#line 3442
  feat[97] = (char )'U';
#line 3442
  feat[98] = (char )'N';
#line 3442
  feat[99] = (char )'I';
#line 3442
  feat[100] = (char )'X';
#line 3442
  feat[101] = (char )'.';
#line 3442
  feat[102] = (char )'m';
#line 3442
  feat[103] = (char )'o';
#line 3442
  feat[104] = (char )'d';
#line 3442
  feat[105] = (char )'e';
#line 3442
  feat[106] = (char )'*';
#line 3442
  feat[107] = (char )';';
#line 3442
  feat[108] = (char )'U';
#line 3442
  feat[109] = (char )'N';
#line 3442
  feat[110] = (char )'I';
#line 3442
  feat[111] = (char )'X';
#line 3442
  feat[112] = (char )'.';
#line 3442
  feat[113] = (char )'u';
#line 3442
  feat[114] = (char )'i';
#line 3442
  feat[115] = (char )'d';
#line 3442
  feat[116] = (char )'*';
#line 3442
  feat[117] = (char )';';
#line 3442
  feat[118] = (char )'U';
#line 3442
  feat[119] = (char )'N';
#line 3442
  feat[120] = (char )'I';
#line 3442
  feat[121] = (char )'X';
#line 3442
  feat[122] = (char )'.';
#line 3442
  feat[123] = (char )'g';
#line 3442
  feat[124] = (char )'i';
#line 3442
  feat[125] = (char )'d';
#line 3442
  feat[126] = (char )'*';
#line 3442
  feat[127] = (char )';';
#line 3442
  feat[128] = (char )'u';
#line 3442
  feat[129] = (char )'n';
#line 3442
  feat[130] = (char )'i';
#line 3442
  feat[131] = (char )'q';
#line 3442
  feat[132] = (char )'u';
#line 3442
  feat[133] = (char )'e';
#line 3442
  feat[134] = (char )'*';
#line 3442
  feat[135] = (char )';';
#line 3442
  feat[136] = (char )'\r';
#line 3442
  feat[137] = (char )'\n';
#line 3442
  feat[138] = (char )' ';
#line 3442
  feat[139] = (char )'M';
#line 3442
  feat[140] = (char )'L';
#line 3442
  feat[141] = (char )'S';
#line 3442
  feat[142] = (char )'D';
#line 3442
  feat[143] = (char )'\r';
#line 3442
  feat[144] = (char )'\n';
#line 3442
  feat[145] = (char )' ';
#line 3442
  feat[146] = (char )'T';
#line 3442
  feat[147] = (char )'V';
#line 3442
  feat[148] = (char )'F';
#line 3442
  feat[149] = (char )'S';
#line 3442
  feat[150] = (char )'\r';
#line 3442
  feat[151] = (char )'\n';
#line 3442
  feat[152] = (char )' ';
#line 3442
  feat[153] = (char )'E';
#line 3442
  feat[154] = (char )'S';
#line 3442
  feat[155] = (char )'T';
#line 3442
  feat[156] = (char )'P';
#line 3442
  feat[157] = (char )'\r';
#line 3442
  feat[158] = (char )'\n';
#line 3442
  feat[159] = (char )' ';
#line 3442
  feat[160] = (char )'P';
#line 3442
  feat[161] = (char )'A';
#line 3442
  feat[162] = (char )'S';
#line 3442
  feat[163] = (char )'V';
#line 3442
  feat[164] = (char )'\r';
#line 3442
  feat[165] = (char )'\n';
#line 3442
  feat[166] = (char )' ';
#line 3442
  feat[167] = (char )'E';
#line 3442
  feat[168] = (char )'P';
#line 3442
  feat[169] = (char )'S';
#line 3442
  feat[170] = (char )'V';
#line 3442
  feat[171] = (char )'\r';
#line 3442
  feat[172] = (char )'\n';
#line 3442
  feat[173] = (char )' ';
#line 3442
  feat[174] = (char )'S';
#line 3442
  feat[175] = (char )'P';
#line 3442
  feat[176] = (char )'S';
#line 3442
  feat[177] = (char )'V';
#line 3442
  feat[178] = (char )'\r';
#line 3442
  feat[179] = (char )'\n';
#line 3442
  feat[180] = (char )' ';
#line 3442
  feat[181] = (char )'E';
#line 3442
  feat[182] = (char )'S';
#line 3442
  feat[183] = (char )'T';
#line 3442
  feat[184] = (char )'A';
#line 3442
  feat[185] = (char )'\000';
#line 3444
  if ((int )disallow_passive != 0) {
#line 3445
    feat[sizeof("Extensions supported:\r\n EPRT\r\n IDLE\r\n MDTM\r\n SIZE\r\n REST STREAM\r\n MLST type*;size*;sizd*;modify*;UNIX.mode*;UNIX.uid*;UNIX.gid*;unique*;\r\n MLSD\r\n TVFS\r\n ESTP")] = 0;
  } else {
#line 3448
    if ((int )force_passive_ip.ss_family != 0) {
#line 3449
      feat[sizeof("Extensions supported:\r\n EPRT\r\n IDLE\r\n MDTM\r\n SIZE\r\n REST STREAM\r\n MLST type*;size*;sizd*;modify*;UNIX.mode*;UNIX.uid*;UNIX.gid*;unique*;\r\n MLSD\r\n TVFS\r\n ESTP\r\n PASV\r\n EPSV\r\n SPSV")] = 0;
    }
  }
  {
#line 3452
  addreply_noformat(0, (char const   *)(feat));
#line 3453
  addreply_noformat(211, "End.");
  }
#line 3454
  return;
}
}
#line 3461 "ftpd.c"
static unsigned int seq  =    0U;
#line 3458 "ftpd.c"
void dostou(void) 
{ char file[64] ;
  struct timeval tv ;
  struct timezone tz ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 3465
  tmp = gettimeofday((struct timeval */* __restrict  */)(& tv), (struct timezone */* __restrict  */)(& tz));
  }
#line 3465
  if (tmp != 0) {
    {
#line 3466
    error(553, "Can\'t get a time stamp");
    }
#line 3467
    return;
  }
  {
#line 3469
  tmp___0 = snprintf((char */* __restrict  */)(file), sizeof(file), (char const   */* __restrict  */)"pureftpd.%08lx.%02lx.%04x",
                     (unsigned long )tv.tv_sec, (unsigned long )tv.tv_usec & 255UL,
                     seq);
  }
#line 3469
  if (tmp___0 >= (int )sizeof(file)) {
    {
#line 3473
    while (1) {
      while_91_continue: /* CIL Label */ ;
      {
#line 3473
      delete_atomic_file();
#line 3473
      _exit(1);
      }
      goto while_91_break;
    }
    while_91_break: /* CIL Label */ ;
    }
  }
  {
#line 3475
  seq ++;
#line 3476
  seq &= 65535U;
#line 3477
  addreply(150, "FILE: %s", file);
#line 3478
  dostor(file, 0, 1);
  }
#line 3479
  return;
}
}
#line 3482 "ftpd.c"
static int tryautorename(char const   *atomic_file , char *name ) 
{ char name2[4096] ;
  unsigned int gc ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int *tmp___4 ;

  {
  if (0 == atomic_file) {
    INV5: /* CIL Label */ 
    assert(0);
  }
  {
#line 3485
  gc = 0U;
#line 3487
  tmp___0 = link(atomic_file, (char const   *)name);
  }
#line 3487
  if (tmp___0 == 0) {
    {
#line 3488
    tmp = unlink(atomic_file);
    }
#line 3488
    if (tmp != 0) {
      {
#line 3489
      unlink((char const   *)name);
      }
    }
#line 3491
    return (0);
  }
  {
#line 3493
  while (1) {
    while_92_continue: /* CIL Label */ ;
#line 3494
    gc ++;
#line 3495
    if (gc == 0U) {
      goto while_92_break;
    } else {
      {
#line 3495
      tmp___1 = snprintf((char */* __restrict  */)(name2), sizeof(name2), (char const   */* __restrict  */)"%s.%u",
                         name, gc);
      }
#line 3495
      if (tmp___1 >= (int )sizeof(name2)) {
        goto while_92_break;
      }
    }
    {
#line 3506
    tmp___3 = link(atomic_file, (char const   *)(name2));
    }
#line 3506
    if (tmp___3 == 0) {
      {
#line 3507
      tmp___2 = unlink(atomic_file);
      }
#line 3507
      if (tmp___2 != 0) {
        {
#line 3508
        unlink((char const   *)(name2));
        }
      }
#line 3510
      return (0);
    }
    {
#line 3512
    tmp___4 = __errno_location();
    }
#line 3513
    if ((*tmp___4) == 17) {
      goto switch_93_17;
    } else {
#line 3514
      if ((*tmp___4) == 21) {
        goto switch_93_21;
      } else {
#line 3515
        if ((*tmp___4) == 26) {
          goto switch_93_26;
        } else {
#line 3512
          if (0) {
            switch_93_17: /* CIL Label */ ;
            switch_93_21: /* CIL Label */ ;
            switch_93_26: /* CIL Label */ ;
            goto __Cont;
          } else {
            switch_93_break: /* CIL Label */ ;
          }
        }
      }
    }
    goto while_92_break;
    __Cont: ;
  }
  while_92_break: /* CIL Label */ ;
  }
#line 3526
  return (-1);
}
}
#line 3531 "ftpd.c"
static char res[4096]  ;
#line 3529 "ftpd.c"
static char *get_atomic_file(char const   *file ) 
{ char *z ;
  size_t orig_len ;
  size_t slash ;
  size_t sizeof_atomic_prefix ;
  size_t tmp___0 ;

  {
#line 3537
  if ((unsigned int )file == (unsigned int )((void *)0)) {
#line 3538
    return (res);
  }
  {
#line 3540
  z = strrchr(file, '/');
  }
#line 3540
  if ((unsigned int )z == (unsigned int )((void *)0)) {
#line 3541
    res[0] = 0;
#line 3542
    orig_len = 0U;
  } else {
#line 3544
    slash = (unsigned int )(z - (char *)file);
#line 3545
    if (slash >= sizeof(res) - 1U) {
#line 3546
      return ((char *)((void *)0));
    }
#line 3548
    slash ++;
#line 3549
    if ((int const   )(*(file + slash)) == 0) {
#line 3550
      return ((char *)((void *)0));
    }
    {
#line 3552
    strncpy((char */* __restrict  */)(res), (char const   */* __restrict  */)file,
            slash);
#line 3553
    res[slash] = 0;
#line 3554
    orig_len = strlen((char const   *)(res));
    }
  }
  {
#line 3556
  tmp___0 = strlen((char const   *)atomic_prefix);
#line 3556
  sizeof_atomic_prefix = tmp___0 + 1U;
  }
#line 3557
  if (sizeof(res) - orig_len < sizeof_atomic_prefix) {
#line 3558
    return ((char *)((void *)0));
  }
  {
#line 3560
  memcpy((void */* __restrict  */)(res + orig_len), (void const   */* __restrict  */)atomic_prefix,
         sizeof_atomic_prefix);
  }
#line 3562
  return (res);
}
}
#line 3565 "ftpd.c"
void delete_atomic_file(void) 
{ char const   *atomic_file ;

  {
  {
#line 3569
  atomic_file = get_atomic_file((char const   *)((void *)0));
  }
#line 3569
  if ((unsigned int )atomic_file == (unsigned int )((void *)0)) {
#line 3571
    return;
  } else {
#line 3569
    if ((int const   )(*atomic_file) == 0) {
#line 3571
      return;
    }
  }
  {
#line 3573
  unlink(atomic_file);
  }
#line 3574
  return;
}
}
#line 3605 "ftpd.c"
void dostor(char *name , int append , int autorename___0 ) 
{ int f ;
  char *p ;
  char const   *atomic_file ;
  char *buf ;
  size_t sizeof_buf ;
  ssize_t r ;
  off_t filesize ;
  struct statvfs64 statfsbuf ;
  struct stat st ;
  double started ;
  int unlinkret ;
  char *cpy ;
  char *alloca_namedir ;
  size_t name_len ;
  register char *z ;
  size_t tmp___0 ;
  char *tmp___2 ;
  int tmp___3 ;
  double jam ;
  int tmp___4 ;
  int tmp___6 ;
  int *tmp___7 ;
  int tmp___8 ;
  __off64_t tmp___9 ;
  int tmp___10 ;
  fd_set rs ;
  struct timeval tv ;
  int __d0 ;
  int __d1 ;
  int tmp___12 ;
  char const   *tmp___13 ;
  int tmp___14 ;
  register char __result ;
  int tmp___15 ;
  int w ;
  size_t asciibytes ;
  size_t i ;
  char *cpypnt ;
  char *tmp___16 ;
  char const   *tmp___17 ;
  int tmp___18 ;
  int tmp___19 ;
  int tmp___20 ;

  {
  {
#line 3609
  atomic_file = (char const   *)((void *)0);
#line 3611
  sizeof_buf = ul_chunk_size;
#line 3613
  filesize = 0LL;
#line 3621
  unlinkret = -1;
#line 3627
  cpy = (char *)((void *)0);
#line 3630
  buf = (char *)__builtin_alloca(sizeof_buf);
  }
#line 3630
  if ((unsigned int )buf == (unsigned int )((void *)0)) {
    {
#line 3631
    die_mem();
    }
  }
#line 3633
  if ((int )type < 1) {
    {
#line 3634
    addreply_noformat(503, "ASCII resume is unsafe, please delete the file first");
    }
    goto end;
  } else {
#line 3633
    if ((int )type == 1) {
#line 3633
      if (restartat > 1LL) {
        {
#line 3634
        addreply_noformat(503, "ASCII resume is unsafe, please delete the file first");
        }
        goto end;
      }
    }
  }
#line 3638
  if ((int )guest != 0) {
#line 3638
    if ((int )anon_noupload != 0) {
      {
#line 3639
      addreply_noformat(553, "Anonymous users may not overwrite existing files");
      }
      goto end;
    }
  }
#line 3643
  if (maxdiskusagepct > 0.0) {
    {
#line 3653
    tmp___0 = strlen((char const   *)name);
#line 3653
    name_len = tmp___0 + 1U;
    }
#line 3654
    if (name_len < 2U) {
      goto cantcheckspace;
    } else {
      {
#line 3654
      alloca_namedir = (char *)__builtin_alloca(name_len);
      }
#line 3654
      if ((unsigned int )alloca_namedir == (unsigned int )((void *)0)) {
        goto cantcheckspace;
      }
    }
    {
#line 3658
    memcpy((void */* __restrict  */)alloca_namedir, (void const   */* __restrict  */)name,
           name_len);
#line 3659
    z = strrchr((char const   *)alloca_namedir, '/');
    }
#line 3659
    if ((unsigned int )z != (unsigned int )((void *)0)) {
#line 3660
      if ((unsigned int )z == (unsigned int )alloca_namedir) {
#line 3661
        tmp___2 = z;
#line 3661
        z ++;
#line 3661
        (*tmp___2) = (char )'.';
      }
#line 3663
      (*z) = 0;
    } else {
#line 3665
      (*(alloca_namedir + 0)) = (char )'.';
#line 3666
      (*(alloca_namedir + 1)) = 0;
    }
    {
#line 3668
    tmp___3 = statvfs64((char const   */* __restrict  */)alloca_namedir, (struct statvfs64 */* __restrict  */)(& statfsbuf));
    }
#line 3668
    if (tmp___3 != 0) {
      {
#line 3669
      while (1) {
        while_94_continue: /* CIL Label */ ;
        goto while_94_break;
      }
      while_94_break: /* CIL Label */ ;
      }
      goto cantcheckspace;
    }
    {
#line 3672
    while (1) {
      while_95_continue: /* CIL Label */ ;
      goto while_95_break;
    }
    while_95_break: /* CIL Label */ ;
    }
#line 3677
    if ((double )statfsbuf.f_blocks > 0.0) {
#line 3680
      jam = (double )statfsbuf.f_bavail / (double )statfsbuf.f_blocks;
#line 3682
      if (jam < maxdiskusagepct) {
        {
#line 3683
        addreply_noformat(553, "Disk full - please upload later");
        }
        goto end;
      }
    }
  }
  cantcheckspace: 
  {
#line 3689
  tmp___4 = checknamesanity((char const   *)name, (int )dot_write_ok);
  }
#line 3689
  if (tmp___4 != 0) {
    {
#line 3691
    addreply(553, "Prohibited file name: %s", name);
    }
    goto end;
  } else {
    {
#line 3689
    atomic_file = get_atomic_file((char const   *)name);
    }
#line 3689
    if ((unsigned int )atomic_file == (unsigned int )((void *)0)) {
      {
#line 3691
      addreply(553, "Prohibited file name: %s", name);
      }
      goto end;
    }
  }
#line 3695
  if (restartat > 0LL) {
    goto _L;
  } else {
#line 3695
    if (autorename___0 == 0) {
#line 3695
      if ((int )no_truncate == 0) {
        _L: 
        {
#line 3696
        tmp___6 = rename((char const   *)name, atomic_file);
        }
#line 3696
        if (tmp___6 != 0) {
          {
#line 3696
          tmp___7 = __errno_location();
          }
#line 3696
          if ((*tmp___7) != 2) {
            {
#line 3697
            error(553, "Rename/move failure");
#line 3698
            atomic_file = (char const   *)((void *)0);
            }
            goto end;
          }
        }
      }
    }
  }
  {
#line 3702
  f = open(atomic_file, 65, 511U & ~ u_mask);
  }
#line 3702
  if (f == -1) {
    {
#line 3704
    error(553, "Can\'t open that file");
    }
    goto end;
  }
  {
#line 3707
  tmp___8 = fstat(f, & st);
  }
#line 3707
  if (tmp___8 < 0) {
    {
#line 3708
    close(f);
#line 3709
    error(553, "Can\'t check for file existence");
    }
    goto end;
  }
#line 3712
  if (! ((st.st_mode & 61440U) == 32768U)) {
    {
#line 3717
    close(f);
#line 3718
    addreply_noformat(553, "I can only retrieve regular files");
    }
    goto end;
  }
#line 3722
  if (st.st_size > 0LL) {
#line 3724
    if ((int )guest != 0) {
      {
#line 3725
      addreply_noformat(553, "Anonymous users may not overwrite existing files");
#line 3726
      close(f);
      }
      goto end;
    }
#line 3730
    if (append != 0) {
#line 3731
      restartat = st.st_size;
    }
  } else {
#line 3734
    restartat = 0LL;
  }
#line 3736
  if (restartat > st.st_size) {
#line 3737
    restartat = st.st_size;
  }
#line 3739
  if (restartat > 0LL) {
    {
#line 3739
    tmp___9 = lseek(f, restartat, 0);
    }
#line 3739
    if (tmp___9 < 0LL) {
      {
#line 3740
      close(f);
#line 3741
      error(451, "seek");
      }
      goto end;
    }
  }
#line 3744
  if (restartat < st.st_size) {
    {
#line 3745
    tmp___10 = ftruncate(f, restartat);
    }
#line 3745
    if (tmp___10 < 0) {
      {
#line 3746
      close(f);
#line 3747
      error(451, "ftruncate");
      }
      goto end;
    }
  }
  {
#line 3762
  opendata();
  }
#line 3763
  if (xferfd == -1) {
    {
#line 3764
    close(f);
    }
    goto end;
  }
  {
#line 3767
  doreply();
#line 3768
  state_needs_update = 1;
#line 3769
  setprocessname("pure-ftpd (UPLOAD)");
#line 3770
  filesize = restartat;
  }
#line 3794
  if ((int )type == 1) {
    {
#line 3795
    cpy = (char *)malloc(sizeof_buf);
    }
#line 3795
    if ((unsigned int )cpy == (unsigned int )((void *)0)) {
      goto errasc;
    }
  }
  {
#line 3800
  alarm(86400U);
#line 3801
  started = get_usec_time();
  }
  {
#line 3802
  while (1) {
    while_96_continue: /* CIL Label */ ;
    {
#line 3807
    while (1) {
      while_97_continue: /* CIL Label */ ;
#line 3807
      __asm__  volatile   ("cld; rep; stosl": "=c" (__d0), "=D" (__d1): "a" (0), "0" (sizeof(fd_set ) /
                                                                                      sizeof(__fd_mask )),
                           "1" (& rs.fds_bits[0]): "memory");
      goto while_97_break;
    }
    while_97_break: /* CIL Label */ ;
    }
    {
#line 3808
    __asm__  volatile   ("btsl %1,%0": "=m" (rs.fds_bits[0U / (8U * sizeof(__fd_mask ))]): "r" (0U %
                                                                                                (8U *
                                                                                                 sizeof(__fd_mask ))): "cc",
                         "memory");
#line 3809
    safe_fd_set((int )xferfd, & rs);
#line 3810
    tv.tv_sec = (long )idletime;
#line 3811
    tv.tv_usec = 0L;
    }
#line 3814
    if (xferfd == -1) {
      goto databroken;
    } else {
      {
#line 3812
      tmp___14 = select((int )(xferfd + 1), (fd_set */* __restrict  */)(& rs), (fd_set */* __restrict  */)((void *)0),
                        (fd_set */* __restrict  */)((void *)0), (struct timeval */* __restrict  */)(& tv));
      }
#line 3814
      if (tmp___14 <= 0) {
        goto databroken;
      } else {
#line 3814
        __asm__  volatile   ("btl %1,%2 ; setcb %b0": "=q" (__result): "r" (0U % (8U *
                                                                                  sizeof(__fd_mask ))),
                             "m" (rs.fds_bits[0U / (8U * sizeof(__fd_mask ))]): "cc");
#line 3814
        if (__result) {
          {
#line 3814
          tmp___15 = safe_fd_isset((int )xferfd, (fd_set const   *)(& rs));
          }
#line 3814
          if (! tmp___15) {
            databroken: 
            {
#line 3821
            close(f);
#line 3823
            closedata();
#line 3824
            addreply_noformat(0, "ABRT is the only legal command while uploading");
#line 3825
            addreply_noformat(426, "Transfer aborted");
            }
#line 3826
            if ((int )guest != 0) {
              {
#line 3827
              unlinkret = unlink(atomic_file);
#line 3828
              atomic_file = (char const   *)((void *)0);
              }
            }
            {
#line 3830
            tmp___12 = safe_fd_isset((int )xferfd, (fd_set const   *)(& rs));
            }
#line 3830
            if (! tmp___12) {
#line 3831
              if ((unsigned int )atomic_file != (unsigned int )((void *)0)) {
                {
#line 3832
                rename(atomic_file, (char const   *)name);
                }
              }
              {
#line 3834
              die(421, 6, "Timeout (no new data for %lu seconds)", idletime);
              }
            }
#line 3837
            if (unlinkret) {
#line 3837
              tmp___13 = "partially uploaded";
            } else {
#line 3837
              tmp___13 = "removed";
            }
            {
#line 3837
            addreply(0, "%s %s", name, tmp___13);
            }
            goto end;
          }
        }
      }
    }
    {
#line 3846
    r = read((int )xferfd, (void *)buf, sizeof_buf);
    }
#line 3847
    if (r > 0) {
#line 3848
      p = buf;
#line 3872
      if ((int )type == 1) {
#line 3873
        asciibytes = 0U;
#line 3874
        i = 0U;
#line 3875
        cpypnt = cpy;
        {
#line 3877
        while (1) {
          while_98_continue: /* CIL Label */ ;
#line 3877
          if (! ((int )i < r)) {
            goto while_98_break;
          }
#line 3878
          if ((int )(*(p + i)) != 13) {
#line 3879
            tmp___16 = cpypnt;
#line 3879
            cpypnt ++;
#line 3879
            (*tmp___16) = (*(p + i));
#line 3880
            asciibytes ++;
          }
#line 3882
          i ++;
        }
        while_98_break: /* CIL Label */ ;
        }
        {
#line 3884
        w = safe_write(f, (void const   *)cpy, asciibytes);
        }
#line 3884
        if (w == 0) {
#line 3885
          filesize += (long long )asciibytes;
        }
      } else {
        {
#line 3890
        w = safe_write(f, (void const   *)p, (unsigned int )r);
        }
#line 3890
        if (w == 0) {
#line 3891
          filesize += (long long )r;
        }
      }
#line 3894
      if (w < 0) {
        errasc: 
        {
#line 3901
        close(f);
#line 3903
        closedata();
#line 3904
        error(450, "Error during write to file");
        }
#line 3905
        if ((int )guest != 0) {
          {
#line 3906
          unlinkret = unlink(atomic_file);
#line 3907
          atomic_file = (char const   *)((void *)0);
          }
        }
#line 3909
        if (unlinkret) {
#line 3909
          tmp___17 = "partially uploaded";
        } else {
#line 3909
          tmp___17 = "removed";
        }
        {
#line 3909
        addreply(0, "%s %s", name, tmp___17);
        }
        goto end;
      }
    } else {
#line 3920
      if (r < 0) {
        {
#line 3921
        error(451, "Error during read from data connection");
        }
        goto databroken;
      }
    }
#line 3802
    if (! (r > 0)) {
      goto while_96_break;
    }
  }
  while_96_break: /* CIL Label */ ;
  }
  {
#line 3941
  closedata();
#line 3947
  close(f);
#line 3949
  uploaded += (unsigned long long )(filesize - restartat);
  }
#line 3954
  if (autorename___0 != 0) {
#line 3954
    if (restartat == 0LL) {
      {
#line 3955
      tmp___18 = tryautorename(atomic_file, name);
      }
#line 3955
      if (tmp___18 != 0) {
        {
#line 3956
        error(553, "Rename/move failure");
        }
      }
    } else {
      goto _L___1;
    }
  } else {
    _L___1: 
    {
#line 3959
    tmp___19 = rename(atomic_file, (char const   *)name);
    }
#line 3959
    if (tmp___19 != 0) {
      {
#line 3960
      error(553, "Rename/move failure");
      }
    }
  }
  {
#line 3963
  displayrate("uploaded", filesize - restartat, started, (char const   *)name, 1);
#line 3970
  atomic_file = (char const   *)((void *)0);
  }
  end: 
  {
#line 3974
  free((void *)cpy);
  }
  {
#line 3976
  while (1) {
    while_99_continue: /* CIL Label */ ;
    goto while_99_break;
  }
  while_99_break: /* CIL Label */ ;
  }
#line 3977
  restartat = 0LL;
#line 3978
  if ((unsigned int )atomic_file != (unsigned int )((void *)0)) {
    {
#line 3979
    tmp___20 = rename(atomic_file, (char const   *)name);
    }
#line 3979
    if (tmp___20 != 0) {
      {
#line 3980
      error(553, "Rename/move failure");
#line 3981
      unlink(atomic_file);
      }
    }
  }
#line 3984
  return;
}
}
#line 3986 "ftpd.c"
void domdtm(char const   *name ) 
{ struct stat st ;
  struct tm *t ;
  int tmp ;

  {
#line 3991
  if (! name) {
    {
#line 3992
    addreply_noformat(500, "Missing argument");
    }
  } else {
#line 3991
    if (! (*name)) {
      {
#line 3992
      addreply_noformat(500, "Missing argument");
      }
    } else {
      {
#line 3993
      tmp = stat((char const   */* __restrict  */)name, (struct stat */* __restrict  */)(& st));
      }
#line 3993
      if (tmp) {
        {
#line 3999
        addreply_noformat(550, "Can\'t check for file existence");
        }
      } else {
#line 4000
        if (! ((st.st_mode & 61440U) == 32768U)) {
          {
#line 4001
          addreply_noformat(550, "I can only retrieve regular files");
          }
        } else {
          {
#line 4003
          t = gmtime((time_t const   *)(& st.st_mtim.tv_sec));
          }
#line 4004
          if (! t) {
            {
#line 4005
            addreply_noformat(550, "Couldn\'t get the local time");
            }
          } else {
            {
#line 4007
            addreply(213, "%04d%02d%02d%02d%02d%02d", t->tm_year + 1900, t->tm_mon +
                                                                         1, t->tm_mday,
                     t->tm_hour, t->tm_min, t->tm_sec);
            }
          }
        }
      }
    }
  }
#line 4012
  return;
}
}
#line 4014 "ftpd.c"
void dosize(char const   *name ) 
{ struct stat st ;
  int tmp ;

  {
#line 4018
  if (! name) {
    {
#line 4019
    addreply_noformat(500, "Missing argument");
    }
  } else {
#line 4018
    if (! (*name)) {
      {
#line 4019
      addreply_noformat(500, "Missing argument");
      }
    } else {
      {
#line 4020
      tmp = stat((char const   */* __restrict  */)name, (struct stat */* __restrict  */)(& st));
      }
#line 4020
      if (tmp) {
        {
#line 4026
        addreply_noformat(550, "Can\'t check for file existence");
        }
      } else {
#line 4027
        if (! ((st.st_mode & 61440U) == 32768U)) {
          {
#line 4028
          addreply_noformat(550, "I can only retrieve regular files");
          }
        } else {
          {
#line 4030
          addreply(213, "%llu", (unsigned long long )st.st_size);
          }
        }
      }
    }
  }
#line 4032
  return;
}
}
#line 4034 "ftpd.c"
void dotype(char const   *arg ) 
{ unsigned short const   **tmp ;
  int __res ;
  __int32_t const   **tmp___2 ;
  int __res___0 ;
  __int32_t const   **tmp___5 ;
  int __res___1 ;
  __int32_t const   **tmp___8 ;
  char const   *tmp___9 ;

  {
#line 4036
  replycode = 200;
#line 4038
  if (! arg) {
    {
#line 4039
    addreply(501, "Missing argument\nA(scii) I(mage) L(ocal)");
    }
  } else {
#line 4038
    if (! (*arg)) {
      {
#line 4039
      addreply(501, "Missing argument\nA(scii) I(mage) L(ocal)");
      }
    } else {
#line 4040
      if (sizeof((unsigned char )(*arg)) > 1U) {
        {
#line 4040
        __res___1 = tolower((int )((unsigned char )(*arg)));
        }
      } else {
        {
#line 4040
        tmp___8 = __ctype_tolower_loc();
#line 4040
        __res___1 = (*((*tmp___8) + (int )((unsigned char )(*arg))));
        }
      }
#line 4040
      if (__res___1 == 97) {
#line 4041
        type = 1;
      } else {
#line 4042
        if (sizeof((unsigned char )(*arg)) > 1U) {
          {
#line 4042
          __res___0 = tolower((int )((unsigned char )(*arg)));
          }
        } else {
          {
#line 4042
          tmp___5 = __ctype_tolower_loc();
#line 4042
          __res___0 = (*((*tmp___5) + (int )((unsigned char )(*arg))));
          }
        }
#line 4042
        if (__res___0 == 105) {
#line 4043
          type = 2;
        } else {
#line 4044
          if (sizeof((unsigned char )(*arg)) > 1U) {
            {
#line 4044
            __res = tolower((int )((unsigned char )(*arg)));
            }
          } else {
            {
#line 4044
            tmp___2 = __ctype_tolower_loc();
#line 4044
            __res = (*((*tmp___2) + (int )((unsigned char )(*arg))));
            }
          }
#line 4044
          if (__res == 108) {
#line 4045
            if ((int const   )(*(arg + 1)) == 56) {
#line 4046
              type = 2;
            } else {
              {
#line 4047
              tmp = __ctype_b_loc();
              }
#line 4047
              if ((int const   )(*((*tmp) + (int )((unsigned char )(*(arg + 1))))) &
                  2048) {
                {
#line 4048
                addreply_noformat(504, "Only 8-bit bytes are supported, we\'re not 10 years ago");
                }
              } else {
                {
#line 4050
                addreply_noformat(0, "Missing argument");
#line 4051
                type = 2;
                }
              }
            }
          } else {
            {
#line 4054
            addreply(504, "Unknown TYPE: %s", arg);
            }
          }
        }
      }
    }
  }
#line 4057
  if ((int )type > 1) {
#line 4057
    tmp___9 = "8-bit binary";
  } else {
#line 4057
    tmp___9 = "ASCII";
  }
  {
#line 4057
  addreply(0, "TYPE is now %s", tmp___9);
  }
#line 4058
  return;
}
}
#line 4060 "ftpd.c"
void dostru(char const   *arg ) 
{ int tmp ;

  {
#line 4062
  if ((unsigned int )arg == (unsigned int )((void *)0)) {
    {
#line 4063
    addreply_noformat(500, "Missing argument");
    }
  } else {
#line 4062
    if (! (*arg)) {
      {
#line 4063
      addreply_noformat(500, "Missing argument");
      }
    } else {
      {
#line 4064
      tmp = strcasecmp(arg, "F");
      }
#line 4064
      if (tmp) {
        {
#line 4065
        addreply_noformat(504, "Only F(ile) is supported");
        }
      } else {
        {
#line 4067
        addreply_noformat(200, "F OK");
        }
      }
    }
  }
#line 4069
  return;
}
}
#line 4071 "ftpd.c"
void domode(char const   *arg ) 
{ int tmp ;

  {
#line 4073
  if ((unsigned int )arg == (unsigned int )((void *)0)) {
    {
#line 4074
    addreply_noformat(500, "Missing argument");
    }
  } else {
#line 4073
    if (! (*arg)) {
      {
#line 4074
      addreply_noformat(500, "Missing argument");
      }
    } else {
      {
#line 4075
      tmp = strcasecmp(arg, "S");
      }
#line 4075
      if (tmp) {
        {
#line 4076
        addreply_noformat(504, "Please use S(tream) mode");
        }
      } else {
        {
#line 4078
        addreply_noformat(200, "S OK");
        }
      }
    }
  }
#line 4080
  return;
}
}
#line 4082 "ftpd.c"
void dornfr(char *name ) 
{ struct stat st ;
  int tmp ;
  char *tmp___9 ;
  int tmp___10 ;

  {
#line 4087
  if ((int )guest != 0) {
    {
#line 4088
    addreply_noformat(550, "Anonymous users are not allowed to move/rename files");
    }
#line 4089
    return;
  }
#line 4092
  if ((int )disallow_rename != 0) {
    {
#line 4093
    addreply_noformat(550, "Rename/move failure");
    }
#line 4094
    return;
  }
  {
#line 4096
  tmp = checknamesanity((char const   *)name, (int )dot_write_ok);
  }
#line 4096
  if (tmp != 0) {
    {
#line 4097
    addreply(550, "Prohibited file name: %s", name);
    }
#line 4098
    return;
  }
  {
#line 4100
  tmp___10 = lstat((char const   */* __restrict  */)name, (struct stat */* __restrict  */)(& st));
  }
#line 4100
  if (tmp___10 == 0) {
#line 4101
    if ((unsigned int )renamefrom != (unsigned int )((void *)0)) {
      {
#line 4102
      addreply_noformat(0, "Aborting previous rename operation");
#line 4103
      free((void *)renamefrom);
      }
    }
    {
#line 4105
    tmp___9 = __strdup((char const   *)name);
#line 4105
    renamefrom = tmp___9;
    }
#line 4105
    if ((unsigned int )renamefrom == (unsigned int )((void *)0)) {
      {
#line 4106
      die_mem();
      }
    }
    {
#line 4108
    addreply_noformat(350, "RNFR accepted - file exists, ready for destination");
    }
  } else {
    {
#line 4110
    addreply_noformat(550, "Sorry, but that file doesn\'t exist");
    }
  }
#line 4112
  return;
}
}
#line 4114 "ftpd.c"
void dornto(char *name ) 
{ int tmp ;
  int *tmp___0 ;
  char *tmp___1 ;
  int tmp___2 ;

  {
#line 4117
  if ((int )guest != 0) {
    {
#line 4118
    addreply_noformat(550, "Anonymous users are not allowed to move/rename files");
    }
    goto bye;
  }
#line 4122
  if ((unsigned int )renamefrom == (unsigned int )((void *)0)) {
    {
#line 4123
    addreply_noformat(503, "Need RNFR before RNTO");
    }
    goto bye;
  }
  {
#line 4126
  tmp = checknamesanity((char const   *)name, (int )dot_write_ok);
  }
#line 4126
  if (tmp != 0) {
    {
#line 4127
    addreply(550, "Prohibited file name: %s", name);
    }
#line 4128
    return;
  }
  {
#line 4149
  tmp___2 = rename((char const   *)renamefrom, (char const   *)name);
  }
#line 4149
  if (tmp___2 < 0) {
    {
#line 4150
    tmp___0 = __errno_location();
#line 4150
    tmp___1 = strerror((*tmp___0));
#line 4150
    addreply(550, "Rename/move failure: %s", tmp___1);
    }
  } else {
    {
#line 4152
    addreply_noformat(250, "File successfully renamed or moved");
#line 4153
    logfile(5, "File successfully renamed or moved: [%s]->[%s]", renamefrom, name);
    }
  }
  bye: 
  {
#line 4157
  free((void *)renamefrom);
#line 4158
  renamefrom = (char *)((void *)0);
  }
#line 4159
  return;
}
}
#line 4162 "ftpd.c"
void doopts(char *args ) 
{ char *cmdopts ;
  char *tmp___0 ;
  int tmp___1 ;

  {
  {
#line 4166
  tmp___0 = strchr((char const   *)args, ' ');
#line 4166
  cmdopts = tmp___0;
  }
#line 4166
  if ((unsigned int )cmdopts != (unsigned int )((void *)0)) {
#line 4167
    cmdopts ++;
  }
  {
#line 4189
  tmp___1 = strncasecmp("mlst ", (char const   *)args, 5U);
  }
#line 4189
  if (tmp___1 == 0) {
    {
#line 4190
    addreply_noformat(200, " MLST OPTS type;size;sizd;modify;UNIX.mode;UNIX.uid;UNIX.gid;unique;");
    }
#line 4193
    return;
  }
  {
#line 4195
  addreply_noformat(500, "Unknown command");
  }
#line 4196
  return;
}
}
#line 4199 "ftpd.c"
void error(int n , char const   *msg ) 
{ char const   *e ;
  int *tmp ;
  int optval ;

  {
  {
#line 4201
  tmp = __errno_location();
#line 4201
  e = strerror((*tmp));
#line 4203
  logfile(3, "%s: %s", msg, e);
#line 4204
  addreply(n, "%s: %s", msg, e);
  }
  {
#line 4205
  while (1) {
    while_100_continue: /* CIL Label */ ;
    {
#line 4205
    optval = 0;
#line 4205
    setsockopt(1, 6, 3, (void const   *)(& optval), sizeof(optval));
    }
    goto while_100_break;
  }
  while_100_break: /* CIL Label */ ;
  }
#line 4206
  return;
}
}
#line 4211 "ftpd.c"
static struct rlimit lim  ;
#line 4208 "ftpd.c"
static void fixlimits(void) 
{ 

  {
  {
#line 4213
  lim.rlim_cur = 3600ULL;
#line 4213
  lim.rlim_max = lim.rlim_cur;
#line 4214
  setrlimit((enum __rlimit_resource )0, (struct rlimit  const  *)(& lim));
#line 4215
  lim.rlim_cur = 8388608ULL;
#line 4215
  lim.rlim_max = lim.rlim_cur;
#line 4216
  setrlimit((enum __rlimit_resource )2, (struct rlimit  const  *)(& lim));
#line 4218
  lim.rlim_cur = 0ULL;
#line 4218
  lim.rlim_max = lim.rlim_cur;
#line 4219
  setrlimit((enum __rlimit_resource )4, (struct rlimit  const  *)(& lim));
  }
#line 4222
  return;
}
}
#line 4313 "ftpd.c"
static int check_standalone(void) 
{ socklen_t socksize ;
  int tmp ;

  {
  {
#line 4315
  socksize = sizeof(ctrlconn);
#line 4317
  tmp = getsockname(0, (struct sockaddr */* __restrict  */)((struct sockaddr *)(& ctrlconn)),
                    (socklen_t */* __restrict  */)(& socksize));
  }
#line 4317
  if (tmp != 0) {
#line 4318
    return (1);
  }
#line 4320
  return (0);
}
}
#line 4324 "ftpd.c"
static void set_signals_client(void) 
{ struct sigaction sa ;

  {
  {
#line 4328
  sigemptyset(& sa.sa_mask);
#line 4330
  sa.sa_flags = 268435456;
#line 4332
  sa.__sigaction_handler.sa_handler = & sigurg;
#line 4333
  sigaction(23, (struct sigaction  const  */* __restrict  */)(& sa), (struct sigaction */* __restrict  */)((void *)0));
#line 4341
  sa.__sigaction_handler.sa_handler = (void (*)(int  ))1;
#line 4342
  sigaction(13, (struct sigaction  const  */* __restrict  */)(& sa), (struct sigaction */* __restrict  */)((void *)0));
#line 4343
  sa.__sigaction_handler.sa_handler = (void (*)(int  ))0;
#line 4344
  sigaction(17, (struct sigaction  const  */* __restrict  */)(& sa), (struct sigaction */* __restrict  */)((void *)0));
#line 4346
  sigaction(8, (struct sigaction  const  */* __restrict  */)(& sa), (struct sigaction */* __restrict  */)((void *)0));
#line 4348
  sa.sa_flags = 0;
#line 4349
  sa.__sigaction_handler.sa_handler = & sigalarm;
#line 4350
  sigaction(14, (struct sigaction  const  */* __restrict  */)(& sa), (struct sigaction */* __restrict  */)((void *)0));
#line 4351
  sa.__sigaction_handler.sa_handler = & sigterm_client;
#line 4352
  sigaction(15, (struct sigaction  const  */* __restrict  */)(& sa), (struct sigaction */* __restrict  */)((void *)0));
#line 4353
  sigaction(1, (struct sigaction  const  */* __restrict  */)(& sa), (struct sigaction */* __restrict  */)((void *)0));
#line 4354
  sigaction(3, (struct sigaction  const  */* __restrict  */)(& sa), (struct sigaction */* __restrict  */)((void *)0));
#line 4355
  sigaction(2, (struct sigaction  const  */* __restrict  */)(& sa), (struct sigaction */* __restrict  */)((void *)0));
#line 4357
  sigaction(24, (struct sigaction  const  */* __restrict  */)(& sa), (struct sigaction */* __restrict  */)((void *)0));
  }
#line 4359
  return;
}
}
#line 4361 "ftpd.c"
static void set_signals(void) 
{ struct sigaction sa ;

  {
  {
#line 4366
  sigemptyset(& sa.sa_mask);
#line 4368
  sa.sa_flags = 268435456;
#line 4369
  sa.__sigaction_handler.sa_handler = & sigchild;
#line 4370
  sigaction(17, (struct sigaction  const  */* __restrict  */)(& sa), (struct sigaction */* __restrict  */)((void *)0));
#line 4372
  sa.__sigaction_handler.sa_handler = (void (*)(int  ))1;
#line 4373
  sigaction(13, (struct sigaction  const  */* __restrict  */)(& sa), (struct sigaction */* __restrict  */)((void *)0));
#line 4374
  sigaction(14, (struct sigaction  const  */* __restrict  */)(& sa), (struct sigaction */* __restrict  */)((void *)0));
#line 4375
  sigaction(23, (struct sigaction  const  */* __restrict  */)(& sa), (struct sigaction */* __restrict  */)((void *)0));
#line 4377
  sa.sa_flags = 0;
#line 4378
  sa.__sigaction_handler.sa_handler = & sigterm;
#line 4379
  sigaction(15, (struct sigaction  const  */* __restrict  */)(& sa), (struct sigaction */* __restrict  */)((void *)0));
#line 4380
  sigaction(1, (struct sigaction  const  */* __restrict  */)(& sa), (struct sigaction */* __restrict  */)((void *)0));
#line 4381
  sigaction(3, (struct sigaction  const  */* __restrict  */)(& sa), (struct sigaction */* __restrict  */)((void *)0));
#line 4382
  sigaction(2, (struct sigaction  const  */* __restrict  */)(& sa), (struct sigaction */* __restrict  */)((void *)0));
#line 4384
  sigaction(24, (struct sigaction  const  */* __restrict  */)(& sa), (struct sigaction */* __restrict  */)((void *)0));
  }
#line 4387
  return;
}
}
#line 4389 "ftpd.c"
static void dns_sanitize(char *z ) 
{ 

  {
  {
#line 4391
  while (1) {
    while_101_continue: /* CIL Label */ ;
#line 4391
    if (! ((int )(*z) != 0)) {
      goto while_101_break;
    }
#line 4392
    if ((int )(*z) >= 97) {
#line 4392
      if (! ((int )(*z) <= 122)) {
        goto _L___0;
      }
    } else {
      _L___0: 
#line 4392
      if ((int )(*z) >= 48) {
#line 4392
        if (! ((int )(*z) <= 57)) {
          goto _L;
        }
      } else {
        _L: 
#line 4392
        if (! ((int )(*z) == 46)) {
#line 4392
          if (! ((int )(*z) == 45)) {
#line 4392
            if ((int )(*z) >= 65) {
#line 4392
              if (! ((int )(*z) <= 90)) {
#line 4398
                (*z) = (char )'_';
              }
            } else {
#line 4398
              (*z) = (char )'_';
            }
          }
        }
      }
    }
#line 4400
    z ++;
  }
  while_101_break: /* CIL Label */ ;
  }
#line 4402
  return;
}
}
#line 4404 "ftpd.c"
static void fill_atomic_prefix(void) 
{ char tmp_atomic_prefix[4096] ;
  unsigned int tmp ;
  __pid_t tmp___0 ;
  char *tmp___10 ;

  {
  {
#line 4408
  tmp = zrand();
#line 4408
  tmp___0 = getpid();
#line 4408
  snprintf((char */* __restrict  */)(tmp_atomic_prefix), sizeof(tmp_atomic_prefix),
           (char const   */* __restrict  */)"%s%lx.%x.%lx.%x", ".pureftpd-upload.",
           (unsigned long )session_start_time, (unsigned int )serverport, (unsigned long )tmp___0,
           tmp);
#line 4415
  tmp___10 = __strdup((char const   *)(tmp_atomic_prefix));
#line 4415
  atomic_prefix = tmp___10;
  }
#line 4415
  if ((unsigned int )atomic_prefix == (unsigned int )((void *)0)) {
    {
#line 4416
    die_mem();
    }
  }
#line 4418
  return;
}
}
#line 4420 "ftpd.c"
static void doit(void) 
{ socklen_t socksize ;
  __pid_t tmp ;
  int tmp___0 ;
  int tmp___1 ;
  register unsigned short __v ;
  register unsigned short __x ;
  register unsigned short __v___0 ;
  register unsigned short __x___0 ;
  int tmp___2 ;
  int *tmp___3 ;
  char *tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  int eai ;
  int tmp___7 ;
  unsigned int tmp___8 ;
  unsigned int tmp___9 ;
  int tmp___10 ;
  unsigned int users ;
  double load_[2] ;
  int tmp___11 ;
  int tmp___12 ;
  int fodder ;
  unsigned int tmp___13 ;
  struct tm *t ;
  int tmp___14 ;
  struct addrinfo hints ;
  struct addrinfo *res___0 ;
  void *__s ;
  void *__s___0 ;
  union __anonunion___u_76 *__u ;
  __uint8_t __c ;
  void *__s___1 ;
  int tmp___15 ;

  {
  {
#line 4424
  session_start_time = time((time_t *)((void *)0));
#line 4425
  fixlimits();
#line 4427
  tmp = getpid();
#line 4427
  fcntl(0, 8, tmp);
#line 4429
  set_signals_client();
#line 4430
  umask(0U);
#line 4431
  socksize = sizeof(ctrlconn);
#line 4432
  tmp___0 = getsockname(0, (struct sockaddr */* __restrict  */)((struct sockaddr *)(& ctrlconn)),
                        (socklen_t */* __restrict  */)(& socksize));
  }
#line 4432
  if (tmp___0 != 0) {
    {
#line 4433
    die(421, 3, "Please run pure-ftpd within a super-server (like tcpserver)");
    }
  }
  {
#line 4435
  fourinsix(& ctrlconn);
#line 4436
  tmp___1 = checkvalidaddr((struct sockaddr_storage  const  *)(& ctrlconn));
  }
#line 4436
  if (tmp___1 == 0) {
    {
#line 4437
    die(425, 3, "Sorry, invalid address given");
    }
  }
#line 4439
  if ((int )ctrlconn.ss_family == 10) {
#line 4440
    __x = ((struct sockaddr_in6 *)(& ctrlconn))->sin6_port;
#line 4440
    __asm__  ("rorw $8, %w0": "=r" (__v): "0" (__x): "cc");
#line 4440
    serverport = __v;
  } else {
#line 4442
    __x___0 = ((struct sockaddr_in *)(& ctrlconn))->sin_port;
#line 4442
    __asm__  ("rorw $8, %w0": "=r" (__v___0): "0" (__x___0): "cc");
#line 4442
    serverport = __v___0;
  }
#line 4444
  if ((unsigned int )trustedip != (unsigned int )((void *)0)) {
    {
#line 4444
    tmp___2 = addrcmp((struct sockaddr_storage  const  *)(& ctrlconn), (struct sockaddr_storage  const  *)trustedip);
    }
#line 4444
    if (tmp___2 != 0) {
#line 4445
      anon_only = 1;
    }
  }
  {
#line 4447
  socksize = sizeof(peer);
#line 4448
  tmp___5 = getpeername(0, (struct sockaddr */* __restrict  */)((struct sockaddr *)(& peer)),
                        (socklen_t */* __restrict  */)(& socksize));
  }
#line 4448
  if (tmp___5) {
    {
#line 4449
    tmp___3 = __errno_location();
#line 4449
    tmp___4 = strerror((*tmp___3));
#line 4449
    die(421, 3, "Unable to identify the local socket: %s", tmp___4);
    }
  }
  {
#line 4451
  fourinsix(& peer);
#line 4452
  tmp___6 = checkvalidaddr((struct sockaddr_storage  const  *)(& peer));
  }
#line 4452
  if (tmp___6 == 0) {
    {
#line 4453
    die(425, 3, "Sorry, invalid address given");
    }
  }
  {
#line 4456
  while (1) {
    while_102_continue: /* CIL Label */ ;
#line 4459
    if ((int )resolve_hostnames != 0) {
#line 4459
      tmp___7 = 0;
    } else {
#line 4459
      tmp___7 = 1;
    }
#line 4459
    if ((int )peer.ss_family == 2) {
#line 4459
      tmp___8 = sizeof(struct sockaddr_in );
    } else {
#line 4459
      tmp___8 = sizeof(struct sockaddr_in6 );
    }
    {
#line 4459
    eai = getnameinfo((struct sockaddr  const  */* __restrict  */)((struct sockaddr *)(& peer)),
                      tmp___8, (char */* __restrict  */)(host), sizeof(host), (char */* __restrict  */)((void *)0),
                      0U, (unsigned int )tmp___7);
    }
#line 4459
    if (eai == 0) {
      goto while_102_break;
    }
#line 4471
    if (eai == -2) {
      goto _L;
    } else {
#line 4471
      if (eai == -11) {
        _L: 
#line 4471
        if ((int )resolve_hostnames != 0) {
#line 4471
          if ((int )peer.ss_family == 2) {
#line 4471
            tmp___9 = sizeof(struct sockaddr_in );
          } else {
#line 4471
            tmp___9 = sizeof(struct sockaddr_in6 );
          }
          {
#line 4471
          tmp___10 = getnameinfo((struct sockaddr  const  */* __restrict  */)((struct sockaddr *)(& peer)),
                                 tmp___9, (char */* __restrict  */)(host), sizeof(host),
                                 (char */* __restrict  */)((void *)0), 0U, 1U);
          }
#line 4471
          if (tmp___10 == 0) {
            goto while_102_break;
          }
        }
      }
    }
    {
#line 4479
    die(425, 3, "Sorry, invalid address given");
    }
  }
  while_102_break: /* CIL Label */ ;
  }
  {
#line 4483
  dns_sanitize(host);
#line 4488
  iptropize((struct sockaddr_storage  const  *)(& peer));
#line 4489
  logfile(6, "New connection from %s", host);
#line 4495
  addreply_noformat(0, "--------- Welcome to Pure-FTPd ----------");
#line 4502
  fill_atomic_prefix();
  }
#line 4504
  if (maxusers > 0U) {
#line 4513
    if (standalone) {
#line 4514
      users = (unsigned int )nb_children;
    } else {
      {
#line 4516
      users = daemons(serverport);
      }
    }
#line 4520
    if (users > maxusers) {
      {
#line 4521
      addreply(421, "%lu users (the maximum) are already logged in, sorry", (unsigned long )maxusers);
#line 4522
      doreply();
      }
      {
#line 4523
      while (1) {
        while_103_continue: /* CIL Label */ ;
        {
#line 4523
        delete_atomic_file();
#line 4523
        _exit(1);
        }
        goto while_103_break;
      }
      while_103_break: /* CIL Label */ ;
      }
    }
#line 4526
    if (users > 0U) {
      {
#line 4527
      addreply(0, "You are user number %d of %d allowed.", users, maxusers);
      }
    }
  }
  {
#line 4576
  tmp___11 = getloadavg(load_, (int )(sizeof(load_) / sizeof(load_[0])));
  }
#line 4576
  if (tmp___11 < 0) {
#line 4577
    load = 0.0;
  } else {
#line 4579
    load = load_[1];
  }
  {
#line 4583
  wd[0] = (char )'/';
#line 4584
  wd[1] = 0;
#line 4585
  tmp___12 = chdir((char const   *)(wd));
  }
#line 4585
  if (tmp___12) {
    {
#line 4586
    while (1) {
      while_104_continue: /* CIL Label */ ;
      {
#line 4586
      delete_atomic_file();
#line 4586
      _exit(1);
      }
      goto while_104_break;
    }
    while_104_break: /* CIL Label */ ;
    }
  }
  {
#line 4592
  fodder = 16;
#line 4593
  setsockopt(0, 0, 1, (void const   *)((char *)(& fodder)), sizeof(fodder));
#line 4594
  setsockopt(1, 0, 1, (void const   *)((char *)(& fodder)), sizeof(fodder));
#line 4597
  fodder = 1;
#line 4598
  setsockopt(0, 1, 10, (void const   *)((char *)(& fodder)), sizeof(fodder));
#line 4602
  fodder = 1;
#line 4603
  setsockopt(1, 6, 1, (void const   *)((char *)(& fodder)), sizeof(fodder));
#line 4606
  keepalive(0, 0);
#line 4607
  keepalive(1, 0);
#line 4612
  tmp___13 = zrand();
#line 4612
  srandom((unsigned int )session_start_time ^ tmp___13);
#line 4623
  t = localtime((time_t const   *)(& session_start_time));
  }
#line 4623
  if ((unsigned int )t != (unsigned int )((void *)0)) {
    {
#line 4624
    addreply(220, "Local time is now %02d:%02d. Server port: %u.", t->tm_hour, t->tm_min,
             (unsigned int )serverport);
    }
  }
#line 4629
  if ((int )anon_only > 0) {
    {
#line 4630
    addreply_noformat(220, "Only anonymous FTP is allowed here");
    }
  } else {
#line 4631
    if ((int )anon_only < 0) {
      {
#line 4632
      addreply_noformat(220, "This is a private system - No anonymous login");
      }
    }
  }
#line 4635
  if ((int )allowfxp == 2) {
    {
#line 4636
    addreply_noformat(220, "This server supports FXP transfers");
    }
  }
#line 4650
  if ((int )v6ready != 0) {
#line 4650
    if ((int )peer.ss_family != 10) {
      {
#line 4651
      addreply(0, "IPv6 connections are also welcome on this server.");
      }
    }
  }
#line 4653
  if (idletime >= 120UL) {
    {
#line 4654
    addreply(220, "You will be disconnected after %lu minutes of inactivity.", idletime /
                                                                               60UL);
    }
  } else {
    {
#line 4656
    addreply(220, "You will be disconnected after %lu seconds of inactivity.", idletime);
    }
  }
#line 4660
  if (maxload <= 0.0) {
#line 4660
    tmp___14 = 1;
  } else {
#line 4660
    if (load < maxload) {
#line 4660
      tmp___14 = 1;
    } else {
#line 4660
      tmp___14 = 0;
    }
  }
#line 4660
  candownload = (signed char )tmp___14;
#line 4662
  if ((unsigned int )force_passive_ip_s != (unsigned int )((void *)0)) {
#line 4665
    if (sizeof(hints) <= 16U) {
#line 4665
      if (sizeof(hints) == 1U) {
#line 4665
        __s___1 = (void *)(& hints);
#line 4665
        (*((__uint8_t *)__s___1)) = 0;
      } else {
#line 4665
        __s___0 = (void *)(& hints);
#line 4665
        __u = (union __anonunion___u_76 *)__s___0;
#line 4665
        __c = 0;
#line 4666
        if ((int )sizeof(hints) == 15) {
          goto switch_105_15;
        } else {
#line 4666
          if ((int )sizeof(hints) == 11) {
            goto switch_105_11;
          } else {
#line 4666
            if ((int )sizeof(hints) == 7) {
              goto switch_105_7;
            } else {
#line 4666
              if ((int )sizeof(hints) == 3) {
                goto switch_105_3;
              } else {
#line 4666
                if ((int )sizeof(hints) == 14) {
                  goto switch_105_14;
                } else {
#line 4666
                  if ((int )sizeof(hints) == 10) {
                    goto switch_105_10;
                  } else {
#line 4666
                    if ((int )sizeof(hints) == 6) {
                      goto switch_105_6;
                    } else {
#line 4666
                      if ((int )sizeof(hints) == 2) {
                        goto switch_105_2;
                      } else {
#line 4666
                        if ((int )sizeof(hints) == 13) {
                          goto switch_105_13;
                        } else {
#line 4666
                          if ((int )sizeof(hints) == 9) {
                            goto switch_105_9;
                          } else {
#line 4666
                            if ((int )sizeof(hints) == 5) {
                              goto switch_105_5;
                            } else {
#line 4666
                              if ((int )sizeof(hints) == 1) {
                                goto switch_105_1;
                              } else {
#line 4666
                                if ((int )sizeof(hints) == 16) {
                                  goto switch_105_16;
                                } else {
#line 4666
                                  if ((int )sizeof(hints) == 12) {
                                    goto switch_105_12;
                                  } else {
#line 4666
                                    if ((int )sizeof(hints) == 8) {
                                      goto switch_105_8;
                                    } else {
#line 4666
                                      if ((int )sizeof(hints) == 4) {
                                        goto switch_105_4;
                                      } else {
#line 4666
                                        if ((int )sizeof(hints) == 0) {
                                          goto switch_105_0;
                                        } else {
#line 4665
                                          if (0) {
                                            switch_105_15: /* CIL Label */ 
#line 4665
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 4665
                                            __u = (union __anonunion___u_76 *)((void *)__u +
                                                                               4);
                                            switch_105_11: /* CIL Label */ 
#line 4665
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 4665
                                            __u = (union __anonunion___u_76 *)((void *)__u +
                                                                               4);
                                            switch_105_7: /* CIL Label */ 
#line 4665
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 4665
                                            __u = (union __anonunion___u_76 *)((void *)__u +
                                                                               4);
                                            switch_105_3: /* CIL Label */ 
#line 4665
                                            __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                           257);
#line 4665
                                            __u = (union __anonunion___u_76 *)((void *)__u +
                                                                               2);
#line 4665
                                            __u->__uc = __c;
                                            goto switch_105_break;
                                            switch_105_14: /* CIL Label */ 
#line 4665
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 4665
                                            __u = (union __anonunion___u_76 *)((void *)__u +
                                                                               4);
                                            switch_105_10: /* CIL Label */ 
#line 4665
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 4665
                                            __u = (union __anonunion___u_76 *)((void *)__u +
                                                                               4);
                                            switch_105_6: /* CIL Label */ 
#line 4665
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 4665
                                            __u = (union __anonunion___u_76 *)((void *)__u +
                                                                               4);
                                            switch_105_2: /* CIL Label */ 
#line 4665
                                            __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                           257);
                                            goto switch_105_break;
                                            switch_105_13: /* CIL Label */ 
#line 4665
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 4665
                                            __u = (union __anonunion___u_76 *)((void *)__u +
                                                                               4);
                                            switch_105_9: /* CIL Label */ 
#line 4665
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 4665
                                            __u = (union __anonunion___u_76 *)((void *)__u +
                                                                               4);
                                            switch_105_5: /* CIL Label */ 
#line 4665
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 4665
                                            __u = (union __anonunion___u_76 *)((void *)__u +
                                                                               4);
                                            switch_105_1: /* CIL Label */ 
#line 4665
                                            __u->__uc = __c;
                                            goto switch_105_break;
                                            switch_105_16: /* CIL Label */ 
#line 4665
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 4665
                                            __u = (union __anonunion___u_76 *)((void *)__u +
                                                                               4);
                                            switch_105_12: /* CIL Label */ 
#line 4665
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 4665
                                            __u = (union __anonunion___u_76 *)((void *)__u +
                                                                               4);
                                            switch_105_8: /* CIL Label */ 
#line 4665
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
#line 4665
                                            __u = (union __anonunion___u_76 *)((void *)__u +
                                                                               4);
                                            switch_105_4: /* CIL Label */ 
#line 4665
                                            __u->__ui = (unsigned int )((int )__c *
                                                                        16843009);
                                            switch_105_0: /* CIL Label */ ;
                                            goto switch_105_break;
                                          } else {
                                            switch_105_break: /* CIL Label */ ;
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    } else {
      {
#line 4665
      __s = (void *)(& hints);
#line 4665
      __builtin_memset(__s, '\000', (int )sizeof(hints));
      }
    }
    {
#line 4666
    hints.ai_family = 2;
#line 4667
    hints.ai_addr = (struct sockaddr *)((void *)0);
#line 4668
    tmp___15 = getaddrinfo((char const   */* __restrict  */)force_passive_ip_s, (char const   */* __restrict  */)((void *)0),
                           (struct addrinfo  const  */* __restrict  */)(& hints),
                           (struct addrinfo **/* __restrict  */)(& res___0));
    }
#line 4668
    if (tmp___15 != 0) {
      {
#line 4671
      die(421, 3, "Illegal forced IP for passive connections");
      }
    } else {
#line 4668
      if (res___0->ai_family != 2) {
        {
#line 4671
        die(421, 3, "Illegal forced IP for passive connections");
        }
      } else {
#line 4668
        if (res___0->ai_addrlen > sizeof(force_passive_ip)) {
          {
#line 4671
          die(421, 3, "Illegal forced IP for passive connections");
          }
        }
      }
    }
    {
#line 4673
    memcpy((void */* __restrict  */)(& force_passive_ip), (void const   */* __restrict  */)res___0->ai_addr,
           res___0->ai_addrlen);
#line 4674
    freeaddrinfo(res___0);
    }
  }
  {
#line 4683
  parser();
#line 4685
  addreply(0, "Logout.");
#line 4686
  logfile(6, "Logout.");
#line 4687
  doreply();
  }
#line 4691
  return;
}
}
#line 4693 "ftpd.c"
static void check_ipv6_support(void) 
{ int p ;

  {
  {
#line 4698
  p = socket(10, 1, 6);
  }
#line 4698
  if (p != -1) {
    {
#line 4699
    close(p);
#line 4700
    v6ready = (signed char )((int )v6ready + 1);
    }
  }
#line 4703
  return;
}
}
#line 4706 "ftpd.c"
static void updatepidfile(void) 
{ int fd ;
  char buf[42] ;
  __pid_t tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int *tmp___2 ;
  size_t tmp___3 ;
  int tmp___4 ;

  {
  {
#line 4711
  tmp = getpid();
#line 4711
  tmp___0 = snprintf((char */* __restrict  */)(buf), sizeof(buf), (char const   */* __restrict  */)"%lu\n",
                     (unsigned long )tmp);
  }
#line 4711
  if (tmp___0 >= (int )sizeof(buf)) {
#line 4713
    return;
  }
  {
#line 4715
  tmp___1 = unlink(pid_file);
  }
#line 4715
  if (tmp___1 != 0) {
    {
#line 4715
    tmp___2 = __errno_location();
    }
#line 4715
    if ((*tmp___2) != 2) {
#line 4716
      return;
    }
  }
  {
#line 4718
  fd = open(pid_file, 131649, 420U);
  }
#line 4718
  if (fd == -1) {
#line 4720
    return;
  }
  {
#line 4722
  tmp___3 = strlen((char const   *)(buf));
#line 4722
  tmp___4 = safe_write(fd, (void const   *)(buf), tmp___3);
  }
#line 4722
  if (tmp___4 != 0) {
    {
#line 4723
    ftruncate(fd, 0LL);
    }
  }
  {
#line 4725
  close(fd);
  }
#line 4726
  return;
}
}
#line 4729 "ftpd.c"
static int closedesc_all(int closestdin ) 
{ int fodder ;

  {
#line 4733
  if (closestdin != 0) {
    {
#line 4734
    close(0);
#line 4735
    fodder = open("/dev/null", 0);
    }
#line 4735
    if (fodder == -1) {
#line 4736
      return (-1);
    }
    {
#line 4738
    dup2(fodder, 0);
    }
#line 4739
    if (fodder > 0) {
      {
#line 4740
      close(fodder);
      }
    }
  }
  {
#line 4743
  fodder = open("/dev/null", 1);
  }
#line 4743
  if (fodder == -1) {
#line 4744
    return (-1);
  }
  {
#line 4746
  dup2(fodder, 1);
#line 4747
  dup2(1, 2);
  }
#line 4748
  if (fodder > 2) {
    {
#line 4749
    close(fodder);
    }
  }
#line 4752
  return (0);
}
}
#line 4755 "ftpd.c"
static void dodaemonize(void) 
{ pid_t child ;
  unsigned int i ;
  int *tmp ;
  char *tmp___0 ;
  __pid_t tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;

  {
#line 4761
  if ((int )daemonize != 0) {
    {
#line 4762
    child = fork();
    }
#line 4762
    if (child == -1) {
      {
#line 4763
      perror("Unable to start a standalone server - fork");
#line 4764
      tmp = __errno_location();
#line 4764
      tmp___0 = strerror((*tmp));
#line 4764
      logfile(3, "Unable to start a standalone server: [fork: %s]", tmp___0);
      }
#line 4765
      return;
    } else {
#line 4766
      if (child != 0) {
        {
#line 4767
        while (1) {
          while_106_continue: /* CIL Label */ ;
          {
#line 4767
          delete_atomic_file();
#line 4767
          _exit(0);
          }
          goto while_106_break;
        }
        while_106_break: /* CIL Label */ ;
        }
      }
    }
    {
#line 4769
    tmp___1 = setsid();
    }
#line 4769
    if (tmp___1 == -1) {
      {
#line 4770
      perror("Unable to start a standalone server - setsid");
      }
    }
    {
#line 4773
    chdir("/");
#line 4775
    i = open_max();
    }
    {
#line 4776
    while (1) {
      while_107_continue: /* CIL Label */ ;
      {
#line 4777
      tmp___2 = isatty((int )i);
      }
#line 4777
      if (tmp___2) {
        {
#line 4778
        close((int )i);
        }
      }
#line 4780
      i --;
#line 4776
      if (! (i > 2U)) {
        goto while_107_break;
      }
    }
    while_107_break: /* CIL Label */ ;
    }
    {
#line 4782
    tmp___3 = closedesc_all(1);
    }
#line 4782
    if (tmp___3 != 0) {
      {
#line 4783
      perror("Unable to start a standalone server - /dev/null duplication");
      }
      {
#line 4784
      while (1) {
        while_108_continue: /* CIL Label */ ;
        {
#line 4784
        delete_atomic_file();
#line 4784
        _exit(1);
        }
        goto while_108_break;
      }
      while_108_break: /* CIL Label */ ;
      }
    }
  }
#line 4787
  return;
}
}
#line 4823 "ftpd.c"
static struct sockaddr_storage old_sa  ;
#line 4790 "ftpd.c"
static void accept_client(int active_listen_fd ) 
{ sigset_t set ;
  struct sockaddr_storage sa ;
  socklen_t dummy ;
  pid_t child ;
  int clientfd ;
  void *__s ;
  void *__s___0 ;
  union __anonunion___u_77 *__u ;
  __uint8_t __c ;
  void *__s___1 ;
  char line[1024] ;
  int tmp ;
  size_t tmp___0 ;
  char line___0[1024] ;
  char hbuf[1025] ;
  int tmp___1 ;
  size_t tmp___2 ;
  int tmp___3 ;
  unsigned int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  unsigned int tmp___7 ;
  int tmp___8 ;

  {
#line 4797
  if (sizeof(sa) <= 16U) {
#line 4797
    if (sizeof(sa) == 1U) {
#line 4797
      __s___1 = (void *)(& sa);
#line 4797
      (*((__uint8_t *)__s___1)) = 0;
    } else {
#line 4797
      __s___0 = (void *)(& sa);
#line 4797
      __u = (union __anonunion___u_77 *)__s___0;
#line 4797
      __c = 0;
#line 4798
      if ((int )sizeof(sa) == 15) {
        goto switch_109_15;
      } else {
#line 4798
        if ((int )sizeof(sa) == 11) {
          goto switch_109_11;
        } else {
#line 4798
          if ((int )sizeof(sa) == 7) {
            goto switch_109_7;
          } else {
#line 4798
            if ((int )sizeof(sa) == 3) {
              goto switch_109_3;
            } else {
#line 4798
              if ((int )sizeof(sa) == 14) {
                goto switch_109_14;
              } else {
#line 4798
                if ((int )sizeof(sa) == 10) {
                  goto switch_109_10;
                } else {
#line 4798
                  if ((int )sizeof(sa) == 6) {
                    goto switch_109_6;
                  } else {
#line 4798
                    if ((int )sizeof(sa) == 2) {
                      goto switch_109_2;
                    } else {
#line 4798
                      if ((int )sizeof(sa) == 13) {
                        goto switch_109_13;
                      } else {
#line 4798
                        if ((int )sizeof(sa) == 9) {
                          goto switch_109_9;
                        } else {
#line 4798
                          if ((int )sizeof(sa) == 5) {
                            goto switch_109_5;
                          } else {
#line 4798
                            if ((int )sizeof(sa) == 1) {
                              goto switch_109_1;
                            } else {
#line 4798
                              if ((int )sizeof(sa) == 16) {
                                goto switch_109_16;
                              } else {
#line 4798
                                if ((int )sizeof(sa) == 12) {
                                  goto switch_109_12;
                                } else {
#line 4798
                                  if ((int )sizeof(sa) == 8) {
                                    goto switch_109_8;
                                  } else {
#line 4798
                                    if ((int )sizeof(sa) == 4) {
                                      goto switch_109_4;
                                    } else {
#line 4798
                                      if ((int )sizeof(sa) == 0) {
                                        goto switch_109_0;
                                      } else {
#line 4797
                                        if (0) {
                                          switch_109_15: /* CIL Label */ 
#line 4797
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4797
                                          __u = (union __anonunion___u_77 *)((void *)__u +
                                                                             4);
                                          switch_109_11: /* CIL Label */ 
#line 4797
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4797
                                          __u = (union __anonunion___u_77 *)((void *)__u +
                                                                             4);
                                          switch_109_7: /* CIL Label */ 
#line 4797
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4797
                                          __u = (union __anonunion___u_77 *)((void *)__u +
                                                                             4);
                                          switch_109_3: /* CIL Label */ 
#line 4797
                                          __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                         257);
#line 4797
                                          __u = (union __anonunion___u_77 *)((void *)__u +
                                                                             2);
#line 4797
                                          __u->__uc = __c;
                                          goto switch_109_break;
                                          switch_109_14: /* CIL Label */ 
#line 4797
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4797
                                          __u = (union __anonunion___u_77 *)((void *)__u +
                                                                             4);
                                          switch_109_10: /* CIL Label */ 
#line 4797
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4797
                                          __u = (union __anonunion___u_77 *)((void *)__u +
                                                                             4);
                                          switch_109_6: /* CIL Label */ 
#line 4797
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4797
                                          __u = (union __anonunion___u_77 *)((void *)__u +
                                                                             4);
                                          switch_109_2: /* CIL Label */ 
#line 4797
                                          __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                         257);
                                          goto switch_109_break;
                                          switch_109_13: /* CIL Label */ 
#line 4797
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4797
                                          __u = (union __anonunion___u_77 *)((void *)__u +
                                                                             4);
                                          switch_109_9: /* CIL Label */ 
#line 4797
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4797
                                          __u = (union __anonunion___u_77 *)((void *)__u +
                                                                             4);
                                          switch_109_5: /* CIL Label */ 
#line 4797
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4797
                                          __u = (union __anonunion___u_77 *)((void *)__u +
                                                                             4);
                                          switch_109_1: /* CIL Label */ 
#line 4797
                                          __u->__uc = __c;
                                          goto switch_109_break;
                                          switch_109_16: /* CIL Label */ 
#line 4797
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4797
                                          __u = (union __anonunion___u_77 *)((void *)__u +
                                                                             4);
                                          switch_109_12: /* CIL Label */ 
#line 4797
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4797
                                          __u = (union __anonunion___u_77 *)((void *)__u +
                                                                             4);
                                          switch_109_8: /* CIL Label */ 
#line 4797
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4797
                                          __u = (union __anonunion___u_77 *)((void *)__u +
                                                                             4);
                                          switch_109_4: /* CIL Label */ 
#line 4797
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
                                          switch_109_0: /* CIL Label */ ;
                                          goto switch_109_break;
                                        } else {
                                          switch_109_break: /* CIL Label */ ;
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  } else {
    {
#line 4797
    __s = (void *)(& sa);
#line 4797
    __builtin_memset(__s, '\000', (int )sizeof(sa));
    }
  }
  {
#line 4798
  dummy = sizeof(sa);
#line 4799
  clientfd = accept(active_listen_fd, (struct sockaddr */* __restrict  */)((struct sockaddr *)(& sa)),
                    (socklen_t */* __restrict  */)(& dummy));
  }
#line 4799
  if (clientfd == -1) {
#line 4801
    return;
  }
#line 4803
  if ((int )sa.ss_family != 2) {
#line 4803
    if ((int )sa.ss_family != 10) {
      {
#line 4804
      close(clientfd);
      }
#line 4805
      return;
    }
  }
#line 4807
  if (maxusers > 0U) {
#line 4807
    if (nb_children >= (unsigned int volatile   )maxusers) {
      {
#line 4810
      snprintf((char */* __restrict  */)(line), sizeof(line), (char const   */* __restrict  */)"421 %lu users (the maximum) are already logged in, sorry\r\n",
               (unsigned long )maxusers);
#line 4813
      tmp = fcntl(clientfd, 3);
#line 4813
      fcntl(clientfd, 4, tmp | 2048);
#line 4814
      tmp___0 = strlen((char const   *)(line));
#line 4814
      write(clientfd, (void const   *)(line), tmp___0);
#line 4815
      close(clientfd);
      }
#line 4816
      return;
    }
  }
#line 4818
  if (maxip > 0U) {
    {
#line 4819
    fourinsix(& sa);
#line 4820
    tmp___7 = iptrack_get((struct sockaddr_storage  const  *)(& sa));
    }
#line 4820
    if (tmp___7 >= maxip) {
      {
#line 4825
      tmp___1 = fcntl(clientfd, 3);
#line 4825
      fcntl(clientfd, 4, tmp___1 | 2048);
#line 4826
      tmp___3 = snprintf((char */* __restrict  */)(line___0), sizeof(line___0), (char const   */* __restrict  */)"421 Too many connections (%lu) from this IP\r\n",
                         (unsigned long )maxip);
      }
#line 4826
      if (! (tmp___3 >= (int )sizeof(line___0))) {
        {
#line 4829
        tmp___2 = strlen((char const   *)(line___0));
#line 4829
        write(clientfd, (void const   *)(line___0), tmp___2);
        }
      }
      {
#line 4831
      tmp___6 = addrcmp((struct sockaddr_storage  const  *)(& old_sa), (struct sockaddr_storage  const  *)(& sa));
      }
#line 4831
      if (tmp___6 != 0) {
#line 4832
        old_sa = sa;
#line 4833
        if ((int )sa.ss_family == 2) {
#line 4833
          tmp___4 = sizeof(struct sockaddr_in );
        } else {
#line 4833
          tmp___4 = sizeof(struct sockaddr_in6 );
        }
        {
#line 4833
        tmp___5 = getnameinfo((struct sockaddr  const  */* __restrict  */)((struct sockaddr *)(& sa)),
                              tmp___4, (char */* __restrict  */)(hbuf), sizeof(hbuf),
                              (char */* __restrict  */)((void *)0), 0U, 1U);
        }
#line 4833
        if (tmp___5 == 0) {
          {
#line 4837
          logfile(4, "Too many connections (%lu) from this IP: [%s]", (unsigned long )maxip,
                  hbuf);
          }
        }
      }
      {
#line 4841
      close(clientfd);
      }
#line 4842
      return;
    }
  }
  {
#line 4845
  sigemptyset(& set);
#line 4846
  sigaddset(& set, 17);
#line 4847
  sigprocmask(0, (sigset_t const   */* __restrict  */)(& set), (sigset_t */* __restrict  */)((void *)0));
#line 4848
  nb_children ++;
#line 4849
  child = fork();
  }
#line 4850
  if (child == 0) {
    {
#line 4851
    dup2(clientfd, 0);
#line 4852
    dup2(0, 1);
    }
#line 4853
    if (clientfd > 1) {
      {
#line 4854
      close(clientfd);
      }
    }
#line 4856
    if (listenfd > 1) {
      {
#line 4857
      close((int )listenfd);
      }
    }
#line 4859
    if (listenfd6 > 1) {
      {
#line 4860
      close((int )listenfd6);
      }
    }
    {
#line 4862
    tmp___8 = isatty(2);
    }
#line 4862
    if (tmp___8) {
      {
#line 4863
      close(2);
      }
    }
#line 4866
    if ((int )no_syslog == 0) {
      {
#line 4867
      closelog();
#line 4868
      openlog("pure-ftpd", 8 | log_pid, syslog_facility);
      }
    }
    {
#line 4871
    doit();
    }
    {
#line 4872
    while (1) {
      while_110_continue: /* CIL Label */ ;
      {
#line 4872
      delete_atomic_file();
#line 4872
      _exit(0);
      }
      goto while_110_break;
    }
    while_110_break: /* CIL Label */ ;
    }
  } else {
#line 4873
    if (child == -1) {
#line 4874
      if (nb_children > 0U) {
#line 4875
        nb_children --;
      }
    } else {
#line 4878
      if (maxip > 0U) {
        {
#line 4879
        iptrack_add((struct sockaddr_storage  const  *)(& sa), child);
        }
      }
    }
  }
  {
#line 4882
  close(clientfd);
#line 4883
  sigprocmask(1, (sigset_t const   */* __restrict  */)(& set), (sigset_t */* __restrict  */)((void *)0));
  }
#line 4884
  return;
}
}
#line 4886 "ftpd.c"
static void standalone_server(void) 
{ int on ;
  struct addrinfo hints ;
  struct addrinfo *res___0 ;
  struct addrinfo *res6 ;
  fd_set rs ;
  int max_fd ;
  void *__s ;
  void *__s___0 ;
  union __anonunion___u_78 *__u ;
  __uint8_t __c ;
  void *__s___1 ;
  int *tmp ;
  char *tmp___0 ;
  int tmp___2 ;
  int tmp___3 ;
  unsigned int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  int tmp___8 ;
  int tmp___9 ;
  unsigned int tmp___10 ;
  int tmp___11 ;
  int tmp___12 ;
  int *tmp___13 ;
  int __d0 ;
  int __d1 ;
  int *tmp___14 ;
  int tmp___15 ;
  int tmp___16 ;
  int tmp___17 ;

  {
#line 4894
  standalone = 1;
#line 4896
  if (sizeof(hints) <= 16U) {
#line 4896
    if (sizeof(hints) == 1U) {
#line 4896
      __s___1 = (void *)(& hints);
#line 4896
      (*((__uint8_t *)__s___1)) = 0;
    } else {
#line 4896
      __s___0 = (void *)(& hints);
#line 4896
      __u = (union __anonunion___u_78 *)__s___0;
#line 4896
      __c = 0;
#line 4897
      if ((int )sizeof(hints) == 15) {
        goto switch_111_15;
      } else {
#line 4897
        if ((int )sizeof(hints) == 11) {
          goto switch_111_11;
        } else {
#line 4897
          if ((int )sizeof(hints) == 7) {
            goto switch_111_7;
          } else {
#line 4897
            if ((int )sizeof(hints) == 3) {
              goto switch_111_3;
            } else {
#line 4897
              if ((int )sizeof(hints) == 14) {
                goto switch_111_14;
              } else {
#line 4897
                if ((int )sizeof(hints) == 10) {
                  goto switch_111_10;
                } else {
#line 4897
                  if ((int )sizeof(hints) == 6) {
                    goto switch_111_6;
                  } else {
#line 4897
                    if ((int )sizeof(hints) == 2) {
                      goto switch_111_2;
                    } else {
#line 4897
                      if ((int )sizeof(hints) == 13) {
                        goto switch_111_13;
                      } else {
#line 4897
                        if ((int )sizeof(hints) == 9) {
                          goto switch_111_9;
                        } else {
#line 4897
                          if ((int )sizeof(hints) == 5) {
                            goto switch_111_5;
                          } else {
#line 4897
                            if ((int )sizeof(hints) == 1) {
                              goto switch_111_1;
                            } else {
#line 4897
                              if ((int )sizeof(hints) == 16) {
                                goto switch_111_16;
                              } else {
#line 4897
                                if ((int )sizeof(hints) == 12) {
                                  goto switch_111_12;
                                } else {
#line 4897
                                  if ((int )sizeof(hints) == 8) {
                                    goto switch_111_8;
                                  } else {
#line 4897
                                    if ((int )sizeof(hints) == 4) {
                                      goto switch_111_4;
                                    } else {
#line 4897
                                      if ((int )sizeof(hints) == 0) {
                                        goto switch_111_0;
                                      } else {
#line 4896
                                        if (0) {
                                          switch_111_15: /* CIL Label */ 
#line 4896
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4896
                                          __u = (union __anonunion___u_78 *)((void *)__u +
                                                                             4);
                                          switch_111_11: /* CIL Label */ 
#line 4896
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4896
                                          __u = (union __anonunion___u_78 *)((void *)__u +
                                                                             4);
                                          switch_111_7: /* CIL Label */ 
#line 4896
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4896
                                          __u = (union __anonunion___u_78 *)((void *)__u +
                                                                             4);
                                          switch_111_3: /* CIL Label */ 
#line 4896
                                          __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                         257);
#line 4896
                                          __u = (union __anonunion___u_78 *)((void *)__u +
                                                                             2);
#line 4896
                                          __u->__uc = __c;
                                          goto switch_111_break;
                                          switch_111_14: /* CIL Label */ 
#line 4896
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4896
                                          __u = (union __anonunion___u_78 *)((void *)__u +
                                                                             4);
                                          switch_111_10: /* CIL Label */ 
#line 4896
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4896
                                          __u = (union __anonunion___u_78 *)((void *)__u +
                                                                             4);
                                          switch_111_6: /* CIL Label */ 
#line 4896
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4896
                                          __u = (union __anonunion___u_78 *)((void *)__u +
                                                                             4);
                                          switch_111_2: /* CIL Label */ 
#line 4896
                                          __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                         257);
                                          goto switch_111_break;
                                          switch_111_13: /* CIL Label */ 
#line 4896
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4896
                                          __u = (union __anonunion___u_78 *)((void *)__u +
                                                                             4);
                                          switch_111_9: /* CIL Label */ 
#line 4896
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4896
                                          __u = (union __anonunion___u_78 *)((void *)__u +
                                                                             4);
                                          switch_111_5: /* CIL Label */ 
#line 4896
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4896
                                          __u = (union __anonunion___u_78 *)((void *)__u +
                                                                             4);
                                          switch_111_1: /* CIL Label */ 
#line 4896
                                          __u->__uc = __c;
                                          goto switch_111_break;
                                          switch_111_16: /* CIL Label */ 
#line 4896
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4896
                                          __u = (union __anonunion___u_78 *)((void *)__u +
                                                                             4);
                                          switch_111_12: /* CIL Label */ 
#line 4896
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4896
                                          __u = (union __anonunion___u_78 *)((void *)__u +
                                                                             4);
                                          switch_111_8: /* CIL Label */ 
#line 4896
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
#line 4896
                                          __u = (union __anonunion___u_78 *)((void *)__u +
                                                                             4);
                                          switch_111_4: /* CIL Label */ 
#line 4896
                                          __u->__ui = (unsigned int )((int )__c *
                                                                      16843009);
                                          switch_111_0: /* CIL Label */ ;
                                          goto switch_111_break;
                                        } else {
                                          switch_111_break: /* CIL Label */ ;
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  } else {
    {
#line 4896
    __s = (void *)(& hints);
#line 4896
    __builtin_memset(__s, '\000', (int )sizeof(hints));
    }
  }
#line 4897
  hints.ai_flags = 1;
#line 4898
  hints.ai_family = 2;
#line 4899
  hints.ai_socktype = 1;
#line 4900
  hints.ai_addr = (struct sockaddr *)((void *)0);
#line 4901
  on = 1;
#line 4902
  if ((int )no_ipv4 == 0) {
    {
#line 4902
    tmp___6 = getaddrinfo((char const   */* __restrict  */)standalone_ip, (char const   */* __restrict  */)standalone_port,
                          (struct addrinfo  const  */* __restrict  */)(& hints), (struct addrinfo **/* __restrict  */)(& res___0));
    }
#line 4902
    if (tmp___6 == 0) {
      {
#line 4904
      listenfd = socket(2, 1, 6);
      }
#line 4904
      if (listenfd == -1) {
        goto cant_bind;
      } else {
        {
#line 4904
        tmp___2 = setsockopt((int )listenfd, 1, 2, (void const   *)((char *)(& on)),
                             sizeof(on));
        }
#line 4904
        if (tmp___2 != 0) {
          cant_bind: 
          {
#line 4908
          perror("Unable to start a standalone server");
#line 4909
          tmp = __errno_location();
#line 4909
          tmp___0 = strerror((*tmp));
#line 4909
          logfile(3, "Unable to start a standalone server: [%s]", tmp___0);
          }
#line 4910
          return;
        }
      }
      {
#line 4912
      tmp___3 = bind((int )listenfd, (struct sockaddr  const  */* __restrict  */)res___0->ai_addr,
                     res___0->ai_addrlen);
      }
#line 4912
      if (tmp___3 != 0) {
        goto cant_bind;
      } else {
#line 4912
        if (maxusers > 0U) {
#line 4912
          tmp___4 = 3U + maxusers / 8U;
        } else {
#line 4912
          tmp___4 = 42U;
        }
        {
#line 4912
        tmp___5 = listen((int )listenfd, (int )tmp___4);
        }
#line 4912
        if (tmp___5 != 0) {
          goto cant_bind;
        }
      }
      {
#line 4917
      freeaddrinfo(res___0);
#line 4918
      set_cloexec_flag((int )listenfd);
      }
    }
  }
#line 4920
  if ((int )v6ready != 0) {
    {
#line 4921
    hints.ai_family = 10;
#line 4922
    tmp___12 = getaddrinfo((char const   */* __restrict  */)standalone_ip, (char const   */* __restrict  */)standalone_port,
                           (struct addrinfo  const  */* __restrict  */)(& hints),
                           (struct addrinfo **/* __restrict  */)(& res6));
    }
#line 4922
    if (tmp___12 == 0) {
      {
#line 4923
      listenfd6 = socket(10, 1, 6);
      }
#line 4923
      if (listenfd6 == -1) {
        goto cant_bind;
      } else {
        {
#line 4923
        tmp___8 = setsockopt((int )listenfd6, 1, 2, (void const   *)((char *)(& on)),
                             sizeof(on));
        }
#line 4923
        if (tmp___8 != 0) {
          goto cant_bind;
        }
      }
      {
#line 4930
      setsockopt((int )listenfd6, 41, 26, (void const   *)((char *)(& on)), sizeof(on));
#line 4933
      tmp___9 = bind((int )listenfd6, (struct sockaddr  const  */* __restrict  */)res6->ai_addr,
                     res6->ai_addrlen);
      }
#line 4933
      if (tmp___9 != 0) {
        goto cant_bind;
      } else {
#line 4933
        if (maxusers > 0U) {
#line 4933
          tmp___10 = 3U + maxusers / 8U;
        } else {
#line 4933
          tmp___10 = 42U;
        }
        {
#line 4933
        tmp___11 = listen((int )listenfd6, (int )tmp___10);
        }
#line 4933
        if (tmp___11 != 0) {
          goto cant_bind;
        }
      }
      {
#line 4939
      freeaddrinfo(res6);
#line 4940
      set_cloexec_flag((int )listenfd6);
      }
    }
  }
#line 4943
  if (listenfd == -1) {
#line 4943
    if (listenfd6 == -1) {
      {
#line 4945
      tmp___13 = __errno_location();
#line 4945
      (*tmp___13) = 99;
      }
      goto cant_bind;
    }
  }
  {
#line 4949
  updatepidfile();
#line 4950
  setprocessname("pure-ftpd (SERVER)");
  }
  {
#line 4951
  while (1) {
    while_112_continue: /* CIL Label */ ;
#line 4951
    __asm__  volatile   ("cld; rep; stosl": "=c" (__d0), "=D" (__d1): "a" (0), "0" (sizeof(fd_set ) /
                                                                                    sizeof(__fd_mask )),
                         "1" (& rs.fds_bits[0]): "memory");
    goto while_112_break;
  }
  while_112_break: /* CIL Label */ ;
  }
#line 4952
  if (listenfd > listenfd6) {
#line 4953
    max_fd = (int )listenfd;
  } else {
#line 4955
    max_fd = (int )listenfd6;
  }
#line 4957
  max_fd ++;
  {
#line 4958
  while (1) {
    while_113_continue: /* CIL Label */ ;
#line 4958
    if (! (stop_server == 0)) {
      goto while_113_break;
    }
    {
#line 4959
    safe_fd_set((int )listenfd, & rs);
#line 4960
    safe_fd_set((int )listenfd6, & rs);
#line 4961
    tmp___15 = select(max_fd, (fd_set */* __restrict  */)(& rs), (fd_set */* __restrict  */)((void *)0),
                      (fd_set */* __restrict  */)((void *)0), (struct timeval */* __restrict  */)((void *)0));
    }
#line 4961
    if (tmp___15 <= 0) {
      {
#line 4962
      tmp___14 = __errno_location();
      }
#line 4962
      if ((*tmp___14) != 4) {
        {
#line 4963
        sleep(1U);
        }
      }
      goto while_113_continue;
    }
    {
#line 4967
    tmp___16 = safe_fd_isset((int )listenfd, (fd_set const   *)(& rs));
    }
#line 4967
    if (tmp___16) {
      {
#line 4968
      accept_client((int )listenfd);
      }
    }
    {
#line 4970
    tmp___17 = safe_fd_isset((int )listenfd6, (fd_set const   *)(& rs));
    }
#line 4970
    if (tmp___17) {
      {
#line 4971
      accept_client((int )listenfd6);
      }
    }
  }
  while_113_break: /* CIL Label */ ;
  }
#line 4974
  return;
}
}
#line 4993 "ftpd.c"
int main(int argc , char **argv ) 
{ int option_index ;
  int fodder ;
  int bypass_ipv6 ;
  struct passwd *pw ;
  char *struck ;
  char *tmp___31 ;
  char const   *nptr ;
  char *endptr ;
  char const   *nptr___0 ;
  char *endptr___0 ;
  char const   *nptr___1 ;
  char *endptr___1 ;
  int n ;
  int tmp___35 ;
  int tmp___36 ;
  Authentication const   *auth_list_pnt ;
  char const   *opt ;
  Authentications *new_auth ;
  size_t auth_name_len ;
  char *file ;
  char *tmp___46 ;
  int tmp___48 ;
  char const   *nptr___2 ;
  char *endptr___2 ;
  int ret ;
  int ret___0 ;
  char const   *nptr___3 ;
  char *endptr___3 ;
  unsigned long tmp___69 ;
  char const   *nptr___4 ;
  char *endptr___4 ;
  double tmp___70 ;
  char const   *nptr___5 ;
  char *endptr___5 ;
  long tmp___71 ;
  char *optarg_copy ;
  char *struck___0 ;
  char const   *tr_umask ;
  char const   *tr_umask_d ;
  char *tmp___81 ;
  char *tmp___83 ;
  __uid_t tmp___86 ;
  struct option  const  *options ;
  char const   *tmp___87 ;
  unsigned int portmax ;
  int tmp___89 ;
  Authentications *auth_scan ;
  Authentications *previous ;

  {
  {
#line 4996
  option_index = 0;
#line 4999
  bypass_ipv6 = 0;
#line 5007
  page_size = (size_t )getpagesize();
#line 5007
  map_size = page_size;
#line 5016
  dl_chunk_size = 262144U & ~ (map_size - 1U);
#line 5017
  ul_chunk_size = 87380U;
#line 5021
  setlocale(5, "en_GB");
#line 5024
  setlocale(0, "");
#line 5027
  setlocale(3, "");
#line 5031
  tzset();
#line 5034
  openlog("pure-ftpd", 8 | log_pid, 88);
#line 5038
  set_initial_caps();
#line 5040
  set_signals();
#line 5042
  loggedin = 0;
  }
  {
#line 5056
  while (1) {
    while_114_continue: /* CIL Label */ ;
    {
#line 5056
    fodder = getopt_long(argc, (char * const  *)argv, GETOPT_OPTIONS, (struct option  const  *)(long_options),
                         & option_index);
    }
#line 5056
    if (! (fodder != -1)) {
      goto while_114_break;
    }
#line 5064
    if (fodder == 115) {
      goto switch_115_115;
    } else {
#line 5071
      if (fodder == 48) {
        goto switch_115_48;
      } else {
#line 5075
        if (fodder == 52) {
          goto switch_115_52;
        } else {
#line 5079
          if (fodder == 54) {
            goto switch_115_54;
          } else {
#line 5083
            if (fodder == 49) {
              goto switch_115_49;
            } else {
#line 5101
              if (fodder == 83) {
                goto switch_115_83;
              } else {
#line 5124
                if (fodder == 68) {
                  goto switch_115_68;
                } else {
#line 5129
                  if (fodder == 97) {
                    goto switch_115_97;
                  } else {
#line 5195
                    if (fodder == 120) {
                      goto switch_115_120;
                    } else {
#line 5199
                      if (fodder == 88) {
                        goto switch_115_88;
                      } else {
#line 5203
                        if (fodder == 122) {
                          goto switch_115_122;
                        } else {
#line 5207
                          if (fodder == 90) {
                            goto switch_115_90;
                          } else {
#line 5211
                            if (fodder == 65) {
                              goto switch_115_65;
                            } else {
#line 5215
                              if (fodder == 119) {
                                goto switch_115_119;
                              } else {
#line 5219
                                if (fodder == 87) {
                                  goto switch_115_87;
                                } else {
#line 5223
                                  if (fodder == 100) {
                                    goto switch_115_100;
                                  } else {
#line 5229
                                    if (fodder == 98) {
                                      goto switch_115_98;
                                    } else {
#line 5233
                                      if (fodder == 99) {
                                        goto switch_115_99;
                                      } else {
#line 5245
                                        if (fodder == 66) {
                                          goto switch_115_66;
                                        } else {
#line 5250
                                          if (fodder == 67) {
                                            goto switch_115_67;
                                          } else {
#line 5262
                                            if (fodder == 101) {
                                              goto switch_115_101;
                                            } else {
#line 5287
                                              if (fodder == 69) {
                                                goto switch_115_69;
                                              } else {
#line 5291
                                                if (fodder == 102) {
                                                  goto switch_115_102;
                                                } else {
#line 5319
                                                  if (fodder == 108) {
                                                    goto switch_115_108;
                                                  } else {
#line 5366
                                                    if (fodder == 109) {
                                                      goto switch_115_109;
                                                    } else {
#line 5379
                                                      if (fodder == 77) {
                                                        goto switch_115_77;
                                                      } else {
#line 5383
                                                        if (fodder == 78) {
                                                          goto switch_115_78;
                                                        } else {
#line 5387
                                                          if (fodder == 112) {
                                                            goto switch_115_112;
                                                          } else {
#line 5445
                                                            if (fodder == 76) {
                                                              goto switch_115_76;
                                                            } else {
#line 5455
                                                              if (fodder == 80) {
                                                                goto switch_115_80;
                                                              } else {
#line 5474
                                                                if (fodder == 114) {
                                                                  goto switch_115_114;
                                                                } else {
#line 5494
                                                                  if (fodder == 82) {
                                                                    goto switch_115_82;
                                                                  } else {
#line 5498
                                                                    if (fodder ==
                                                                        75) {
                                                                      goto switch_115_75;
                                                                    } else {
#line 5502
                                                                      if (fodder ==
                                                                          103) {
                                                                        goto switch_115_103;
                                                                      } else {
#line 5509
                                                                        if (fodder ==
                                                                            71) {
                                                                          goto switch_115_71;
                                                                        } else {
#line 5514
                                                                          if (fodder ==
                                                                              72) {
                                                                            goto switch_115_72;
                                                                          } else {
#line 5518
                                                                            if (fodder ==
                                                                                73) {
                                                                              goto switch_115_73;
                                                                            } else {
#line 5530
                                                                              if (fodder ==
                                                                                  105) {
                                                                                goto switch_115_105;
                                                                              } else {
#line 5534
                                                                                if (fodder ==
                                                                                    106) {
                                                                                  goto switch_115_106;
                                                                                } else {
#line 5538
                                                                                  if (fodder ==
                                                                                      107) {
                                                                                    goto switch_115_107;
                                                                                  } else {
#line 5550
                                                                                    if (fodder ==
                                                                                        117) {
                                                                                      goto switch_115_117;
                                                                                    } else {
#line 5564
                                                                                      if (fodder ==
                                                                                          85) {
                                                                                        goto switch_115_85;
                                                                                      } else {
#line 5605
                                                                                        if (fodder ==
                                                                                            104) {
                                                                                          goto switch_115_104;
                                                                                        } else {
                                                                                          {
                                                                                          goto switch_115_default;
#line 5063
                                                                                          if (0) {
                                                                                            switch_115_115: /* CIL Label */ 
                                                                                            {
#line 5065
                                                                                            pw = getpwnam("ftp");
                                                                                            }
#line 5065
                                                                                            if (pw) {
#line 5066
                                                                                              warez = pw->pw_uid;
                                                                                            } else {
                                                                                              {
#line 5068
                                                                                              logfile(3,
                                                                                                      "Unable to find the \'ftp\' account");
                                                                                              }
                                                                                            }
                                                                                            goto switch_115_break;
                                                                                            switch_115_48: /* CIL Label */ 
#line 5073
                                                                                            no_truncate = 1;
                                                                                            goto switch_115_break;
                                                                                            switch_115_52: /* CIL Label */ 
#line 5077
                                                                                            bypass_ipv6 = 1;
                                                                                            goto switch_115_break;
                                                                                            switch_115_54: /* CIL Label */ 
#line 5081
                                                                                            no_ipv4 = 1;
                                                                                            goto switch_115_break;
                                                                                            switch_115_49: /* CIL Label */ 
#line 5099
                                                                                            log_pid = 1;
                                                                                            goto switch_115_break;
                                                                                            switch_115_83: /* CIL Label */ 
                                                                                            {
#line 5106
                                                                                            tmp___31 = strchr((char const   *)optarg,
                                                                                                              ',');
#line 5106
                                                                                            struck = tmp___31;
                                                                                            }
#line 5106
                                                                                            if ((unsigned int )struck !=
                                                                                                (unsigned int )((void *)0)) {
#line 5107
                                                                                              (*struck) = 0;
#line 5108
                                                                                              if ((int )(*optarg) !=
                                                                                                  0) {
                                                                                                {
#line 5109
                                                                                                standalone_ip = __strdup((char const   *)optarg);
                                                                                                }
#line 5109
                                                                                                if ((unsigned int )standalone_ip ==
                                                                                                    (unsigned int )((void *)0)) {
                                                                                                  {
#line 5110
                                                                                                  die_mem();
                                                                                                  }
                                                                                                }
                                                                                              }
#line 5113
                                                                                              if ((int )(*(struck +
                                                                                                           1)) !=
                                                                                                  0) {
                                                                                                {
#line 5114
                                                                                                standalone_port = __strdup((char const   *)(struck +
                                                                                                                                            1));
                                                                                                }
#line 5114
                                                                                                if ((unsigned int )standalone_port ==
                                                                                                    (unsigned int )((void *)0)) {
                                                                                                  {
#line 5115
                                                                                                  die_mem();
                                                                                                  }
                                                                                                }
                                                                                              }
                                                                                            } else {
                                                                                              {
#line 5119
                                                                                              standalone_port = __strdup((char const   *)optarg);
                                                                                              }
#line 5119
                                                                                              if ((unsigned int )standalone_port ==
                                                                                                  (unsigned int )((void *)0)) {
                                                                                                {
#line 5120
                                                                                                die_mem();
                                                                                                }
                                                                                              }
                                                                                            }
                                                                                            goto switch_115_break;
                                                                                            switch_115_68: /* CIL Label */ 
#line 5127
                                                                                            force_ls_a = 1;
                                                                                            goto switch_115_break;
                                                                                            switch_115_97: /* CIL Label */ 
                                                                                            {
#line 5187
                                                                                            nptr = (char const   *)optarg;
#line 5188
                                                                                            endptr = (char *)((void *)0);
#line 5189
                                                                                            chroot_trustedgid = (uid_t )strtoul((char const   */* __restrict  */)nptr,
                                                                                                                                (char **/* __restrict  */)(& endptr),
                                                                                                                                0);
                                                                                            }
#line 5190
                                                                                            if (! nptr) {
                                                                                              {
#line 5191
                                                                                              die(421,
                                                                                                  3,
                                                                                                  "Configuration error: Illegal trusted gid for chroot: %s",
                                                                                                  optarg);
                                                                                              }
                                                                                            } else {
#line 5190
                                                                                              if (! (*nptr)) {
                                                                                                {
#line 5191
                                                                                                die(421,
                                                                                                    3,
                                                                                                    "Configuration error: Illegal trusted gid for chroot: %s",
                                                                                                    optarg);
                                                                                                }
                                                                                              } else {
#line 5190
                                                                                                if (! endptr) {
                                                                                                  {
#line 5191
                                                                                                  die(421,
                                                                                                      3,
                                                                                                      "Configuration error: Illegal trusted gid for chroot: %s",
                                                                                                      optarg);
                                                                                                  }
                                                                                                } else {
#line 5190
                                                                                                  if ((*endptr)) {
                                                                                                    {
#line 5191
                                                                                                    die(421,
                                                                                                        3,
                                                                                                        "Configuration error: Illegal trusted gid for chroot: %s",
                                                                                                        optarg);
                                                                                                    }
                                                                                                  }
                                                                                                }
                                                                                              }
                                                                                            }
#line 5193
                                                                                            userchroot = 1;
                                                                                            goto switch_115_break;
                                                                                            switch_115_120: /* CIL Label */ 
#line 5197
                                                                                            dot_write_ok = 0;
                                                                                            goto switch_115_break;
                                                                                            switch_115_88: /* CIL Label */ 
#line 5201
                                                                                            dot_read_ok = 0;
#line 5201
                                                                                            dot_write_ok = dot_read_ok;
                                                                                            goto switch_115_break;
                                                                                            switch_115_122: /* CIL Label */ 
#line 5205
                                                                                            dot_read_anon_ok = 1;
                                                                                            goto switch_115_break;
                                                                                            switch_115_90: /* CIL Label */ 
#line 5209
                                                                                            be_customer_proof = 1;
                                                                                            goto switch_115_break;
                                                                                            switch_115_65: /* CIL Label */ 
#line 5213
                                                                                            userchroot = 2;
                                                                                            goto switch_115_break;
                                                                                            switch_115_119: /* CIL Label */ 
#line 5217
                                                                                            allowfxp = 1;
                                                                                            goto switch_115_break;
                                                                                            switch_115_87: /* CIL Label */ 
#line 5221
                                                                                            allowfxp = 2;
                                                                                            goto switch_115_break;
                                                                                            switch_115_100: /* CIL Label */ ;
#line 5225
                                                                                            if ((int volatile   )logging <
                                                                                                2) {
#line 5226
                                                                                              logging = (signed char volatile   )((int volatile   )logging +
                                                                                                                                  1);
                                                                                            }
                                                                                            goto switch_115_break;
                                                                                            switch_115_98: /* CIL Label */ 
#line 5231
                                                                                            broken_client_compat = 1;
                                                                                            goto switch_115_break;
                                                                                            switch_115_99: /* CIL Label */ 
                                                                                            {
#line 5238
                                                                                            nptr___0 = (char const   *)optarg;
#line 5239
                                                                                            endptr___0 = (char *)((void *)0);
#line 5240
                                                                                            maxusers = (unsigned int )strtoul((char const   */* __restrict  */)nptr___0,
                                                                                                                              (char **/* __restrict  */)(& endptr___0),
                                                                                                                              0);
                                                                                            }
#line 5241
                                                                                            if (! nptr___0) {
                                                                                              {
#line 5242
                                                                                              die(421,
                                                                                                  3,
                                                                                                  "Configuration error: Illegal user limit: %s",
                                                                                                  optarg);
                                                                                              }
                                                                                            } else {
#line 5241
                                                                                              if (! (*nptr___0)) {
                                                                                                {
#line 5242
                                                                                                die(421,
                                                                                                    3,
                                                                                                    "Configuration error: Illegal user limit: %s",
                                                                                                    optarg);
                                                                                                }
                                                                                              } else {
#line 5241
                                                                                                if (! endptr___0) {
                                                                                                  {
#line 5242
                                                                                                  die(421,
                                                                                                      3,
                                                                                                      "Configuration error: Illegal user limit: %s",
                                                                                                      optarg);
                                                                                                  }
                                                                                                } else {
#line 5241
                                                                                                  if ((*endptr___0)) {
                                                                                                    {
#line 5242
                                                                                                    die(421,
                                                                                                        3,
                                                                                                        "Configuration error: Illegal user limit: %s",
                                                                                                        optarg);
                                                                                                    }
                                                                                                  } else {
#line 5241
                                                                                                    if (! maxusers) {
                                                                                                      {
#line 5242
                                                                                                      die(421,
                                                                                                          3,
                                                                                                          "Configuration error: Illegal user limit: %s",
                                                                                                          optarg);
                                                                                                      }
                                                                                                    }
                                                                                                  }
                                                                                                }
                                                                                              }
                                                                                            }
                                                                                            goto switch_115_break;
                                                                                            switch_115_66: /* CIL Label */ 
#line 5248
                                                                                            daemonize = 1;
                                                                                            goto switch_115_break;
                                                                                            switch_115_67: /* CIL Label */ 
                                                                                            {
#line 5255
                                                                                            nptr___1 = (char const   *)optarg;
#line 5256
                                                                                            endptr___1 = (char *)((void *)0);
#line 5257
                                                                                            maxip = (unsigned int )strtoul((char const   */* __restrict  */)nptr___1,
                                                                                                                           (char **/* __restrict  */)(& endptr___1),
                                                                                                                           0);
                                                                                            }
#line 5258
                                                                                            if (! nptr___1) {
                                                                                              {
#line 5259
                                                                                              die(421,
                                                                                                  3,
                                                                                                  "Configuration error: Illegal user limit: %s",
                                                                                                  optarg);
                                                                                              }
                                                                                            } else {
#line 5258
                                                                                              if (! (*nptr___1)) {
                                                                                                {
#line 5259
                                                                                                die(421,
                                                                                                    3,
                                                                                                    "Configuration error: Illegal user limit: %s",
                                                                                                    optarg);
                                                                                                }
                                                                                              } else {
#line 5258
                                                                                                if (! endptr___1) {
                                                                                                  {
#line 5259
                                                                                                  die(421,
                                                                                                      3,
                                                                                                      "Configuration error: Illegal user limit: %s",
                                                                                                      optarg);
                                                                                                  }
                                                                                                } else {
#line 5258
                                                                                                  if ((*endptr___1)) {
                                                                                                    {
#line 5259
                                                                                                    die(421,
                                                                                                        3,
                                                                                                        "Configuration error: Illegal user limit: %s",
                                                                                                        optarg);
                                                                                                    }
                                                                                                  } else {
#line 5258
                                                                                                    if (! maxip) {
                                                                                                      {
#line 5259
                                                                                                      die(421,
                                                                                                          3,
                                                                                                          "Configuration error: Illegal user limit: %s",
                                                                                                          optarg);
                                                                                                      }
                                                                                                    }
                                                                                                  }
                                                                                                }
                                                                                              }
                                                                                            }
                                                                                            goto switch_115_break;
                                                                                            switch_115_101: /* CIL Label */ 
#line 5285
                                                                                            anon_only = 1;
                                                                                            goto switch_115_break;
                                                                                            switch_115_69: /* CIL Label */ 
#line 5289
                                                                                            anon_only = -1;
                                                                                            goto switch_115_break;
                                                                                            switch_115_102: /* CIL Label */ 
                                                                                            {
#line 5302
                                                                                            n = 0;
#line 5304
                                                                                            tmp___35 = strcasecmp((char const   *)optarg,
                                                                                                                  "none");
                                                                                            }
#line 5304
                                                                                            if (tmp___35 ==
                                                                                                0) {
#line 5305
                                                                                              no_syslog = 1;
                                                                                              goto switch_115_break;
                                                                                            }
                                                                                            {
#line 5308
                                                                                            while (1) {
                                                                                              while_116_continue: /* CIL Label */ ;
#line 5308
                                                                                              if (facilitynames[n].c_name) {
                                                                                                {
#line 5308
                                                                                                tmp___36 = strcasecmp((char const   *)facilitynames[n].c_name,
                                                                                                                      (char const   *)optarg);
                                                                                                }
#line 5308
                                                                                                if (! (tmp___36 !=
                                                                                                       0)) {
                                                                                                  goto while_116_break;
                                                                                                }
                                                                                              } else {
                                                                                                goto while_116_break;
                                                                                              }
#line 5310
                                                                                              n ++;
                                                                                            }
                                                                                            while_116_break: /* CIL Label */ ;
                                                                                            }
#line 5312
                                                                                            if (facilitynames[n].c_name) {
#line 5313
                                                                                              syslog_facility = facilitynames[n].c_val;
                                                                                            } else {
                                                                                              {
#line 5315
                                                                                              logfile(3,
                                                                                                      "Configuration error: Unknown facility name: %s",
                                                                                                      optarg);
                                                                                              }
                                                                                            }
                                                                                            goto switch_115_break;
                                                                                            switch_115_108: /* CIL Label */ 
#line 5321
                                                                                            auth_list_pnt = (Authentication const   *)(auth_list);
#line 5322
                                                                                            opt = (char const   *)optarg;
                                                                                            {
#line 5326
                                                                                            while (1) {
                                                                                              while_117_continue: /* CIL Label */ ;
                                                                                              {
#line 5327
                                                                                              auth_name_len = strlen(auth_list_pnt->name);
#line 5328
                                                                                              tmp___48 = strncasecmp(opt,
                                                                                                                     auth_list_pnt->name,
                                                                                                                     auth_name_len);
                                                                                              }
#line 5328
                                                                                              if (tmp___48 ==
                                                                                                  0) {
#line 5330
                                                                                                file = (char *)((void *)0);
#line 5332
                                                                                                opt += auth_name_len;
#line 5333
                                                                                                if ((int const   )(*opt) ==
                                                                                                    58) {
#line 5334
                                                                                                  opt ++;
#line 5335
                                                                                                  if ((int const   )(*opt) !=
                                                                                                      0) {
                                                                                                    {
#line 5336
                                                                                                    tmp___46 = __strdup(opt);
#line 5336
                                                                                                    file = tmp___46;
                                                                                                    }
#line 5336
                                                                                                    if ((unsigned int )file ==
                                                                                                        (unsigned int )((void *)0)) {
                                                                                                      {
#line 5337
                                                                                                      die_mem();
                                                                                                      }
                                                                                                    }
                                                                                                  }
                                                                                                }
#line 5341
                                                                                                if ((unsigned int )auth_list_pnt->parse !=
                                                                                                    (unsigned int )((void *)0)) {
                                                                                                  {
#line 5342
                                                                                                  ((*(auth_list_pnt->parse)))((char const   *)file);
                                                                                                  }
                                                                                                }
                                                                                                {
#line 5344
                                                                                                new_auth = (Authentications *)malloc(sizeof((*new_auth)));
                                                                                                }
#line 5344
                                                                                                if ((unsigned int )new_auth ==
                                                                                                    (unsigned int )((void *)0)) {
                                                                                                  {
#line 5345
                                                                                                  die_mem();
                                                                                                  }
                                                                                                }
#line 5347
                                                                                                new_auth->auth = auth_list_pnt;
#line 5348
                                                                                                new_auth->conf_file = file;
#line 5349
                                                                                                new_auth->next = (struct Authentications_ *)((void *)0);
#line 5350
                                                                                                if ((unsigned int )last_authentications ==
                                                                                                    (unsigned int )((void *)0)) {
#line 5351
                                                                                                  first_authentications = new_auth;
                                                                                                } else {
#line 5353
                                                                                                  last_authentications->next = new_auth;
                                                                                                }
#line 5355
                                                                                                last_authentications = new_auth;
                                                                                                goto while_117_break;
                                                                                              }
#line 5359
                                                                                              auth_list_pnt ++;
#line 5360
                                                                                              if ((unsigned int )auth_list_pnt->name ==
                                                                                                  (unsigned int )((void *)0)) {
                                                                                                {
#line 5361
                                                                                                die(421,
                                                                                                    3,
                                                                                                    "Unknown authentication method: %s",
                                                                                                    opt);
                                                                                                }
                                                                                              }
                                                                                            }
                                                                                            while_117_break: /* CIL Label */ ;
                                                                                            }
                                                                                            goto switch_115_break;
                                                                                            switch_115_109: /* CIL Label */ 
                                                                                            {
#line 5371
                                                                                            nptr___2 = (char const   *)optarg;
#line 5372
                                                                                            endptr___2 = (char *)((void *)0);
#line 5373
                                                                                            maxload = strtod((char const   */* __restrict  */)nptr___2,
                                                                                                             (char **/* __restrict  */)(& endptr___2));
                                                                                            }
#line 5374
                                                                                            if (! nptr___2) {
                                                                                              {
#line 5375
                                                                                              die(421,
                                                                                                  3,
                                                                                                  "Configuration error: Illegal load limit: %s",
                                                                                                  optarg);
                                                                                              }
                                                                                            } else {
#line 5374
                                                                                              if (! (*nptr___2)) {
                                                                                                {
#line 5375
                                                                                                die(421,
                                                                                                    3,
                                                                                                    "Configuration error: Illegal load limit: %s",
                                                                                                    optarg);
                                                                                                }
                                                                                              } else {
#line 5374
                                                                                                if (! endptr___2) {
                                                                                                  {
#line 5375
                                                                                                  die(421,
                                                                                                      3,
                                                                                                      "Configuration error: Illegal load limit: %s",
                                                                                                      optarg);
                                                                                                  }
                                                                                                } else {
#line 5374
                                                                                                  if ((*endptr___2)) {
                                                                                                    {
#line 5375
                                                                                                    die(421,
                                                                                                        3,
                                                                                                        "Configuration error: Illegal load limit: %s",
                                                                                                        optarg);
                                                                                                    }
                                                                                                  } else {
#line 5374
                                                                                                    if (maxload <=
                                                                                                        0.0) {
                                                                                                      {
#line 5375
                                                                                                      die(421,
                                                                                                          3,
                                                                                                          "Configuration error: Illegal load limit: %s",
                                                                                                          optarg);
                                                                                                      }
                                                                                                    }
                                                                                                  }
                                                                                                }
                                                                                              }
                                                                                            }
                                                                                            goto switch_115_break;
                                                                                            switch_115_77: /* CIL Label */ 
#line 5381
                                                                                            allow_anon_mkdir = 1;
                                                                                            goto switch_115_break;
                                                                                            switch_115_78: /* CIL Label */ 
#line 5385
                                                                                            disallow_passive = 1;
                                                                                            goto switch_115_break;
                                                                                            switch_115_112: /* CIL Label */ 
                                                                                            {
#line 5438
                                                                                            ret = sscanf((char const   */* __restrict  */)optarg,
                                                                                                         (char const   */* __restrict  */)"%u:%u",
                                                                                                         & firstport,
                                                                                                         & lastport);
                                                                                            }
#line 5439
                                                                                            if (ret !=
                                                                                                2) {
                                                                                              {
#line 5442
                                                                                              die(421,
                                                                                                  3,
                                                                                                  "Configuration error: Illegal ports range: %s",
                                                                                                  optarg);
                                                                                              }
                                                                                            } else {
#line 5439
                                                                                              if (firstport <
                                                                                                  1024U) {
                                                                                                {
#line 5442
                                                                                                die(421,
                                                                                                    3,
                                                                                                    "Configuration error: Illegal ports range: %s",
                                                                                                    optarg);
                                                                                                }
                                                                                              } else {
#line 5439
                                                                                                if (lastport >
                                                                                                    65535U) {
                                                                                                  {
#line 5442
                                                                                                  die(421,
                                                                                                      3,
                                                                                                      "Configuration error: Illegal ports range: %s",
                                                                                                      optarg);
                                                                                                  }
                                                                                                } else {
#line 5439
                                                                                                  if (lastport <
                                                                                                      firstport) {
                                                                                                    {
#line 5442
                                                                                                    die(421,
                                                                                                        3,
                                                                                                        "Configuration error: Illegal ports range: %s",
                                                                                                        optarg);
                                                                                                    }
                                                                                                  }
                                                                                                }
                                                                                              }
                                                                                            }
                                                                                            goto switch_115_break;
                                                                                            switch_115_76: /* CIL Label */ 
                                                                                            {
#line 5449
                                                                                            ret___0 = sscanf((char const   */* __restrict  */)optarg,
                                                                                                             (char const   */* __restrict  */)"%u:%u",
                                                                                                             & max_ls_files,
                                                                                                             & max_ls_depth);
                                                                                            }
#line 5450
                                                                                            if (ret___0 !=
                                                                                                2) {
                                                                                              {
#line 5452
                                                                                              die(421,
                                                                                                  3,
                                                                                                  "Configuration error: Illegal \'ls\' limits: %s",
                                                                                                  optarg);
                                                                                              }
                                                                                            } else {
#line 5450
                                                                                              if (max_ls_files <
                                                                                                  1U) {
                                                                                                {
#line 5452
                                                                                                die(421,
                                                                                                    3,
                                                                                                    "Configuration error: Illegal \'ls\' limits: %s",
                                                                                                    optarg);
                                                                                                }
                                                                                              } else {
#line 5450
                                                                                                if (max_ls_depth <
                                                                                                    1U) {
                                                                                                  {
#line 5452
                                                                                                  die(421,
                                                                                                      3,
                                                                                                      "Configuration error: Illegal \'ls\' limits: %s",
                                                                                                      optarg);
                                                                                                  }
                                                                                                }
                                                                                              }
                                                                                            }
                                                                                            goto switch_115_break;
                                                                                            switch_115_80: /* CIL Label */ 
                                                                                            {
#line 5470
                                                                                            force_passive_ip_s = __strdup((char const   *)optarg);
                                                                                            }
#line 5470
                                                                                            if ((unsigned int )force_passive_ip_s ==
                                                                                                (unsigned int )((void *)0)) {
                                                                                              {
#line 5471
                                                                                              die_mem();
                                                                                              }
                                                                                            }
                                                                                            goto switch_115_break;
                                                                                            switch_115_114: /* CIL Label */ 
#line 5492
                                                                                            autorename = 1;
                                                                                            goto switch_115_break;
                                                                                            switch_115_82: /* CIL Label */ 
#line 5496
                                                                                            nochmod = 1;
                                                                                            goto switch_115_break;
                                                                                            switch_115_75: /* CIL Label */ 
#line 5500
                                                                                            keepallfiles = 1;
                                                                                            goto switch_115_break;
                                                                                            switch_115_103: /* CIL Label */ 
                                                                                            {
#line 5505
                                                                                            pid_file = __strdup((char const   *)optarg);
                                                                                            }
#line 5505
                                                                                            if ((unsigned int )pid_file ==
                                                                                                (unsigned int )((void *)0)) {
                                                                                              {
#line 5506
                                                                                              die_mem();
                                                                                              }
                                                                                            }
                                                                                            goto switch_115_break;
                                                                                            switch_115_71: /* CIL Label */ 
#line 5512
                                                                                            disallow_rename = 1;
                                                                                            goto switch_115_break;
                                                                                            switch_115_72: /* CIL Label */ 
#line 5516
                                                                                            resolve_hostnames = 0;
                                                                                            goto switch_115_break;
                                                                                            switch_115_73: /* CIL Label */ 
                                                                                            {
#line 5523
                                                                                            nptr___3 = (char const   *)optarg;
#line 5524
                                                                                            endptr___3 = (char *)((void *)0);
#line 5525
                                                                                            tmp___69 = strtoul((char const   */* __restrict  */)nptr___3,
                                                                                                               (char **/* __restrict  */)(& endptr___3),
                                                                                                               0);
#line 5525
                                                                                            idletime = tmp___69 *
                                                                                                       60UL;
                                                                                            }
#line 5526
                                                                                            if (idletime <=
                                                                                                0UL) {
#line 5527
                                                                                              idletime = 900UL;
                                                                                            }
                                                                                            goto switch_115_break;
                                                                                            switch_115_105: /* CIL Label */ 
#line 5532
                                                                                            anon_noupload = 1;
                                                                                            goto switch_115_break;
                                                                                            switch_115_106: /* CIL Label */ 
#line 5536
                                                                                            create_home = 1;
                                                                                            goto switch_115_break;
                                                                                            switch_115_107: /* CIL Label */ 
                                                                                            {
#line 5543
                                                                                            nptr___4 = (char const   *)optarg;
#line 5544
                                                                                            endptr___4 = (char *)((void *)0);
#line 5545
                                                                                            tmp___70 = strtod((char const   */* __restrict  */)nptr___4,
                                                                                                              (char **/* __restrict  */)(& endptr___4));
#line 5545
                                                                                            maxdiskusagepct = 1.0 -
                                                                                                              tmp___70 /
                                                                                                              100.0;
                                                                                            }
#line 5546
                                                                                            if (maxdiskusagepct >=
                                                                                                1.0) {
#line 5547
                                                                                              maxdiskusagepct = 0.0;
                                                                                            } else {
#line 5546
                                                                                              if (maxdiskusagepct <
                                                                                                  0.0) {
#line 5547
                                                                                                maxdiskusagepct = 0.0;
                                                                                              }
                                                                                            }
                                                                                            goto switch_115_break;
                                                                                            switch_115_117: /* CIL Label */ 
                                                                                            {
#line 5556
                                                                                            nptr___5 = (char const   *)optarg;
#line 5557
                                                                                            endptr___5 = (char *)((void *)0);
#line 5558
                                                                                            tmp___71 = strtol((char const   */* __restrict  */)nptr___5,
                                                                                                              (char **/* __restrict  */)(& endptr___5),
                                                                                                              10);
                                                                                            }
#line 5559
                                                                                            if (! nptr___5) {
                                                                                              {
#line 5560
                                                                                              die(421,
                                                                                                  3,
                                                                                                  "Configuration error: Illegal uid limit: %s",
                                                                                                  optarg);
                                                                                              }
                                                                                            } else {
#line 5559
                                                                                              if (! (*nptr___5)) {
                                                                                                {
#line 5560
                                                                                                die(421,
                                                                                                    3,
                                                                                                    "Configuration error: Illegal uid limit: %s",
                                                                                                    optarg);
                                                                                                }
                                                                                              } else {
#line 5559
                                                                                                if (! endptr___5) {
                                                                                                  {
#line 5560
                                                                                                  die(421,
                                                                                                      3,
                                                                                                      "Configuration error: Illegal uid limit: %s",
                                                                                                      optarg);
                                                                                                  }
                                                                                                } else {
#line 5559
                                                                                                  if ((*endptr___5)) {
                                                                                                    {
#line 5560
                                                                                                    die(421,
                                                                                                        3,
                                                                                                        "Configuration error: Illegal uid limit: %s",
                                                                                                        optarg);
                                                                                                    }
                                                                                                  } else {
#line 5559
                                                                                                    if (tmp___71 <
                                                                                                        0L) {
                                                                                                      {
#line 5560
                                                                                                      die(421,
                                                                                                          3,
                                                                                                          "Configuration error: Illegal uid limit: %s",
                                                                                                          optarg);
                                                                                                      }
                                                                                                    }
                                                                                                  }
                                                                                                }
                                                                                              }
                                                                                            }
#line 5562
                                                                                            useruid = (unsigned int )tmp___71;
                                                                                            goto switch_115_break;
                                                                                            switch_115_85: /* CIL Label */ 
                                                                                            {
#line 5568
                                                                                            tr_umask = (char const   *)((void *)0);
#line 5569
                                                                                            tr_umask_d = (char const   *)((void *)0);
#line 5571
                                                                                            tmp___81 = __strdup((char const   *)optarg);
#line 5571
                                                                                            optarg_copy = tmp___81;
                                                                                            }
#line 5571
                                                                                            if ((unsigned int )optarg_copy ==
                                                                                                (unsigned int )((void *)0)) {
                                                                                              {
#line 5572
                                                                                              die_mem();
                                                                                              }
                                                                                            }
                                                                                            {
#line 5574
                                                                                            tmp___83 = strchr((char const   *)optarg_copy,
                                                                                                              ':');
#line 5574
                                                                                            struck___0 = tmp___83;
                                                                                            }
#line 5574
                                                                                            if ((unsigned int )struck___0 !=
                                                                                                (unsigned int )((void *)0)) {
#line 5575
                                                                                              (*struck___0) = 0;
#line 5576
                                                                                              if ((int )(*optarg_copy) !=
                                                                                                  0) {
#line 5577
                                                                                                tr_umask = (char const   *)optarg_copy;
                                                                                              }
#line 5579
                                                                                              if ((int )(*(struck___0 +
                                                                                                           1)) !=
                                                                                                  0) {
#line 5580
                                                                                                tr_umask_d = (char const   *)(struck___0 +
                                                                                                                              1);
                                                                                              }
                                                                                            } else {
#line 5583
                                                                                              tr_umask_d = (char const   *)optarg_copy;
#line 5583
                                                                                              tr_umask = tr_umask_d;
                                                                                            }
#line 5585
                                                                                            if ((unsigned int )tr_umask ==
                                                                                                (unsigned int )((void *)0)) {
                                                                                              goto _L___0;
                                                                                            } else {
#line 5585
                                                                                              if ((int const   )(*tr_umask) ==
                                                                                                  0) {
                                                                                                _L___0: 
#line 5585
                                                                                                if ((unsigned int )tr_umask_d ==
                                                                                                    (unsigned int )((void *)0)) {
                                                                                                  goto bad_umask;
                                                                                                } else {
#line 5585
                                                                                                  if ((int const   )(*tr_umask_d) ==
                                                                                                      0) {
                                                                                                    bad_umask: 
                                                                                                    {
#line 5588
                                                                                                    die(421,
                                                                                                        3,
                                                                                                        "Configuration error: Invalid umask: %s",
                                                                                                        optarg_copy);
                                                                                                    }
                                                                                                  }
                                                                                                }
                                                                                              }
                                                                                            }
#line 5591
                                                                                            if ((unsigned int )tr_umask !=
                                                                                                (unsigned int )((void *)0)) {
                                                                                              {
#line 5592
                                                                                              u_mask = (mode_t )strtoul((char const   */* __restrict  */)tr_umask,
                                                                                                                        (char **/* __restrict  */)((void *)0),
                                                                                                                        8);
                                                                                              }
#line 5592
                                                                                              if (u_mask >
                                                                                                  511U) {
                                                                                                goto bad_umask;
                                                                                              }
                                                                                            }
#line 5597
                                                                                            if ((unsigned int )tr_umask_d !=
                                                                                                (unsigned int )((void *)0)) {
                                                                                              {
#line 5598
                                                                                              u_mask_d = (mode_t )strtoul((char const   */* __restrict  */)tr_umask_d,
                                                                                                                          (char **/* __restrict  */)((void *)0),
                                                                                                                          8);
                                                                                              }
#line 5598
                                                                                              if (u_mask_d >
                                                                                                  511U) {
                                                                                                goto bad_umask;
                                                                                              }
                                                                                            }
                                                                                            {
#line 5603
                                                                                            free((void *)optarg_copy);
                                                                                            }
                                                                                            goto switch_115_break;
                                                                                            switch_115_104: /* CIL Label */ 
                                                                                            {
#line 5631
                                                                                            tmp___86 = geteuid();
                                                                                            }
#line 5631
                                                                                            if (tmp___86 ==
                                                                                                0U) {
                                                                                              {
#line 5634
                                                                                              puts("pure-ftpd v1.0.21\n");
                                                                                              }
                                                                                            }
#line 5638
                                                                                            options = (struct option  const  *)(long_options);
                                                                                            {
#line 5640
                                                                                            while (1) {
                                                                                              while_118_continue: /* CIL Label */ ;
#line 5641
                                                                                              if (options->has_arg) {
#line 5641
                                                                                                tmp___87 = "<opt>";
                                                                                              } else {
#line 5641
                                                                                                tmp___87 = "";
                                                                                              }
                                                                                              {
#line 5641
                                                                                              printf((char const   */* __restrict  */)"-%c\t--%s\t%s\n",
                                                                                                     options->val,
                                                                                                     options->name,
                                                                                                     tmp___87);
#line 5643
                                                                                              options ++;
                                                                                              }
#line 5640
                                                                                              if (! ((unsigned int )options->name !=
                                                                                                     (unsigned int )((void *)0))) {
                                                                                                goto while_118_break;
                                                                                              }
                                                                                            }
                                                                                            while_118_break: /* CIL Label */ ;
                                                                                            }
                                                                                            {
#line 5647
                                                                                            exit(0);
                                                                                            }
                                                                                            switch_115_default: /* CIL Label */ 
                                                                                            {
#line 5650
                                                                                            logfile(4,
                                                                                                    "Unknown run-time option");
                                                                                            }
                                                                                          } else {
                                                                                            switch_115_break: /* CIL Label */ ;
                                                                                          }
                                                                                          }
                                                                                        }
                                                                                      }
                                                                                    }
                                                                                  }
                                                                                }
                                                                              }
                                                                            }
                                                                          }
                                                                        }
                                                                      }
                                                                    }
                                                                  }
                                                                }
                                                              }
                                                            }
                                                          }
                                                        }
                                                      }
                                                    }
                                                  }
                                                }
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  while_114_break: /* CIL Label */ ;
  }
#line 5690
  if ((unsigned int )first_authentications == (unsigned int )((void *)0)) {
    {
#line 5691
    first_authentications = (Authentications *)malloc(sizeof((*first_authentications)));
    }
#line 5691
    if ((unsigned int )first_authentications == (unsigned int )((void *)0)) {
      {
#line 5693
      die_mem();
      }
    }
#line 5695
    first_authentications->auth = (Authentication const   *)(auth_list);
#line 5696
    first_authentications->conf_file = (char *)((void *)0);
#line 5697
    first_authentications->next = (struct Authentications_ *)((void *)0);
  }
  {
#line 5700
  dodaemonize();
  }
#line 5703
  if ((int )no_syslog == 0) {
#line 5703
    if (log_pid) {
      {
#line 5704
      closelog();
#line 5705
      openlog("pure-ftpd", 8 | log_pid, syslog_facility);
      }
    } else {
#line 5703
      if (syslog_facility != 88) {
        {
#line 5704
        closelog();
#line 5705
        openlog("pure-ftpd", 8 | log_pid, syslog_facility);
        }
      }
    }
  }
  {
#line 5708
  umask(0U);
#line 5709
  clearargs(argc, argv);
#line 5710
  idletime_noop = (double )idletime * 2.0;
  }
#line 5711
  if (firstport) {
#line 5714
    portmax = ((lastport - firstport) + 1U) / 2U;
#line 5715
    if (! maxusers) {
#line 5716
      maxusers = portmax;
    } else {
#line 5715
      if (maxusers > portmax) {
#line 5716
        maxusers = portmax;
      }
    }
  }
#line 5719
  if (bypass_ipv6 == 0) {
    {
#line 5720
    check_ipv6_support();
    }
  }
  {
#line 5738
  tmp___89 = check_standalone();
  }
#line 5738
  if (tmp___89 != 0) {
    {
#line 5739
    standalone_server();
    }
  } else {
    {
#line 5741
    doit();
    }
  }
#line 5755
  auth_scan = first_authentications;
  {
#line 5758
  while (1) {
    while_119_continue: /* CIL Label */ ;
#line 5758
    if (! ((unsigned int )auth_scan != (unsigned int )((void *)0))) {
      goto while_119_break;
    }
#line 5759
    if ((unsigned int )(auth_scan->auth)->exit != (unsigned int )((void *)0)) {
      {
#line 5760
      ((*((auth_scan->auth)->exit)))();
      }
    }
    {
#line 5762
    free((void *)auth_scan->conf_file);
#line 5763
    previous = auth_scan;
#line 5764
    auth_scan = auth_scan->next;
#line 5765
    free((void *)previous);
    }
  }
  while_119_break: /* CIL Label */ ;
  }
  {
#line 5768
  free((void *)trustedip);
#line 5784
  iptrack_free();
#line 5785
  unlink(pid_file);
#line 5787
  closelog();
  }
#line 5795
  return (0);
}
}
#line 1 "cil-omrDJSg1.o"
/* #pragma merger(0,"/tmp/cil-qco1C8v9.i","") */
#line 1 "src/pure_ftpd-log_unix.o_saved.c"
/* #pragma merger(112422803,"./log_unix.i","-g,-O2") */
#line 829 "/usr/include/unistd.h"
extern char *getusershell(void) ;
#line 830
extern void endusershell(void) ;
#line 831
extern void setusershell(void) ;
#line 1001
extern char *crypt(char const   *__key , char const   *__salt ) ;
#line 87 "/usr/include/shadow.h"
extern struct spwd *getspnam(char const   *__name ) ;
#line 10 "log_unix.c"
void pw_unix_check(AuthResult *result , char const   *account___0 , char const   *password ,
                   struct sockaddr_storage  const  *sa , struct sockaddr_storage  const  *peer___0 ) 
{ char const   *cpwd ;
  struct passwd pw ;
  struct passwd *pw_ ;
  struct spwd *spw ;
  char *dir ;
  char const   *shell ;
  size_t __s1_len ;
  size_t __s2_len ;
  int tmp___4 ;
  size_t tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  char *tmp___18 ;
  long today ;
  time_t tmp___19 ;
  size_t __s1_len___0 ;
  size_t __s2_len___0 ;
  int tmp___24 ;
  size_t tmp___25 ;
  int tmp___26 ;
  int tmp___27 ;
  register char const   *crypted ;
  size_t __s1_len___1 ;
  size_t __s2_len___1 ;
  int tmp___33 ;
  size_t tmp___34 ;
  int tmp___35 ;
  int tmp___36 ;

  {
  {
#line 15
  cpwd = (char const   *)((void *)0);
#line 20
  dir = (char *)((void *)0);
#line 24
  result->auth_ok = 0;
#line 25
  pw_ = getpwnam(account___0);
  }
#line 25
  if ((unsigned int )pw_ == (unsigned int )((void *)0)) {
#line 26
    return;
  }
#line 28
  pw = (*pw_);
#line 29
  result->auth_ok --;
#line 31
  if ((unsigned int )pw.pw_shell == (unsigned int )((void *)0)) {
#line 32
    return;
  }
  {
#line 34
  tmp___8 = strcasecmp((char const   *)pw.pw_shell, "ftp");
  }
#line 34
  if (tmp___8 != 0) {
    {
#line 37
    setusershell();
    }
    {
#line 39
    while (1) {
      while_120_continue: /* CIL Label */ ;
      {
#line 38
      shell = getusershell();
      }
#line 39
      if ((unsigned int )shell != (unsigned int )((void *)0)) {
#line 39
        if (0) {
          {
#line 39
          __s1_len = strlen((char const   *)pw.pw_shell);
#line 39
          __s2_len = strlen(shell);
          }
#line 39
          if (! ((unsigned int )((void const   *)(pw.pw_shell + 1)) - (unsigned int )((void const   *)pw.pw_shell) ==
                 1U)) {
            goto _L___0;
          } else {
#line 39
            if (__s1_len >= 4U) {
              _L___0: 
#line 39
              if (! ((unsigned int )((void const   *)(shell + 1)) - (unsigned int )((void const   *)shell) ==
                     1U)) {
#line 39
                tmp___7 = 1;
              } else {
#line 39
                if (__s2_len >= 4U) {
#line 39
                  tmp___7 = 1;
                } else {
#line 39
                  tmp___7 = 0;
                }
              }
            } else {
#line 39
              tmp___7 = 0;
            }
          }
#line 39
          if (tmp___7) {
#line 39
            if (__s1_len < __s2_len) {
#line 39
              tmp___5 = __s1_len;
            } else {
#line 39
              tmp___5 = __s2_len;
            }
            {
#line 39
            tmp___4 = memcmp((void const   *)((char const   *)pw.pw_shell), (void const   *)shell,
                             tmp___5 + 1U);
            }
          } else {
            {
#line 39
            tmp___6 = strcmp((char const   *)pw.pw_shell, shell);
#line 39
            tmp___4 = tmp___6;
            }
          }
        } else {
          {
#line 39
          tmp___6 = strcmp((char const   *)pw.pw_shell, shell);
#line 39
          tmp___4 = tmp___6;
          }
        }
#line 39
        if (! (tmp___4 != 0)) {
          goto while_120_break;
        }
      } else {
        goto while_120_break;
      }
    }
    while_120_break: /* CIL Label */ ;
    }
    {
#line 40
    endusershell();
    }
#line 41
    if ((unsigned int )shell == (unsigned int )((void *)0)) {
#line 42
      return;
    }
  }
  {
#line 46
  tmp___18 = __strdup((char const   *)pw.pw_dir);
#line 46
  dir = tmp___18;
  }
#line 46
  if ((unsigned int )dir == (unsigned int )((void *)0)) {
#line 47
    return;
  }
#line 52
  if ((int )(*(pw.pw_passwd + 0)) == 120) {
#line 52
    if ((int )(*(pw.pw_passwd + 1)) == 0) {
      goto _L___4;
    } else {
      goto _L___5;
    }
  } else {
    _L___5: 
#line 52
    if ((int )(*(pw.pw_passwd + 0)) == 35) {
#line 52
      if ((int )(*(pw.pw_passwd + 1)) == 35) {
#line 52
        if (0) {
          {
#line 52
          __s1_len___0 = strlen((char const   *)(pw.pw_passwd + 2));
#line 52
          __s2_len___0 = strlen(account___0);
          }
#line 52
          if (! ((unsigned int )((void const   *)((pw.pw_passwd + 2) + 1)) - (unsigned int )((void const   *)(pw.pw_passwd +
                                                                                                              2)) ==
                 1U)) {
            goto _L___3;
          } else {
#line 52
            if (__s1_len___0 >= 4U) {
              _L___3: 
#line 52
              if (! ((unsigned int )((void const   *)(account___0 + 1)) - (unsigned int )((void const   *)account___0) ==
                     1U)) {
#line 52
                tmp___27 = 1;
              } else {
#line 52
                if (__s2_len___0 >= 4U) {
#line 52
                  tmp___27 = 1;
                } else {
#line 52
                  tmp___27 = 0;
                }
              }
            } else {
#line 52
              tmp___27 = 0;
            }
          }
#line 52
          if (tmp___27) {
#line 52
            if (__s1_len___0 < __s2_len___0) {
#line 52
              tmp___25 = __s1_len___0;
            } else {
#line 52
              tmp___25 = __s2_len___0;
            }
            {
#line 52
            tmp___24 = memcmp((void const   *)((char const   *)(pw.pw_passwd + 2)),
                              (void const   *)account___0, tmp___25 + 1U);
            }
          } else {
            {
#line 52
            tmp___26 = strcmp((char const   *)(pw.pw_passwd + 2), account___0);
#line 52
            tmp___24 = tmp___26;
            }
          }
        } else {
          {
#line 52
          tmp___26 = strcmp((char const   *)(pw.pw_passwd + 2), account___0);
#line 52
          tmp___24 = tmp___26;
          }
        }
#line 52
        if (tmp___24 == 0) {
          _L___4: 
          {
#line 52
          spw = getspnam(account___0);
          }
#line 52
          if ((unsigned int )spw != (unsigned int )((void *)0)) {
#line 52
            if ((unsigned int )spw->sp_pwdp != (unsigned int )((void *)0)) {
#line 54
              if ((int )(*(spw->sp_pwdp + 0)) == 64) {
#line 54
                cpwd = (char const   *)((void *)0);
              } else {
#line 54
                cpwd = (char const   *)spw->sp_pwdp;
              }
#line 55
              if (spw->sp_expire > 0L) {
                goto _L___1;
              } else {
#line 55
                if (spw->sp_max > 0L) {
                  _L___1: 
                  {
#line 56
                  tmp___19 = time((time_t *)((void *)0));
#line 56
                  today = tmp___19 / 86400L;
                  }
#line 58
                  if (spw->sp_expire > 0L) {
#line 58
                    if (spw->sp_expire < today) {
                      goto bye;
                    }
                  }
#line 61
                  if (spw->sp_max > 0L) {
#line 61
                    if (spw->sp_lstchg > 0L) {
#line 61
                      if (spw->sp_lstchg + spw->sp_max < today) {
                        goto bye;
                      }
                    }
                  }
                }
              }
            } else {
#line 69
              cpwd = (char const   *)pw.pw_passwd;
            }
          } else {
#line 69
            cpwd = (char const   *)pw.pw_passwd;
          }
        } else {
#line 69
          cpwd = (char const   *)pw.pw_passwd;
        }
      } else {
#line 69
        cpwd = (char const   *)pw.pw_passwd;
      }
    } else {
#line 69
      cpwd = (char const   *)pw.pw_passwd;
    }
  }
#line 76
  if ((unsigned int )cpwd == (unsigned int )((void *)0)) {
    goto bye;
  } else {
    {
#line 74
    crypted = crypt(password, cpwd);
    }
#line 76
    if ((unsigned int )crypted == (unsigned int )((void *)0)) {
      goto bye;
    } else {
#line 76
      if (0) {
        {
#line 76
        __s1_len___1 = strlen(cpwd);
#line 76
        __s2_len___1 = strlen(crypted);
        }
#line 76
        if (! ((unsigned int )((void const   *)(cpwd + 1)) - (unsigned int )((void const   *)cpwd) ==
               1U)) {
          goto _L___7;
        } else {
#line 76
          if (__s1_len___1 >= 4U) {
            _L___7: 
#line 76
            if (! ((unsigned int )((void const   *)(crypted + 1)) - (unsigned int )((void const   *)crypted) ==
                   1U)) {
#line 76
              tmp___36 = 1;
            } else {
#line 76
              if (__s2_len___1 >= 4U) {
#line 76
                tmp___36 = 1;
              } else {
#line 76
                tmp___36 = 0;
              }
            }
          } else {
#line 76
            tmp___36 = 0;
          }
        }
#line 76
        if (tmp___36) {
#line 76
          if (__s1_len___1 < __s2_len___1) {
#line 76
            tmp___34 = __s1_len___1;
          } else {
#line 76
            tmp___34 = __s2_len___1;
          }
          {
#line 76
          tmp___33 = memcmp((void const   *)cpwd, (void const   *)crypted, tmp___34 +
                                                                           1U);
          }
        } else {
          {
#line 76
          tmp___35 = strcmp(cpwd, crypted);
#line 76
          tmp___33 = tmp___35;
          }
        }
      } else {
        {
#line 76
        tmp___35 = strcmp(cpwd, crypted);
#line 76
        tmp___33 = tmp___35;
        }
      }
#line 76
      if (tmp___33 != 0) {
        goto bye;
      }
    }
  }
#line 80
  result->uid = pw.pw_uid;
#line 81
  result->gid = pw.pw_gid;
#line 82
  result->dir = (char const   *)dir;
#line 83
  result->slow_tilde_expansion = 0;
#line 84
  result->auth_ok = - result->auth_ok;
#line 85
  return;
  bye: 
  {
#line 88
  free((void *)dir);
  }
#line 89
  return;
}
}
#line 1 "cil-rVieQUfH.o"
/* #pragma merger(0,"/tmp/cil-ShbGoLUQ.i","") */
#line 1 "src/pure_ftpd-log_mysql.o_saved.c"
/* #pragma merger(112422803,"./log_mysql.i","-g,-O2") */
#line 1 "cil-TX48oNjn.o"
/* #pragma merger(0,"/tmp/cil-jsWHe9jO.i","") */
#line 1 "src/pure_ftpd-log_pgsql.o_saved.c"
/* #pragma merger(112422803,"./log_pgsql.i","-g,-O2") */
#line 1 "cil-U37MwJ1x.o"
/* #pragma merger(0,"/tmp/cil-xc755KeD.i","") */
#line 1 "src/pure_ftpd-log_pam.o_saved.c"
/* #pragma merger(112422803,"./log_pam.i","-g,-O2") */
#line 1 "cil-n1xmVS5U.o"
/* #pragma merger(0,"/tmp/cil-Yrd5usbF.i","") */
#line 1 "src/pure_ftpd-log_ldap.o_saved.c"
/* #pragma merger(112422803,"./log_ldap.i","-g,-O2") */
#line 1 "cil-Ey96rNCk.o"
/* #pragma merger(0,"/tmp/cil-4QWFgTU3.i","") */
#line 1 "src/pure_ftpd-log_puredb.o_saved.c"
/* #pragma merger(112422803,"./log_puredb.i","-g,-O2") */
#line 1 "cil-zjqWatOD.o"
/* #pragma merger(0,"/tmp/cil-RtUtYeSC.i","") */
#line 1 "src/pure_ftpd-log_extauth.o_saved.c"
/* #pragma merger(112422804,"./log_extauth.i","-g,-O2") */
#line 1 "cil-fxMJG6IO.o"
/* #pragma merger(0,"/tmp/cil-mJUTTkXb.i","") */
#line 1 "src/pure_ftpd-ls.o_saved.c"
/* #pragma merger(112422804,"./ls.i","-g,-O2") */
#line 567 "/usr/include/stdlib.h"
extern void *realloc(void *__ptr , size_t __size )  __attribute__((__malloc__)) ;
#line 743
extern void qsort(void *__base , size_t __nmemb , size_t __size , int (*__compar)(void const   * ,
                                                                                  void const   * ) ) ;
#line 58 "/usr/include/string.h"
extern void *memset(void *__s , int __c , size_t __n ) ;
#line 731 "/usr/include/unistd.h"
extern int readlink(char const   * __restrict  __path , char * __restrict  __buf ,
                    size_t __len ) ;
#line 103 "/usr/include/grp.h"
extern struct group *getgrgid(__gid_t __gid ) ;
#line 361 "ftpd.h"
void donlist(char *arg , int on_ctrl_conn , int opt_l_ , int split_args ) ;
#line 399 "ftpd.h"
int opt_a  ;
#line 399 "ftpd.h"
int opt_C  ;
#line 399 "ftpd.h"
int opt_d  ;
#line 399 "ftpd.h"
int opt_F  ;
#line 399 "ftpd.h"
int opt_l  ;
#line 399 "ftpd.h"
int opt_R  ;
#line 135 "/usr/include/dirent.h"
extern DIR *opendir(char const   *__name ) ;
#line 142
extern int closedir(DIR *__dirp ) ;
#line 158
extern struct dirent *readdir(DIR *__dirp )  __asm__("readdir64")  ;
#line 10 "ls_p.h"
static unsigned int colwidth  ;
#line 11 "ls_p.h"
static unsigned int filenames  ;
#line 20 "ls_p.h"
static struct filename *head  ;
#line 21 "ls_p.h"
static struct filename *tail  ;
#line 22 "ls_p.h"
static unsigned int matches  ;
#line 37 "ls_p.h"
static struct userid *user_head  ;
#line 38 "ls_p.h"
static struct groupid *group_head  ;
#line 42 "ls_p.h"
int opt_r  ;
#line 42 "ls_p.h"
int opt_t  ;
#line 42 "ls_p.h"
int opt_S  ;
#line 84 "bsd-glob.h"
int sglob(char *pattern , int flags , int (*errfunc)(char const   * , int  ) , glob_t *pglob ,
          unsigned long maxfiles , int maxdepth ) ;
#line 86
void globfree(glob_t *pglob ) ;
#line 17 "ls.c"
static char outbuf[65536]  ;
#line 18 "ls.c"
static size_t outcnt  ;
#line 15 "ls.c"
static void wrstr(int f , char const   *s ) 
{ size_t l ;
  int tmp ;
  size_t rest ;
  int tmp___0 ;
  int tmp___1 ;

  {
#line 21
  if ((unsigned int )s == (unsigned int )((void *)0)) {
#line 22
    if (outcnt > 0U) {
      {
#line 23
      tmp = safe_write(f, (void const   *)(outbuf), outcnt);
      }
#line 23
      if (tmp != 0) {
#line 24
        return;
      }
    }
#line 27
    outcnt = 0U;
#line 28
    return;
  }
  {
#line 30
  l = strlen(s);
  }
#line 30
  if (l <= 0U) {
#line 31
    return;
  }
#line 33
  if (l <= sizeof(outbuf) - outcnt) {
    {
#line 34
    memcpy((void */* __restrict  */)(outbuf + outcnt), (void const   */* __restrict  */)s,
           l);
#line 35
    outcnt += l;
    }
#line 36
    return;
  }
#line 38
  if (outcnt < sizeof(outbuf)) {
    {
#line 39
    rest = sizeof(outbuf) - outcnt;
#line 41
    memcpy((void */* __restrict  */)(outbuf + outcnt), (void const   */* __restrict  */)s,
           rest);
#line 42
    s += rest;
#line 43
    l -= rest;
    }
  }
  {
#line 45
  tmp___0 = safe_write(f, (void const   *)(outbuf), sizeof(outbuf));
  }
#line 45
  if (tmp___0 != 0) {
#line 46
    return;
  }
  {
#line 48
  while (1) {
    while_121_continue: /* CIL Label */ ;
#line 48
    if (! (l > sizeof(outbuf))) {
      goto while_121_break;
    }
    {
#line 49
    tmp___1 = safe_write(f, (void const   *)s, sizeof(outbuf));
    }
#line 49
    if (tmp___1 != 0) {
#line 50
      return;
    }
#line 52
    s += sizeof(outbuf);
#line 53
    l -= sizeof(outbuf);
  }
  while_121_break: /* CIL Label */ ;
  }
#line 55
  if (l > 0U) {
    {
#line 56
    memcpy((void */* __restrict  */)(outbuf), (void const   */* __restrict  */)s,
           l);
#line 57
    outcnt = l;
    }
  }
#line 59
  return;
}
}
#line 79 "ls.c"
char const   *getname(uid_t uid ) 
{ struct userid *p ;
  struct passwd *pwd ;
  int tmp___1 ;
  int tmp___2 ;

  {
#line 82
  pwd = (struct passwd *)((void *)0);
#line 84
  p = user_head;
  {
#line 84
  while (1) {
    while_122_continue: /* CIL Label */ ;
#line 84
    if (! p) {
      goto while_122_break;
    }
#line 85
    if (p->uid == uid) {
#line 86
      return ((char const   *)p->name);
    }
#line 84
    p = p->next;
  }
  while_122_break: /* CIL Label */ ;
  }
#line 89
  if ((int )chrooted == 0) {
#line 89
    if (authresult.slow_tilde_expansion == 0) {
      {
#line 94
      pwd = getpwuid(uid);
      }
    }
  }
  {
#line 96
  p = (struct userid *)malloc(sizeof((*p)));
  }
#line 96
  if ((unsigned int )p == (unsigned int )((void *)0)) {
    {
#line 97
    die_mem();
    }
  }
  {
#line 99
  p->uid = uid;
#line 100
  p->name = (char *)malloc(9U);
  }
#line 100
  if ((unsigned int )p->name == (unsigned int )((void *)0)) {
    {
#line 101
    die_mem();
    }
  }
#line 103
  if ((unsigned int )pwd != (unsigned int )((void *)0)) {
    {
#line 104
    tmp___1 = snprintf((char */* __restrict  */)p->name, 9U, (char const   */* __restrict  */)"%-8.8s",
                       pwd->pw_name);
    }
#line 104
    if (tmp___1 >= 9) {
      {
#line 106
      while (1) {
        while_123_continue: /* CIL Label */ ;
        {
#line 106
        delete_atomic_file();
#line 106
        _exit(1);
        }
        goto while_123_break;
      }
      while_123_break: /* CIL Label */ ;
      }
    }
  } else {
    {
#line 109
    tmp___2 = snprintf((char */* __restrict  */)p->name, 9U, (char const   */* __restrict  */)"%-8d",
                       uid);
    }
#line 109
    if (tmp___2 >= 9) {
      {
#line 111
      while (1) {
        while_124_continue: /* CIL Label */ ;
        {
#line 111
        delete_atomic_file();
#line 111
        _exit(1);
        }
        goto while_124_break;
      }
      while_124_break: /* CIL Label */ ;
      }
    }
  }
#line 114
  p->next = user_head;
#line 115
  user_head = p;
#line 117
  return ((char const   *)p->name);
}
}
#line 121 "ls.c"
char const   *getgroup(gid_t gid ) 
{ struct groupid *p ;
  struct group *pwd ;
  int tmp___1 ;
  int tmp___2 ;

  {
#line 124
  pwd = (struct group *)((void *)0);
#line 126
  p = group_head;
  {
#line 126
  while (1) {
    while_125_continue: /* CIL Label */ ;
#line 126
    if (! p) {
      goto while_125_break;
    }
#line 127
    if (p->gid == gid) {
#line 128
      return ((char const   *)p->name);
    }
#line 126
    p = p->next;
  }
  while_125_break: /* CIL Label */ ;
  }
#line 132
  if ((int )chrooted == 0) {
    {
#line 135
    pwd = getgrgid(gid);
    }
  }
  {
#line 137
  p = (struct groupid *)malloc(sizeof((*p)));
  }
#line 137
  if ((unsigned int )p == (unsigned int )((void *)0)) {
    {
#line 138
    die_mem();
    }
  }
  {
#line 140
  p->gid = gid;
#line 141
  p->name = (char *)malloc(9U);
  }
#line 141
  if ((unsigned int )p->name == (unsigned int )((void *)0)) {
    {
#line 142
    die_mem();
    }
  }
#line 144
  if ((unsigned int )pwd != (unsigned int )((void *)0)) {
    {
#line 145
    tmp___1 = snprintf((char */* __restrict  */)p->name, 9U, (char const   */* __restrict  */)"%-8.8s",
                       pwd->gr_name);
    }
#line 145
    if (tmp___1 >= 9) {
      {
#line 147
      while (1) {
        while_126_continue: /* CIL Label */ ;
        {
#line 147
        delete_atomic_file();
#line 147
        _exit(1);
        }
        goto while_126_break;
      }
      while_126_break: /* CIL Label */ ;
      }
    }
  } else {
    {
#line 150
    tmp___2 = snprintf((char */* __restrict  */)p->name, 9U, (char const   */* __restrict  */)"%-8d",
                       gid);
    }
#line 150
    if (tmp___2 >= 9) {
      {
#line 152
      while (1) {
        while_127_continue: /* CIL Label */ ;
        {
#line 152
        delete_atomic_file();
#line 152
        _exit(1);
        }
        goto while_127_break;
      }
      while_127_break: /* CIL Label */ ;
      }
    }
  }
#line 155
  p->next = group_head;
#line 156
  group_head = p;
#line 158
  return ((char const   *)p->name);
}
}
#line 162 "ls.c"
static void addfile(char const   *name , char const   *suffix ) 
{ struct filename *p ;
  unsigned int l ;
  size_t tmp ;
  size_t tmp___0 ;
  int tmp___2 ;

  {
#line 167
  if (! name) {
#line 168
    return;
  } else {
#line 167
    if (! suffix) {
#line 168
      return;
    }
  }
#line 170
  if (matches >= max_ls_files) {
#line 171
    return;
  }
  {
#line 173
  matches ++;
#line 174
  tmp = strlen(name);
#line 174
  tmp___0 = strlen(suffix);
#line 174
  l = tmp + tmp___0;
  }
#line 175
  if (l > colwidth) {
#line 176
    colwidth = l;
  }
  {
#line 178
  p = (struct filename *)malloc(((unsigned int )(& ((struct filename *)0)->line) +
                                 l) + 1U);
  }
#line 178
  if ((unsigned int )p == (unsigned int )((void *)0)) {
#line 179
    return;
  }
  {
#line 181
  tmp___2 = snprintf((char */* __restrict  */)(p->line), l + 1U, (char const   */* __restrict  */)"%s%s",
                     name, suffix);
  }
#line 181
  if (tmp___2 >= (int )(l + 1U)) {
    {
#line 182
    while (1) {
      while_128_continue: /* CIL Label */ ;
      {
#line 182
      delete_atomic_file();
#line 182
      _exit(1);
      }
      goto while_128_break;
    }
    while_128_break: /* CIL Label */ ;
    }
  }
#line 184
  if ((unsigned int )tail != (unsigned int )((void *)0)) {
#line 185
    tail->down = p;
  } else {
#line 187
    head = p;
  }
#line 189
  tail = p;
#line 190
  filenames ++;
#line 191
  return;
}
}
#line 194 "ls.c"
static int listfile(PureFileInfo const   *fi , char const   *name ) 
{ int rval ;
  struct stat st ;
  struct tm *t ;
  char suffix[2] ;
  char m[4097] ;
  char const   *n ;
  char *alloca_nameline ;
  size_t sizeof_nameline ;
  int tmp___0 ;
  char *alloca_nameline___0 ;
  size_t sizeof_nameline___0 ;
  char timeline[6] ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  time_t tmp___7 ;
  char const   *tmp___9 ;
  char const   *tmp___10 ;
  int tmp___11 ;
  char *p ;
  size_t tmp___12 ;
  int sx ;
  int tmp___13 ;
  size_t tmp___14 ;
  int tmp___15 ;
  size_t tmp___16 ;

 CHECK2: assert(0);

  {
#line 196
  rval = 0;
#line 199
  suffix[0] = 0;
#line 199
  suffix[1] = 0;
#line 203
  if ((int )modern_listings != 0) {
#line 206
    sizeof_nameline = 4352U;
#line 208
    if ((unsigned int )fi == (unsigned int )((void *)0)) {
#line 209
      n = name;
    } else {
#line 211
      n = (char const   *)((*(fi->names_pnt)) + fi->name_offset);
    }
    {
#line 213
    alloca_nameline = (char *)__builtin_alloca(sizeof_nameline);
    }
#line 213
    if ((unsigned int )alloca_nameline == (unsigned int )((void *)0)) {
#line 214
      return (0);
    }
    {
#line 216
    rval = modernformat(n, alloca_nameline, sizeof_nameline);
    }
#line 216
    if (rval < 0) {
      {
#line 217
      while (1) {
        while_129_continue: /* CIL Label */ ;
        goto while_129_break;
      }
      while_129_break: /* CIL Label */ ;
      }
#line 218
      return (0);
    }
    {
#line 220
    addfile((char const   *)alloca_nameline, (char const   *)(suffix));
    }
    {
#line 221
    while (1) {
      while_130_continue: /* CIL Label */ ;
      goto while_130_break;
    }
    while_130_break: /* CIL Label */ ;
    }
#line 223
    return (rval);
  }
#line 226
  if ((unsigned int )fi == (unsigned int )((void *)0)) {
    {
#line 227
    tmp___0 = lstat((char const   */* __restrict  */)name, (struct stat */* __restrict  */)(& st));
    }
#line 227
    if (tmp___0 < 0) {
#line 228
      return (0);
    }
  } else {
#line 231
    st.st_size = fi->size;
#line 232
    st.st_mtim.tv_sec = fi->mtime;
#line 233
    st.st_mode = fi->mode;
#line 234
    st.st_nlink = fi->nlink;
#line 235
    st.st_uid = fi->uid;
#line 236
    st.st_gid = fi->gid;
#line 237
    name = (char const   *)((*(fi->names_pnt)) + fi->name_offset);
  }
  {
#line 248
  t = localtime((time_t const   *)(& st.st_mtim.tv_sec));
  }
#line 250
  if ((unsigned int )t == (unsigned int )((void *)0)) {
    {
#line 251
    logfile(3, "{gm,local}gtime() for [%s]", name);
    }
#line 252
    return (0);
  }
#line 254
  if (opt_F) {
#line 255
    if ((st.st_mode & 61440U) == 40960U) {
#line 256
      suffix[0] = (char )'@';
    } else {
#line 257
      if ((st.st_mode & 61440U) == 16384U) {
#line 258
        suffix[0] = (char )'/';
#line 259
        rval = 1;
      } else {
#line 260
        if (st.st_mode & 4161U) {
#line 261
          suffix[0] = (char )'*';
        }
      }
    }
  }
#line 264
  if (opt_l) {
    {
#line 265
    strncpy((char */* __restrict  */)(m), (char const   */* __restrict  */)" ---------",
            sizeof(m) - 1U);
#line 266
    m[sizeof(m) - 1U] = 0;
    }
#line 268
    if ((int )(st.st_mode & 61440U) == 32768) {
      goto switch_131_32768;
    } else {
#line 271
      if ((int )(st.st_mode & 61440U) == 40960) {
        goto switch_131_40960;
      } else {
#line 274
        if ((int )(st.st_mode & 61440U) == 16384) {
          goto switch_131_16384;
        } else {
#line 267
          if (0) {
            switch_131_32768: /* CIL Label */ 
#line 269
            m[0] = (char )'-';
            goto switch_131_break;
            switch_131_40960: /* CIL Label */ 
#line 272
            m[0] = (char )'l';
            goto switch_131_break;
            switch_131_16384: /* CIL Label */ 
#line 275
            m[0] = (char )'d';
#line 276
            rval = 1;
            goto switch_131_break;
          } else {
            switch_131_break: /* CIL Label */ ;
          }
        }
      }
    }
#line 279
    if ((int )m[0] != 32) {
#line 281
      sizeof_nameline___0 = 8320U;
#line 284
      if (st.st_mode & 256U) {
#line 285
        m[1] = (char )'r';
      }
#line 287
      if (st.st_mode & 128U) {
#line 288
        m[2] = (char )'w';
      }
#line 290
      if (st.st_mode & 64U) {
#line 291
        if (st.st_mode & 2048U) {
#line 291
          tmp___2 = 's';
        } else {
#line 291
          tmp___2 = 'x';
        }
#line 291
        m[3] = (char )tmp___2;
      } else {
#line 292
        if (st.st_mode & 2048U) {
#line 293
          m[3] = (char )'S';
        }
      }
#line 295
      if (st.st_mode & 32U) {
#line 296
        m[4] = (char )'r';
      }
#line 298
      if (st.st_mode & 16U) {
#line 299
        m[5] = (char )'w';
      }
#line 301
      if (st.st_mode & 8U) {
#line 302
        if (st.st_mode & 1024U) {
#line 302
          tmp___3 = 's';
        } else {
#line 302
          tmp___3 = 'x';
        }
#line 302
        m[6] = (char )tmp___3;
      } else {
#line 303
        if (st.st_mode & 1024U) {
#line 304
          m[6] = (char )'S';
        }
      }
#line 306
      if (st.st_mode & 4U) {
#line 307
        m[7] = (char )'r';
      }
#line 309
      if (st.st_mode & 2U) {
#line 310
        m[8] = (char )'w';
      }
#line 312
      if (st.st_mode & 1U) {
#line 313
        if (st.st_mode & 512U) {
#line 313
          tmp___4 = 't';
        } else {
#line 313
          tmp___4 = 'x';
        }
#line 313
        m[9] = (char )tmp___4;
      } else {
#line 314
        if (st.st_mode & 512U) {
#line 315
          m[9] = (char )'T';
        }
      }
      {
#line 317
      tmp___7 = time((time_t *)((void *)0));
      }
#line 317
      if (tmp___7 - st.st_mtim.tv_sec > 15552000L) {
        {
#line 318
        tmp___5 = snprintf((char */* __restrict  */)(timeline), sizeof(timeline),
                           (char const   */* __restrict  */)"%5d", t->tm_year + 1900);
        }
#line 318
        if (tmp___5 >= (int )sizeof(timeline)) {
          {
#line 320
          while (1) {
            while_132_continue: /* CIL Label */ ;
            {
#line 320
            delete_atomic_file();
#line 320
            _exit(1);
            }
            goto while_132_break;
          }
          while_132_break: /* CIL Label */ ;
          }
        }
      } else {
        {
#line 323
        tmp___6 = snprintf((char */* __restrict  */)(timeline), sizeof(timeline),
                           (char const   */* __restrict  */)"%02d:%02d", t->tm_hour,
                           t->tm_min);
        }
#line 323
        if (tmp___6 >= (int )sizeof(timeline)) {
          {
#line 325
          while (1) {
            while_133_continue: /* CIL Label */ ;
            {
#line 325
            delete_atomic_file();
#line 325
            _exit(1);
            }
            goto while_133_break;
          }
          while_133_break: /* CIL Label */ ;
          }
        }
      }
      {
#line 328
      alloca_nameline___0 = (char *)__builtin_alloca(sizeof_nameline___0);
      }
#line 328
      if ((unsigned int )alloca_nameline___0 == (unsigned int )((void *)0)) {
#line 329
        return (0);
      }
      {
#line 332
      tmp___9 = getgroup(st.st_gid);
#line 332
      tmp___10 = getname(st.st_uid);
#line 332
      tmp___11 = snprintf((char */* __restrict  */)alloca_nameline___0, sizeof_nameline___0,
                          (char const   */* __restrict  */)"%s %4u %s %s %8llu %s %2d %s %s",
                          m, st.st_nlink, tmp___10, tmp___9, (unsigned long long )st.st_size,
                          months[t->tm_mon], t->tm_mday, timeline, name);
      }
#line 332
      if (tmp___11 >= (int )sizeof_nameline___0) {
        {
#line 353
        while (1) {
          while_134_continue: /* CIL Label */ ;
          goto while_134_break;
        }
        while_134_break: /* CIL Label */ ;
        }
        {
#line 354
        while (1) {
          while_135_continue: /* CIL Label */ ;
          {
#line 354
          delete_atomic_file();
#line 354
          _exit(1);
          }
          goto while_135_break;
        }
        while_135_break: /* CIL Label */ ;
        }
      }
#line 356
      if ((st.st_mode & 61440U) == 40960U) {
        {
#line 357
        tmp___12 = strlen((char const   *)alloca_nameline___0);
#line 357
        p = alloca_nameline___0 + tmp___12;
#line 362
        sx = readlink((char const   */* __restrict  */)name, (char */* __restrict  */)(m),
                      sizeof(m) - 1U);
        }
#line 362
        if (sx > 0) {
#line 363
          m[sx] = 0;
        } else {
#line 365
          m[1] = (char )'.';
#line 365
          m[0] = m[1];
#line 366
          m[2] = 0;
        }
#line 369
        suffix[0] = 0;
#line 370
        if (opt_F) {
          {
#line 370
          tmp___13 = stat((char const   */* __restrict  */)name, (struct stat */* __restrict  */)(& st));
          }
#line 370
          if (tmp___13 == 0) {
#line 371
            if ((st.st_mode & 61440U) == 40960U) {
#line 372
              suffix[0] = (char )'@';
            } else {
#line 373
              if ((st.st_mode & 61440U) == 16384U) {
#line 374
                suffix[0] = (char )'/';
              } else {
#line 375
                if (st.st_mode & 4161U) {
#line 376
                  suffix[0] = (char )'*';
                }
              }
            }
          }
        }
        {
#line 380
        tmp___14 = strlen((char const   *)alloca_nameline___0);
#line 380
        tmp___15 = snprintf((char */* __restrict  */)p, sizeof_nameline___0 - tmp___14,
                            (char const   */* __restrict  */)" -> %s", m);
#line 380
        tmp___16 = strlen((char const   *)alloca_nameline___0);
        }
#line 380
        if (tmp___15 >= (int )(sizeof_nameline___0 - tmp___16)) {
          {
#line 384
          while (1) {
            while_136_continue: /* CIL Label */ ;
            goto while_136_break;
          }
          while_136_break: /* CIL Label */ ;
          }
          {
#line 385
          while (1) {
            while_137_continue: /* CIL Label */ ;
            {
#line 385
            delete_atomic_file();
#line 385
            _exit(1);
            }
            goto while_137_break;
          }
          while_137_break: /* CIL Label */ ;
          }
        }
      }
      {
#line 388
      addfile((char const   *)alloca_nameline___0, (char const   *)(suffix));
      }
      {
#line 389
      while (1) {
        while_138_continue: /* CIL Label */ ;
        goto while_138_break;
      }
      while_138_break: /* CIL Label */ ;
      }
    }
  } else {
#line 392
    if ((st.st_mode & 61440U) == 32768U) {
      {
#line 394
      addfile(name, (char const   *)(suffix));
      }
    } else {
#line 392
      if ((st.st_mode & 61440U) == 16384U) {
        {
#line 394
        addfile(name, (char const   *)(suffix));
        }
      } else {
#line 392
        if ((st.st_mode & 61440U) == 40960U) {
          {
#line 394
          addfile(name, (char const   *)(suffix));
          }
        }
      }
    }
  }
#line 397
  return (rval);
}
}
#line 400 "ls.c"
static void outputfiles(int f ) 
{ unsigned int n ;
  struct filename *p ;
  struct filename *q ;
  char pad[6] ;
  char *tmp ;
  void *__s___0 ;
  union __anonunion___u_68 *__u ;
  __uint8_t __c ;
  void *__s___1 ;
  size_t tmp___0 ;

  {
#line 409
  if (! head) {
#line 410
    return;
  }
#line 412
  tail->down = (struct filename *)((void *)0);
#line 413
  tail = (struct filename *)((void *)0);
#line 414
  colwidth = (colwidth | 7U) + 1U;
#line 415
  if (opt_l != 0) {
#line 416
    colwidth = 75U;
  } else {
#line 415
    if (opt_C == 0) {
#line 416
      colwidth = 75U;
    }
  }
#line 419
  p = head;
#line 420
  p->top = 1;
#line 421
  if (colwidth > 75U) {
#line 422
    n = filenames;
  } else {
#line 424
    n = ((filenames + 75U / colwidth) - 1U) / (75U / colwidth);
  }
  {
#line 426
  while (1) {
    while_139_continue: /* CIL Label */ ;
#line 426
    if (n) {
#line 426
      if (! p) {
        goto while_139_break;
      }
    } else {
      goto while_139_break;
    }
#line 427
    p = p->down;
#line 428
    if ((unsigned int )p != (unsigned int )((void *)0)) {
#line 429
      p->top = 0;
    }
#line 431
    n --;
  }
  while_139_break: /* CIL Label */ ;
  }
#line 435
  q = head;
  {
#line 436
  while (1) {
    while_140_continue: /* CIL Label */ ;
#line 436
    if (! p) {
      goto while_140_break;
    }
#line 437
    p->top = q->top;
#line 438
    q->right = p;
#line 439
    q = q->down;
#line 440
    p = p->down;
  }
  while_140_break: /* CIL Label */ ;
  }
  {
#line 444
  while (1) {
    while_141_continue: /* CIL Label */ ;
#line 444
    if (! q) {
      goto while_141_break;
    }
#line 445
    q->right = (struct filename *)((void *)0);
#line 446
    q = q->down;
  }
  while_141_break: /* CIL Label */ ;
  }
#line 450
  p = head;
  {
#line 451
  while (1) {
    while_142_continue: /* CIL Label */ ;
#line 451
    if (p) {
#line 451
      if (p->down) {
#line 451
        if (! (! (p->down)->top)) {
          goto while_142_break;
        }
      } else {
        goto while_142_break;
      }
    } else {
      goto while_142_break;
    }
#line 452
    p = p->down;
  }
  while_142_break: /* CIL Label */ ;
  }
#line 454
  if (p) {
#line 454
    if (p->down) {
#line 455
      p->down = (struct filename *)((void *)0);
    }
  }
#line 459
  p = head;
  {
#line 460
  while (1) {
    while_143_continue: /* CIL Label */ ;
#line 460
    if (! p) {
      goto while_143_break;
    }
#line 461
    q = p;
#line 462
    p = p->down;
    {
#line 463
    while (1) {
      while_144_continue: /* CIL Label */ ;
#line 463
      if (! q) {
        goto while_144_break;
      }
#line 465
      tmp = (char *)q;
#line 467
      if (q->right) {
#line 468
        if (sizeof(pad) - 1U <= 16U) {
#line 468
          if (sizeof(pad) - 1U == 1U) {
#line 468
            __s___1 = (void *)(pad);
#line 468
            (*((__uint8_t *)__s___1)) = (unsigned char )'\t';
          } else {
#line 468
            __s___0 = (void *)(pad);
#line 468
            __u = (union __anonunion___u_68 *)__s___0;
#line 468
            __c = (unsigned char )'\t';
#line 469
            if ((int )(sizeof(pad) - 1U) == 15) {
              goto switch_145_15;
            } else {
#line 469
              if ((int )(sizeof(pad) - 1U) == 11) {
                goto switch_145_11;
              } else {
#line 469
                if ((int )(sizeof(pad) - 1U) == 7) {
                  goto switch_145_7;
                } else {
#line 469
                  if ((int )(sizeof(pad) - 1U) == 3) {
                    goto switch_145_3;
                  } else {
#line 469
                    if ((int )(sizeof(pad) - 1U) == 14) {
                      goto switch_145_14;
                    } else {
#line 469
                      if ((int )(sizeof(pad) - 1U) == 10) {
                        goto switch_145_10;
                      } else {
#line 469
                        if ((int )(sizeof(pad) - 1U) == 6) {
                          goto switch_145_6;
                        } else {
#line 469
                          if ((int )(sizeof(pad) - 1U) == 2) {
                            goto switch_145_2;
                          } else {
#line 469
                            if ((int )(sizeof(pad) - 1U) == 13) {
                              goto switch_145_13;
                            } else {
#line 469
                              if ((int )(sizeof(pad) - 1U) == 9) {
                                goto switch_145_9;
                              } else {
#line 469
                                if ((int )(sizeof(pad) - 1U) == 5) {
                                  goto switch_145_5;
                                } else {
#line 469
                                  if ((int )(sizeof(pad) - 1U) == 1) {
                                    goto switch_145_1;
                                  } else {
#line 469
                                    if ((int )(sizeof(pad) - 1U) == 16) {
                                      goto switch_145_16;
                                    } else {
#line 469
                                      if ((int )(sizeof(pad) - 1U) == 12) {
                                        goto switch_145_12;
                                      } else {
#line 469
                                        if ((int )(sizeof(pad) - 1U) == 8) {
                                          goto switch_145_8;
                                        } else {
#line 469
                                          if ((int )(sizeof(pad) - 1U) == 4) {
                                            goto switch_145_4;
                                          } else {
#line 469
                                            if ((int )(sizeof(pad) - 1U) == 0) {
                                              goto switch_145_0;
                                            } else {
#line 468
                                              if (0) {
                                                switch_145_15: /* CIL Label */ 
#line 468
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 468
                                                __u = (union __anonunion___u_68 *)((void *)__u +
                                                                                   4);
                                                switch_145_11: /* CIL Label */ 
#line 468
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 468
                                                __u = (union __anonunion___u_68 *)((void *)__u +
                                                                                   4);
                                                switch_145_7: /* CIL Label */ 
#line 468
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 468
                                                __u = (union __anonunion___u_68 *)((void *)__u +
                                                                                   4);
                                                switch_145_3: /* CIL Label */ 
#line 468
                                                __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                               257);
#line 468
                                                __u = (union __anonunion___u_68 *)((void *)__u +
                                                                                   2);
#line 468
                                                __u->__uc = __c;
                                                goto switch_145_break;
                                                switch_145_14: /* CIL Label */ 
#line 468
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 468
                                                __u = (union __anonunion___u_68 *)((void *)__u +
                                                                                   4);
                                                switch_145_10: /* CIL Label */ 
#line 468
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 468
                                                __u = (union __anonunion___u_68 *)((void *)__u +
                                                                                   4);
                                                switch_145_6: /* CIL Label */ 
#line 468
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 468
                                                __u = (union __anonunion___u_68 *)((void *)__u +
                                                                                   4);
                                                switch_145_2: /* CIL Label */ 
#line 468
                                                __u->__usi = (unsigned short )((int )((unsigned short )__c) *
                                                                               257);
                                                goto switch_145_break;
                                                switch_145_13: /* CIL Label */ 
#line 468
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 468
                                                __u = (union __anonunion___u_68 *)((void *)__u +
                                                                                   4);
                                                switch_145_9: /* CIL Label */ 
#line 468
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 468
                                                __u = (union __anonunion___u_68 *)((void *)__u +
                                                                                   4);
                                                switch_145_5: /* CIL Label */ 
#line 468
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 468
                                                __u = (union __anonunion___u_68 *)((void *)__u +
                                                                                   4);
                                                switch_145_1: /* CIL Label */ 
#line 468
                                                __u->__uc = __c;
                                                goto switch_145_break;
                                                switch_145_16: /* CIL Label */ 
#line 468
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 468
                                                __u = (union __anonunion___u_68 *)((void *)__u +
                                                                                   4);
                                                switch_145_12: /* CIL Label */ 
#line 468
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 468
                                                __u = (union __anonunion___u_68 *)((void *)__u +
                                                                                   4);
                                                switch_145_8: /* CIL Label */ 
#line 468
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
#line 468
                                                __u = (union __anonunion___u_68 *)((void *)__u +
                                                                                   4);
                                                switch_145_4: /* CIL Label */ 
#line 468
                                                __u->__ui = (unsigned int )((int )__c *
                                                                            16843009);
                                                switch_145_0: /* CIL Label */ ;
                                                goto switch_145_break;
                                              } else {
                                                switch_145_break: /* CIL Label */ ;
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        } else {
          {
#line 468
          memset((void *)(pad), '\t', sizeof(pad) - 1U);
          }
        }
        {
#line 469
        pad[sizeof(pad) - 1U] = 0;
#line 470
        tmp___0 = strlen((char const   *)(q->line));
#line 470
        pad[((colwidth + 7U) - tmp___0) / 8U] = 0;
        }
      } else {
#line 472
        pad[0] = (char )'\r';
#line 473
        pad[1] = (char )'\n';
#line 474
        pad[2] = 0;
      }
      {
#line 481
      wrstr(f, (char const   *)(q->line));
#line 483
      wrstr(f, (char const   *)(pad));
#line 484
      q = q->right;
#line 485
      free((void *)tmp);
      }
    }
    while_144_break: /* CIL Label */ ;
    }
  }
  while_143_break: /* CIL Label */ ;
  }
#line 490
  tail = (struct filename *)((void *)0);
#line 490
  head = tail;
#line 491
  colwidth = 0U;
#line 492
  filenames = 0U;
#line 493
  return;
}
}
#line 496 "ls.c"
static int cmp(void const   *a , void const   *b ) 
{ size_t __s1_len ;
  size_t __s2_len ;
  int tmp___3 ;
  size_t tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;

  {
#line 498
  if (0) {
    {
#line 498
    __s1_len = strlen((char const   *)((*(((PureFileInfo const   *)a)->names_pnt)) +
                                       ((PureFileInfo const   *)a)->name_offset));
#line 498
    __s2_len = strlen((char const   *)((*(((PureFileInfo const   *)b)->names_pnt)) +
                                       ((PureFileInfo const   *)b)->name_offset));
    }
#line 498
    if (! ((unsigned int )((void const   *)(((*(((PureFileInfo const   *)a)->names_pnt)) +
                                             ((PureFileInfo const   *)a)->name_offset) +
                                            1)) - (unsigned int )((void const   *)((*(((PureFileInfo const   *)a)->names_pnt)) +
                                                                                   ((PureFileInfo const   *)a)->name_offset)) ==
           1U)) {
      goto _L___0;
    } else {
#line 498
      if (__s1_len >= 4U) {
        _L___0: 
#line 498
        if (! ((unsigned int )((void const   *)(((*(((PureFileInfo const   *)b)->names_pnt)) +
                                                 ((PureFileInfo const   *)b)->name_offset) +
                                                1)) - (unsigned int )((void const   *)((*(((PureFileInfo const   *)b)->names_pnt)) +
                                                                                       ((PureFileInfo const   *)b)->name_offset)) ==
               1U)) {
#line 498
          tmp___6 = 1;
        } else {
#line 498
          if (__s2_len >= 4U) {
#line 498
            tmp___6 = 1;
          } else {
#line 498
            tmp___6 = 0;
          }
        }
      } else {
#line 498
        tmp___6 = 0;
      }
    }
#line 498
    if (tmp___6) {
#line 498
      if (__s1_len < __s2_len) {
#line 498
        tmp___4 = __s1_len;
      } else {
#line 498
        tmp___4 = __s2_len;
      }
      {
#line 498
      tmp___3 = memcmp((void const   *)((char const   *)((*(((PureFileInfo const   *)a)->names_pnt)) +
                                                         ((PureFileInfo const   *)a)->name_offset)),
                       (void const   *)((char const   *)((*(((PureFileInfo const   *)b)->names_pnt)) +
                                                         ((PureFileInfo const   *)b)->name_offset)),
                       tmp___4 + 1U);
      }
    } else {
      {
#line 498
      tmp___5 = strcmp((char const   *)((*(((PureFileInfo const   *)a)->names_pnt)) +
                                        ((PureFileInfo const   *)a)->name_offset),
                       (char const   *)((*(((PureFileInfo const   *)b)->names_pnt)) +
                                        ((PureFileInfo const   *)b)->name_offset));
#line 498
      tmp___3 = tmp___5;
      }
    }
  } else {
    {
#line 498
    tmp___5 = strcmp((char const   *)((*(((PureFileInfo const   *)a)->names_pnt)) +
                                      ((PureFileInfo const   *)a)->name_offset), (char const   *)((*(((PureFileInfo const   *)b)->names_pnt)) +
                                                                                                  ((PureFileInfo const   *)b)->name_offset));
#line 498
    tmp___3 = tmp___5;
    }
  }
#line 498
  return (tmp___3);
}
}
#line 502 "ls.c"
static int cmp_r(void const   *a , void const   *b ) 
{ size_t __s1_len ;
  size_t __s2_len ;
  int tmp___3 ;
  size_t tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;

  {
#line 504
  if (0) {
    {
#line 504
    __s1_len = strlen((char const   *)((*(((PureFileInfo const   *)b)->names_pnt)) +
                                       ((PureFileInfo const   *)b)->name_offset));
#line 504
    __s2_len = strlen((char const   *)((*(((PureFileInfo const   *)a)->names_pnt)) +
                                       ((PureFileInfo const   *)a)->name_offset));
    }
#line 504
    if (! ((unsigned int )((void const   *)(((*(((PureFileInfo const   *)b)->names_pnt)) +
                                             ((PureFileInfo const   *)b)->name_offset) +
                                            1)) - (unsigned int )((void const   *)((*(((PureFileInfo const   *)b)->names_pnt)) +
                                                                                   ((PureFileInfo const   *)b)->name_offset)) ==
           1U)) {
      goto _L___0;
    } else {
#line 504
      if (__s1_len >= 4U) {
        _L___0: 
#line 504
        if (! ((unsigned int )((void const   *)(((*(((PureFileInfo const   *)a)->names_pnt)) +
                                                 ((PureFileInfo const   *)a)->name_offset) +
                                                1)) - (unsigned int )((void const   *)((*(((PureFileInfo const   *)a)->names_pnt)) +
                                                                                       ((PureFileInfo const   *)a)->name_offset)) ==
               1U)) {
#line 504
          tmp___6 = 1;
        } else {
#line 504
          if (__s2_len >= 4U) {
#line 504
            tmp___6 = 1;
          } else {
#line 504
            tmp___6 = 0;
          }
        }
      } else {
#line 504
        tmp___6 = 0;
      }
    }
#line 504
    if (tmp___6) {
#line 504
      if (__s1_len < __s2_len) {
#line 504
        tmp___4 = __s1_len;
      } else {
#line 504
        tmp___4 = __s2_len;
      }
      {
#line 504
      tmp___3 = memcmp((void const   *)((char const   *)((*(((PureFileInfo const   *)b)->names_pnt)) +
                                                         ((PureFileInfo const   *)b)->name_offset)),
                       (void const   *)((char const   *)((*(((PureFileInfo const   *)a)->names_pnt)) +
                                                         ((PureFileInfo const   *)a)->name_offset)),
                       tmp___4 + 1U);
      }
    } else {
      {
#line 504
      tmp___5 = strcmp((char const   *)((*(((PureFileInfo const   *)b)->names_pnt)) +
                                        ((PureFileInfo const   *)b)->name_offset),
                       (char const   *)((*(((PureFileInfo const   *)a)->names_pnt)) +
                                        ((PureFileInfo const   *)a)->name_offset));
#line 504
      tmp___3 = tmp___5;
      }
    }
  } else {
    {
#line 504
    tmp___5 = strcmp((char const   *)((*(((PureFileInfo const   *)b)->names_pnt)) +
                                      ((PureFileInfo const   *)b)->name_offset), (char const   *)((*(((PureFileInfo const   *)a)->names_pnt)) +
                                                                                                  ((PureFileInfo const   *)a)->name_offset));
#line 504
    tmp___3 = tmp___5;
    }
  }
#line 504
  return (tmp___3);
}
}
#line 508 "ls.c"
static int cmp_t(void const   *a , void const   *b ) 
{ 

  {
#line 510
  if (((PureFileInfo const   *)a)->mtime < ((PureFileInfo const   *)b)->mtime) {
#line 511
    return (1);
  }
#line 513
  if (((PureFileInfo const   *)a)->mtime > ((PureFileInfo const   *)b)->mtime) {
#line 514
    return (-1);
  }
#line 516
  return (0);
}
}
#line 519 "ls.c"
static int cmp_rt(void const   *a , void const   *b ) 
{ int tmp ;

  {
  {
#line 521
  tmp = cmp_t(b, a);
  }
#line 521
  return (tmp);
}
}
#line 524 "ls.c"
static int cmp_S(void const   *a , void const   *b ) 
{ 

  {
#line 526
  if (((PureFileInfo const   *)a)->size < ((PureFileInfo const   *)b)->size) {
#line 527
    return (1);
  }
#line 529
  if (((PureFileInfo const   *)a)->size > ((PureFileInfo const   *)b)->size) {
#line 530
    return (-1);
  }
#line 532
  return (0);
}
}
#line 535 "ls.c"
static int cmp_rS(void const   *a , void const   *b ) 
{ int tmp ;

  {
  {
#line 537
  tmp = cmp_S(b, a);
  }
#line 537
  return (tmp);
}
}
#line 540 "ls.c"
static PureFileInfo *sreaddir(char **names_pnt ) 
{ struct stat st ;
  DIR *d ;
  struct dirent *de ;
  PureFileInfo *files_info ;
  PureFileInfo *file_info ;
  size_t files_info_size ;
  size_t files_info_counter ;
  char *names ;
  size_t names_size ;
  size_t names_counter ;
  size_t name_len ;
  int (*cmp_func)(void const   * , void const   * ) ;
  int tmp___1 ;
  int tmp___2 ;
  size_t tmp___3 ;
  char *new_names ;
  PureFileInfo *new_files_info ;

  {
  {
#line 548
  files_info_counter = 0U;
#line 551
  names_counter = 0U;
#line 555
  d = opendir(".");
  }
#line 555
  if ((unsigned int )d == (unsigned int )((void *)0)) {
#line 556
    return ((PureFileInfo *)((void *)0));
  }
  {
#line 558
  names_size = page_size;
#line 559
  names = (char *)malloc(names_size);
  }
#line 559
  if ((unsigned int )names == (unsigned int )((void *)0)) {
    {
#line 560
    closedir(d);
    }
#line 561
    return ((PureFileInfo *)((void *)0));
  }
  {
#line 563
  files_info_size = page_size / sizeof((*files_info));
#line 564
  files_info = (PureFileInfo *)malloc(files_info_size * sizeof((*files_info)));
  }
#line 564
  if ((unsigned int )files_info == (unsigned int )((void *)0)) {
    {
#line 565
    closedir(d);
#line 566
    free((void *)names);
    }
#line 567
    return ((PureFileInfo *)((void *)0));
  }
  {
#line 569
  while (1) {
    while_146_continue: /* CIL Label */ ;
    {
#line 569
    de = readdir(d);
    }
#line 569
    if (! ((unsigned int )de != (unsigned int )((void *)0))) {
      goto while_146_break;
    }
    {
#line 570
    tmp___1 = checkprintable((char const   *)(de->d_name));
    }
#line 570
    if (tmp___1 != 0) {
      goto while_146_continue;
    } else {
      {
#line 570
      tmp___2 = lstat((char const   */* __restrict  */)(de->d_name), (struct stat */* __restrict  */)(& st));
      }
#line 570
      if (tmp___2 < 0) {
        goto while_146_continue;
      }
    }
    {
#line 573
    tmp___3 = strlen((char const   *)(de->d_name));
#line 573
    name_len = tmp___3 + 1U;
    }
    {
#line 574
    while (1) {
      while_147_continue: /* CIL Label */ ;
#line 574
      if (! (names_counter + name_len >= names_size)) {
        goto while_147_break;
      }
#line 577
      if (name_len >= page_size) {
#line 578
        names_size += name_len + page_size;
      } else {
#line 580
        names_size += page_size;
      }
      {
#line 582
      new_names = (char *)realloc((void *)names, names_size);
      }
#line 582
      if ((unsigned int )new_names == (unsigned int )((void *)0)) {
        nomem: 
        {
#line 584
        closedir(d);
#line 585
        free((void *)names);
#line 586
        free((void *)files_info);
        }
#line 587
        return ((PureFileInfo *)((void *)0));
      }
#line 589
      names = new_names;
    }
    while_147_break: /* CIL Label */ ;
    }
    {
#line 591
    while (1) {
      while_148_continue: /* CIL Label */ ;
#line 591
      if (! (files_info_counter + 1U >= files_info_size)) {
        goto while_148_break;
      }
      {
#line 594
      files_info_size += page_size / sizeof((*files_info));
#line 595
      new_files_info = (PureFileInfo *)realloc((void *)files_info, files_info_size *
                                                                   sizeof((*files_info)));
      }
#line 595
      if ((unsigned int )new_files_info == (unsigned int )((void *)0)) {
        goto nomem;
      }
#line 599
      files_info = new_files_info;
    }
    while_148_break: /* CIL Label */ ;
    }
    {
#line 601
    memcpy((void */* __restrict  */)(names + names_counter), (void const   */* __restrict  */)(de->d_name),
           name_len);
#line 602
    (*(names + ((names_counter + name_len) - 1U))) = 0;
#line 603
    file_info = files_info + files_info_counter;
#line 604
    file_info->names_pnt = names_pnt;
#line 605
    file_info->name_offset = names_counter;
#line 606
    file_info->size = st.st_size;
#line 607
    file_info->mtime = st.st_mtim.tv_sec;
#line 608
    file_info->mode = st.st_mode;
#line 609
    file_info->nlink = st.st_nlink;
#line 610
    file_info->uid = st.st_uid;
#line 611
    file_info->gid = st.st_gid;
#line 612
    names_counter += name_len;
#line 613
    files_info_counter ++;
    }
  }
  while_146_break: /* CIL Label */ ;
  }
  {
#line 615
  closedir(d);
#line 616
  (files_info + files_info_counter)->name_offset = 4294967295U;
#line 617
  (*names_pnt) = names;
  }
#line 619
  if (opt_t) {
#line 620
    if (opt_r) {
#line 621
      cmp_func = & cmp_rt;
    } else {
#line 623
      cmp_func = & cmp_t;
    }
  } else {
#line 625
    if (opt_S) {
#line 626
      if (opt_r) {
#line 627
        cmp_func = & cmp_rS;
      } else {
#line 629
        cmp_func = & cmp_S;
      }
    } else {
#line 631
      if (opt_r) {
#line 632
        cmp_func = & cmp_r;
      } else {
#line 634
        cmp_func = & cmp;
      }
    }
  }
  {
#line 636
  qsort((void *)files_info, files_info_counter, sizeof((*(files_info + 0))), cmp_func);
  }
#line 638
  return (files_info);
}
}
#line 642 "ls.c"
static void listdir(unsigned int depth , int f , char const   *name ) 
{ PureFileInfo *dir ;
  char *names ;
  PureFileInfo *s ;
  PureFileInfo *r ;
  int d ;
  char *alloca_subdir ;
  size_t sizeof_subdir ;
  int tmp___0 ;
  int *tmp___1 ;
  char *tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;

  {
#line 650
  if (depth >= max_ls_depth) {
#line 651
    return;
  } else {
#line 650
    if (matches >= max_ls_files) {
#line 651
      return;
    }
  }
  {
#line 653
  dir = sreaddir(& names);
  }
#line 653
  if ((unsigned int )dir == (unsigned int )((void *)0)) {
    {
#line 654
    addreply(226, "Sorry, we were unable to read [%s]", name);
    }
#line 655
    return;
  }
#line 657
  s = dir;
  {
#line 658
  while (1) {
    while_149_continue: /* CIL Label */ ;
#line 658
    if (! (s->name_offset != 4294967295U)) {
      goto while_149_break;
    }
#line 659
    if ((int )(*(((*(s->names_pnt)) + s->name_offset) + 0)) != 46) {
      {
#line 660
      d = listfile((PureFileInfo const   *)s, (char const   *)((void *)0));
      }
    } else {
#line 661
      if (opt_a) {
        {
#line 662
        d = listfile((PureFileInfo const   *)s, (char const   *)((void *)0));
        }
#line 663
        if ((int )(*(((*(s->names_pnt)) + s->name_offset) + 1)) == 0) {
#line 665
          d = 0;
        } else {
#line 663
          if ((int )(*(((*(s->names_pnt)) + s->name_offset) + 1)) == 46) {
#line 663
            if ((int )(*(((*(s->names_pnt)) + s->name_offset) + 2)) == 0) {
#line 665
              d = 0;
            }
          }
        }
      } else {
#line 668
        d = 0;
      }
    }
#line 670
    if (! d) {
#line 671
      s->name_offset = 4294967295U;
    }
#line 673
    s ++;
  }
  while_149_break: /* CIL Label */ ;
  }
  {
#line 675
  outputfiles(f);
#line 676
  r = dir;
  }
  {
#line 677
  while (1) {
    while_150_continue: /* CIL Label */ ;
#line 677
    if (opt_R) {
#line 677
      if (! ((unsigned int )r != (unsigned int )s)) {
        goto while_150_break;
      }
    } else {
      goto while_150_break;
    }
#line 678
    if (r->name_offset != 4294967295U) {
      {
#line 678
      tmp___5 = chdir((char const   *)((*(r->names_pnt)) + r->name_offset));
      }
#line 678
      if (! tmp___5) {
        {
#line 680
        sizeof_subdir = 4097U;
#line 682
        alloca_subdir = (char *)__builtin_alloca(sizeof_subdir);
        }
#line 682
        if ((unsigned int )alloca_subdir == (unsigned int )((void *)0)) {
          goto toomany;
        }
        {
#line 685
        tmp___0 = snprintf((char */* __restrict  */)alloca_subdir, sizeof_subdir,
                           (char const   */* __restrict  */)"%s/%s", name, (*(r->names_pnt)) +
                                                                           r->name_offset);
        }
#line 685
        if (tmp___0 >= (int )sizeof_subdir) {
          goto nolist;
        }
#line 690
        if ((int )modern_listings == 0) {
          {
#line 697
          wrstr(f, "\r\n\r\n");
#line 698
          wrstr(f, (char const   *)alloca_subdir);
#line 699
          wrstr(f, ":\r\n\r\n");
          }
        }
        {
#line 704
        listdir(depth + 1U, f, (char const   *)alloca_subdir);
        }
        nolist: 
        {
#line 706
        while (1) {
          while_151_continue: /* CIL Label */ ;
          goto while_151_break;
        }
        while_151_break: /* CIL Label */ ;
        }
#line 707
        if (matches >= max_ls_files) {
          goto toomany;
        }
        {
#line 710
        tmp___4 = chdir("..");
        }
#line 710
        if (tmp___4) {
          {
#line 711
          chdir((char const   *)(wd));
#line 712
          tmp___3 = chdir(name);
          }
#line 712
          if (tmp___3) {
            {
#line 713
            tmp___1 = __errno_location();
#line 713
            tmp___2 = strerror((*tmp___1));
#line 713
            die(421, 3, "chdir: %s", tmp___2);
            }
          }
        }
      }
    }
#line 718
    r ++;
  }
  while_150_break: /* CIL Label */ ;
  }
  toomany: 
  {
#line 721
  free((void *)names);
#line 722
  free((void *)dir);
#line 723
  names = (char *)((void *)0);
  }
#line 724
  return;
}
}
#line 726 "ls.c"
void donlist(char *arg , int on_ctrl_conn , int opt_l_ , int split_args ) 
{ int c ;
  unsigned short const   **tmp ;
  char *tmp___0 ;
  unsigned short const   **tmp___1 ;
  unsigned short const   **tmp___2 ;
  int justone ;
  glob_t g ;
  int a ;
  char *endarg ;
  char *tmp___3 ;
  char *tmp___5 ;
  int tmp___6 ;
  char **path ;
  struct stat st ;
  int tmp___7 ;
  int tmp___8 ;
  char const   *tmp___9 ;
  char const   *tmp___10 ;
  char const   *tmp___11 ;
  char const   *tmp___12 ;
  char const   *tmp___13 ;
  char const   *tmp___14 ;
  char const   *tmp___15 ;
  char const   *tmp___16 ;
  char const   *tmp___17 ;

  {
#line 731
  matches = 0U;
#line 733
  opt_S = 0;
#line 733
  opt_t = opt_S;
#line 733
  opt_r = opt_t;
#line 733
  opt_R = opt_r;
#line 733
  opt_F = opt_R;
#line 733
  opt_d = opt_F;
#line 733
  opt_C = opt_d;
#line 734
  opt_l = opt_l_;
#line 735
  if ((int )force_ls_a != 0) {
#line 736
    opt_a = 1;
  } else {
#line 738
    opt_a = 0;
  }
#line 740
  if (split_args != 0) {
    {
#line 741
    while (1) {
      while_152_continue: /* CIL Label */ ;
      {
#line 741
      tmp = __ctype_b_loc();
      }
#line 741
      if (! ((int const   )(*((*tmp) + (int )((unsigned char )(*arg)))) & 8192)) {
        goto while_152_break;
      }
#line 742
      arg ++;
    }
    while_152_break: /* CIL Label */ ;
    }
    {
#line 744
    while (1) {
      while_153_continue: /* CIL Label */ ;
#line 744
      if (arg) {
#line 744
        if (! ((int )(*arg) == 45)) {
          goto while_153_break;
        }
      } else {
        goto while_153_break;
      }
      {
#line 745
      while (1) {
        while_154_continue: /* CIL Label */ ;
#line 745
        tmp___0 = arg;
#line 745
        arg ++;
#line 745
        if (tmp___0) {
          {
#line 745
          tmp___1 = __ctype_b_loc();
          }
#line 745
          if (! ((int const   )(*((*tmp___1) + (int )((unsigned char )(*arg)))) &
                 8)) {
            goto while_154_break;
          }
        } else {
          goto while_154_break;
        }
#line 747
        if ((int )(*arg) == 97) {
          goto switch_155_97;
        } else {
#line 750
          if ((int )(*arg) == 108) {
            goto switch_155_108;
          } else {
#line 754
            if ((int )(*arg) == 49) {
              goto switch_155_49;
            } else {
#line 757
              if ((int )(*arg) == 67) {
                goto switch_155_67;
              } else {
#line 761
                if ((int )(*arg) == 70) {
                  goto switch_155_70;
                } else {
#line 764
                  if ((int )(*arg) == 82) {
                    goto switch_155_82;
                  } else {
#line 767
                    if ((int )(*arg) == 100) {
                      goto switch_155_100;
                    } else {
#line 770
                      if ((int )(*arg) == 114) {
                        goto switch_155_114;
                      } else {
#line 773
                        if ((int )(*arg) == 116) {
                          goto switch_155_116;
                        } else {
#line 777
                          if ((int )(*arg) == 83) {
                            goto switch_155_83;
                          } else {
#line 746
                            if (0) {
                              switch_155_97: /* CIL Label */ 
#line 748
                              opt_a = 1;
                              goto switch_155_break;
                              switch_155_108: /* CIL Label */ 
#line 751
                              opt_l = 1;
#line 752
                              opt_C = 0;
                              goto switch_155_break;
                              switch_155_49: /* CIL Label */ 
#line 755
                              opt_C = 0;
#line 755
                              opt_l = opt_C;
                              goto switch_155_break;
                              switch_155_67: /* CIL Label */ 
#line 758
                              opt_l = 0;
#line 759
                              opt_C = 1;
                              goto switch_155_break;
                              switch_155_70: /* CIL Label */ 
#line 762
                              opt_F = 1;
                              goto switch_155_break;
                              switch_155_82: /* CIL Label */ 
#line 765
                              opt_R = 1;
                              goto switch_155_break;
                              switch_155_100: /* CIL Label */ 
#line 768
                              opt_d = 1;
                              goto switch_155_break;
                              switch_155_114: /* CIL Label */ 
#line 771
                              opt_r = 1;
                              goto switch_155_break;
                              switch_155_116: /* CIL Label */ 
#line 774
                              opt_t = 1;
#line 775
                              opt_S = 0;
                              goto switch_155_break;
                              switch_155_83: /* CIL Label */ 
#line 778
                              opt_S = 1;
#line 779
                              opt_t = 0;
                              goto switch_155_break;
                            } else {
                              switch_155_break: /* CIL Label */ ;
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
      while_154_break: /* CIL Label */ ;
      }
      {
#line 783
      while (1) {
        while_156_continue: /* CIL Label */ ;
        {
#line 783
        tmp___2 = __ctype_b_loc();
        }
#line 783
        if (! ((int const   )(*((*tmp___2) + (int )((unsigned char )(*arg)))) & 8192)) {
          goto while_156_break;
        }
#line 784
        arg ++;
      }
      while_156_break: /* CIL Label */ ;
      }
    }
    while_153_break: /* CIL Label */ ;
    }
  }
#line 788
  if (on_ctrl_conn == 0) {
    {
#line 789
    opendata();
#line 790
    c = (int )xferfd;
    }
#line 790
    if (c == -1) {
#line 791
      return;
    }
    {
#line 793
    doreply();
    }
#line 794
    if ((int )type == 2) {
      {
#line 795
      addreply_noformat(0, "ASCII");
      }
    }
  } else {
    {
#line 798
    c = 1;
#line 799
    safe_write(c, (void const   *)"213-STAT\r\n", sizeof("213-STAT\r\n") - 1U);
    }
  }
#line 801
  if ((unsigned int )arg != (unsigned int )((void *)0)) {
#line 801
    if ((int )(*arg) != 0) {
#line 804
      justone = 1;
      {
#line 806
      while (1) {
        while_157_continue: /* CIL Label */ ;
#line 811
        if (split_args == 0) {
#line 812
          endarg = (char *)((void *)0);
        } else {
          {
#line 813
          tmp___5 = strchr((char const   *)arg, ' ');
#line 813
          endarg = tmp___5;
          }
#line 813
          if ((unsigned int )endarg != (unsigned int )((void *)0)) {
#line 814
            tmp___3 = endarg;
#line 814
            endarg ++;
#line 814
            (*tmp___3) = 0;
#line 815
            justone = 0;
          }
        }
        {
#line 825
        alarm(17U);
        }
#line 826
        if (opt_a) {
#line 826
          tmp___6 = 0;
        } else {
#line 826
          tmp___6 = 0;
        }
        {
#line 826
        a = sglob(arg, 128 | tmp___6, (int (*)(char const   * , int  ))((void *)0),
                  & g, (unsigned long )(max_ls_files + 2U), (int )(max_ls_depth *
                                                                   2U));
#line 829
        alarm(0U);
        }
#line 830
        if (a == 0) {
#line 833
          path = g.gl_pathv;
#line 834
          if (path) {
#line 834
            if ((*(path + 0))) {
#line 834
              if ((*(path + 1))) {
#line 835
                justone = 0;
              }
            }
          }
          {
#line 837
          while (1) {
            while_158_continue: /* CIL Label */ ;
#line 837
            if (path) {
#line 837
              if (! (*path)) {
                goto while_158_break;
              }
            } else {
              goto while_158_break;
            }
            {
#line 840
            tmp___7 = stat((char const   */* __restrict  */)(*path), (struct stat */* __restrict  */)(& st));
            }
#line 840
            if (tmp___7 == 0) {
#line 841
              if (opt_d) {
                {
#line 842
                listfile((PureFileInfo const   *)((void *)0), (char const   *)(*path));
#line 843
                (*((*path))) = 0;
                }
              } else {
#line 841
                if (! ((st.st_mode & 61440U) == 16384U)) {
                  {
#line 842
                  listfile((PureFileInfo const   *)((void *)0), (char const   *)(*path));
#line 843
                  (*((*path))) = 0;
                  }
                }
              }
            } else {
#line 846
              (*((*path))) = 0;
            }
#line 848
            path ++;
          }
          while_158_break: /* CIL Label */ ;
          }
          {
#line 850
          outputfiles(c);
#line 851
          path = g.gl_pathv;
          }
          {
#line 852
          while (1) {
            while_159_continue: /* CIL Label */ ;
#line 852
            if (path) {
#line 852
              if (! (*path)) {
                goto while_159_break;
              }
            } else {
              goto while_159_break;
            }
#line 853
            if (matches >= max_ls_files) {
              goto while_159_break;
            }
#line 856
            if ((*((*path)))) {
#line 857
              if (! justone) {
                {
#line 863
                wrstr(c, "\r\n\r\n");
#line 864
                wrstr(c, (char const   *)(*path));
#line 865
                wrstr(c, ":\r\n\r\n");
                }
              }
              {
#line 868
              tmp___8 = chdir((char const   *)(*path));
              }
#line 868
              if (! tmp___8) {
                {
#line 869
                listdir(0U, c, (char const   *)(*path));
#line 870
                chdir((char const   *)(wd));
                }
              }
            }
#line 873
            path ++;
          }
          while_159_break: /* CIL Label */ ;
          }
        } else {
#line 876
          if (a == -1) {
            {
#line 877
            addreply(226, "Out of memory during globbing of %s", arg);
#line 878
            addreply_noformat(0, "(This probably means \"Permission denied\")");
            }
          } else {
#line 879
            if (a == -2) {
              {
#line 880
              addreply(226, "Read error during globbing of %s", arg);
              }
            } else {
#line 881
              if (a != -3) {
                {
#line 882
                addreply(226, "Read error during globbing of %s", arg);
#line 883
                addreply_noformat(0, "(This probably means \"Permission denied\")");
                }
              }
            }
          }
        }
        {
#line 886
        globfree(& g);
#line 887
        arg = endarg;
        }
#line 806
        if (! ((unsigned int )arg != (unsigned int )((void *)0))) {
          goto while_157_break;
        }
      }
      while_157_break: /* CIL Label */ ;
      }
    } else {
      goto _L;
    }
  } else {
    _L: 
#line 890
    if (opt_d) {
      {
#line 891
      listfile((PureFileInfo const   *)((void *)0), ".");
      }
    } else {
      {
#line 893
      listdir(0U, c, ".");
      }
    }
    {
#line 895
    outputfiles(c);
    }
  }
  {
#line 897
  wrstr(c, (char const   *)((void *)0));
  }
#line 898
  if (on_ctrl_conn == 0) {
    {
#line 899
    close(c);
    }
  } else {
    {
#line 901
    addreply_noformat(213, "End.");
    }
    goto end;
  }
#line 904
  if (opt_a) {
    goto _L___0;
  } else {
#line 904
    if (opt_C) {
      goto _L___0;
    } else {
#line 904
      if (opt_d) {
        goto _L___0;
      } else {
#line 904
        if (opt_F) {
          goto _L___0;
        } else {
#line 904
          if (opt_l) {
            goto _L___0;
          } else {
#line 904
            if (opt_r) {
              goto _L___0;
            } else {
#line 904
              if (opt_R) {
                goto _L___0;
              } else {
#line 904
                if (opt_t) {
                  goto _L___0;
                } else {
#line 904
                  if (opt_S) {
                    _L___0: 
#line 906
                    if (opt_t) {
#line 906
                      tmp___9 = "-t";
                    } else {
#line 906
                      tmp___9 = "";
                    }
#line 906
                    if (opt_S) {
#line 906
                      tmp___10 = "-S ";
                    } else {
#line 906
                      tmp___10 = "";
                    }
#line 906
                    if (opt_R) {
#line 906
                      tmp___11 = "-R ";
                    } else {
#line 906
                      tmp___11 = "";
                    }
#line 906
                    if (opt_r) {
#line 906
                      tmp___12 = "-r ";
                    } else {
#line 906
                      tmp___12 = "";
                    }
#line 906
                    if (opt_l) {
#line 906
                      tmp___13 = "-l ";
                    } else {
#line 906
                      tmp___13 = "";
                    }
#line 906
                    if (opt_F) {
#line 906
                      tmp___14 = "-F ";
                    } else {
#line 906
                      tmp___14 = "";
                    }
#line 906
                    if (opt_d) {
#line 906
                      tmp___15 = "-d ";
                    } else {
#line 906
                      tmp___15 = "";
                    }
#line 906
                    if (opt_C) {
#line 906
                      tmp___16 = "-C ";
                    } else {
#line 906
                      tmp___16 = "";
                    }
#line 906
                    if (opt_a) {
#line 906
                      tmp___17 = "-a ";
                    } else {
#line 906
                      tmp___17 = "";
                    }
                    {
#line 906
                    addreply(0, "Options: %s%s%s%s%s%s%s%s%s", tmp___17, tmp___16,
                             tmp___15, tmp___14, tmp___13, tmp___12, tmp___11, tmp___10,
                             tmp___9);
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
#line 915
  if (matches >= max_ls_files) {
    {
#line 916
    addreply(226, "Output truncated to %u matches", matches);
    }
  } else {
    {
#line 918
    addreply(226, "%u matches total", matches);
    }
  }
  end: 
  {
#line 921
  chdir((char const   *)(wd));
  }
#line 922
  return;
}
}
#line 1 "cil-jn1JCqAY.o"
/* #pragma merger(0,"/tmp/cil-ndLkv3HV.i","") */
#line 1 "src/pure_ftpd-parser.o_saved.c"
/* #pragma merger(112422804,"./parser.i","-g,-O2") */
#line 1 "cil-PoeqXARn.o"
/* #pragma merger(0,"/tmp/cil-grbrajRA.i","") */
#line 1 "src/pure_ftpd-bsd-glob.o_saved.c"
/* #pragma merger(112422804,"./bsd-glob.i","-g,-O2") */
#line 82 "bsd-glob.h"
int glob(char const   *pattern , int flags , int (*errfunc)(char const   * , int  ) ,
         glob_t *pglob ) ;
#line 113 "bsd-glob.c"
static int compare(void const   *p , void const   *q ) ;
#line 114
static int g_Ctoc(Char const   *str , char *buf , unsigned int len ) ;
#line 115
static int g_lstat(Char *fn , struct stat *sb ) ;
#line 116
static DIR *g_opendir(Char *str ) ;
#line 117
static Char const   *g_strchr(Char const   *str , int ch ) ;
#line 118
static int glob0(Char const   *pattern , glob_t *pglob ) ;
#line 119
static int glob1(Char *pattern , Char *pattern_last , glob_t *pglob , size_t *limitp ) ;
#line 120
static int glob2(Char *pathbuf , Char *pathbuf_last , Char *pathend , Char *pathend_last ,
                 Char *pattern , Char *pattern_last , glob_t *pglob , size_t *limitp ,
                 int recursion ) ;
#line 122
static int glob3(Char *pathbuf , Char *pathbuf_last , Char *pathend , Char *pathend_last ,
                 Char *pattern , Char *restpattern , Char *restpattern_last , glob_t *pglob ,
                 size_t *limitp , int recursion ) ;
#line 124
static int globextend(Char const   *path , glob_t *pglob , size_t *limitp ) ;
#line 128
static int globexp1(Char const   *pattern , glob_t *pglob , int recursion ) ;
#line 129
static int globexp2(Char const   *ptr , Char const   *pattern , glob_t *pglob , int *rv ,
                    int recursion ) ;
#line 130
static int match(Char *name , Char *pat , Char *patend ) ;
#line 131
static int glob_(char const   *pattern , int flags , int (*errfunc)(char const   * ,
                                                                    int  ) , glob_t *pglob ,
                 unsigned long maxfiles , int maxdepth ) ;
#line 136 "bsd-glob.c"
static int glob_(char const   *pattern , int flags , int (*errfunc)(char const   * ,
                                                                    int  ) , glob_t *pglob ,
                 unsigned long maxfiles , int maxdepth ) 
{ unsigned char const   *patnext ;
  int c ;
  Char *bufnext ;
  Char *bufend ;
  Char patbuf[4097] ;
  Char *tmp ;
  unsigned char const   *tmp___0 ;
  unsigned char const   *tmp___1 ;
  Char *tmp___2 ;
  Char *tmp___3 ;
  unsigned char const   *tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;

  {
#line 145
  pglob->gl_maxdepth = maxdepth;
#line 146
  pglob->gl_maxfiles = maxfiles;
#line 147
  patnext = (unsigned char const   *)pattern;
#line 148
  pglob->gl_flags = flags & -257;
#line 149
  pglob->gl_errfunc = errfunc;
#line 150
  pglob->gl_matchc = 0;
#line 151
  pglob->gl_pathc = 0;
#line 152
  pglob->gl_pathv = (char **)((void *)0);
#line 154
  bufnext = patbuf;
#line 155
  bufend = bufnext + 4096;
#line 156
  if (flags & 4096) {
    {
#line 157
    while (1) {
      while_160_continue: /* CIL Label */ ;
#line 157
      if ((unsigned int )bufnext < (unsigned int )bufend) {
#line 157
        tmp___0 = patnext;
#line 157
        patnext ++;
#line 157
        c = (int )(*tmp___0);
#line 157
        if (! (c != 0)) {
          goto while_160_break;
        }
      } else {
        goto while_160_break;
      }
#line 158
      tmp = bufnext;
#line 158
      bufnext ++;
#line 158
      (*tmp) = (unsigned short )c;
    }
    while_160_break: /* CIL Label */ ;
    }
  } else {
    {
#line 162
    while (1) {
      while_161_continue: /* CIL Label */ ;
#line 162
      if ((unsigned int )bufnext < (unsigned int )bufend) {
#line 162
        tmp___4 = patnext;
#line 162
        patnext ++;
#line 162
        c = (int )(*tmp___4);
#line 162
        if (! (c != 0)) {
          goto while_161_break;
        }
      } else {
        goto while_161_break;
      }
#line 163
      if (c == 92) {
#line 164
        tmp___1 = patnext;
#line 164
        patnext ++;
#line 164
        c = (int )(*tmp___1);
#line 164
        if (c == 0) {
#line 165
          c = '\\';
#line 166
          patnext --;
        }
#line 168
        tmp___2 = bufnext;
#line 168
        bufnext ++;
#line 168
        (*tmp___2) = (unsigned short )(c | 16384);
      } else {
#line 170
        tmp___3 = bufnext;
#line 170
        bufnext ++;
#line 170
        (*tmp___3) = (unsigned short )c;
      }
    }
    while_161_break: /* CIL Label */ ;
    }
  }
#line 174
  (*bufnext) = (unsigned short )'\000';
#line 176
  if (flags & 128) {
    {
#line 177
    tmp___5 = globexp1((Char const   *)(patbuf), pglob, 0);
    }
#line 177
    return (tmp___5);
  }
  {
#line 179
  tmp___6 = glob0((Char const   *)(patbuf), pglob);
  }
#line 179
  return (tmp___6);
}
}
#line 182 "bsd-glob.c"
int glob(char const   *pattern , int flags , int (*errfunc)(char const   * , int  ) ,
         glob_t *pglob ) 
{ int tmp ;

  {
  {
#line 186
  tmp = glob_(pattern, flags, errfunc, pglob, 4294967295UL, 0);
  }
#line 186
  return (tmp);
}
}
#line 189 "bsd-glob.c"
int sglob(char *pattern , int flags , int (*errfunc)(char const   * , int  ) , glob_t *pglob ,
          unsigned long maxfiles , int maxdepth ) 
{ int tmp ;

  {
  if (0 == pattern) {
    INV6: /* CIL Label */ 
    assert(0);
  }
  {
#line 195
  simplify(pattern);
#line 196
  tmp = glob_((char const   *)pattern, flags, errfunc, pglob, maxfiles, maxdepth);
  }
#line 196
  return (tmp);
}
}
#line 204 "bsd-glob.c"
static int globexp1(Char const   *pattern , glob_t *pglob , int recursion ) 
{ Char const   *ptr ;
  int rv ;
  int *tmp ;
  int tmp___0 ;
  int tmp___1 ;
  Char const   *tmp___2 ;
  int tmp___3 ;

  {
#line 206
  ptr = pattern;
#line 207
  rv = 0;
#line 209
  if (pglob->gl_maxdepth > 0) {
#line 209
    if (recursion > pglob->gl_maxdepth) {
      {
#line 210
      tmp = __errno_location();
#line 210
      (*tmp) = 0;
      }
#line 211
      return (0);
    }
  }
#line 214
  if ((int const   )(*(pattern + 0)) == 123) {
#line 214
    if ((int const   )(*(pattern + 1)) == 125) {
#line 214
      if ((int const   )(*(pattern + 2)) == 0) {
        {
#line 215
        tmp___0 = glob0(pattern, pglob);
        }
#line 215
        return (tmp___0);
      }
    }
  }
  {
#line 217
  while (1) {
    while_162_continue: /* CIL Label */ ;
    {
#line 217
    tmp___2 = g_strchr(ptr, '{');
#line 217
    ptr = tmp___2;
    }
#line 217
    if (! ((unsigned int )ptr != (unsigned int )((void *)0))) {
      goto while_162_break;
    }
    {
#line 219
    tmp___1 = globexp2(ptr, pattern, pglob, & rv, recursion + 1);
    }
#line 219
    if (! tmp___1) {
#line 220
      return (rv);
    }
  }
  while_162_break: /* CIL Label */ ;
  }
  {
#line 223
  tmp___3 = glob0(pattern, pglob);
  }
#line 223
  return (tmp___3);
}
}
#line 232 "bsd-glob.c"
static int globexp2(Char const   *ptr , Char const   *pattern , glob_t *pglob , int *rv ,
                    int recursion ) 
{ int i ;
  Char *lm ;
  Char *ls ;
  Char const   *pe ;
  Char const   *pm ;
  Char const   *pl ;
  Char patbuf[4097] ;
  int *tmp ;
  Char *tmp___0 ;
  Char const   *tmp___1 ;
  Char const   *tmp___2 ;
  Char const   *tmp___3 ;
  Char *tmp___4 ;
  Char const   *tmp___5 ;
  Char *tmp___6 ;
  Char const   *tmp___7 ;

  {
  if (0 == ptr) {
    INV7: /* CIL Label */ 
    assert(0);
  }
#line 241
  if (pglob->gl_maxdepth > 0) {
#line 241
    if (recursion > pglob->gl_maxdepth) {
      {
#line 242
      tmp = __errno_location();
#line 242
      (*tmp) = 0;
      }
#line 243
      return (0);
    }
  }
#line 246
  lm = patbuf;
#line 246
  pm = pattern;
  {
#line 246
  while (1) {
    while_163_continue: /* CIL Label */ ;
#line 246
    if (! ((unsigned int )pm != (unsigned int )ptr)) {
      goto while_163_break;
    }
#line 246
    tmp___0 = lm;
#line 246
    lm ++;
#line 246
    tmp___1 = pm;
#line 246
    pm ++;
#line 246
    (*tmp___0) = (*tmp___1);
  }
  while_163_break: /* CIL Label */ ;
  }
#line 247
  (*lm) = (unsigned short )'\000';
#line 248
  ls = lm;
#line 251
  i = 0;
#line 251
  ptr ++;
#line 251
  pe = ptr;
  {
#line 251
  while (1) {
    while_164_continue: /* CIL Label */ ;
#line 251
    if (! (*pe)) {
      goto while_164_break;
    }
#line 252
    if ((int const   )(*pe) == 91) {
#line 254
      tmp___2 = pe;
#line 254
      pe ++;
#line 254
      pm = tmp___2;
      {
#line 254
      while (1) {
        while_165_continue: /* CIL Label */ ;
#line 254
        if ((int const   )(*pe) != 93) {
#line 254
          if (! ((int const   )(*pe) != 0)) {
            goto while_165_break;
          }
        } else {
          goto while_165_break;
        }
#line 254
        pe ++;
      }
      while_165_break: /* CIL Label */ ;
      }
#line 255
      if ((int const   )(*pe) == 0) {
#line 260
        pe = pm;
      }
    } else {
#line 262
      if ((int const   )(*pe) == 123) {
#line 263
        i ++;
      } else {
#line 264
        if ((int const   )(*pe) == 125) {
#line 265
          if (i == 0) {
            goto while_164_break;
          }
#line 267
          i --;
        }
      }
    }
#line 251
    pe ++;
  }
  while_164_break: /* CIL Label */ ;
  }
#line 271
  if (i != 0) {
    {
#line 272
    (*rv) = glob0((Char const   *)(patbuf), pglob);
    }
#line 273
    return (0);
  } else {
#line 271
    if ((int const   )(*pe) == 0) {
      {
#line 272
      (*rv) = glob0((Char const   *)(patbuf), pglob);
      }
#line 273
      return (0);
    }
  }
#line 276
  i = 0;
#line 276
  pm = ptr;
#line 276
  pl = pm;
  {
#line 276
  while (1) {
    while_166_continue: /* CIL Label */ ;
#line 276
    if (! ((unsigned int )pm <= (unsigned int )pe)) {
      goto while_166_break;
    }
#line 278
    if ((int )(*pm) == 91) {
      goto switch_167_91;
    } else {
#line 289
      if ((int )(*pm) == 123) {
        goto switch_167_123;
      } else {
#line 293
        if ((int )(*pm) == 125) {
          goto switch_167_125;
        } else {
#line 299
          if ((int )(*pm) == 44) {
            goto switch_167_44;
          } else {
            {
            goto switch_167_default;
#line 277
            if (0) {
              switch_167_91: /* CIL Label */ 
#line 280
              tmp___3 = pm;
#line 280
              pm ++;
#line 280
              pl = tmp___3;
              {
#line 280
              while (1) {
                while_168_continue: /* CIL Label */ ;
#line 280
                if ((int const   )(*pm) != 93) {
#line 280
                  if (! ((int const   )(*pm) != 0)) {
                    goto while_168_break;
                  }
                } else {
                  goto while_168_break;
                }
#line 280
                pm ++;
              }
              while_168_break: /* CIL Label */ ;
              }
#line 281
              if ((int const   )(*pm) == 0) {
#line 286
                pm = pl;
              }
              goto switch_167_break;
              switch_167_123: /* CIL Label */ 
#line 291
              i ++;
              goto switch_167_break;
              switch_167_125: /* CIL Label */ ;
#line 295
              if (i) {
#line 296
                i --;
                goto switch_167_break;
              }
              switch_167_44: /* CIL Label */ ;
#line 301
              if (i) {
#line 301
                if ((int const   )(*pm) == 44) {
                  goto switch_167_break;
                } else {
                  goto _L;
                }
              } else {
                _L: 
#line 305
                lm = ls;
                {
#line 305
                while (1) {
                  while_169_continue: /* CIL Label */ ;
#line 305
                  if (! ((unsigned int )pl < (unsigned int )pm)) {
                    goto while_169_break;
                  }
#line 305
                  tmp___4 = lm;
#line 305
                  lm ++;
#line 305
                  tmp___5 = pl;
#line 305
                  pl ++;
#line 305
                  (*tmp___4) = (*tmp___5);
                }
                while_169_break: /* CIL Label */ ;
                }
#line 311
                pl = pe + 1;
                {
#line 311
                while (1) {
                  while_170_continue: /* CIL Label */ ;
#line 311
                  tmp___6 = lm;
#line 311
                  lm ++;
#line 311
                  tmp___7 = pl;
#line 311
                  pl ++;
#line 311
                  (*tmp___6) = (*tmp___7);
#line 311
                  if (! ((int )(*tmp___6) != 0)) {
                    goto while_170_break;
                  }
                }
                while_170_break: /* CIL Label */ ;
                }
                {
#line 314
                (*rv) = globexp1((Char const   *)(patbuf), pglob, recursion + 1);
#line 317
                pl = pm + 1;
                }
              }
              goto switch_167_break;
              switch_167_default: /* CIL Label */ ;
              goto switch_167_break;
            } else {
              switch_167_break: /* CIL Label */ ;
            }
            }
          }
        }
      }
    }
#line 276
    pm ++;
  }
  while_166_break: /* CIL Label */ ;
  }
#line 325
  (*rv) = 0;
#line 326
  return (0);
}
}
#line 402 "bsd-glob.c"
static int glob0(Char const   *pattern , glob_t *pglob ) 
{ Char const   *qpatnext ;
  int c ;
  int err ;
  int oldpathc ;
  Char *bufnext ;
  Char patbuf[4097] ;
  size_t limit ;
  Char *tmp ;
  Char const   *tmp___0 ;
  Char *tmp___1 ;
  Char *tmp___2 ;
  Char const   *tmp___3 ;
  Char *tmp___4 ;
  Char *tmp___5 ;
  Char *tmp___6 ;
  Char const   *tmp___7 ;
  Char *tmp___8 ;
  Char *tmp___9 ;
  Char *tmp___10 ;
  Char *tmp___11 ;
  Char const   *tmp___12 ;

  {
#line 407
  limit = 0U;
#line 412
  qpatnext = pattern;
#line 414
  oldpathc = pglob->gl_pathc;
#line 415
  bufnext = patbuf;
  {
#line 418
  while (1) {
    while_171_continue: /* CIL Label */ ;
#line 418
    tmp___12 = qpatnext;
#line 418
    qpatnext ++;
#line 418
    c = (int )(*tmp___12);
#line 418
    if (! (c != 0)) {
      goto while_171_break;
    }
#line 420
    if (c == 91) {
      goto switch_172_91;
    } else {
#line 446
      if (c == 63) {
        goto switch_172_63;
      } else {
#line 450
        if (c == 42) {
          goto switch_172_42;
        } else {
          {
          goto switch_172_default;
#line 419
          if (0) {
            switch_172_91: /* CIL Label */ 
#line 421
            c = (int )(*qpatnext);
#line 422
            if (c == 33) {
#line 423
              qpatnext ++;
            }
#line 424
            if ((int const   )(*qpatnext) == 0) {
              goto _L;
            } else {
              {
#line 424
              tmp___0 = g_strchr(qpatnext + 1, ']');
              }
#line 424
              if ((unsigned int )tmp___0 == (unsigned int )((void *)0)) {
                _L: 
#line 426
                tmp = bufnext;
#line 426
                bufnext ++;
#line 426
                (*tmp) = (unsigned short )'[';
#line 427
                if (c == 33) {
#line 428
                  qpatnext --;
                }
                goto switch_172_break;
              }
            }
#line 431
            tmp___1 = bufnext;
#line 431
            bufnext ++;
#line 431
            (*tmp___1) = 32859;
#line 432
            if (c == 33) {
#line 433
              tmp___2 = bufnext;
#line 433
              bufnext ++;
#line 433
              (*tmp___2) = 32801;
            }
#line 434
            tmp___3 = qpatnext;
#line 434
            qpatnext ++;
#line 434
            c = (int )(*tmp___3);
            {
#line 435
            while (1) {
              while_173_continue: /* CIL Label */ ;
#line 436
              tmp___4 = bufnext;
#line 436
              bufnext ++;
#line 436
              (*tmp___4) = (unsigned short )(c & 255);
#line 437
              if ((int const   )(*qpatnext) == 45) {
#line 437
                c = (int )(*(qpatnext + 1));
#line 437
                if (c != 93) {
#line 438
                  tmp___5 = bufnext;
#line 438
                  bufnext ++;
#line 438
                  (*tmp___5) = 32813;
#line 439
                  tmp___6 = bufnext;
#line 439
                  bufnext ++;
#line 439
                  (*tmp___6) = (unsigned short )(c & 255);
#line 440
                  qpatnext += 2;
                }
              }
#line 435
              tmp___7 = qpatnext;
#line 435
              qpatnext ++;
#line 435
              c = (int )(*tmp___7);
#line 435
              if (! (c != 93)) {
                goto while_173_break;
              }
            }
            while_173_break: /* CIL Label */ ;
            }
#line 443
            pglob->gl_flags |= 256;
#line 444
            tmp___8 = bufnext;
#line 444
            bufnext ++;
#line 444
            (*tmp___8) = 32861;
            goto switch_172_break;
            switch_172_63: /* CIL Label */ 
#line 447
            pglob->gl_flags |= 256;
#line 448
            tmp___9 = bufnext;
#line 448
            bufnext ++;
#line 448
            (*tmp___9) = 32831;
            goto switch_172_break;
            switch_172_42: /* CIL Label */ 
#line 451
            pglob->gl_flags |= 256;
#line 455
            if ((unsigned int )bufnext == (unsigned int )(patbuf)) {
#line 456
              tmp___10 = bufnext;
#line 456
              bufnext ++;
#line 456
              (*tmp___10) = 32810;
            } else {
#line 455
              if ((int )(*(bufnext + -1)) != 32810) {
#line 456
                tmp___10 = bufnext;
#line 456
                bufnext ++;
#line 456
                (*tmp___10) = 32810;
              }
            }
            goto switch_172_break;
            switch_172_default: /* CIL Label */ 
#line 460
            tmp___11 = bufnext;
#line 460
            bufnext ++;
#line 460
            (*tmp___11) = (unsigned short )(c & 255);
            goto switch_172_break;
          } else {
            switch_172_break: /* CIL Label */ ;
          }
          }
        }
      }
    }
  }
  while_171_break: /* CIL Label */ ;
  }
  {
#line 464
  (*bufnext) = (unsigned short )'\000';
#line 466
  err = glob1(patbuf, patbuf + 4096, pglob, & limit);
  }
#line 466
  if (err != 0) {
#line 467
    return (err);
  }
#line 476
  if (pglob->gl_pathc == oldpathc) {
#line 477
    return (-3);
  }
#line 479
  if (! (pglob->gl_flags & 32)) {
    {
#line 480
    qsort((void *)(pglob->gl_pathv + oldpathc), (unsigned int )(pglob->gl_pathc -
                                                                oldpathc), sizeof(char *),
          & compare);
    }
  }
#line 483
  return (0);
}
}
#line 486 "bsd-glob.c"
static int compare(void const   *p , void const   *q ) 
{ size_t __s1_len ;
  size_t __s2_len ;
  int tmp___3 ;
  size_t tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;

  {
#line 488
  if (0) {
    {
#line 488
    __s1_len = strlen((*((char const   **)p)));
#line 488
    __s2_len = strlen((*((char const   **)q)));
    }
#line 488
    if (! ((unsigned int )((void const   *)((*((char const   **)p)) + 1)) - (unsigned int )((void const   *)(*((char const   **)p))) ==
           1U)) {
      goto _L___0;
    } else {
#line 488
      if (__s1_len >= 4U) {
        _L___0: 
#line 488
        if (! ((unsigned int )((void const   *)((*((char const   **)q)) + 1)) - (unsigned int )((void const   *)(*((char const   **)q))) ==
               1U)) {
#line 488
          tmp___6 = 1;
        } else {
#line 488
          if (__s2_len >= 4U) {
#line 488
            tmp___6 = 1;
          } else {
#line 488
            tmp___6 = 0;
          }
        }
      } else {
#line 488
        tmp___6 = 0;
      }
    }
#line 488
    if (tmp___6) {
#line 488
      if (__s1_len < __s2_len) {
#line 488
        tmp___4 = __s1_len;
      } else {
#line 488
        tmp___4 = __s2_len;
      }
      {
#line 488
      tmp___3 = memcmp((void const   *)(*((char const   **)p)), (void const   *)(*((char const   **)q)),
                       tmp___4 + 1U);
      }
    } else {
      {
#line 488
      tmp___5 = strcmp((*((char const   **)p)), (*((char const   **)q)));
#line 488
      tmp___3 = tmp___5;
      }
    }
  } else {
    {
#line 488
    tmp___5 = strcmp((*((char const   **)p)), (*((char const   **)q)));
#line 488
    tmp___3 = tmp___5;
    }
  }
#line 488
  return (tmp___3);
}
}
#line 491 "bsd-glob.c"
static int glob1(Char *pattern , Char *pattern_last , glob_t *pglob , size_t *limitp ) 
{ Char pathbuf[4097] ;
  int tmp ;

  {
#line 497
  if ((int )(*pattern) == 0) {
#line 498
    return (0);
  }
  {
#line 500
  tmp = glob2(pathbuf, pathbuf + 4096, pathbuf, pathbuf + 4096, pattern, pattern_last,
              pglob, limitp, 0);
  }
#line 500
  return (tmp);
}
}
#line 510 "bsd-glob.c"
static int glob2(Char *pathbuf , Char *pathbuf_last , Char *pathend , Char *pathend_last ,
                 Char *pattern , Char *pattern_last , glob_t *pglob , size_t *limitp ,
                 int recursion ) 
{ struct stat sb ;
  Char *p ;
  Char *q ;
  int anymeta ;
  int *tmp ;
  int tmp___0 ;
  int tmp___1 ;
  Char *tmp___2 ;
  Char *tmp___3 ;
  Char *tmp___4 ;
  Char *tmp___5 ;
  int tmp___6 ;

  {
#line 522
  if (pglob->gl_maxdepth > 0) {
#line 522
    if (recursion > pglob->gl_maxdepth) {
      {
#line 523
      tmp = __errno_location();
#line 523
      (*tmp) = 0;
      }
#line 524
      return (-1);
    }
  }
#line 530
  anymeta = 0;
  {
#line 530
  while (1) {
    while_174_continue: /* CIL Label */ ;
#line 531
    if ((int )(*pattern) == 0) {
      {
#line 532
      (*pathend) = (unsigned short )'\000';
#line 533
      tmp___0 = g_lstat(pathbuf, & sb);
      }
#line 533
      if (tmp___0) {
#line 534
        return (0);
      }
      {
#line 536
      pglob->gl_matchc ++;
#line 537
      tmp___1 = globextend((Char const   *)pathbuf, pglob, limitp);
      }
#line 537
      return (tmp___1);
    }
#line 541
    q = pathend;
#line 542
    p = pattern;
    {
#line 543
    while (1) {
      while_175_continue: /* CIL Label */ ;
#line 543
      if ((int )(*p) != 0) {
#line 543
        if (! ((int )(*p) != 47)) {
          goto while_175_break;
        }
      } else {
        goto while_175_break;
      }
#line 544
      if (((int )(*p) & 32768) != 0) {
#line 545
        anymeta = 1;
      }
#line 546
      if ((unsigned int )(q + 1) > (unsigned int )pathend_last) {
#line 547
        return (1);
      }
#line 548
      tmp___2 = q;
#line 548
      q ++;
#line 548
      tmp___3 = p;
#line 548
      p ++;
#line 548
      (*tmp___2) = (*tmp___3);
    }
    while_175_break: /* CIL Label */ ;
    }
#line 551
    if (! anymeta) {
#line 552
      pathend = q;
#line 553
      pattern = p;
      {
#line 554
      while (1) {
        while_176_continue: /* CIL Label */ ;
#line 554
        if (! ((int )(*pattern) == 47)) {
          goto while_176_break;
        }
#line 555
        if ((unsigned int )(pathend + 1) > (unsigned int )pathend_last) {
#line 556
          return (1);
        }
#line 557
        tmp___4 = pathend;
#line 557
        pathend ++;
#line 557
        tmp___5 = pattern;
#line 557
        pattern ++;
#line 557
        (*tmp___4) = (*tmp___5);
      }
      while_176_break: /* CIL Label */ ;
      }
    } else {
      {
#line 561
      tmp___6 = glob3(pathbuf, pathbuf_last, pathend, pathend_last, pattern, p, pattern_last,
                      pglob, limitp, recursion + 1);
      }
#line 561
      return (tmp___6);
    }
  }
  while_174_break: /* CIL Label */ ;
  }
#line 565
  return (0);
}
}
#line 568 "bsd-glob.c"
static int glob3(Char *pathbuf , Char *pathbuf_last , Char *pathend , Char *pathend_last ,
                 Char *pattern , Char *restpattern , Char *restpattern_last , glob_t *pglob ,
                 size_t *limitp , int recursion ) 
{ struct dirent *dp ;
  DIR *dirp ;
  int err ;
  char buf[4097] ;
  int *tmp ;
  int tmp___0 ;
  int *tmp___1 ;
  int tmp___2 ;
  unsigned char *sc ;
  Char *dc ;
  int tmp___3 ;
  Char *tmp___4 ;
  unsigned char *tmp___5 ;
  int tmp___6 ;

  {
#line 579
  if ((unsigned int )pathend > (unsigned int )pathend_last) {
#line 580
    return (1);
  }
  {
#line 582
  (*pathend) = (unsigned short )'\000';
#line 583
  tmp = __errno_location();
#line 583
  (*tmp) = 0;
  }
#line 585
  if (pglob->gl_maxdepth > 0) {
#line 585
    if (recursion > pglob->gl_maxdepth) {
#line 586
      return (-1);
    }
  }
  {
#line 589
  dirp = g_opendir(pathbuf);
  }
#line 589
  if ((unsigned int )dirp == (unsigned int )((void *)0)) {
#line 591
    if (pglob->gl_errfunc) {
      {
#line 592
      tmp___0 = g_Ctoc((Char const   *)pathbuf, buf, sizeof(buf));
      }
#line 592
      if (tmp___0) {
#line 593
        return (-2);
      }
      {
#line 595
      tmp___1 = __errno_location();
#line 595
      tmp___2 = ((*(pglob->gl_errfunc)))((char const   *)(buf), (*tmp___1));
      }
#line 595
      if (tmp___2) {
#line 597
        return (-2);
      } else {
#line 595
        if (pglob->gl_flags & 4) {
#line 597
          return (-2);
        }
      }
    }
#line 600
    return (0);
  }
#line 603
  err = 0;
  {
#line 605
  while (1) {
    while_177_continue: /* CIL Label */ ;
    {
#line 605
    dp = readdir(dirp);
    }
#line 605
    if (! dp) {
      goto while_177_break;
    }
#line 610
    if ((int )dp->d_name[0] == 46) {
#line 610
      if ((int )(*pattern) != 46) {
        goto while_177_continue;
      }
    }
    {
#line 614
    tmp___3 = checkprintable((char const   *)(dp->d_name));
    }
#line 614
    if (tmp___3 != 0) {
      goto while_177_continue;
    }
#line 618
    dc = pathend;
#line 619
    sc = (unsigned char *)(dp->d_name);
    {
#line 620
    while (1) {
      while_178_continue: /* CIL Label */ ;
#line 620
      if ((unsigned int )dc < (unsigned int )pathend_last) {
#line 620
        tmp___4 = dc;
#line 620
        dc ++;
#line 620
        tmp___5 = sc;
#line 620
        sc ++;
#line 620
        (*tmp___4) = (unsigned short )(*tmp___5);
#line 620
        if (! ((int )(*tmp___4) != 0)) {
          goto while_178_break;
        }
      } else {
        goto while_178_break;
      }
    }
    while_178_break: /* CIL Label */ ;
    }
#line 621
    if ((unsigned int )dc >= (unsigned int )pathend_last) {
#line 622
      (*dc) = (unsigned short )'\000';
#line 623
      err = 1;
      goto while_177_break;
    }
    {
#line 627
    tmp___6 = match(pathend, pattern, restpattern);
    }
#line 627
    if (! tmp___6) {
#line 628
      (*pathend) = (unsigned short )'\000';
      goto while_177_continue;
    }
    {
#line 631
    dc --;
#line 631
    err = glob2(pathbuf, pathbuf_last, dc, pathend_last, restpattern, restpattern_last,
                pglob, limitp, recursion + 1);
    }
#line 634
    if (err) {
      goto while_177_break;
    }
  }
  while_177_break: /* CIL Label */ ;
  }
  {
#line 638
  closedir(dirp);
  }
#line 639
  return (err);
}
}
#line 657 "bsd-glob.c"
static int globextend(Char const   *path , glob_t *pglob , size_t *limitp ) 
{ char **pathv ;
  unsigned int newsize ;
  size_t len ;
  char *copy ;
  Char const   *p ;
  Char const   *tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___7 ;

  {
#line 665
  if (pglob->gl_maxfiles != 4294967295UL) {
#line 666
    if (pglob->gl_maxfiles == 0UL) {
#line 667
      return (0);
    }
#line 669
    pglob->gl_maxfiles --;
  }
#line 671
  newsize = sizeof((*pathv)) * (unsigned int )(2 + pglob->gl_pathc);
#line 672
  if (pglob->gl_pathv) {
    {
#line 672
    pathv = (char **)realloc((void *)((char *)pglob->gl_pathv), newsize);
    }
  } else {
    {
#line 672
    pathv = (char **)malloc(newsize);
    }
  }
#line 674
  if ((unsigned int )pathv == (unsigned int )((void *)0)) {
    {
#line 675
    free((void *)pglob->gl_pathv);
#line 676
    pglob->gl_pathv = (char **)((void *)0);
    }
#line 677
    return (-1);
  }
#line 680
  pglob->gl_pathv = pathv;
#line 682
  p = path;
  {
#line 682
  while (1) {
    while_179_continue: /* CIL Label */ ;
#line 682
    tmp___3 = p;
#line 682
    p ++;
#line 682
    if (! (*tmp___3)) {
      goto while_179_break;
    }
  }
  while_179_break: /* CIL Label */ ;
  }
  {
#line 683
  len = (unsigned int )(p - path);
#line 684
  (*limitp) += len;
#line 685
  copy = (char *)malloc(len);
  }
#line 685
  if ((unsigned int )copy != (unsigned int )((void *)0)) {
    {
#line 686
    tmp___4 = g_Ctoc(path, copy, len);
    }
#line 686
    if (tmp___4) {
      {
#line 687
      free((void *)copy);
      }
#line 688
      return (-1);
    }
#line 690
    tmp___5 = pglob->gl_pathc;
#line 690
    pglob->gl_pathc ++;
#line 690
    (*(pathv + tmp___5)) = copy;
  }
#line 692
  (*(pathv + pglob->gl_pathc)) = (char *)((void *)0);
#line 701
  if ((unsigned int )copy == (unsigned int )((void *)0)) {
#line 701
    tmp___7 = -1;
  } else {
#line 701
    tmp___7 = 0;
  }
#line 701
  return (tmp___7);
}
}
#line 709 "bsd-glob.c"
static int match(Char *name , Char *pat , Char *patend ) 
{ int ok ;
  int negate_range ;
  Char c ;
  Char k ;
  Char *tmp ;
  int tmp___0 ;
  Char *tmp___1 ;
  Char *tmp___2 ;
  Char *tmp___3 ;
  Char *tmp___4 ;
  Char *tmp___5 ;

  {
  {
#line 715
  while (1) {
    while_180_continue: /* CIL Label */ ;
#line 715
    if (! ((unsigned int )pat < (unsigned int )patend)) {
      goto while_180_break;
    }
#line 716
    tmp = pat;
#line 716
    pat ++;
#line 716
    c = (*tmp);
#line 718
    if (((int )c & 65535) == 32810) {
      goto switch_181_32810;
    } else {
#line 727
      if (((int )c & 65535) == 32831) {
        goto switch_181_32831;
      } else {
#line 732
        if (((int )c & 65535) == 32859) {
          goto switch_181_32859;
        } else {
          {
          goto switch_181_default;
#line 717
          if (0) {
            switch_181_32810: /* CIL Label */ ;
#line 719
            if ((unsigned int )pat == (unsigned int )patend) {
#line 720
              return (1);
            }
            {
#line 721
            while (1) {
              while_182_continue: /* CIL Label */ ;
              {
#line 722
              tmp___0 = match(name, pat, patend);
              }
#line 722
              if (tmp___0) {
#line 723
                return (1);
              }
#line 721
              tmp___1 = name;
#line 721
              name ++;
#line 721
              if (! ((int )(*tmp___1) != 0)) {
                goto while_182_break;
              }
            }
            while_182_break: /* CIL Label */ ;
            }
#line 726
            return (0);
            switch_181_32831: /* CIL Label */ 
#line 728
            tmp___2 = name;
#line 728
            name ++;
#line 728
            if ((int )(*tmp___2) == 0) {
#line 729
              return (0);
            }
            goto switch_181_break;
            switch_181_32859: /* CIL Label */ 
#line 733
            ok = 0;
#line 734
            tmp___3 = name;
#line 734
            name ++;
#line 734
            k = (*tmp___3);
#line 734
            if ((int )k == 0) {
#line 735
              return (0);
            }
#line 736
            negate_range = ((int )(*pat) & 65535) == 32801;
#line 736
            if (negate_range != 0) {
#line 737
              pat ++;
            }
            {
#line 739
            while (1) {
              while_183_continue: /* CIL Label */ ;
#line 739
              tmp___4 = pat;
#line 739
              pat ++;
#line 739
              c = (*tmp___4);
#line 739
              if (! (((int )c & 65535) != 32861)) {
                goto while_183_break;
              }
#line 740
              if (((int )(*pat) & 65535) == 32813) {
#line 741
                if ((int )c <= (int )k) {
#line 741
                  if ((int )k <= (int )(*(pat + 1))) {
#line 742
                    ok = 1;
                  }
                }
#line 743
                pat += 2;
              } else {
#line 744
                if ((int )c == (int )k) {
#line 745
                  ok = 1;
                }
              }
            }
            while_183_break: /* CIL Label */ ;
            }
#line 748
            if (ok == negate_range) {
#line 749
              return (0);
            }
            goto switch_181_break;
            switch_181_default: /* CIL Label */ 
#line 753
            tmp___5 = name;
#line 753
            name ++;
#line 753
            if ((int )(*tmp___5) != (int )c) {
#line 754
              return (0);
            }
            goto switch_181_break;
          } else {
            switch_181_break: /* CIL Label */ ;
          }
          }
        }
      }
    }
  }
  while_180_break: /* CIL Label */ ;
  }
#line 759
  return ((int )(*name) == 0);
}
}
#line 763 "bsd-glob.c"
void globfree(glob_t *pglob ) 
{ int i ;
  char **pp ;
  int tmp ;

  {
#line 768
  if ((unsigned int )pglob->gl_pathv != (unsigned int )((void *)0)) {
#line 769
    pp = pglob->gl_pathv;
#line 770
    i = pglob->gl_pathc;
    {
#line 770
    while (1) {
      while_184_continue: /* CIL Label */ ;
#line 770
      tmp = i;
#line 770
      i --;
#line 770
      if (! tmp) {
        goto while_184_break;
      }
      {
#line 771
      free((void *)(*pp));
#line 770
      pp ++;
      }
    }
    while_184_break: /* CIL Label */ ;
    }
    {
#line 773
    free((void *)pglob->gl_pathv);
#line 774
    pglob->gl_pathv = (char **)((void *)0);
    }
  }
#line 776
  return;
}
}
#line 778 "bsd-glob.c"
static DIR *g_opendir(Char *str ) 
{ char buf[4097] ;
  int tmp ;
  DIR *tmp___0 ;

  {
#line 782
  if (! (*str)) {
#line 783
    buf[0] = (char )'.';
#line 784
    buf[1] = 0;
  } else {
    {
#line 786
    tmp = g_Ctoc((Char const   *)str, buf, sizeof(buf));
    }
#line 786
    if (tmp) {
#line 787
      return ((DIR *)((void *)0));
    }
  }
  {
#line 789
  tmp___0 = opendir((char const   *)(buf));
  }
#line 789
  return (tmp___0);
}
}
#line 792 "bsd-glob.c"
static int g_lstat(Char *fn , struct stat *sb ) 
{ char buf[4097] ;
  int tmp ;
  int tmp___0 ;

  {
  {
#line 796
  tmp = g_Ctoc((Char const   *)fn, buf, sizeof(buf));
  }
#line 796
  if (tmp) {
#line 797
    return (-1);
  }
  {
#line 798
  tmp___0 = lstat((char const   */* __restrict  */)(buf), (struct stat */* __restrict  */)sb);
  }
#line 798
  return (tmp___0);
}
}
#line 801 "bsd-glob.c"
static Char const   *g_strchr(Char const   *str , int ch ) 
{ Char const   *tmp ;

  {
  {
#line 803
  while (1) {
    while_185_continue: /* CIL Label */ ;
#line 804
    if ((int const   )(*str) == (int const   )((unsigned short )ch)) {
#line 805
      return (str);
    }
#line 803
    tmp = str;
#line 803
    str ++;
#line 803
    if (! (*tmp)) {
      goto while_185_break;
    }
  }
  while_185_break: /* CIL Label */ ;
  }
#line 807
  return ((Char const   *)((void *)0));
}
}
#line 810 "bsd-glob.c"
static int g_Ctoc(Char const   *str , char *buf , unsigned int len ) 
{ char *tmp ;
  Char const   *tmp___0 ;
  unsigned int tmp___1 ;

  {
  {
#line 812
  while (1) {
    while_186_continue: /* CIL Label */ ;
#line 812
    tmp___1 = len;
#line 812
    len --;
#line 812
    if (! tmp___1) {
      goto while_186_break;
    }
#line 813
    tmp = buf;
#line 813
    buf ++;
#line 813
    tmp___0 = str;
#line 813
    str ++;
#line 813
    (*tmp) = (char )(*tmp___0);
#line 813
    if ((int )(*tmp) == 0) {
#line 814
      return (0);
    }
  }
  while_186_break: /* CIL Label */ ;
  }
#line 816
  return (1);
}
}
#line 1 "cil-6CypzTdT.o"
/* #pragma merger(0,"/tmp/cil-uCuTNLHz.i","") */
#line 1 "src/pure_ftpd-fakesnprintf.o_saved.c"
/* #pragma merger(112422805,"./fakesnprintf.i","-g,-O2") */
#line 1 "cil-kkkFHAiv.o"
/* #pragma merger(0,"/tmp/cil-GmH7u9ga.i","") */
#line 1 "src/pure_ftpd-bsd-realpath.o_saved.c"
/* #pragma merger(112422805,"./bsd-realpath.i","-g,-O2") */
#line 1 "cil-mFeAuKBA.o"
/* #pragma merger(0,"/tmp/cil-LdV8QMh4.i","") */
#line 1 "src/pure_ftpd-mysnprintf.o_saved.c"
/* #pragma merger(112422805,"./mysnprintf.i","-g,-O2") */
#line 1 "cil-j7wxkc9r.o"
/* #pragma merger(0,"/tmp/cil-w8woY6uX.i","") */
#line 1 "src/pure_ftpd-caps.o_saved.c"
/* #pragma merger(112422805,"./caps.i","-g,-O2") */
#line 77 "/usr/include/sys/capability.h"
extern int cap_free(void * ) ;
#line 78
extern cap_t cap_init(void) ;
#line 82
extern int cap_set_flag(cap_t  , cap_flag_t  , int  , cap_value_t * , cap_flag_value_t  ) ;
#line 83
extern int cap_clear(cap_t  ) ;
#line 93
extern int cap_set_proc(cap_t  ) ;
#line 9 "caps_p.h"
cap_value_t cap_keep_startup[8]  = 
#line 9
  {      6,      7,      0,      10, 
        18,      23,      12,      2};
#line 20 "caps_p.h"
cap_value_t cap_keep_login[2]  = {      10,      12};
#line 16 "caps.c"
static void apply_caps(cap_value_t *ncaps , size_t ncaps_size ) 
{ cap_t caps ;
  __uid_t tmp ;
  int *tmp___0 ;
  char *tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;

  {
  {
#line 22
  tmp = geteuid();
  }
#line 22
  if (tmp != 0U) {
#line 23
    return;
  }
  {
#line 25
  caps = cap_init();
  }
#line 25
  if ((unsigned int )caps == (unsigned int )((struct _cap_struct *)0)) {
    {
#line 31
    tmp___0 = __errno_location();
#line 31
    tmp___1 = strerror((*tmp___0));
#line 31
    die(421, 3, "Unable to switch capabilities : %s", tmp___1);
    }
  } else {
    {
#line 25
    tmp___2 = cap_clear(caps);
    }
#line 25
    if (tmp___2 == -1) {
      {
#line 31
      tmp___0 = __errno_location();
#line 31
      tmp___1 = strerror((*tmp___0));
#line 31
      die(421, 3, "Unable to switch capabilities : %s", tmp___1);
      }
    } else {
      {
#line 25
      tmp___3 = cap_set_flag(caps, (enum __anonenum_cap_flag_t_67 )1, (int )ncaps_size,
                             ncaps, (enum __anonenum_cap_flag_value_t_68 )1);
      }
#line 25
      if (tmp___3 == -1) {
        {
#line 31
        tmp___0 = __errno_location();
#line 31
        tmp___1 = strerror((*tmp___0));
#line 31
        die(421, 3, "Unable to switch capabilities : %s", tmp___1);
        }
      } else {
        {
#line 25
        tmp___4 = cap_set_flag(caps, (enum __anonenum_cap_flag_t_67 )0, (int )ncaps_size,
                               ncaps, (enum __anonenum_cap_flag_value_t_68 )1);
        }
#line 25
        if (tmp___4 == -1) {
          {
#line 31
          tmp___0 = __errno_location();
#line 31
          tmp___1 = strerror((*tmp___0));
#line 31
          die(421, 3, "Unable to switch capabilities : %s", tmp___1);
          }
        } else {
          {
#line 25
          tmp___5 = cap_set_proc(caps);
          }
#line 25
          if (tmp___5 == -1) {
            {
#line 31
            tmp___0 = __errno_location();
#line 31
            tmp___1 = strerror((*tmp___0));
#line 31
            die(421, 3, "Unable to switch capabilities : %s", tmp___1);
            }
          } else {
            {
#line 25
            tmp___6 = cap_free((void *)caps);
            }
#line 25
            if (tmp___6 == -1) {
              {
#line 31
              tmp___0 = __errno_location();
#line 31
              tmp___1 = strerror((*tmp___0));
#line 31
              die(421, 3, "Unable to switch capabilities : %s", tmp___1);
              }
            }
          }
        }
      }
    }
  }
#line 37
  return;
}
}
#line 39 "caps.c"
void drop_login_caps(void) 
{ 

  {
  {
#line 41
  apply_caps(cap_keep_login, sizeof(cap_keep_login) / sizeof(cap_value_t ));
  }
#line 43
  return;
}
}
#line 45 "caps.c"
void set_initial_caps(void) 
{ 

  {
  {
#line 47
  apply_caps(cap_keep_startup, sizeof(cap_keep_startup) / sizeof(cap_value_t ));
  }
#line 49
  return;
}
}
#line 1 "cil-WcTZsGYe.o"
/* #pragma merger(0,"/tmp/cil-N0V0QzWW.i","") */
#line 1 "src/pure_ftpd-ftp_parser.o_saved.c"
/* #pragma merger(112422806,"./ftp_parser.i","-g,-O2") */
#line 473 "/usr/include/stdlib.h"
extern int rand(void) ;
#line 380 "ftpd.h"
int sfgets(void) ;
#line 19 "ftp_parser.c"
static void antiidle(void) 
{ time_t tmp ;

  {
#line 21
  if (noopidle == -1L) {
    {
#line 22
    noopidle = time((time_t *)((void *)0));
    }
  } else {
    {
#line 24
    tmp = time((time_t *)((void *)0));
    }
#line 24
    if (tmp - noopidle > (long )idletime_noop) {
      {
#line 25
      die(421, 6, "Timeout (no operation for %lu seconds)", (unsigned long )idletime_noop);
      }
    }
  }
#line 28
  return;
}
}
#line 36 "ftp_parser.c"
static void randomdelay(void) 
{ int tmp ;

  {
  {
#line 38
  tmp = rand();
#line 38
  usleep((unsigned int )((unsigned long )tmp % 15000UL));
  }
#line 39
  return;
}
}
#line 66 "ftp_parser.c"
static size_t scanned  ;
#line 67 "ftp_parser.c"
static size_t readend  ;
#line 60 "ftp_parser.c"
int sfgets(void) 
{ fd_set rs ;
  struct timeval tv ;
  ssize_t readen ;
  signed char seen_r ;
  int __d0 ;
  int __d1 ;
  int tmp ;
  int *tmp___0 ;
  register char __result ;
  int *tmp___1 ;

  {
#line 65
  seen_r = 0;
#line 69
  if (scanned > 0U) {
    {
#line 70
    readend -= scanned;
#line 71
    memmove((void *)(cmd), (void const   *)(cmd + scanned), readend);
#line 72
    scanned = 0U;
    }
  }
#line 74
  tv.tv_sec = (long )idletime;
#line 75
  tv.tv_usec = 0L;
  {
#line 76
  while (1) {
    while_187_continue: /* CIL Label */ ;
#line 76
    __asm__  volatile   ("cld; rep; stosl": "=c" (__d0), "=D" (__d1): "a" (0), "0" (sizeof(fd_set ) /
                                                                                    sizeof(__fd_mask )),
                         "1" (& rs.fds_bits[0]): "memory");
    goto while_187_break;
  }
  while_187_break: /* CIL Label */ ;
  }
  {
#line 77
  while (1) {
    while_188_continue: /* CIL Label */ ;
#line 77
    if (! (scanned < (unsigned int )cmdsize)) {
      goto while_188_break;
    }
#line 78
    if (scanned >= readend) {
#line 79
      __asm__  volatile   ("btsl %1,%0": "=m" (rs.fds_bits[0U / (8U * sizeof(__fd_mask ))]): "r" (0U %
                                                                                                  (8U *
                                                                                                   sizeof(__fd_mask ))): "cc",
                           "memory");
      {
#line 80
      while (1) {
        while_189_continue: /* CIL Label */ ;
        {
#line 80
        tmp = select(1, (fd_set */* __restrict  */)(& rs), (fd_set */* __restrict  */)((void *)0),
                     (fd_set */* __restrict  */)((void *)0), (struct timeval */* __restrict  */)(& tv));
        }
#line 80
        if (tmp <= 0) {
          {
#line 80
          tmp___0 = __errno_location();
          }
#line 80
          if (! ((*tmp___0) == 4)) {
            goto while_189_break;
          }
        } else {
          goto while_189_break;
        }
      }
      while_189_break: /* CIL Label */ ;
      }
#line 81
      __asm__  volatile   ("btl %1,%2 ; setcb %b0": "=q" (__result): "r" (0U % (8U *
                                                                                sizeof(__fd_mask ))),
                           "m" (rs.fds_bits[0U / (8U * sizeof(__fd_mask ))]): "cc");
#line 81
      if ((int )__result == 0) {
#line 82
        return (-1);
      }
#line 84
      if (readend >= (unsigned int )cmdsize) {
        goto while_188_break;
      }
      {
#line 95
      while (1) {
        while_190_continue: /* CIL Label */ ;
        {
#line 95
        readen = read(0, (void *)(cmd + readend), (unsigned int )(cmdsize - (unsigned int const   )readend));
        }
#line 95
        if (readen < 0) {
          {
#line 95
          tmp___1 = __errno_location();
          }
#line 95
          if (! ((*tmp___1) == 4)) {
            goto while_190_break;
          }
        } else {
          goto while_190_break;
        }
      }
      while_190_break: /* CIL Label */ ;
      }
#line 98
      if (readen <= 0) {
#line 99
        return (-2);
      }
#line 101
      readend += (unsigned int )readen;
#line 102
      if (readend > (unsigned int )cmdsize) {
#line 103
        return (-2);
      }
    }
#line 109
    if ((int )cmd[scanned] == 10) {
#line 111
      if ((int )seen_r != 0) {
#line 113
        cmd[scanned - 1U] = 0;
      } else {
#line 116
        cmd[scanned] = 0;
      }
#line 119
      scanned ++;
#line 119
      if (scanned >= readend) {
#line 120
        readend = 0U;
#line 120
        scanned = readend;
      }
#line 122
      return (0);
    }
#line 124
    seen_r = 0;
#line 128
    if ((int )cmd[scanned] == 127) {
      goto _L;
    } else {
#line 128
      if ((unsigned int )((unsigned char )cmd[scanned]) < 32U) {
        _L: 
#line 129
        if ((int )cmd[scanned] == 13) {
#line 130
          seen_r = 1;
        }
#line 138
        cmd[scanned] = (char )'_';
      }
    }
#line 141
    scanned ++;
  }
  while_188_break: /* CIL Label */ ;
  }
  {
#line 143
  die(421, 4, "Line too long");
  }
#line 145
  return (0);
}
}
#line 153 "ftp_parser.c"
static char *revealextraspc(char *s_ ) 
{ register unsigned char *s ;
  register unsigned char *sn ;
  unsigned char *tmp ;
  unsigned short const   **tmp___0 ;
  unsigned short const   **tmp___1 ;

  {
#line 155
  s = (unsigned char *)s_;
#line 158
  if ((unsigned int )s == (unsigned int )((void *)0)) {
#line 159
    return (s_);
  }
  {
#line 161
  simplify(s_);
  }
  {
#line 162
  while (1) {
    while_191_continue: /* CIL Label */ ;
#line 162
    if ((unsigned int )(*s) != 0U) {
      {
#line 162
      tmp___0 = __ctype_b_loc();
      }
#line 162
      if (! ((int const   )(*((*tmp___0) + (int )(*s))) & 8192)) {
        goto while_191_break;
      }
    } else {
      goto while_191_break;
    }
#line 163
    tmp = s;
#line 163
    s ++;
#line 163
    (*tmp) = (unsigned char )'_';
  }
  while_191_break: /* CIL Label */ ;
  }
#line 165
  if ((unsigned int )(*s) == 0U) {
#line 166
    return (s_);
  }
#line 168
  sn = s;
  {
#line 169
  while (1) {
    while_192_continue: /* CIL Label */ ;
#line 170
    sn ++;
#line 169
    if (! ((unsigned int )(*sn) != 0U)) {
      goto while_192_break;
    }
  }
  while_192_break: /* CIL Label */ ;
  }
  {
#line 172
  while (1) {
    while_193_continue: /* CIL Label */ ;
    {
#line 173
    sn --;
#line 174
    tmp___1 = __ctype_b_loc();
    }
#line 174
    if (! ((int const   )(*((*tmp___1) + (int )(*sn))) & 8192)) {
      goto while_193_break;
    }
#line 177
    (*sn) = (unsigned char )'_';
#line 172
    if (! ((unsigned int )sn != (unsigned int )s)) {
      goto while_193_break;
    }
  }
  while_193_break: /* CIL Label */ ;
  }
#line 180
  return (s_);
}
}
#line 215 "ftp_parser.c"
void parser(void) 
{ char *arg ;
  char *sitearg ;
  size_t n ;
  int tmp ;
  int __res ;
  __int32_t const   **tmp___2 ;
  unsigned short const   **tmp___3 ;
  unsigned short const   **tmp___4 ;
  char const   *tmp___13 ;
  size_t __s1_len___0 ;
  size_t __s2_len___0 ;
  int tmp___18 ;
  size_t tmp___19 ;
  int tmp___20 ;
  int tmp___21 ;
  size_t __s1_len___1 ;
  size_t __s2_len___1 ;
  int tmp___26 ;
  size_t tmp___27 ;
  int tmp___28 ;
  int tmp___29 ;
  size_t __s1_len___2 ;
  size_t __s2_len___2 ;
  int tmp___34 ;
  size_t tmp___35 ;
  int tmp___36 ;
  int tmp___37 ;
  size_t __s1_len___3 ;
  size_t __s2_len___3 ;
  int tmp___42 ;
  size_t tmp___43 ;
  int tmp___44 ;
  int tmp___45 ;
  int tmp___46 ;
  char const   *tmp___47 ;
  unsigned short const   **tmp___48 ;
  char *tmp___49 ;
  unsigned long i ;
  char *sitearg2 ;
  mode_t mode ;
  unsigned short const   **tmp___50 ;
  unsigned short const   **tmp___51 ;
  char *sitearg2___0 ;
  int tmp___53 ;
  char *tmp___54 ;
  char *tmp___55 ;
  char *tmp___56 ;
  char *tmp___57 ;
  int tmp___58 ;
  int tmp___59 ;
  int tmp___60 ;
  int tmp___61 ;
  int tmp___62 ;
  size_t __s1_len___4 ;
  size_t __s2_len___4 ;
  int tmp___67 ;
  size_t tmp___68 ;
  int tmp___69 ;
  int tmp___70 ;
  size_t __s1_len___5 ;
  size_t __s2_len___5 ;
  int tmp___75 ;
  size_t tmp___76 ;
  int tmp___77 ;
  int tmp___78 ;
  size_t __s1_len___6 ;
  size_t __s2_len___6 ;
  int tmp___83 ;
  size_t tmp___84 ;
  int tmp___85 ;
  int tmp___86 ;
  size_t __s1_len___7 ;
  size_t __s2_len___7 ;
  int tmp___91 ;
  size_t tmp___92 ;
  int tmp___93 ;
  int tmp___94 ;
  size_t __s1_len___8 ;
  size_t __s2_len___8 ;
  int tmp___99 ;
  size_t tmp___100 ;
  int tmp___101 ;
  int tmp___102 ;
  size_t __s1_len___9 ;
  size_t __s2_len___9 ;
  int tmp___107 ;
  size_t tmp___108 ;
  int tmp___109 ;
  int tmp___110 ;
  size_t __s1_len___10 ;
  size_t __s2_len___10 ;
  int tmp___115 ;
  size_t tmp___116 ;
  int tmp___117 ;
  int tmp___118 ;
  size_t __s1_len___11 ;
  size_t __s2_len___11 ;
  int tmp___123 ;
  size_t tmp___124 ;
  int tmp___125 ;
  int tmp___126 ;
  size_t __s1_len___12 ;
  size_t __s2_len___12 ;
  int tmp___131 ;
  size_t tmp___132 ;
  int tmp___133 ;
  int tmp___134 ;
  size_t __s1_len___13 ;
  size_t __s2_len___13 ;
  int tmp___139 ;
  size_t tmp___140 ;
  int tmp___141 ;
  int tmp___142 ;
  size_t __s1_len___14 ;
  size_t __s2_len___14 ;
  int tmp___147 ;
  size_t tmp___148 ;
  int tmp___149 ;
  int tmp___150 ;
  size_t __s1_len___15 ;
  size_t __s2_len___15 ;
  int tmp___155 ;
  size_t tmp___156 ;
  int tmp___157 ;
  int tmp___158 ;
  size_t __s1_len___16 ;
  size_t __s2_len___16 ;
  int tmp___163 ;
  size_t tmp___164 ;
  int tmp___165 ;
  int tmp___166 ;
  size_t __s1_len___17 ;
  size_t __s2_len___17 ;
  int tmp___171 ;
  size_t tmp___172 ;
  int tmp___173 ;
  int tmp___174 ;
  size_t __s1_len___18 ;
  size_t __s2_len___18 ;
  int tmp___179 ;
  size_t tmp___180 ;
  int tmp___181 ;
  int tmp___182 ;
  size_t __s1_len___19 ;
  size_t __s2_len___19 ;
  int tmp___187 ;
  size_t tmp___188 ;
  int tmp___189 ;
  int tmp___190 ;
  size_t __s1_len___20 ;
  size_t __s2_len___20 ;
  int tmp___195 ;
  size_t tmp___196 ;
  int tmp___197 ;
  int tmp___198 ;
  size_t __s1_len___21 ;
  size_t __s2_len___21 ;
  int tmp___203 ;
  size_t tmp___204 ;
  int tmp___205 ;
  int tmp___206 ;
  size_t __s1_len___22 ;
  size_t __s2_len___22 ;
  int tmp___211 ;
  size_t tmp___212 ;
  int tmp___213 ;
  int tmp___214 ;
  size_t __s1_len___23 ;
  size_t __s2_len___23 ;
  int tmp___219 ;
  size_t tmp___220 ;
  int tmp___221 ;
  int tmp___222 ;
  size_t __s1_len___24 ;
  size_t __s2_len___24 ;
  int tmp___227 ;
  size_t tmp___228 ;
  int tmp___229 ;
  int tmp___230 ;
  size_t __s1_len___25 ;
  size_t __s2_len___25 ;
  int tmp___235 ;
  size_t tmp___236 ;
  int tmp___237 ;
  int tmp___238 ;
  size_t __s1_len___26 ;
  size_t __s2_len___26 ;
  int tmp___243 ;
  size_t tmp___244 ;
  int tmp___245 ;
  int tmp___246 ;
  size_t __s1_len___27 ;
  size_t __s2_len___27 ;
  int tmp___251 ;
  size_t tmp___252 ;
  int tmp___253 ;
  int tmp___254 ;
  size_t __s1_len___28 ;
  size_t __s2_len___28 ;
  int tmp___259 ;
  size_t tmp___260 ;
  int tmp___261 ;
  int tmp___262 ;
  size_t __s1_len___29 ;
  size_t __s2_len___29 ;
  int tmp___267 ;
  size_t tmp___268 ;
  int tmp___269 ;
  int tmp___270 ;
  size_t __s1_len___30 ;
  size_t __s2_len___30 ;
  int tmp___275 ;
  size_t tmp___276 ;
  int tmp___277 ;
  int tmp___278 ;
  size_t __s1_len___31 ;
  size_t __s2_len___31 ;
  int tmp___283 ;
  size_t tmp___284 ;
  int tmp___285 ;
  int tmp___286 ;
  size_t __s1_len___32 ;
  size_t __s2_len___32 ;
  int tmp___291 ;
  size_t tmp___292 ;
  int tmp___293 ;
  int tmp___294 ;
  size_t __s1_len___33 ;
  size_t __s2_len___33 ;
  int tmp___299 ;
  size_t tmp___300 ;
  int tmp___301 ;
  int tmp___302 ;
  size_t __s1_len___34 ;
  size_t __s2_len___34 ;
  int tmp___307 ;
  size_t tmp___308 ;
  int tmp___309 ;
  int tmp___310 ;
  size_t __s1_len___35 ;
  size_t __s2_len___35 ;
  int tmp___315 ;
  size_t tmp___316 ;
  int tmp___317 ;
  int tmp___318 ;
  size_t __s1_len___36 ;
  size_t __s2_len___36 ;
  int tmp___323 ;
  size_t tmp___324 ;
  int tmp___325 ;
  int tmp___326 ;
  size_t __s1_len___37 ;
  size_t __s2_len___37 ;
  int tmp___331 ;
  size_t tmp___332 ;
  int tmp___333 ;
  int tmp___334 ;
  size_t __s1_len___38 ;
  size_t __s2_len___38 ;
  int tmp___339 ;
  size_t tmp___340 ;
  int tmp___341 ;
  int tmp___342 ;
  size_t __s1_len___39 ;
  size_t __s2_len___39 ;
  int tmp___347 ;
  size_t tmp___348 ;
  int tmp___349 ;
  int tmp___350 ;
  size_t __s1_len___40 ;
  size_t __s2_len___40 ;
  int tmp___355 ;
  size_t tmp___356 ;
  int tmp___357 ;
  int tmp___358 ;
  size_t __s1_len___41 ;
  size_t __s2_len___41 ;
  int tmp___363 ;
  size_t tmp___364 ;
  int tmp___365 ;
  int tmp___366 ;
  size_t __s1_len___42 ;
  size_t __s2_len___42 ;
  int tmp___371 ;
  size_t tmp___372 ;
  int tmp___373 ;
  int tmp___374 ;
  size_t __s1_len___43 ;
  size_t __s2_len___43 ;
  int tmp___379 ;
  size_t tmp___380 ;
  int tmp___381 ;
  int tmp___382 ;
  size_t __s1_len___44 ;
  size_t __s2_len___44 ;
  int tmp___387 ;
  size_t tmp___388 ;
  int tmp___389 ;
  int tmp___390 ;
  size_t __s1_len___45 ;
  size_t __s2_len___45 ;
  int tmp___395 ;
  size_t tmp___396 ;
  int tmp___397 ;
  int tmp___398 ;
  size_t __s1_len___46 ;
  size_t __s2_len___46 ;
  int tmp___403 ;
  size_t tmp___404 ;
  int tmp___405 ;
  int tmp___406 ;
  size_t __s1_len___47 ;
  size_t __s2_len___47 ;
  int tmp___411 ;
  size_t tmp___412 ;
  int tmp___413 ;
  int tmp___414 ;
  size_t __s1_len___48 ;
  size_t __s2_len___48 ;
  int tmp___419 ;
  size_t tmp___420 ;
  int tmp___421 ;
  int tmp___422 ;
  size_t __s1_len___49 ;
  size_t __s2_len___49 ;
  int tmp___427 ;
  size_t tmp___428 ;
  int tmp___429 ;
  int tmp___430 ;
  size_t __s1_len___50 ;
  size_t __s2_len___50 ;
  int tmp___435 ;
  size_t tmp___436 ;
  int tmp___437 ;
  int tmp___438 ;
  size_t __s1_len___51 ;
  size_t __s2_len___51 ;
  int tmp___443 ;
  size_t tmp___444 ;
  int tmp___445 ;
  int tmp___446 ;
  size_t __s1_len___52 ;
  size_t __s2_len___52 ;
  int tmp___451 ;
  size_t tmp___452 ;
  int tmp___453 ;
  int tmp___454 ;
 CHECK3: assert(1);
  {
  {
#line 226
  while (1) {
    while_194_continue: /* CIL Label */ ;
#line 227
    xferfd = (int volatile   )-1;
#line 228
    if ((int )state_needs_update != 0) {
      {
#line 229
      state_needs_update = 0;
#line 230
      setprocessname("pure-ftpd (IDLE)");
      }
    }
    {
#line 240
    doreply();
#line 241
    alarm((unsigned int )(idletime * 2UL));
#line 242
    tmp = sfgets();
    }
#line 243
    if (tmp == -1) {
      goto switch_195_neg_1;
    } else {
#line 248
      if (tmp == -2) {
        goto switch_195_neg_2;
      } else {
#line 242
        if (0) {
          switch_195_neg_1: /* CIL Label */ 
          {
#line 247
          die(421, 6, "Timeout - try typing a little faster next time");
          }
          switch_195_neg_2: /* CIL Label */ ;
#line 250
          return;
        } else {
          switch_195_break: /* CIL Label */ ;
        }
      }
    }
#line 257
    n = 0U;
    {
#line 258
    while (1) {
      while_196_continue: /* CIL Label */ ;
      {
#line 258
      tmp___3 = __ctype_b_loc();
      }
#line 258
      if ((int const   )(*((*tmp___3) + (int )((unsigned char )cmd[n]))) & 1024) {
        goto _L;
      } else {
#line 258
        if ((int )cmd[n] == 64) {
          _L: 
#line 258
          if (! (n < (unsigned int )cmdsize)) {
            goto while_196_break;
          }
        } else {
          goto while_196_break;
        }
      }
#line 260
      if (sizeof((unsigned char )cmd[n]) > 1U) {
        {
#line 260
        __res = tolower((int )((unsigned char )cmd[n]));
        }
      } else {
        {
#line 260
        tmp___2 = __ctype_tolower_loc();
#line 260
        __res = (*((*tmp___2) + (int )((unsigned char )cmd[n])));
        }
      }
#line 260
      cmd[n] = (char )__res;
#line 261
      n ++;
    }
    while_196_break: /* CIL Label */ ;
    }
#line 263
    if (n >= (unsigned int )cmdsize) {
      {
#line 264
      die(421, 4, "Line too long");
      }
    }
#line 266
    if (n == 0U) {
      nop: 
      {
#line 268
      addreply_noformat(500, "?");
      }
      goto __Cont;
    }
#line 284
    if ((int )cmd[n] == 0) {
#line 285
      arg = cmd + n;
    } else {
      {
#line 286
      tmp___4 = __ctype_b_loc();
      }
#line 286
      if ((int const   )(*((*tmp___4) + (int )((unsigned char )cmd[n]))) & 8192) {
#line 287
        cmd[n] = 0;
#line 288
        arg = (cmd + n) + 1;
      } else {
        goto nop;
      }
    }
#line 293
    if ((int volatile   )logging != 0) {
#line 299
      if (0) {
        {
#line 299
        __s1_len___0 = strlen((char const   *)(cmd));
#line 299
        __s2_len___0 = strlen("pass");
        }
#line 299
        if (! ((unsigned int )((void const   *)(cmd + 1)) - (unsigned int )((void const   *)(cmd)) ==
               1U)) {
          goto _L___3;
        } else {
#line 299
          if (__s1_len___0 >= 4U) {
            _L___3: 
#line 299
            if (! ((unsigned int )((void const   *)("pass" + 1)) - (unsigned int )((void const   *)"pass") ==
                   1U)) {
#line 299
              tmp___21 = 1;
            } else {
#line 299
              if (__s2_len___0 >= 4U) {
#line 299
                tmp___21 = 1;
              } else {
#line 299
                tmp___21 = 0;
              }
            }
          } else {
#line 299
            tmp___21 = 0;
          }
        }
#line 299
        if (tmp___21) {
#line 299
          if (__s1_len___0 < __s2_len___0) {
#line 299
            tmp___19 = __s1_len___0;
          } else {
#line 299
            tmp___19 = __s2_len___0;
          }
          {
#line 299
          tmp___18 = memcmp((void const   *)((char const   *)(cmd)), (void const   *)"pass",
                            tmp___19 + 1U);
          }
        } else {
          {
#line 299
          tmp___20 = strcmp((char const   *)(cmd), "pass");
#line 299
          tmp___18 = tmp___20;
          }
        }
      } else {
        {
#line 299
        tmp___20 = strcmp((char const   *)(cmd), "pass");
#line 299
        tmp___18 = tmp___20;
        }
      }
#line 299
      if (tmp___18) {
#line 299
        tmp___13 = (char const   *)arg;
      } else {
#line 299
        tmp___13 = "<*>";
      }
      {
#line 299
      logfile(7, "Command [%s] [%s]", cmd, tmp___13);
      }
    }
#line 314
    if (0) {
      {
#line 314
      __s1_len___1 = strlen((char const   *)(cmd));
#line 314
      __s2_len___1 = strlen("noop");
      }
#line 314
      if (! ((unsigned int )((void const   *)(cmd + 1)) - (unsigned int )((void const   *)(cmd)) ==
             1U)) {
        goto _L___5;
      } else {
#line 314
        if (__s1_len___1 >= 4U) {
          _L___5: 
#line 314
          if (! ((unsigned int )((void const   *)("noop" + 1)) - (unsigned int )((void const   *)"noop") ==
                 1U)) {
#line 314
            tmp___29 = 1;
          } else {
#line 314
            if (__s2_len___1 >= 4U) {
#line 314
              tmp___29 = 1;
            } else {
#line 314
              tmp___29 = 0;
            }
          }
        } else {
#line 314
          tmp___29 = 0;
        }
      }
#line 314
      if (tmp___29) {
#line 314
        if (__s1_len___1 < __s2_len___1) {
#line 314
          tmp___27 = __s1_len___1;
        } else {
#line 314
          tmp___27 = __s2_len___1;
        }
        {
#line 314
        tmp___26 = memcmp((void const   *)((char const   *)(cmd)), (void const   *)"noop",
                          tmp___27 + 1U);
        }
      } else {
        {
#line 314
        tmp___28 = strcmp((char const   *)(cmd), "noop");
#line 314
        tmp___26 = tmp___28;
        }
      }
    } else {
      {
#line 314
      tmp___28 = strcmp((char const   *)(cmd), "noop");
#line 314
      tmp___26 = tmp___28;
      }
    }
#line 314
    if (tmp___26) {
#line 314
      if (0) {
        {
#line 314
        __s1_len___2 = strlen((char const   *)(cmd));
#line 314
        __s2_len___2 = strlen("allo");
        }
#line 314
        if (! ((unsigned int )((void const   *)(cmd + 1)) - (unsigned int )((void const   *)(cmd)) ==
               1U)) {
          goto _L___7;
        } else {
#line 314
          if (__s1_len___2 >= 4U) {
            _L___7: 
#line 314
            if (! ((unsigned int )((void const   *)("allo" + 1)) - (unsigned int )((void const   *)"allo") ==
                   1U)) {
#line 314
              tmp___37 = 1;
            } else {
#line 314
              if (__s2_len___2 >= 4U) {
#line 314
                tmp___37 = 1;
              } else {
#line 314
                tmp___37 = 0;
              }
            }
          } else {
#line 314
            tmp___37 = 0;
          }
        }
#line 314
        if (tmp___37) {
#line 314
          if (__s1_len___2 < __s2_len___2) {
#line 314
            tmp___35 = __s1_len___2;
          } else {
#line 314
            tmp___35 = __s2_len___2;
          }
          {
#line 314
          tmp___34 = memcmp((void const   *)((char const   *)(cmd)), (void const   *)"allo",
                            tmp___35 + 1U);
          }
        } else {
          {
#line 314
          tmp___36 = strcmp((char const   *)(cmd), "allo");
#line 314
          tmp___34 = tmp___36;
          }
        }
      } else {
        {
#line 314
        tmp___36 = strcmp((char const   *)(cmd), "allo");
#line 314
        tmp___34 = tmp___36;
        }
      }
#line 314
      if (! tmp___34) {
        {
#line 315
        antiidle();
#line 316
        donoop();
        }
        goto wayout;
      }
    } else {
      {
#line 315
      antiidle();
#line 316
      donoop();
      }
      goto wayout;
    }
#line 320
    if (0) {
      {
#line 320
      __s1_len___52 = strlen((char const   *)(cmd));
#line 320
      __s2_len___52 = strlen("user");
      }
#line 320
      if (! ((unsigned int )((void const   *)(cmd + 1)) - (unsigned int )((void const   *)(cmd)) ==
             1U)) {
        goto _L___117;
      } else {
#line 320
        if (__s1_len___52 >= 4U) {
          _L___117: 
#line 320
          if (! ((unsigned int )((void const   *)("user" + 1)) - (unsigned int )((void const   *)"user") ==
                 1U)) {
#line 320
            tmp___454 = 1;
          } else {
#line 320
            if (__s2_len___52 >= 4U) {
#line 320
              tmp___454 = 1;
            } else {
#line 320
              tmp___454 = 0;
            }
          }
        } else {
#line 320
          tmp___454 = 0;
        }
      }
#line 320
      if (tmp___454) {
#line 320
        if (__s1_len___52 < __s2_len___52) {
#line 320
          tmp___452 = __s1_len___52;
        } else {
#line 320
          tmp___452 = __s2_len___52;
        }
        {
#line 320
        tmp___451 = memcmp((void const   *)((char const   *)(cmd)), (void const   *)"user",
                           tmp___452 + 1U);
        }
      } else {
        {
#line 320
        tmp___453 = strcmp((char const   *)(cmd), "user");
#line 320
        tmp___451 = tmp___453;
        }
      }
    } else {
      {
#line 320
      tmp___453 = strcmp((char const   *)(cmd), "user");
#line 320
      tmp___451 = tmp___453;
      }
    }
#line 320
    if (tmp___451) {
#line 327
      if (0) {
        {
#line 327
        __s1_len___51 = strlen((char const   *)(cmd));
#line 327
        __s2_len___51 = strlen("acct");
        }
#line 327
        if (! ((unsigned int )((void const   *)(cmd + 1)) - (unsigned int )((void const   *)(cmd)) ==
               1U)) {
          goto _L___115;
        } else {
#line 327
          if (__s1_len___51 >= 4U) {
            _L___115: 
#line 327
            if (! ((unsigned int )((void const   *)("acct" + 1)) - (unsigned int )((void const   *)"acct") ==
                   1U)) {
#line 327
              tmp___446 = 1;
            } else {
#line 327
              if (__s2_len___51 >= 4U) {
#line 327
                tmp___446 = 1;
              } else {
#line 327
                tmp___446 = 0;
              }
            }
          } else {
#line 327
            tmp___446 = 0;
          }
        }
#line 327
        if (tmp___446) {
#line 327
          if (__s1_len___51 < __s2_len___51) {
#line 327
            tmp___444 = __s1_len___51;
          } else {
#line 327
            tmp___444 = __s2_len___51;
          }
          {
#line 327
          tmp___443 = memcmp((void const   *)((char const   *)(cmd)), (void const   *)"acct",
                             tmp___444 + 1U);
          }
        } else {
          {
#line 327
          tmp___445 = strcmp((char const   *)(cmd), "acct");
#line 327
          tmp___443 = tmp___445;
          }
        }
      } else {
        {
#line 327
        tmp___445 = strcmp((char const   *)(cmd), "acct");
#line 327
        tmp___443 = tmp___445;
        }
      }
#line 327
      if (tmp___443) {
#line 329
        if (0) {
          {
#line 329
          __s1_len___50 = strlen((char const   *)(cmd));
#line 329
          __s2_len___50 = strlen("pass");
          }
#line 329
          if (! ((unsigned int )((void const   *)(cmd + 1)) - (unsigned int )((void const   *)(cmd)) ==
                 1U)) {
            goto _L___113;
          } else {
#line 329
            if (__s1_len___50 >= 4U) {
              _L___113: 
#line 329
              if (! ((unsigned int )((void const   *)("pass" + 1)) - (unsigned int )((void const   *)"pass") ==
                     1U)) {
#line 329
                tmp___438 = 1;
              } else {
#line 329
                if (__s2_len___50 >= 4U) {
#line 329
                  tmp___438 = 1;
                } else {
#line 329
                  tmp___438 = 0;
                }
              }
            } else {
#line 329
              tmp___438 = 0;
            }
          }
#line 329
          if (tmp___438) {
#line 329
            if (__s1_len___50 < __s2_len___50) {
#line 329
              tmp___436 = __s1_len___50;
            } else {
#line 329
              tmp___436 = __s2_len___50;
            }
            {
#line 329
            tmp___435 = memcmp((void const   *)((char const   *)(cmd)), (void const   *)"pass",
                               tmp___436 + 1U);
            }
          } else {
            {
#line 329
            tmp___437 = strcmp((char const   *)(cmd), "pass");
#line 329
            tmp___435 = tmp___437;
            }
          }
        } else {
          {
#line 329
          tmp___437 = strcmp((char const   *)(cmd), "pass");
#line 329
          tmp___435 = tmp___437;
          }
        }
#line 329
        if (tmp___435) {
#line 334
          if (0) {
            {
#line 334
            __s1_len___49 = strlen((char const   *)(cmd));
#line 334
            __s2_len___49 = strlen("quit");
            }
#line 334
            if (! ((unsigned int )((void const   *)(cmd + 1)) - (unsigned int )((void const   *)(cmd)) ==
                   1U)) {
              goto _L___111;
            } else {
#line 334
              if (__s1_len___49 >= 4U) {
                _L___111: 
#line 334
                if (! ((unsigned int )((void const   *)("quit" + 1)) - (unsigned int )((void const   *)"quit") ==
                       1U)) {
#line 334
                  tmp___430 = 1;
                } else {
#line 334
                  if (__s2_len___49 >= 4U) {
#line 334
                    tmp___430 = 1;
                  } else {
#line 334
                    tmp___430 = 0;
                  }
                }
              } else {
#line 334
                tmp___430 = 0;
              }
            }
#line 334
            if (tmp___430) {
#line 334
              if (__s1_len___49 < __s2_len___49) {
#line 334
                tmp___428 = __s1_len___49;
              } else {
#line 334
                tmp___428 = __s2_len___49;
              }
              {
#line 334
              tmp___427 = memcmp((void const   *)((char const   *)(cmd)), (void const   *)"quit",
                                 tmp___428 + 1U);
              }
            } else {
              {
#line 334
              tmp___429 = strcmp((char const   *)(cmd), "quit");
#line 334
              tmp___427 = tmp___429;
              }
            }
          } else {
            {
#line 334
            tmp___429 = strcmp((char const   *)(cmd), "quit");
#line 334
            tmp___427 = tmp___429;
            }
          }
#line 334
          if (tmp___427) {
#line 339
            if (0) {
              {
#line 339
              __s1_len___48 = strlen((char const   *)(cmd));
#line 339
              __s2_len___48 = strlen("syst");
              }
#line 339
              if (! ((unsigned int )((void const   *)(cmd + 1)) - (unsigned int )((void const   *)(cmd)) ==
                     1U)) {
                goto _L___109;
              } else {
#line 339
                if (__s1_len___48 >= 4U) {
                  _L___109: 
#line 339
                  if (! ((unsigned int )((void const   *)("syst" + 1)) - (unsigned int )((void const   *)"syst") ==
                         1U)) {
#line 339
                    tmp___422 = 1;
                  } else {
#line 339
                    if (__s2_len___48 >= 4U) {
#line 339
                      tmp___422 = 1;
                    } else {
#line 339
                      tmp___422 = 0;
                    }
                  }
                } else {
#line 339
                  tmp___422 = 0;
                }
              }
#line 339
              if (tmp___422) {
#line 339
                if (__s1_len___48 < __s2_len___48) {
#line 339
                  tmp___420 = __s1_len___48;
                } else {
#line 339
                  tmp___420 = __s2_len___48;
                }
                {
#line 339
                tmp___419 = memcmp((void const   *)((char const   *)(cmd)), (void const   *)"syst",
                                   tmp___420 + 1U);
                }
              } else {
                {
#line 339
                tmp___421 = strcmp((char const   *)(cmd), "syst");
#line 339
                tmp___419 = tmp___421;
                }
              }
            } else {
              {
#line 339
              tmp___421 = strcmp((char const   *)(cmd), "syst");
#line 339
              tmp___419 = tmp___421;
              }
            }
#line 339
            if (tmp___419) {
#line 373
              if (0) {
                {
#line 373
                __s1_len___46 = strlen((char const   *)(cmd));
#line 373
                __s2_len___46 = strlen("auth");
                }
#line 373
                if (! ((unsigned int )((void const   *)(cmd + 1)) - (unsigned int )((void const   *)(cmd)) ==
                       1U)) {
                  goto _L___105;
                } else {
#line 373
                  if (__s1_len___46 >= 4U) {
                    _L___105: 
#line 373
                    if (! ((unsigned int )((void const   *)("auth" + 1)) - (unsigned int )((void const   *)"auth") ==
                           1U)) {
#line 373
                      tmp___406 = 1;
                    } else {
#line 373
                      if (__s2_len___46 >= 4U) {
#line 373
                        tmp___406 = 1;
                      } else {
#line 373
                        tmp___406 = 0;
                      }
                    }
                  } else {
#line 373
                    tmp___406 = 0;
                  }
                }
#line 373
                if (tmp___406) {
#line 373
                  if (__s1_len___46 < __s2_len___46) {
#line 373
                    tmp___404 = __s1_len___46;
                  } else {
#line 373
                    tmp___404 = __s2_len___46;
                  }
                  {
#line 373
                  tmp___403 = memcmp((void const   *)((char const   *)(cmd)), (void const   *)"auth",
                                     tmp___404 + 1U);
                  }
                } else {
                  {
#line 373
                  tmp___405 = strcmp((char const   *)(cmd), "auth");
#line 373
                  tmp___403 = tmp___405;
                  }
                }
              } else {
                {
#line 373
                tmp___405 = strcmp((char const   *)(cmd), "auth");
#line 373
                tmp___403 = tmp___405;
                }
              }
#line 373
              if (tmp___403) {
#line 373
                if (0) {
                  {
#line 373
                  __s1_len___47 = strlen((char const   *)(cmd));
#line 373
                  __s2_len___47 = strlen("adat");
                  }
#line 373
                  if (! ((unsigned int )((void const   *)(cmd + 1)) - (unsigned int )((void const   *)(cmd)) ==
                         1U)) {
                    goto _L___107;
                  } else {
#line 373
                    if (__s1_len___47 >= 4U) {
                      _L___107: 
#line 373
                      if (! ((unsigned int )((void const   *)("adat" + 1)) - (unsigned int )((void const   *)"adat") ==
                             1U)) {
#line 373
                        tmp___414 = 1;
                      } else {
#line 373
                        if (__s2_len___47 >= 4U) {
#line 373
                          tmp___414 = 1;
                        } else {
#line 373
                          tmp___414 = 0;
                        }
                      }
                    } else {
#line 373
                      tmp___414 = 0;
                    }
                  }
#line 373
                  if (tmp___414) {
#line 373
                    if (__s1_len___47 < __s2_len___47) {
#line 373
                      tmp___412 = __s1_len___47;
                    } else {
#line 373
                      tmp___412 = __s2_len___47;
                    }
                    {
#line 373
                    tmp___411 = memcmp((void const   *)((char const   *)(cmd)), (void const   *)"adat",
                                       tmp___412 + 1U);
                    }
                  } else {
                    {
#line 373
                    tmp___413 = strcmp((char const   *)(cmd), "adat");
#line 373
                    tmp___411 = tmp___413;
                    }
                  }
                } else {
                  {
#line 373
                  tmp___413 = strcmp((char const   *)(cmd), "adat");
#line 373
                  tmp___411 = tmp___413;
                  }
                }
#line 373
                if (tmp___411) {
#line 375
                  if (0) {
                    {
#line 375
                    __s1_len___45 = strlen((char const   *)(cmd));
#line 375
                    __s2_len___45 = strlen("type");
                    }
#line 375
                    if (! ((unsigned int )((void const   *)(cmd + 1)) - (unsigned int )((void const   *)(cmd)) ==
                           1U)) {
                      goto _L___103;
                    } else {
#line 375
                      if (__s1_len___45 >= 4U) {
                        _L___103: 
#line 375
                        if (! ((unsigned int )((void const   *)("type" + 1)) - (unsigned int )((void const   *)"type") ==
                               1U)) {
#line 375
                          tmp___398 = 1;
                        } else {
#line 375
                          if (__s2_len___45 >= 4U) {
#line 375
                            tmp___398 = 1;
                          } else {
#line 375
                            tmp___398 = 0;
                          }
                        }
                      } else {
#line 375
                        tmp___398 = 0;
                      }
                    }
#line 375
                    if (tmp___398) {
#line 375
                      if (__s1_len___45 < __s2_len___45) {
#line 375
                        tmp___396 = __s1_len___45;
                      } else {
#line 375
                        tmp___396 = __s2_len___45;
                      }
                      {
#line 375
                      tmp___395 = memcmp((void const   *)((char const   *)(cmd)),
                                         (void const   *)"type", tmp___396 + 1U);
                      }
                    } else {
                      {
#line 375
                      tmp___397 = strcmp((char const   *)(cmd), "type");
#line 375
                      tmp___395 = tmp___397;
                      }
                    }
                  } else {
                    {
#line 375
                    tmp___397 = strcmp((char const   *)(cmd), "type");
#line 375
                    tmp___395 = tmp___397;
                    }
                  }
#line 375
                  if (tmp___395) {
#line 379
                    if (0) {
                      {
#line 379
                      __s1_len___44 = strlen((char const   *)(cmd));
#line 379
                      __s2_len___44 = strlen("mode");
                      }
#line 379
                      if (! ((unsigned int )((void const   *)(cmd + 1)) - (unsigned int )((void const   *)(cmd)) ==
                             1U)) {
                        goto _L___101;
                      } else {
#line 379
                        if (__s1_len___44 >= 4U) {
                          _L___101: 
#line 379
                          if (! ((unsigned int )((void const   *)("mode" + 1)) - (unsigned int )((void const   *)"mode") ==
                                 1U)) {
#line 379
                            tmp___390 = 1;
                          } else {
#line 379
                            if (__s2_len___44 >= 4U) {
#line 379
                              tmp___390 = 1;
                            } else {
#line 379
                              tmp___390 = 0;
                            }
                          }
                        } else {
#line 379
                          tmp___390 = 0;
                        }
                      }
#line 379
                      if (tmp___390) {
#line 379
                        if (__s1_len___44 < __s2_len___44) {
#line 379
                          tmp___388 = __s1_len___44;
                        } else {
#line 379
                          tmp___388 = __s2_len___44;
                        }
                        {
#line 379
                        tmp___387 = memcmp((void const   *)((char const   *)(cmd)),
                                           (void const   *)"mode", tmp___388 + 1U);
                        }
                      } else {
                        {
#line 379
                        tmp___389 = strcmp((char const   *)(cmd), "mode");
#line 379
                        tmp___387 = tmp___389;
                        }
                      }
                    } else {
                      {
#line 379
                      tmp___389 = strcmp((char const   *)(cmd), "mode");
#line 379
                      tmp___387 = tmp___389;
                      }
                    }
#line 379
                    if (tmp___387) {
#line 384
                      if (0) {
                        {
#line 384
                        __s1_len___43 = strlen((char const   *)(cmd));
#line 384
                        __s2_len___43 = strlen("feat");
                        }
#line 384
                        if (! ((unsigned int )((void const   *)(cmd + 1)) - (unsigned int )((void const   *)(cmd)) ==
                               1U)) {
                          goto _L___99;
                        } else {
#line 384
                          if (__s1_len___43 >= 4U) {
                            _L___99: 
#line 384
                            if (! ((unsigned int )((void const   *)("feat" + 1)) -
                                   (unsigned int )((void const   *)"feat") == 1U)) {
#line 384
                              tmp___382 = 1;
                            } else {
#line 384
                              if (__s2_len___43 >= 4U) {
#line 384
                                tmp___382 = 1;
                              } else {
#line 384
                                tmp___382 = 0;
                              }
                            }
                          } else {
#line 384
                            tmp___382 = 0;
                          }
                        }
#line 384
                        if (tmp___382) {
#line 384
                          if (__s1_len___43 < __s2_len___43) {
#line 384
                            tmp___380 = __s1_len___43;
                          } else {
#line 384
                            tmp___380 = __s2_len___43;
                          }
                          {
#line 384
                          tmp___379 = memcmp((void const   *)((char const   *)(cmd)),
                                             (void const   *)"feat", tmp___380 + 1U);
                          }
                        } else {
                          {
#line 384
                          tmp___381 = strcmp((char const   *)(cmd), "feat");
#line 384
                          tmp___379 = tmp___381;
                          }
                        }
                      } else {
                        {
#line 384
                        tmp___381 = strcmp((char const   *)(cmd), "feat");
#line 384
                        tmp___379 = tmp___381;
                        }
                      }
#line 384
                      if (tmp___379) {
#line 387
                        if (0) {
                          {
#line 387
                          __s1_len___42 = strlen((char const   *)(cmd));
#line 387
                          __s2_len___42 = strlen("opts");
                          }
#line 387
                          if (! ((unsigned int )((void const   *)(cmd + 1)) - (unsigned int )((void const   *)(cmd)) ==
                                 1U)) {
                            goto _L___97;
                          } else {
#line 387
                            if (__s1_len___42 >= 4U) {
                              _L___97: 
#line 387
                              if (! ((unsigned int )((void const   *)("opts" + 1)) -
                                     (unsigned int )((void const   *)"opts") == 1U)) {
#line 387
                                tmp___374 = 1;
                              } else {
#line 387
                                if (__s2_len___42 >= 4U) {
#line 387
                                  tmp___374 = 1;
                                } else {
#line 387
                                  tmp___374 = 0;
                                }
                              }
                            } else {
#line 387
                              tmp___374 = 0;
                            }
                          }
#line 387
                          if (tmp___374) {
#line 387
                            if (__s1_len___42 < __s2_len___42) {
#line 387
                              tmp___372 = __s1_len___42;
                            } else {
#line 387
                              tmp___372 = __s2_len___42;
                            }
                            {
#line 387
                            tmp___371 = memcmp((void const   *)((char const   *)(cmd)),
                                               (void const   *)"opts", tmp___372 +
                                                                       1U);
                            }
                          } else {
                            {
#line 387
                            tmp___373 = strcmp((char const   *)(cmd), "opts");
#line 387
                            tmp___371 = tmp___373;
                            }
                          }
                        } else {
                          {
#line 387
                          tmp___373 = strcmp((char const   *)(cmd), "opts");
#line 387
                          tmp___371 = tmp___373;
                          }
                        }
#line 387
                        if (tmp___371) {
#line 391
                          if (0) {
                            {
#line 391
                            __s1_len___41 = strlen((char const   *)(cmd));
#line 391
                            __s2_len___41 = strlen("stru");
                            }
#line 391
                            if (! ((unsigned int )((void const   *)(cmd + 1)) - (unsigned int )((void const   *)(cmd)) ==
                                   1U)) {
                              goto _L___95;
                            } else {
#line 391
                              if (__s1_len___41 >= 4U) {
                                _L___95: 
#line 391
                                if (! ((unsigned int )((void const   *)("stru" + 1)) -
                                       (unsigned int )((void const   *)"stru") ==
                                       1U)) {
#line 391
                                  tmp___366 = 1;
                                } else {
#line 391
                                  if (__s2_len___41 >= 4U) {
#line 391
                                    tmp___366 = 1;
                                  } else {
#line 391
                                    tmp___366 = 0;
                                  }
                                }
                              } else {
#line 391
                                tmp___366 = 0;
                              }
                            }
#line 391
                            if (tmp___366) {
#line 391
                              if (__s1_len___41 < __s2_len___41) {
#line 391
                                tmp___364 = __s1_len___41;
                              } else {
#line 391
                                tmp___364 = __s2_len___41;
                              }
                              {
#line 391
                              tmp___363 = memcmp((void const   *)((char const   *)(cmd)),
                                                 (void const   *)"stru", tmp___364 +
                                                                         1U);
                              }
                            } else {
                              {
#line 391
                              tmp___365 = strcmp((char const   *)(cmd), "stru");
#line 391
                              tmp___363 = tmp___365;
                              }
                            }
                          } else {
                            {
#line 391
                            tmp___365 = strcmp((char const   *)(cmd), "stru");
#line 391
                            tmp___363 = tmp___365;
                            }
                          }
#line 391
                          if (tmp___363) {
#line 395
                            if (0) {
                              {
#line 395
                              __s1_len___40 = strlen((char const   *)(cmd));
#line 395
                              __s2_len___40 = strlen("help");
                              }
#line 395
                              if (! ((unsigned int )((void const   *)(cmd + 1)) -
                                     (unsigned int )((void const   *)(cmd)) == 1U)) {
                                goto _L___93;
                              } else {
#line 395
                                if (__s1_len___40 >= 4U) {
                                  _L___93: 
#line 395
                                  if (! ((unsigned int )((void const   *)("help" +
                                                                          1)) - (unsigned int )((void const   *)"help") ==
                                         1U)) {
#line 395
                                    tmp___358 = 1;
                                  } else {
#line 395
                                    if (__s2_len___40 >= 4U) {
#line 395
                                      tmp___358 = 1;
                                    } else {
#line 395
                                      tmp___358 = 0;
                                    }
                                  }
                                } else {
#line 395
                                  tmp___358 = 0;
                                }
                              }
#line 395
                              if (tmp___358) {
#line 395
                                if (__s1_len___40 < __s2_len___40) {
#line 395
                                  tmp___356 = __s1_len___40;
                                } else {
#line 395
                                  tmp___356 = __s2_len___40;
                                }
                                {
#line 395
                                tmp___355 = memcmp((void const   *)((char const   *)(cmd)),
                                                   (void const   *)"help", tmp___356 +
                                                                           1U);
                                }
                              } else {
                                {
#line 395
                                tmp___357 = strcmp((char const   *)(cmd), "help");
#line 395
                                tmp___355 = tmp___357;
                                }
                              }
                            } else {
                              {
#line 395
                              tmp___357 = strcmp((char const   *)(cmd), "help");
#line 395
                              tmp___355 = tmp___357;
                              }
                            }
#line 395
                            if (tmp___355) {
#line 404
                              if ((int )loggedin == 0) {
                                {
#line 406
                                addreply_noformat(530, "You aren\'t logged in");
                                }
                                goto wayout;
                              } else {
#line 409
                                if (0) {
                                  {
#line 409
                                  __s1_len___38 = strlen((char const   *)(cmd));
#line 409
                                  __s2_len___38 = strlen("cwd");
                                  }
#line 409
                                  if (! ((unsigned int )((void const   *)(cmd + 1)) -
                                         (unsigned int )((void const   *)(cmd)) ==
                                         1U)) {
                                    goto _L___89;
                                  } else {
#line 409
                                    if (__s1_len___38 >= 4U) {
                                      _L___89: 
#line 409
                                      if (! ((unsigned int )((void const   *)("cwd" +
                                                                              1)) -
                                             (unsigned int )((void const   *)"cwd") ==
                                             1U)) {
#line 409
                                        tmp___342 = 1;
                                      } else {
#line 409
                                        if (__s2_len___38 >= 4U) {
#line 409
                                          tmp___342 = 1;
                                        } else {
#line 409
                                          tmp___342 = 0;
                                        }
                                      }
                                    } else {
#line 409
                                      tmp___342 = 0;
                                    }
                                  }
#line 409
                                  if (tmp___342) {
#line 409
                                    if (__s1_len___38 < __s2_len___38) {
#line 409
                                      tmp___340 = __s1_len___38;
                                    } else {
#line 409
                                      tmp___340 = __s2_len___38;
                                    }
                                    {
#line 409
                                    tmp___339 = memcmp((void const   *)((char const   *)(cmd)),
                                                       (void const   *)"cwd", tmp___340 +
                                                                              1U);
                                    }
                                  } else {
                                    {
#line 409
                                    tmp___341 = strcmp((char const   *)(cmd), "cwd");
#line 409
                                    tmp___339 = tmp___341;
                                    }
                                  }
                                } else {
                                  {
#line 409
                                  tmp___341 = strcmp((char const   *)(cmd), "cwd");
#line 409
                                  tmp___339 = tmp___341;
                                  }
                                }
#line 409
                                if (tmp___339) {
#line 409
                                  if (0) {
                                    {
#line 409
                                    __s1_len___39 = strlen((char const   *)(cmd));
#line 409
                                    __s2_len___39 = strlen("xcwd");
                                    }
#line 409
                                    if (! ((unsigned int )((void const   *)(cmd +
                                                                            1)) -
                                           (unsigned int )((void const   *)(cmd)) ==
                                           1U)) {
                                      goto _L___91;
                                    } else {
#line 409
                                      if (__s1_len___39 >= 4U) {
                                        _L___91: 
#line 409
                                        if (! ((unsigned int )((void const   *)("xcwd" +
                                                                                1)) -
                                               (unsigned int )((void const   *)"xcwd") ==
                                               1U)) {
#line 409
                                          tmp___350 = 1;
                                        } else {
#line 409
                                          if (__s2_len___39 >= 4U) {
#line 409
                                            tmp___350 = 1;
                                          } else {
#line 409
                                            tmp___350 = 0;
                                          }
                                        }
                                      } else {
#line 409
                                        tmp___350 = 0;
                                      }
                                    }
#line 409
                                    if (tmp___350) {
#line 409
                                      if (__s1_len___39 < __s2_len___39) {
#line 409
                                        tmp___348 = __s1_len___39;
                                      } else {
#line 409
                                        tmp___348 = __s2_len___39;
                                      }
                                      {
#line 409
                                      tmp___347 = memcmp((void const   *)((char const   *)(cmd)),
                                                         (void const   *)"xcwd", tmp___348 +
                                                                                 1U);
                                      }
                                    } else {
                                      {
#line 409
                                      tmp___349 = strcmp((char const   *)(cmd), "xcwd");
#line 409
                                      tmp___347 = tmp___349;
                                      }
                                    }
                                  } else {
                                    {
#line 409
                                    tmp___349 = strcmp((char const   *)(cmd), "xcwd");
#line 409
                                    tmp___347 = tmp___349;
                                    }
                                  }
#line 409
                                  if (tmp___347) {
#line 413
                                    if (0) {
                                      {
#line 413
                                      __s1_len___37 = strlen((char const   *)(cmd));
#line 413
                                      __s2_len___37 = strlen("port");
                                      }
#line 413
                                      if (! ((unsigned int )((void const   *)(cmd +
                                                                              1)) -
                                             (unsigned int )((void const   *)(cmd)) ==
                                             1U)) {
                                        goto _L___87;
                                      } else {
#line 413
                                        if (__s1_len___37 >= 4U) {
                                          _L___87: 
#line 413
                                          if (! ((unsigned int )((void const   *)("port" +
                                                                                  1)) -
                                                 (unsigned int )((void const   *)"port") ==
                                                 1U)) {
#line 413
                                            tmp___334 = 1;
                                          } else {
#line 413
                                            if (__s2_len___37 >= 4U) {
#line 413
                                              tmp___334 = 1;
                                            } else {
#line 413
                                              tmp___334 = 0;
                                            }
                                          }
                                        } else {
#line 413
                                          tmp___334 = 0;
                                        }
                                      }
#line 413
                                      if (tmp___334) {
#line 413
                                        if (__s1_len___37 < __s2_len___37) {
#line 413
                                          tmp___332 = __s1_len___37;
                                        } else {
#line 413
                                          tmp___332 = __s2_len___37;
                                        }
                                        {
#line 413
                                        tmp___331 = memcmp((void const   *)((char const   *)(cmd)),
                                                           (void const   *)"port",
                                                           tmp___332 + 1U);
                                        }
                                      } else {
                                        {
#line 413
                                        tmp___333 = strcmp((char const   *)(cmd),
                                                           "port");
#line 413
                                        tmp___331 = tmp___333;
                                        }
                                      }
                                    } else {
                                      {
#line 413
                                      tmp___333 = strcmp((char const   *)(cmd), "port");
#line 413
                                      tmp___331 = tmp___333;
                                      }
                                    }
#line 413
                                    if (tmp___331) {
#line 416
                                      if (0) {
                                        {
#line 416
                                        __s1_len___36 = strlen((char const   *)(cmd));
#line 416
                                        __s2_len___36 = strlen("eprt");
                                        }
#line 416
                                        if (! ((unsigned int )((void const   *)(cmd +
                                                                                1)) -
                                               (unsigned int )((void const   *)(cmd)) ==
                                               1U)) {
                                          goto _L___85;
                                        } else {
#line 416
                                          if (__s1_len___36 >= 4U) {
                                            _L___85: 
#line 416
                                            if (! ((unsigned int )((void const   *)("eprt" +
                                                                                    1)) -
                                                   (unsigned int )((void const   *)"eprt") ==
                                                   1U)) {
#line 416
                                              tmp___326 = 1;
                                            } else {
#line 416
                                              if (__s2_len___36 >= 4U) {
#line 416
                                                tmp___326 = 1;
                                              } else {
#line 416
                                                tmp___326 = 0;
                                              }
                                            }
                                          } else {
#line 416
                                            tmp___326 = 0;
                                          }
                                        }
#line 416
                                        if (tmp___326) {
#line 416
                                          if (__s1_len___36 < __s2_len___36) {
#line 416
                                            tmp___324 = __s1_len___36;
                                          } else {
#line 416
                                            tmp___324 = __s2_len___36;
                                          }
                                          {
#line 416
                                          tmp___323 = memcmp((void const   *)((char const   *)(cmd)),
                                                             (void const   *)"eprt",
                                                             tmp___324 + 1U);
                                          }
                                        } else {
                                          {
#line 416
                                          tmp___325 = strcmp((char const   *)(cmd),
                                                             "eprt");
#line 416
                                          tmp___323 = tmp___325;
                                          }
                                        }
                                      } else {
                                        {
#line 416
                                        tmp___325 = strcmp((char const   *)(cmd),
                                                           "eprt");
#line 416
                                        tmp___323 = tmp___325;
                                        }
                                      }
#line 416
                                      if (tmp___323) {
#line 418
                                        if (0) {
                                          {
#line 418
                                          __s1_len___35 = strlen((char const   *)(cmd));
#line 418
                                          __s2_len___35 = strlen("esta");
                                          }
#line 418
                                          if (! ((unsigned int )((void const   *)(cmd +
                                                                                  1)) -
                                                 (unsigned int )((void const   *)(cmd)) ==
                                                 1U)) {
                                            goto _L___81;
                                          } else {
#line 418
                                            if (__s1_len___35 >= 4U) {
                                              _L___81: 
#line 418
                                              if (! ((unsigned int )((void const   *)("esta" +
                                                                                      1)) -
                                                     (unsigned int )((void const   *)"esta") ==
                                                     1U)) {
#line 418
                                                tmp___318 = 1;
                                              } else {
#line 418
                                                if (__s2_len___35 >= 4U) {
#line 418
                                                  tmp___318 = 1;
                                                } else {
#line 418
                                                  tmp___318 = 0;
                                                }
                                              }
                                            } else {
#line 418
                                              tmp___318 = 0;
                                            }
                                          }
#line 418
                                          if (tmp___318) {
#line 418
                                            if (__s1_len___35 < __s2_len___35) {
#line 418
                                              tmp___316 = __s1_len___35;
                                            } else {
#line 418
                                              tmp___316 = __s2_len___35;
                                            }
                                            {
#line 418
                                            tmp___315 = memcmp((void const   *)((char const   *)(cmd)),
                                                               (void const   *)"esta",
                                                               tmp___316 + 1U);
                                            }
                                          } else {
                                            {
#line 418
                                            tmp___317 = strcmp((char const   *)(cmd),
                                                               "esta");
#line 418
                                            tmp___315 = tmp___317;
                                            }
                                          }
                                        } else {
                                          {
#line 418
                                          tmp___317 = strcmp((char const   *)(cmd),
                                                             "esta");
#line 418
                                          tmp___315 = tmp___317;
                                          }
                                        }
#line 418
                                        if (tmp___315) {
                                          _L___83: 
#line 422
                                          if (0) {
                                            {
#line 422
                                            __s1_len___34 = strlen((char const   *)(cmd));
#line 422
                                            __s2_len___34 = strlen("estp");
                                            }
#line 422
                                            if (! ((unsigned int )((void const   *)(cmd +
                                                                                    1)) -
                                                   (unsigned int )((void const   *)(cmd)) ==
                                                   1U)) {
                                              goto _L___79;
                                            } else {
#line 422
                                              if (__s1_len___34 >= 4U) {
                                                _L___79: 
#line 422
                                                if (! ((unsigned int )((void const   *)("estp" +
                                                                                        1)) -
                                                       (unsigned int )((void const   *)"estp") ==
                                                       1U)) {
#line 422
                                                  tmp___310 = 1;
                                                } else {
#line 422
                                                  if (__s2_len___34 >= 4U) {
#line 422
                                                    tmp___310 = 1;
                                                  } else {
#line 422
                                                    tmp___310 = 0;
                                                  }
                                                }
                                              } else {
#line 422
                                                tmp___310 = 0;
                                              }
                                            }
#line 422
                                            if (tmp___310) {
#line 422
                                              if (__s1_len___34 < __s2_len___34) {
#line 422
                                                tmp___308 = __s1_len___34;
                                              } else {
#line 422
                                                tmp___308 = __s2_len___34;
                                              }
                                              {
#line 422
                                              tmp___307 = memcmp((void const   *)((char const   *)(cmd)),
                                                                 (void const   *)"estp",
                                                                 tmp___308 + 1U);
                                              }
                                            } else {
                                              {
#line 422
                                              tmp___309 = strcmp((char const   *)(cmd),
                                                                 "estp");
#line 422
                                              tmp___307 = tmp___309;
                                              }
                                            }
                                          } else {
                                            {
#line 422
                                            tmp___309 = strcmp((char const   *)(cmd),
                                                               "estp");
#line 422
                                            tmp___307 = tmp___309;
                                            }
                                          }
#line 422
                                          if (tmp___307) {
#line 426
                                            if ((int )disallow_passive == 0) {
#line 426
                                              if (0) {
                                                {
#line 426
                                                __s1_len___32 = strlen((char const   *)(cmd));
#line 426
                                                __s2_len___32 = strlen("pasv");
                                                }
#line 426
                                                if (! ((unsigned int )((void const   *)(cmd +
                                                                                        1)) -
                                                       (unsigned int )((void const   *)(cmd)) ==
                                                       1U)) {
                                                  goto _L___74;
                                                } else {
#line 426
                                                  if (__s1_len___32 >= 4U) {
                                                    _L___74: 
#line 426
                                                    if (! ((unsigned int )((void const   *)("pasv" +
                                                                                            1)) -
                                                           (unsigned int )((void const   *)"pasv") ==
                                                           1U)) {
#line 426
                                                      tmp___294 = 1;
                                                    } else {
#line 426
                                                      if (__s2_len___32 >= 4U) {
#line 426
                                                        tmp___294 = 1;
                                                      } else {
#line 426
                                                        tmp___294 = 0;
                                                      }
                                                    }
                                                  } else {
#line 426
                                                    tmp___294 = 0;
                                                  }
                                                }
#line 426
                                                if (tmp___294) {
#line 426
                                                  if (__s1_len___32 < __s2_len___32) {
#line 426
                                                    tmp___292 = __s1_len___32;
                                                  } else {
#line 426
                                                    tmp___292 = __s2_len___32;
                                                  }
                                                  {
#line 426
                                                  tmp___291 = memcmp((void const   *)((char const   *)(cmd)),
                                                                     (void const   *)"pasv",
                                                                     tmp___292 + 1U);
                                                  }
                                                } else {
                                                  {
#line 426
                                                  tmp___293 = strcmp((char const   *)(cmd),
                                                                     "pasv");
#line 426
                                                  tmp___291 = tmp___293;
                                                  }
                                                }
                                              } else {
                                                {
#line 426
                                                tmp___293 = strcmp((char const   *)(cmd),
                                                                   "pasv");
#line 426
                                                tmp___291 = tmp___293;
                                                }
                                              }
#line 426
                                              if (tmp___291) {
#line 426
                                                if (0) {
                                                  {
#line 426
                                                  __s1_len___33 = strlen((char const   *)(cmd));
#line 426
                                                  __s2_len___33 = strlen("p@sw");
                                                  }
#line 426
                                                  if (! ((unsigned int )((void const   *)(cmd +
                                                                                          1)) -
                                                         (unsigned int )((void const   *)(cmd)) ==
                                                         1U)) {
                                                    goto _L___76;
                                                  } else {
#line 426
                                                    if (__s1_len___33 >= 4U) {
                                                      _L___76: 
#line 426
                                                      if (! ((unsigned int )((void const   *)("p@sw" +
                                                                                              1)) -
                                                             (unsigned int )((void const   *)"p@sw") ==
                                                             1U)) {
#line 426
                                                        tmp___302 = 1;
                                                      } else {
#line 426
                                                        if (__s2_len___33 >= 4U) {
#line 426
                                                          tmp___302 = 1;
                                                        } else {
#line 426
                                                          tmp___302 = 0;
                                                        }
                                                      }
                                                    } else {
#line 426
                                                      tmp___302 = 0;
                                                    }
                                                  }
#line 426
                                                  if (tmp___302) {
#line 426
                                                    if (__s1_len___33 < __s2_len___33) {
#line 426
                                                      tmp___300 = __s1_len___33;
                                                    } else {
#line 426
                                                      tmp___300 = __s2_len___33;
                                                    }
                                                    {
#line 426
                                                    tmp___299 = memcmp((void const   *)((char const   *)(cmd)),
                                                                       (void const   *)"p@sw",
                                                                       tmp___300 +
                                                                       1U);
                                                    }
                                                  } else {
                                                    {
#line 426
                                                    tmp___301 = strcmp((char const   *)(cmd),
                                                                       "p@sw");
#line 426
                                                    tmp___299 = tmp___301;
                                                    }
                                                  }
                                                } else {
                                                  {
#line 426
                                                  tmp___301 = strcmp((char const   *)(cmd),
                                                                     "p@sw");
#line 426
                                                  tmp___299 = tmp___301;
                                                  }
                                                }
#line 426
                                                if (tmp___299) {
                                                  goto _L___77;
                                                } else {
                                                  {
#line 427
                                                  dopasv(0);
                                                  }
                                                }
                                              } else {
                                                {
#line 427
                                                dopasv(0);
                                                }
                                              }
                                            } else {
                                              _L___77: 
#line 429
                                              if ((int )disallow_passive == 0) {
#line 429
                                                if (0) {
                                                  {
#line 429
                                                  __s1_len___31 = strlen((char const   *)(cmd));
#line 429
                                                  __s2_len___31 = strlen("epsv");
                                                  }
#line 429
                                                  if (! ((unsigned int )((void const   *)(cmd +
                                                                                          1)) -
                                                         (unsigned int )((void const   *)(cmd)) ==
                                                         1U)) {
                                                    goto _L___70;
                                                  } else {
#line 429
                                                    if (__s1_len___31 >= 4U) {
                                                      _L___70: 
#line 429
                                                      if (! ((unsigned int )((void const   *)("epsv" +
                                                                                              1)) -
                                                             (unsigned int )((void const   *)"epsv") ==
                                                             1U)) {
#line 429
                                                        tmp___286 = 1;
                                                      } else {
#line 429
                                                        if (__s2_len___31 >= 4U) {
#line 429
                                                          tmp___286 = 1;
                                                        } else {
#line 429
                                                          tmp___286 = 0;
                                                        }
                                                      }
                                                    } else {
#line 429
                                                      tmp___286 = 0;
                                                    }
                                                  }
#line 429
                                                  if (tmp___286) {
#line 429
                                                    if (__s1_len___31 < __s2_len___31) {
#line 429
                                                      tmp___284 = __s1_len___31;
                                                    } else {
#line 429
                                                      tmp___284 = __s2_len___31;
                                                    }
                                                    {
#line 429
                                                    tmp___283 = memcmp((void const   *)((char const   *)(cmd)),
                                                                       (void const   *)"epsv",
                                                                       tmp___284 +
                                                                       1U);
                                                    }
                                                  } else {
                                                    {
#line 429
                                                    tmp___285 = strcmp((char const   *)(cmd),
                                                                       "epsv");
#line 429
                                                    tmp___283 = tmp___285;
                                                    }
                                                  }
                                                } else {
                                                  {
#line 429
                                                  tmp___285 = strcmp((char const   *)(cmd),
                                                                     "epsv");
#line 429
                                                  tmp___283 = tmp___285;
                                                  }
                                                }
#line 429
                                                if (tmp___283) {
                                                  goto _L___71;
                                                } else {
#line 429
                                                  if ((int )broken_client_compat ==
                                                      0) {
                                                    goto _L___72;
                                                  } else {
#line 429
                                                    if ((int )ctrlconn.ss_family ==
                                                        10) {
                                                      _L___72: 
                                                      {
#line 432
                                                      tmp___46 = strcasecmp((char const   *)arg,
                                                                            "all");
                                                      }
#line 432
                                                      if (tmp___46) {
#line 435
                                                        if (0) {
                                                          {
#line 435
                                                          __s1_len___3 = strlen((char const   *)arg);
#line 435
                                                          __s2_len___3 = strlen("2");
                                                          }
#line 435
                                                          if (! ((unsigned int )((void const   *)(arg +
                                                                                                  1)) -
                                                                 (unsigned int )((void const   *)arg) ==
                                                                 1U)) {
                                                            goto _L___9;
                                                          } else {
#line 435
                                                            if (__s1_len___3 >= 4U) {
                                                              _L___9: 
#line 435
                                                              if (! ((unsigned int )((void const   *)("2" +
                                                                                                      1)) -
                                                                     (unsigned int )((void const   *)"2") ==
                                                                     1U)) {
#line 435
                                                                tmp___45 = 1;
                                                              } else {
#line 435
                                                                if (__s2_len___3 >=
                                                                    4U) {
#line 435
                                                                  tmp___45 = 1;
                                                                } else {
#line 435
                                                                  tmp___45 = 0;
                                                                }
                                                              }
                                                            } else {
#line 435
                                                              tmp___45 = 0;
                                                            }
                                                          }
#line 435
                                                          if (tmp___45) {
#line 435
                                                            if (__s1_len___3 < __s2_len___3) {
#line 435
                                                              tmp___43 = __s1_len___3;
                                                            } else {
#line 435
                                                              tmp___43 = __s2_len___3;
                                                            }
                                                            {
#line 435
                                                            tmp___42 = memcmp((void const   *)((char const   *)arg),
                                                                              (void const   *)"2",
                                                                              tmp___43 +
                                                                              1U);
                                                            }
                                                          } else {
                                                            {
#line 435
                                                            tmp___44 = strcmp((char const   *)arg,
                                                                              "2");
#line 435
                                                            tmp___42 = tmp___44;
                                                            }
                                                          }
                                                        } else {
                                                          {
#line 435
                                                          tmp___44 = strcmp((char const   *)arg,
                                                                            "2");
#line 435
                                                          tmp___42 = tmp___44;
                                                          }
                                                        }
#line 435
                                                        if (tmp___42) {
                                                          {
#line 438
                                                          dopasv(1);
                                                          }
                                                        } else {
#line 435
                                                          if (! v6ready) {
                                                            {
#line 436
                                                            addreply_noformat(522,
                                                                              "Only IPv4 is supported (1)");
                                                            }
                                                          } else {
                                                            {
#line 438
                                                            dopasv(1);
                                                            }
                                                          }
                                                        }
                                                      } else {
                                                        {
#line 433
                                                        epsv_all = 1;
#line 434
                                                        addreply_noformat(220, "Active mode is disabled");
                                                        }
                                                      }
                                                    } else {
                                                      goto _L___71;
                                                    }
                                                  }
                                                }
                                              } else {
                                                _L___71: 
#line 441
                                                if ((int )disallow_passive == 0) {
#line 441
                                                  if (0) {
                                                    {
#line 441
                                                    __s1_len___30 = strlen((char const   *)(cmd));
#line 441
                                                    __s2_len___30 = strlen("spsv");
                                                    }
#line 441
                                                    if (! ((unsigned int )((void const   *)(cmd +
                                                                                            1)) -
                                                           (unsigned int )((void const   *)(cmd)) ==
                                                           1U)) {
                                                      goto _L___67;
                                                    } else {
#line 441
                                                      if (__s1_len___30 >= 4U) {
                                                        _L___67: 
#line 441
                                                        if (! ((unsigned int )((void const   *)("spsv" +
                                                                                                1)) -
                                                               (unsigned int )((void const   *)"spsv") ==
                                                               1U)) {
#line 441
                                                          tmp___278 = 1;
                                                        } else {
#line 441
                                                          if (__s2_len___30 >= 4U) {
#line 441
                                                            tmp___278 = 1;
                                                          } else {
#line 441
                                                            tmp___278 = 0;
                                                          }
                                                        }
                                                      } else {
#line 441
                                                        tmp___278 = 0;
                                                      }
                                                    }
#line 441
                                                    if (tmp___278) {
#line 441
                                                      if (__s1_len___30 < __s2_len___30) {
#line 441
                                                        tmp___276 = __s1_len___30;
                                                      } else {
#line 441
                                                        tmp___276 = __s2_len___30;
                                                      }
                                                      {
#line 441
                                                      tmp___275 = memcmp((void const   *)((char const   *)(cmd)),
                                                                         (void const   *)"spsv",
                                                                         tmp___276 +
                                                                         1U);
                                                      }
                                                    } else {
                                                      {
#line 441
                                                      tmp___277 = strcmp((char const   *)(cmd),
                                                                         "spsv");
#line 441
                                                      tmp___275 = tmp___277;
                                                      }
                                                    }
                                                  } else {
                                                    {
#line 441
                                                    tmp___277 = strcmp((char const   *)(cmd),
                                                                       "spsv");
#line 441
                                                    tmp___275 = tmp___277;
                                                    }
                                                  }
#line 441
                                                  if (tmp___275) {
                                                    goto _L___68;
                                                  } else {
                                                    {
#line 442
                                                    dopasv(2);
                                                    }
                                                  }
                                                } else {
                                                  _L___68: 
#line 444
                                                  if (0) {
                                                    {
#line 444
                                                    __s1_len___28 = strlen((char const   *)(cmd));
#line 444
                                                    __s2_len___28 = strlen("pwd");
                                                    }
#line 444
                                                    if (! ((unsigned int )((void const   *)(cmd +
                                                                                            1)) -
                                                           (unsigned int )((void const   *)(cmd)) ==
                                                           1U)) {
                                                      goto _L___63;
                                                    } else {
#line 444
                                                      if (__s1_len___28 >= 4U) {
                                                        _L___63: 
#line 444
                                                        if (! ((unsigned int )((void const   *)("pwd" +
                                                                                                1)) -
                                                               (unsigned int )((void const   *)"pwd") ==
                                                               1U)) {
#line 444
                                                          tmp___262 = 1;
                                                        } else {
#line 444
                                                          if (__s2_len___28 >= 4U) {
#line 444
                                                            tmp___262 = 1;
                                                          } else {
#line 444
                                                            tmp___262 = 0;
                                                          }
                                                        }
                                                      } else {
#line 444
                                                        tmp___262 = 0;
                                                      }
                                                    }
#line 444
                                                    if (tmp___262) {
#line 444
                                                      if (__s1_len___28 < __s2_len___28) {
#line 444
                                                        tmp___260 = __s1_len___28;
                                                      } else {
#line 444
                                                        tmp___260 = __s2_len___28;
                                                      }
                                                      {
#line 444
                                                      tmp___259 = memcmp((void const   *)((char const   *)(cmd)),
                                                                         (void const   *)"pwd",
                                                                         tmp___260 +
                                                                         1U);
                                                      }
                                                    } else {
                                                      {
#line 444
                                                      tmp___261 = strcmp((char const   *)(cmd),
                                                                         "pwd");
#line 444
                                                      tmp___259 = tmp___261;
                                                      }
                                                    }
                                                  } else {
                                                    {
#line 444
                                                    tmp___261 = strcmp((char const   *)(cmd),
                                                                       "pwd");
#line 444
                                                    tmp___259 = tmp___261;
                                                    }
                                                  }
#line 444
                                                  if (tmp___259) {
#line 444
                                                    if (0) {
                                                      {
#line 444
                                                      __s1_len___29 = strlen((char const   *)(cmd));
#line 444
                                                      __s2_len___29 = strlen("xpwd");
                                                      }
#line 444
                                                      if (! ((unsigned int )((void const   *)(cmd +
                                                                                              1)) -
                                                             (unsigned int )((void const   *)(cmd)) ==
                                                             1U)) {
                                                        goto _L___65;
                                                      } else {
#line 444
                                                        if (__s1_len___29 >= 4U) {
                                                          _L___65: 
#line 444
                                                          if (! ((unsigned int )((void const   *)("xpwd" +
                                                                                                  1)) -
                                                                 (unsigned int )((void const   *)"xpwd") ==
                                                                 1U)) {
#line 444
                                                            tmp___270 = 1;
                                                          } else {
#line 444
                                                            if (__s2_len___29 >= 4U) {
#line 444
                                                              tmp___270 = 1;
                                                            } else {
#line 444
                                                              tmp___270 = 0;
                                                            }
                                                          }
                                                        } else {
#line 444
                                                          tmp___270 = 0;
                                                        }
                                                      }
#line 444
                                                      if (tmp___270) {
#line 444
                                                        if (__s1_len___29 < __s2_len___29) {
#line 444
                                                          tmp___268 = __s1_len___29;
                                                        } else {
#line 444
                                                          tmp___268 = __s2_len___29;
                                                        }
                                                        {
#line 444
                                                        tmp___267 = memcmp((void const   *)((char const   *)(cmd)),
                                                                           (void const   *)"xpwd",
                                                                           tmp___268 +
                                                                           1U);
                                                        }
                                                      } else {
                                                        {
#line 444
                                                        tmp___269 = strcmp((char const   *)(cmd),
                                                                           "xpwd");
#line 444
                                                        tmp___267 = tmp___269;
                                                        }
                                                      }
                                                    } else {
                                                      {
#line 444
                                                      tmp___269 = strcmp((char const   *)(cmd),
                                                                         "xpwd");
#line 444
                                                      tmp___267 = tmp___269;
                                                      }
                                                    }
#line 444
                                                    if (tmp___267) {
#line 457
                                                      if (0) {
                                                        {
#line 457
                                                        __s1_len___26 = strlen((char const   *)(cmd));
#line 457
                                                        __s2_len___26 = strlen("cdup");
                                                        }
#line 457
                                                        if (! ((unsigned int )((void const   *)(cmd +
                                                                                                1)) -
                                                               (unsigned int )((void const   *)(cmd)) ==
                                                               1U)) {
                                                          goto _L___59;
                                                        } else {
#line 457
                                                          if (__s1_len___26 >= 4U) {
                                                            _L___59: 
#line 457
                                                            if (! ((unsigned int )((void const   *)("cdup" +
                                                                                                    1)) -
                                                                   (unsigned int )((void const   *)"cdup") ==
                                                                   1U)) {
#line 457
                                                              tmp___246 = 1;
                                                            } else {
#line 457
                                                              if (__s2_len___26 >=
                                                                  4U) {
#line 457
                                                                tmp___246 = 1;
                                                              } else {
#line 457
                                                                tmp___246 = 0;
                                                              }
                                                            }
                                                          } else {
#line 457
                                                            tmp___246 = 0;
                                                          }
                                                        }
#line 457
                                                        if (tmp___246) {
#line 457
                                                          if (__s1_len___26 < __s2_len___26) {
#line 457
                                                            tmp___244 = __s1_len___26;
                                                          } else {
#line 457
                                                            tmp___244 = __s2_len___26;
                                                          }
                                                          {
#line 457
                                                          tmp___243 = memcmp((void const   *)((char const   *)(cmd)),
                                                                             (void const   *)"cdup",
                                                                             tmp___244 +
                                                                             1U);
                                                          }
                                                        } else {
                                                          {
#line 457
                                                          tmp___245 = strcmp((char const   *)(cmd),
                                                                             "cdup");
#line 457
                                                          tmp___243 = tmp___245;
                                                          }
                                                        }
                                                      } else {
                                                        {
#line 457
                                                        tmp___245 = strcmp((char const   *)(cmd),
                                                                           "cdup");
#line 457
                                                        tmp___243 = tmp___245;
                                                        }
                                                      }
#line 457
                                                      if (tmp___243) {
#line 457
                                                        if (0) {
                                                          {
#line 457
                                                          __s1_len___27 = strlen((char const   *)(cmd));
#line 457
                                                          __s2_len___27 = strlen("xcup");
                                                          }
#line 457
                                                          if (! ((unsigned int )((void const   *)(cmd +
                                                                                                  1)) -
                                                                 (unsigned int )((void const   *)(cmd)) ==
                                                                 1U)) {
                                                            goto _L___61;
                                                          } else {
#line 457
                                                            if (__s1_len___27 >= 4U) {
                                                              _L___61: 
#line 457
                                                              if (! ((unsigned int )((void const   *)("xcup" +
                                                                                                      1)) -
                                                                     (unsigned int )((void const   *)"xcup") ==
                                                                     1U)) {
#line 457
                                                                tmp___254 = 1;
                                                              } else {
#line 457
                                                                if (__s2_len___27 >=
                                                                    4U) {
#line 457
                                                                  tmp___254 = 1;
                                                                } else {
#line 457
                                                                  tmp___254 = 0;
                                                                }
                                                              }
                                                            } else {
#line 457
                                                              tmp___254 = 0;
                                                            }
                                                          }
#line 457
                                                          if (tmp___254) {
#line 457
                                                            if (__s1_len___27 < __s2_len___27) {
#line 457
                                                              tmp___252 = __s1_len___27;
                                                            } else {
#line 457
                                                              tmp___252 = __s2_len___27;
                                                            }
                                                            {
#line 457
                                                            tmp___251 = memcmp((void const   *)((char const   *)(cmd)),
                                                                               (void const   *)"xcup",
                                                                               tmp___252 +
                                                                               1U);
                                                            }
                                                          } else {
                                                            {
#line 457
                                                            tmp___253 = strcmp((char const   *)(cmd),
                                                                               "xcup");
#line 457
                                                            tmp___251 = tmp___253;
                                                            }
                                                          }
                                                        } else {
                                                          {
#line 457
                                                          tmp___253 = strcmp((char const   *)(cmd),
                                                                             "xcup");
#line 457
                                                          tmp___251 = tmp___253;
                                                          }
                                                        }
#line 457
                                                        if (tmp___251) {
#line 459
                                                          if (0) {
                                                            {
#line 459
                                                            __s1_len___25 = strlen((char const   *)(cmd));
#line 459
                                                            __s2_len___25 = strlen("retr");
                                                            }
#line 459
                                                            if (! ((unsigned int )((void const   *)(cmd +
                                                                                                    1)) -
                                                                   (unsigned int )((void const   *)(cmd)) ==
                                                                   1U)) {
                                                              goto _L___57;
                                                            } else {
#line 459
                                                              if (__s1_len___25 >=
                                                                  4U) {
                                                                _L___57: 
#line 459
                                                                if (! ((unsigned int )((void const   *)("retr" +
                                                                                                        1)) -
                                                                       (unsigned int )((void const   *)"retr") ==
                                                                       1U)) {
#line 459
                                                                  tmp___238 = 1;
                                                                } else {
#line 459
                                                                  if (__s2_len___25 >=
                                                                      4U) {
#line 459
                                                                    tmp___238 = 1;
                                                                  } else {
#line 459
                                                                    tmp___238 = 0;
                                                                  }
                                                                }
                                                              } else {
#line 459
                                                                tmp___238 = 0;
                                                              }
                                                            }
#line 459
                                                            if (tmp___238) {
#line 459
                                                              if (__s1_len___25 <
                                                                  __s2_len___25) {
#line 459
                                                                tmp___236 = __s1_len___25;
                                                              } else {
#line 459
                                                                tmp___236 = __s2_len___25;
                                                              }
                                                              {
#line 459
                                                              tmp___235 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                 (void const   *)"retr",
                                                                                 tmp___236 +
                                                                                 1U);
                                                              }
                                                            } else {
                                                              {
#line 459
                                                              tmp___237 = strcmp((char const   *)(cmd),
                                                                                 "retr");
#line 459
                                                              tmp___235 = tmp___237;
                                                              }
                                                            }
                                                          } else {
                                                            {
#line 459
                                                            tmp___237 = strcmp((char const   *)(cmd),
                                                                               "retr");
#line 459
                                                            tmp___235 = tmp___237;
                                                            }
                                                          }
#line 459
                                                          if (tmp___235) {
#line 465
                                                            if (0) {
                                                              {
#line 465
                                                              __s1_len___24 = strlen((char const   *)(cmd));
#line 465
                                                              __s2_len___24 = strlen("rest");
                                                              }
#line 465
                                                              if (! ((unsigned int )((void const   *)(cmd +
                                                                                                      1)) -
                                                                     (unsigned int )((void const   *)(cmd)) ==
                                                                     1U)) {
                                                                goto _L___55;
                                                              } else {
#line 465
                                                                if (__s1_len___24 >=
                                                                    4U) {
                                                                  _L___55: 
#line 465
                                                                  if (! ((unsigned int )((void const   *)("rest" +
                                                                                                          1)) -
                                                                         (unsigned int )((void const   *)"rest") ==
                                                                         1U)) {
#line 465
                                                                    tmp___230 = 1;
                                                                  } else {
#line 465
                                                                    if (__s2_len___24 >=
                                                                        4U) {
#line 465
                                                                      tmp___230 = 1;
                                                                    } else {
#line 465
                                                                      tmp___230 = 0;
                                                                    }
                                                                  }
                                                                } else {
#line 465
                                                                  tmp___230 = 0;
                                                                }
                                                              }
#line 465
                                                              if (tmp___230) {
#line 465
                                                                if (__s1_len___24 <
                                                                    __s2_len___24) {
#line 465
                                                                  tmp___228 = __s1_len___24;
                                                                } else {
#line 465
                                                                  tmp___228 = __s2_len___24;
                                                                }
                                                                {
#line 465
                                                                tmp___227 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                   (void const   *)"rest",
                                                                                   tmp___228 +
                                                                                   1U);
                                                                }
                                                              } else {
                                                                {
#line 465
                                                                tmp___229 = strcmp((char const   *)(cmd),
                                                                                   "rest");
#line 465
                                                                tmp___227 = tmp___229;
                                                                }
                                                              }
                                                            } else {
                                                              {
#line 465
                                                              tmp___229 = strcmp((char const   *)(cmd),
                                                                                 "rest");
#line 465
                                                              tmp___227 = tmp___229;
                                                              }
                                                            }
#line 465
                                                            if (tmp___227) {
#line 474
                                                              if (0) {
                                                                {
#line 474
                                                                __s1_len___23 = strlen((char const   *)(cmd));
#line 474
                                                                __s2_len___23 = strlen("dele");
                                                                }
#line 474
                                                                if (! ((unsigned int )((void const   *)(cmd +
                                                                                                        1)) -
                                                                       (unsigned int )((void const   *)(cmd)) ==
                                                                       1U)) {
                                                                  goto _L___53;
                                                                } else {
#line 474
                                                                  if (__s1_len___23 >=
                                                                      4U) {
                                                                    _L___53: 
#line 474
                                                                    if (! ((unsigned int )((void const   *)("dele" +
                                                                                                            1)) -
                                                                           (unsigned int )((void const   *)"dele") ==
                                                                           1U)) {
#line 474
                                                                      tmp___222 = 1;
                                                                    } else {
#line 474
                                                                      if (__s2_len___23 >=
                                                                          4U) {
#line 474
                                                                        tmp___222 = 1;
                                                                      } else {
#line 474
                                                                        tmp___222 = 0;
                                                                      }
                                                                    }
                                                                  } else {
#line 474
                                                                    tmp___222 = 0;
                                                                  }
                                                                }
#line 474
                                                                if (tmp___222) {
#line 474
                                                                  if (__s1_len___23 <
                                                                      __s2_len___23) {
#line 474
                                                                    tmp___220 = __s1_len___23;
                                                                  } else {
#line 474
                                                                    tmp___220 = __s2_len___23;
                                                                  }
                                                                  {
#line 474
                                                                  tmp___219 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                     (void const   *)"dele",
                                                                                     tmp___220 +
                                                                                     1U);
                                                                  }
                                                                } else {
                                                                  {
#line 474
                                                                  tmp___221 = strcmp((char const   *)(cmd),
                                                                                     "dele");
#line 474
                                                                  tmp___219 = tmp___221;
                                                                  }
                                                                }
                                                              } else {
                                                                {
#line 474
                                                                tmp___221 = strcmp((char const   *)(cmd),
                                                                                   "dele");
#line 474
                                                                tmp___219 = tmp___221;
                                                                }
                                                              }
#line 474
                                                              if (tmp___219) {
#line 480
                                                                if (0) {
                                                                  {
#line 480
                                                                  __s1_len___22 = strlen((char const   *)(cmd));
#line 480
                                                                  __s2_len___22 = strlen("stor");
                                                                  }
#line 480
                                                                  if (! ((unsigned int )((void const   *)(cmd +
                                                                                                          1)) -
                                                                         (unsigned int )((void const   *)(cmd)) ==
                                                                         1U)) {
                                                                    goto _L___51;
                                                                  } else {
#line 480
                                                                    if (__s1_len___22 >=
                                                                        4U) {
                                                                      _L___51: 
#line 480
                                                                      if (! ((unsigned int )((void const   *)("stor" +
                                                                                                              1)) -
                                                                             (unsigned int )((void const   *)"stor") ==
                                                                             1U)) {
#line 480
                                                                        tmp___214 = 1;
                                                                      } else {
#line 480
                                                                        if (__s2_len___22 >=
                                                                            4U) {
#line 480
                                                                          tmp___214 = 1;
                                                                        } else {
#line 480
                                                                          tmp___214 = 0;
                                                                        }
                                                                      }
                                                                    } else {
#line 480
                                                                      tmp___214 = 0;
                                                                    }
                                                                  }
#line 480
                                                                  if (tmp___214) {
#line 480
                                                                    if (__s1_len___22 <
                                                                        __s2_len___22) {
#line 480
                                                                      tmp___212 = __s1_len___22;
                                                                    } else {
#line 480
                                                                      tmp___212 = __s2_len___22;
                                                                    }
                                                                    {
#line 480
                                                                    tmp___211 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                       (void const   *)"stor",
                                                                                       tmp___212 +
                                                                                       1U);
                                                                    }
                                                                  } else {
                                                                    {
#line 480
                                                                    tmp___213 = strcmp((char const   *)(cmd),
                                                                                       "stor");
#line 480
                                                                    tmp___211 = tmp___213;
                                                                    }
                                                                  }
                                                                } else {
                                                                  {
#line 480
                                                                  tmp___213 = strcmp((char const   *)(cmd),
                                                                                     "stor");
#line 480
                                                                  tmp___211 = tmp___213;
                                                                  }
                                                                }
#line 480
                                                                if (tmp___211) {
#line 487
                                                                  if (0) {
                                                                    {
#line 487
                                                                    __s1_len___21 = strlen((char const   *)(cmd));
#line 487
                                                                    __s2_len___21 = strlen("appe");
                                                                    }
#line 487
                                                                    if (! ((unsigned int )((void const   *)(cmd +
                                                                                                            1)) -
                                                                           (unsigned int )((void const   *)(cmd)) ==
                                                                           1U)) {
                                                                      goto _L___49;
                                                                    } else {
#line 487
                                                                      if (__s1_len___21 >=
                                                                          4U) {
                                                                        _L___49: 
#line 487
                                                                        if (! ((unsigned int )((void const   *)("appe" +
                                                                                                                1)) -
                                                                               (unsigned int )((void const   *)"appe") ==
                                                                               1U)) {
#line 487
                                                                          tmp___206 = 1;
                                                                        } else {
#line 487
                                                                          if (__s2_len___21 >=
                                                                              4U) {
#line 487
                                                                            tmp___206 = 1;
                                                                          } else {
#line 487
                                                                            tmp___206 = 0;
                                                                          }
                                                                        }
                                                                      } else {
#line 487
                                                                        tmp___206 = 0;
                                                                      }
                                                                    }
#line 487
                                                                    if (tmp___206) {
#line 487
                                                                      if (__s1_len___21 <
                                                                          __s2_len___21) {
#line 487
                                                                        tmp___204 = __s1_len___21;
                                                                      } else {
#line 487
                                                                        tmp___204 = __s2_len___21;
                                                                      }
                                                                      {
#line 487
                                                                      tmp___203 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                         (void const   *)"appe",
                                                                                         tmp___204 +
                                                                                         1U);
                                                                      }
                                                                    } else {
                                                                      {
#line 487
                                                                      tmp___205 = strcmp((char const   *)(cmd),
                                                                                         "appe");
#line 487
                                                                      tmp___203 = tmp___205;
                                                                      }
                                                                    }
                                                                  } else {
                                                                    {
#line 487
                                                                    tmp___205 = strcmp((char const   *)(cmd),
                                                                                       "appe");
#line 487
                                                                    tmp___203 = tmp___205;
                                                                    }
                                                                  }
#line 487
                                                                  if (tmp___203) {
#line 495
                                                                    if (0) {
                                                                      {
#line 495
                                                                      __s1_len___20 = strlen((char const   *)(cmd));
#line 495
                                                                      __s2_len___20 = strlen("stou");
                                                                      }
#line 495
                                                                      if (! ((unsigned int )((void const   *)(cmd +
                                                                                                              1)) -
                                                                             (unsigned int )((void const   *)(cmd)) ==
                                                                             1U)) {
                                                                        goto _L___47;
                                                                      } else {
#line 495
                                                                        if (__s1_len___20 >=
                                                                            4U) {
                                                                          _L___47: 
#line 495
                                                                          if (! ((unsigned int )((void const   *)("stou" +
                                                                                                                  1)) -
                                                                                 (unsigned int )((void const   *)"stou") ==
                                                                                 1U)) {
#line 495
                                                                            tmp___198 = 1;
                                                                          } else {
#line 495
                                                                            if (__s2_len___20 >=
                                                                                4U) {
#line 495
                                                                              tmp___198 = 1;
                                                                            } else {
#line 495
                                                                              tmp___198 = 0;
                                                                            }
                                                                          }
                                                                        } else {
#line 495
                                                                          tmp___198 = 0;
                                                                        }
                                                                      }
#line 495
                                                                      if (tmp___198) {
#line 495
                                                                        if (__s1_len___20 <
                                                                            __s2_len___20) {
#line 495
                                                                          tmp___196 = __s1_len___20;
                                                                        } else {
#line 495
                                                                          tmp___196 = __s2_len___20;
                                                                        }
                                                                        {
#line 495
                                                                        tmp___195 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                           (void const   *)"stou",
                                                                                           tmp___196 +
                                                                                           1U);
                                                                        }
                                                                      } else {
                                                                        {
#line 495
                                                                        tmp___197 = strcmp((char const   *)(cmd),
                                                                                           "stou");
#line 495
                                                                        tmp___195 = tmp___197;
                                                                        }
                                                                      }
                                                                    } else {
                                                                      {
#line 495
                                                                      tmp___197 = strcmp((char const   *)(cmd),
                                                                                         "stou");
#line 495
                                                                      tmp___195 = tmp___197;
                                                                      }
                                                                    }
#line 495
                                                                    if (tmp___195) {
#line 499
                                                                      if (0) {
                                                                        {
#line 499
                                                                        __s1_len___18 = strlen((char const   *)(cmd));
#line 499
                                                                        __s2_len___18 = strlen("mkd");
                                                                        }
#line 499
                                                                        if (! ((unsigned int )((void const   *)(cmd +
                                                                                                                1)) -
                                                                               (unsigned int )((void const   *)(cmd)) ==
                                                                               1U)) {
                                                                          goto _L___42;
                                                                        } else {
#line 499
                                                                          if (__s1_len___18 >=
                                                                              4U) {
                                                                            _L___42: 
#line 499
                                                                            if (! ((unsigned int )((void const   *)("mkd" +
                                                                                                                    1)) -
                                                                                   (unsigned int )((void const   *)"mkd") ==
                                                                                   1U)) {
#line 499
                                                                              tmp___182 = 1;
                                                                            } else {
#line 499
                                                                              if (__s2_len___18 >=
                                                                                  4U) {
#line 499
                                                                                tmp___182 = 1;
                                                                              } else {
#line 499
                                                                                tmp___182 = 0;
                                                                              }
                                                                            }
                                                                          } else {
#line 499
                                                                            tmp___182 = 0;
                                                                          }
                                                                        }
#line 499
                                                                        if (tmp___182) {
#line 499
                                                                          if (__s1_len___18 <
                                                                              __s2_len___18) {
#line 499
                                                                            tmp___180 = __s1_len___18;
                                                                          } else {
#line 499
                                                                            tmp___180 = __s2_len___18;
                                                                          }
                                                                          {
#line 499
                                                                          tmp___179 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                             (void const   *)"mkd",
                                                                                             tmp___180 +
                                                                                             1U);
                                                                          }
                                                                        } else {
                                                                          {
#line 499
                                                                          tmp___181 = strcmp((char const   *)(cmd),
                                                                                             "mkd");
#line 499
                                                                          tmp___179 = tmp___181;
                                                                          }
                                                                        }
                                                                      } else {
                                                                        {
#line 499
                                                                        tmp___181 = strcmp((char const   *)(cmd),
                                                                                           "mkd");
#line 499
                                                                        tmp___179 = tmp___181;
                                                                        }
                                                                      }
#line 499
                                                                      if (tmp___179) {
#line 499
                                                                        if (0) {
                                                                          {
#line 499
                                                                          __s1_len___19 = strlen((char const   *)(cmd));
#line 499
                                                                          __s2_len___19 = strlen("xmkd");
                                                                          }
#line 499
                                                                          if (! ((unsigned int )((void const   *)(cmd +
                                                                                                                  1)) -
                                                                                 (unsigned int )((void const   *)(cmd)) ==
                                                                                 1U)) {
                                                                            goto _L___44;
                                                                          } else {
#line 499
                                                                            if (__s1_len___19 >=
                                                                                4U) {
                                                                              _L___44: 
#line 499
                                                                              if (! ((unsigned int )((void const   *)("xmkd" +
                                                                                                                      1)) -
                                                                                     (unsigned int )((void const   *)"xmkd") ==
                                                                                     1U)) {
#line 499
                                                                                tmp___190 = 1;
                                                                              } else {
#line 499
                                                                                if (__s2_len___19 >=
                                                                                    4U) {
#line 499
                                                                                  tmp___190 = 1;
                                                                                } else {
#line 499
                                                                                  tmp___190 = 0;
                                                                                }
                                                                              }
                                                                            } else {
#line 499
                                                                              tmp___190 = 0;
                                                                            }
                                                                          }
#line 499
                                                                          if (tmp___190) {
#line 499
                                                                            if (__s1_len___19 <
                                                                                __s2_len___19) {
#line 499
                                                                              tmp___188 = __s1_len___19;
                                                                            } else {
#line 499
                                                                              tmp___188 = __s2_len___19;
                                                                            }
                                                                            {
#line 499
                                                                            tmp___187 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                               (void const   *)"xmkd",
                                                                                               tmp___188 +
                                                                                               1U);
                                                                            }
                                                                          } else {
                                                                            {
#line 499
                                                                            tmp___189 = strcmp((char const   *)(cmd),
                                                                                               "xmkd");
#line 499
                                                                            tmp___187 = tmp___189;
                                                                            }
                                                                          }
                                                                        } else {
                                                                          {
#line 499
                                                                          tmp___189 = strcmp((char const   *)(cmd),
                                                                                             "xmkd");
#line 499
                                                                          tmp___187 = tmp___189;
                                                                          }
                                                                        }
#line 499
                                                                        if (tmp___187) {
#line 506
                                                                          if (0) {
                                                                            {
#line 506
                                                                            __s1_len___16 = strlen((char const   *)(cmd));
#line 506
                                                                            __s2_len___16 = strlen("rmd");
                                                                            }
#line 506
                                                                            if (! ((unsigned int )((void const   *)(cmd +
                                                                                                                    1)) -
                                                                                   (unsigned int )((void const   *)(cmd)) ==
                                                                                   1U)) {
                                                                              goto _L___37;
                                                                            } else {
#line 506
                                                                              if (__s1_len___16 >=
                                                                                  4U) {
                                                                                _L___37: 
#line 506
                                                                                if (! ((unsigned int )((void const   *)("rmd" +
                                                                                                                        1)) -
                                                                                       (unsigned int )((void const   *)"rmd") ==
                                                                                       1U)) {
#line 506
                                                                                  tmp___166 = 1;
                                                                                } else {
#line 506
                                                                                  if (__s2_len___16 >=
                                                                                      4U) {
#line 506
                                                                                    tmp___166 = 1;
                                                                                  } else {
#line 506
                                                                                    tmp___166 = 0;
                                                                                  }
                                                                                }
                                                                              } else {
#line 506
                                                                                tmp___166 = 0;
                                                                              }
                                                                            }
#line 506
                                                                            if (tmp___166) {
#line 506
                                                                              if (__s1_len___16 <
                                                                                  __s2_len___16) {
#line 506
                                                                                tmp___164 = __s1_len___16;
                                                                              } else {
#line 506
                                                                                tmp___164 = __s2_len___16;
                                                                              }
                                                                              {
#line 506
                                                                              tmp___163 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                                 (void const   *)"rmd",
                                                                                                 tmp___164 +
                                                                                                 1U);
                                                                              }
                                                                            } else {
                                                                              {
#line 506
                                                                              tmp___165 = strcmp((char const   *)(cmd),
                                                                                                 "rmd");
#line 506
                                                                              tmp___163 = tmp___165;
                                                                              }
                                                                            }
                                                                          } else {
                                                                            {
#line 506
                                                                            tmp___165 = strcmp((char const   *)(cmd),
                                                                                               "rmd");
#line 506
                                                                            tmp___163 = tmp___165;
                                                                            }
                                                                          }
#line 506
                                                                          if (tmp___163) {
#line 506
                                                                            if (0) {
                                                                              {
#line 506
                                                                              __s1_len___17 = strlen((char const   *)(cmd));
#line 506
                                                                              __s2_len___17 = strlen("xrmd");
                                                                              }
#line 506
                                                                              if (! ((unsigned int )((void const   *)(cmd +
                                                                                                                      1)) -
                                                                                     (unsigned int )((void const   *)(cmd)) ==
                                                                                     1U)) {
                                                                                goto _L___39;
                                                                              } else {
#line 506
                                                                                if (__s1_len___17 >=
                                                                                    4U) {
                                                                                  _L___39: 
#line 506
                                                                                  if (! ((unsigned int )((void const   *)("xrmd" +
                                                                                                                          1)) -
                                                                                         (unsigned int )((void const   *)"xrmd") ==
                                                                                         1U)) {
#line 506
                                                                                    tmp___174 = 1;
                                                                                  } else {
#line 506
                                                                                    if (__s2_len___17 >=
                                                                                        4U) {
#line 506
                                                                                      tmp___174 = 1;
                                                                                    } else {
#line 506
                                                                                      tmp___174 = 0;
                                                                                    }
                                                                                  }
                                                                                } else {
#line 506
                                                                                  tmp___174 = 0;
                                                                                }
                                                                              }
#line 506
                                                                              if (tmp___174) {
#line 506
                                                                                if (__s1_len___17 <
                                                                                    __s2_len___17) {
#line 506
                                                                                  tmp___172 = __s1_len___17;
                                                                                } else {
#line 506
                                                                                  tmp___172 = __s2_len___17;
                                                                                }
                                                                                {
#line 506
                                                                                tmp___171 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                                   (void const   *)"xrmd",
                                                                                                   tmp___172 +
                                                                                                   1U);
                                                                                }
                                                                              } else {
                                                                                {
#line 506
                                                                                tmp___173 = strcmp((char const   *)(cmd),
                                                                                                   "xrmd");
#line 506
                                                                                tmp___171 = tmp___173;
                                                                                }
                                                                              }
                                                                            } else {
                                                                              {
#line 506
                                                                              tmp___173 = strcmp((char const   *)(cmd),
                                                                                                 "xrmd");
#line 506
                                                                              tmp___171 = tmp___173;
                                                                              }
                                                                            }
#line 506
                                                                            if (tmp___171) {
#line 514
                                                                              if (0) {
                                                                                {
#line 514
                                                                                __s1_len___15 = strlen((char const   *)(cmd));
#line 514
                                                                                __s2_len___15 = strlen("stat");
                                                                                }
#line 514
                                                                                if (! ((unsigned int )((void const   *)(cmd +
                                                                                                                        1)) -
                                                                                       (unsigned int )((void const   *)(cmd)) ==
                                                                                       1U)) {
                                                                                  goto _L___35;
                                                                                } else {
#line 514
                                                                                  if (__s1_len___15 >=
                                                                                      4U) {
                                                                                    _L___35: 
#line 514
                                                                                    if (! ((unsigned int )((void const   *)("stat" +
                                                                                                                            1)) -
                                                                                           (unsigned int )((void const   *)"stat") ==
                                                                                           1U)) {
#line 514
                                                                                      tmp___158 = 1;
                                                                                    } else {
#line 514
                                                                                      if (__s2_len___15 >=
                                                                                          4U) {
#line 514
                                                                                        tmp___158 = 1;
                                                                                      } else {
#line 514
                                                                                        tmp___158 = 0;
                                                                                      }
                                                                                    }
                                                                                  } else {
#line 514
                                                                                    tmp___158 = 0;
                                                                                  }
                                                                                }
#line 514
                                                                                if (tmp___158) {
#line 514
                                                                                  if (__s1_len___15 <
                                                                                      __s2_len___15) {
#line 514
                                                                                    tmp___156 = __s1_len___15;
                                                                                  } else {
#line 514
                                                                                    tmp___156 = __s2_len___15;
                                                                                  }
                                                                                  {
#line 514
                                                                                  tmp___155 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                                     (void const   *)"stat",
                                                                                                     tmp___156 +
                                                                                                     1U);
                                                                                  }
                                                                                } else {
                                                                                  {
#line 514
                                                                                  tmp___157 = strcmp((char const   *)(cmd),
                                                                                                     "stat");
#line 514
                                                                                  tmp___155 = tmp___157;
                                                                                  }
                                                                                }
                                                                              } else {
                                                                                {
#line 514
                                                                                tmp___157 = strcmp((char const   *)(cmd),
                                                                                                   "stat");
#line 514
                                                                                tmp___155 = tmp___157;
                                                                                }
                                                                              }
#line 514
                                                                              if (tmp___155) {
#line 529
                                                                                if (0) {
                                                                                  {
#line 529
                                                                                  __s1_len___14 = strlen((char const   *)(cmd));
#line 529
                                                                                  __s2_len___14 = strlen("list");
                                                                                  }
#line 529
                                                                                  if (! ((unsigned int )((void const   *)(cmd +
                                                                                                                          1)) -
                                                                                         (unsigned int )((void const   *)(cmd)) ==
                                                                                         1U)) {
                                                                                    goto _L___33;
                                                                                  } else {
#line 529
                                                                                    if (__s1_len___14 >=
                                                                                        4U) {
                                                                                      _L___33: 
#line 529
                                                                                      if (! ((unsigned int )((void const   *)("list" +
                                                                                                                              1)) -
                                                                                             (unsigned int )((void const   *)"list") ==
                                                                                             1U)) {
#line 529
                                                                                        tmp___150 = 1;
                                                                                      } else {
#line 529
                                                                                        if (__s2_len___14 >=
                                                                                            4U) {
#line 529
                                                                                          tmp___150 = 1;
                                                                                        } else {
#line 529
                                                                                          tmp___150 = 0;
                                                                                        }
                                                                                      }
                                                                                    } else {
#line 529
                                                                                      tmp___150 = 0;
                                                                                    }
                                                                                  }
#line 529
                                                                                  if (tmp___150) {
#line 529
                                                                                    if (__s1_len___14 <
                                                                                        __s2_len___14) {
#line 529
                                                                                      tmp___148 = __s1_len___14;
                                                                                    } else {
#line 529
                                                                                      tmp___148 = __s2_len___14;
                                                                                    }
                                                                                    {
#line 529
                                                                                    tmp___147 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                                       (void const   *)"list",
                                                                                                       tmp___148 +
                                                                                                       1U);
                                                                                    }
                                                                                  } else {
                                                                                    {
#line 529
                                                                                    tmp___149 = strcmp((char const   *)(cmd),
                                                                                                       "list");
#line 529
                                                                                    tmp___147 = tmp___149;
                                                                                    }
                                                                                  }
                                                                                } else {
                                                                                  {
#line 529
                                                                                  tmp___149 = strcmp((char const   *)(cmd),
                                                                                                     "list");
#line 529
                                                                                  tmp___147 = tmp___149;
                                                                                  }
                                                                                }
#line 529
                                                                                if (tmp___147) {
#line 534
                                                                                  if (0) {
                                                                                    {
#line 534
                                                                                    __s1_len___13 = strlen((char const   *)(cmd));
#line 534
                                                                                    __s2_len___13 = strlen("nlst");
                                                                                    }
#line 534
                                                                                    if (! ((unsigned int )((void const   *)(cmd +
                                                                                                                            1)) -
                                                                                           (unsigned int )((void const   *)(cmd)) ==
                                                                                           1U)) {
                                                                                      goto _L___31;
                                                                                    } else {
#line 534
                                                                                      if (__s1_len___13 >=
                                                                                          4U) {
                                                                                        _L___31: 
#line 534
                                                                                        if (! ((unsigned int )((void const   *)("nlst" +
                                                                                                                                1)) -
                                                                                               (unsigned int )((void const   *)"nlst") ==
                                                                                               1U)) {
#line 534
                                                                                          tmp___142 = 1;
                                                                                        } else {
#line 534
                                                                                          if (__s2_len___13 >=
                                                                                              4U) {
#line 534
                                                                                            tmp___142 = 1;
                                                                                          } else {
#line 534
                                                                                            tmp___142 = 0;
                                                                                          }
                                                                                        }
                                                                                      } else {
#line 534
                                                                                        tmp___142 = 0;
                                                                                      }
                                                                                    }
#line 534
                                                                                    if (tmp___142) {
#line 534
                                                                                      if (__s1_len___13 <
                                                                                          __s2_len___13) {
#line 534
                                                                                        tmp___140 = __s1_len___13;
                                                                                      } else {
#line 534
                                                                                        tmp___140 = __s2_len___13;
                                                                                      }
                                                                                      {
#line 534
                                                                                      tmp___139 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                                         (void const   *)"nlst",
                                                                                                         tmp___140 +
                                                                                                         1U);
                                                                                      }
                                                                                    } else {
                                                                                      {
#line 534
                                                                                      tmp___141 = strcmp((char const   *)(cmd),
                                                                                                         "nlst");
#line 534
                                                                                      tmp___139 = tmp___141;
                                                                                      }
                                                                                    }
                                                                                  } else {
                                                                                    {
#line 534
                                                                                    tmp___141 = strcmp((char const   *)(cmd),
                                                                                                       "nlst");
#line 534
                                                                                    tmp___139 = tmp___141;
                                                                                    }
                                                                                  }
#line 534
                                                                                  if (tmp___139) {
#line 540
                                                                                    if (0) {
                                                                                      {
#line 540
                                                                                      __s1_len___12 = strlen((char const   *)(cmd));
#line 540
                                                                                      __s2_len___12 = strlen("mlst");
                                                                                      }
#line 540
                                                                                      if (! ((unsigned int )((void const   *)(cmd +
                                                                                                                              1)) -
                                                                                             (unsigned int )((void const   *)(cmd)) ==
                                                                                             1U)) {
                                                                                        goto _L___29;
                                                                                      } else {
#line 540
                                                                                        if (__s1_len___12 >=
                                                                                            4U) {
                                                                                          _L___29: 
#line 540
                                                                                          if (! ((unsigned int )((void const   *)("mlst" +
                                                                                                                                  1)) -
                                                                                                 (unsigned int )((void const   *)"mlst") ==
                                                                                                 1U)) {
#line 540
                                                                                            tmp___134 = 1;
                                                                                          } else {
#line 540
                                                                                            if (__s2_len___12 >=
                                                                                                4U) {
#line 540
                                                                                              tmp___134 = 1;
                                                                                            } else {
#line 540
                                                                                              tmp___134 = 0;
                                                                                            }
                                                                                          }
                                                                                        } else {
#line 540
                                                                                          tmp___134 = 0;
                                                                                        }
                                                                                      }
#line 540
                                                                                      if (tmp___134) {
#line 540
                                                                                        if (__s1_len___12 <
                                                                                            __s2_len___12) {
#line 540
                                                                                          tmp___132 = __s1_len___12;
                                                                                        } else {
#line 540
                                                                                          tmp___132 = __s2_len___12;
                                                                                        }
                                                                                        {
#line 540
                                                                                        tmp___131 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                                           (void const   *)"mlst",
                                                                                                           tmp___132 +
                                                                                                           1U);
                                                                                        }
                                                                                      } else {
                                                                                        {
#line 540
                                                                                        tmp___133 = strcmp((char const   *)(cmd),
                                                                                                           "mlst");
#line 540
                                                                                        tmp___131 = tmp___133;
                                                                                        }
                                                                                      }
                                                                                    } else {
                                                                                      {
#line 540
                                                                                      tmp___133 = strcmp((char const   *)(cmd),
                                                                                                         "mlst");
#line 540
                                                                                      tmp___131 = tmp___133;
                                                                                      }
                                                                                    }
#line 540
                                                                                    if (tmp___131) {
#line 542
                                                                                      if (0) {
                                                                                        {
#line 542
                                                                                        __s1_len___11 = strlen((char const   *)(cmd));
#line 542
                                                                                        __s2_len___11 = strlen("mlsd");
                                                                                        }
#line 542
                                                                                        if (! ((unsigned int )((void const   *)(cmd +
                                                                                                                                1)) -
                                                                                               (unsigned int )((void const   *)(cmd)) ==
                                                                                               1U)) {
                                                                                          goto _L___27;
                                                                                        } else {
#line 542
                                                                                          if (__s1_len___11 >=
                                                                                              4U) {
                                                                                            _L___27: 
#line 542
                                                                                            if (! ((unsigned int )((void const   *)("mlsd" +
                                                                                                                                    1)) -
                                                                                                   (unsigned int )((void const   *)"mlsd") ==
                                                                                                   1U)) {
#line 542
                                                                                              tmp___126 = 1;
                                                                                            } else {
#line 542
                                                                                              if (__s2_len___11 >=
                                                                                                  4U) {
#line 542
                                                                                                tmp___126 = 1;
                                                                                              } else {
#line 542
                                                                                                tmp___126 = 0;
                                                                                              }
                                                                                            }
                                                                                          } else {
#line 542
                                                                                            tmp___126 = 0;
                                                                                          }
                                                                                        }
#line 542
                                                                                        if (tmp___126) {
#line 542
                                                                                          if (__s1_len___11 <
                                                                                              __s2_len___11) {
#line 542
                                                                                            tmp___124 = __s1_len___11;
                                                                                          } else {
#line 542
                                                                                            tmp___124 = __s2_len___11;
                                                                                          }
                                                                                          {
#line 542
                                                                                          tmp___123 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                                             (void const   *)"mlsd",
                                                                                                             tmp___124 +
                                                                                                             1U);
                                                                                          }
                                                                                        } else {
                                                                                          {
#line 542
                                                                                          tmp___125 = strcmp((char const   *)(cmd),
                                                                                                             "mlsd");
#line 542
                                                                                          tmp___123 = tmp___125;
                                                                                          }
                                                                                        }
                                                                                      } else {
                                                                                        {
#line 542
                                                                                        tmp___125 = strcmp((char const   *)(cmd),
                                                                                                           "mlsd");
#line 542
                                                                                        tmp___123 = tmp___125;
                                                                                        }
                                                                                      }
#line 542
                                                                                      if (tmp___123) {
#line 546
                                                                                        if (0) {
                                                                                          {
#line 546
                                                                                          __s1_len___10 = strlen((char const   *)(cmd));
#line 546
                                                                                          __s2_len___10 = strlen("abor");
                                                                                          }
#line 546
                                                                                          if (! ((unsigned int )((void const   *)(cmd +
                                                                                                                                  1)) -
                                                                                                 (unsigned int )((void const   *)(cmd)) ==
                                                                                                 1U)) {
                                                                                            goto _L___25;
                                                                                          } else {
#line 546
                                                                                            if (__s1_len___10 >=
                                                                                                4U) {
                                                                                              _L___25: 
#line 546
                                                                                              if (! ((unsigned int )((void const   *)("abor" +
                                                                                                                                      1)) -
                                                                                                     (unsigned int )((void const   *)"abor") ==
                                                                                                     1U)) {
#line 546
                                                                                                tmp___118 = 1;
                                                                                              } else {
#line 546
                                                                                                if (__s2_len___10 >=
                                                                                                    4U) {
#line 546
                                                                                                  tmp___118 = 1;
                                                                                                } else {
#line 546
                                                                                                  tmp___118 = 0;
                                                                                                }
                                                                                              }
                                                                                            } else {
#line 546
                                                                                              tmp___118 = 0;
                                                                                            }
                                                                                          }
#line 546
                                                                                          if (tmp___118) {
#line 546
                                                                                            if (__s1_len___10 <
                                                                                                __s2_len___10) {
#line 546
                                                                                              tmp___116 = __s1_len___10;
                                                                                            } else {
#line 546
                                                                                              tmp___116 = __s2_len___10;
                                                                                            }
                                                                                            {
#line 546
                                                                                            tmp___115 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                                               (void const   *)"abor",
                                                                                                               tmp___116 +
                                                                                                               1U);
                                                                                            }
                                                                                          } else {
                                                                                            {
#line 546
                                                                                            tmp___117 = strcmp((char const   *)(cmd),
                                                                                                               "abor");
#line 546
                                                                                            tmp___115 = tmp___117;
                                                                                            }
                                                                                          }
                                                                                        } else {
                                                                                          {
#line 546
                                                                                          tmp___117 = strcmp((char const   *)(cmd),
                                                                                                             "abor");
#line 546
                                                                                          tmp___115 = tmp___117;
                                                                                          }
                                                                                        }
#line 546
                                                                                        if (tmp___115) {
#line 549
                                                                                          if (0) {
                                                                                            {
#line 549
                                                                                            __s1_len___9 = strlen((char const   *)(cmd));
#line 549
                                                                                            __s2_len___9 = strlen("site");
                                                                                            }
#line 549
                                                                                            if (! ((unsigned int )((void const   *)(cmd +
                                                                                                                                    1)) -
                                                                                                   (unsigned int )((void const   *)(cmd)) ==
                                                                                                   1U)) {
                                                                                              goto _L___23;
                                                                                            } else {
#line 549
                                                                                              if (__s1_len___9 >=
                                                                                                  4U) {
                                                                                                _L___23: 
#line 549
                                                                                                if (! ((unsigned int )((void const   *)("site" +
                                                                                                                                        1)) -
                                                                                                       (unsigned int )((void const   *)"site") ==
                                                                                                       1U)) {
#line 549
                                                                                                  tmp___110 = 1;
                                                                                                } else {
#line 549
                                                                                                  if (__s2_len___9 >=
                                                                                                      4U) {
#line 549
                                                                                                    tmp___110 = 1;
                                                                                                  } else {
#line 549
                                                                                                    tmp___110 = 0;
                                                                                                  }
                                                                                                }
                                                                                              } else {
#line 549
                                                                                                tmp___110 = 0;
                                                                                              }
                                                                                            }
#line 549
                                                                                            if (tmp___110) {
#line 549
                                                                                              if (__s1_len___9 <
                                                                                                  __s2_len___9) {
#line 549
                                                                                                tmp___108 = __s1_len___9;
                                                                                              } else {
#line 549
                                                                                                tmp___108 = __s2_len___9;
                                                                                              }
                                                                                              {
#line 549
                                                                                              tmp___107 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                                                 (void const   *)"site",
                                                                                                                 tmp___108 +
                                                                                                                 1U);
                                                                                              }
                                                                                            } else {
                                                                                              {
#line 549
                                                                                              tmp___109 = strcmp((char const   *)(cmd),
                                                                                                                 "site");
#line 549
                                                                                              tmp___107 = tmp___109;
                                                                                              }
                                                                                            }
                                                                                          } else {
                                                                                            {
#line 549
                                                                                            tmp___109 = strcmp((char const   *)(cmd),
                                                                                                               "site");
#line 549
                                                                                            tmp___107 = tmp___109;
                                                                                            }
                                                                                          }
#line 549
                                                                                          if (tmp___107) {
#line 674
                                                                                            if (0) {
                                                                                              {
#line 674
                                                                                              __s1_len___8 = strlen((char const   *)(cmd));
#line 674
                                                                                              __s2_len___8 = strlen("mdtm");
                                                                                              }
#line 674
                                                                                              if (! ((unsigned int )((void const   *)(cmd +
                                                                                                                                      1)) -
                                                                                                     (unsigned int )((void const   *)(cmd)) ==
                                                                                                     1U)) {
                                                                                                goto _L___21;
                                                                                              } else {
#line 674
                                                                                                if (__s1_len___8 >=
                                                                                                    4U) {
                                                                                                  _L___21: 
#line 674
                                                                                                  if (! ((unsigned int )((void const   *)("mdtm" +
                                                                                                                                          1)) -
                                                                                                         (unsigned int )((void const   *)"mdtm") ==
                                                                                                         1U)) {
#line 674
                                                                                                    tmp___102 = 1;
                                                                                                  } else {
#line 674
                                                                                                    if (__s2_len___8 >=
                                                                                                        4U) {
#line 674
                                                                                                      tmp___102 = 1;
                                                                                                    } else {
#line 674
                                                                                                      tmp___102 = 0;
                                                                                                    }
                                                                                                  }
                                                                                                } else {
#line 674
                                                                                                  tmp___102 = 0;
                                                                                                }
                                                                                              }
#line 674
                                                                                              if (tmp___102) {
#line 674
                                                                                                if (__s1_len___8 <
                                                                                                    __s2_len___8) {
#line 674
                                                                                                  tmp___100 = __s1_len___8;
                                                                                                } else {
#line 674
                                                                                                  tmp___100 = __s2_len___8;
                                                                                                }
                                                                                                {
#line 674
                                                                                                tmp___99 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                                                  (void const   *)"mdtm",
                                                                                                                  tmp___100 +
                                                                                                                  1U);
                                                                                                }
                                                                                              } else {
                                                                                                {
#line 674
                                                                                                tmp___101 = strcmp((char const   *)(cmd),
                                                                                                                   "mdtm");
#line 674
                                                                                                tmp___99 = tmp___101;
                                                                                                }
                                                                                              }
                                                                                            } else {
                                                                                              {
#line 674
                                                                                              tmp___101 = strcmp((char const   *)(cmd),
                                                                                                                 "mdtm");
#line 674
                                                                                              tmp___99 = tmp___101;
                                                                                              }
                                                                                            }
#line 674
                                                                                            if (tmp___99) {
#line 676
                                                                                              if (0) {
                                                                                                {
#line 676
                                                                                                __s1_len___7 = strlen((char const   *)(cmd));
#line 676
                                                                                                __s2_len___7 = strlen("size");
                                                                                                }
#line 676
                                                                                                if (! ((unsigned int )((void const   *)(cmd +
                                                                                                                                        1)) -
                                                                                                       (unsigned int )((void const   *)(cmd)) ==
                                                                                                       1U)) {
                                                                                                  goto _L___19;
                                                                                                } else {
#line 676
                                                                                                  if (__s1_len___7 >=
                                                                                                      4U) {
                                                                                                    _L___19: 
#line 676
                                                                                                    if (! ((unsigned int )((void const   *)("size" +
                                                                                                                                            1)) -
                                                                                                           (unsigned int )((void const   *)"size") ==
                                                                                                           1U)) {
#line 676
                                                                                                      tmp___94 = 1;
                                                                                                    } else {
#line 676
                                                                                                      if (__s2_len___7 >=
                                                                                                          4U) {
#line 676
                                                                                                        tmp___94 = 1;
                                                                                                      } else {
#line 676
                                                                                                        tmp___94 = 0;
                                                                                                      }
                                                                                                    }
                                                                                                  } else {
#line 676
                                                                                                    tmp___94 = 0;
                                                                                                  }
                                                                                                }
#line 676
                                                                                                if (tmp___94) {
#line 676
                                                                                                  if (__s1_len___7 <
                                                                                                      __s2_len___7) {
#line 676
                                                                                                    tmp___92 = __s1_len___7;
                                                                                                  } else {
#line 676
                                                                                                    tmp___92 = __s2_len___7;
                                                                                                  }
                                                                                                  {
#line 676
                                                                                                  tmp___91 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                                                    (void const   *)"size",
                                                                                                                    tmp___92 +
                                                                                                                    1U);
                                                                                                  }
                                                                                                } else {
                                                                                                  {
#line 676
                                                                                                  tmp___93 = strcmp((char const   *)(cmd),
                                                                                                                    "size");
#line 676
                                                                                                  tmp___91 = tmp___93;
                                                                                                  }
                                                                                                }
                                                                                              } else {
                                                                                                {
#line 676
                                                                                                tmp___93 = strcmp((char const   *)(cmd),
                                                                                                                  "size");
#line 676
                                                                                                tmp___91 = tmp___93;
                                                                                                }
                                                                                              }
#line 676
                                                                                              if (tmp___91) {
#line 679
                                                                                                if (0) {
                                                                                                  {
#line 679
                                                                                                  __s1_len___6 = strlen((char const   *)(cmd));
#line 679
                                                                                                  __s2_len___6 = strlen("chmod");
                                                                                                  }
#line 679
                                                                                                  if (! ((unsigned int )((void const   *)(cmd +
                                                                                                                                          1)) -
                                                                                                         (unsigned int )((void const   *)(cmd)) ==
                                                                                                         1U)) {
                                                                                                    goto _L___17;
                                                                                                  } else {
#line 679
                                                                                                    if (__s1_len___6 >=
                                                                                                        4U) {
                                                                                                      _L___17: 
#line 679
                                                                                                      if (! ((unsigned int )((void const   *)("chmod" +
                                                                                                                                              1)) -
                                                                                                             (unsigned int )((void const   *)"chmod") ==
                                                                                                             1U)) {
#line 679
                                                                                                        tmp___86 = 1;
                                                                                                      } else {
#line 679
                                                                                                        if (__s2_len___6 >=
                                                                                                            4U) {
#line 679
                                                                                                          tmp___86 = 1;
                                                                                                        } else {
#line 679
                                                                                                          tmp___86 = 0;
                                                                                                        }
                                                                                                      }
                                                                                                    } else {
#line 679
                                                                                                      tmp___86 = 0;
                                                                                                    }
                                                                                                  }
#line 679
                                                                                                  if (tmp___86) {
#line 679
                                                                                                    if (__s1_len___6 <
                                                                                                        __s2_len___6) {
#line 679
                                                                                                      tmp___84 = __s1_len___6;
                                                                                                    } else {
#line 679
                                                                                                      tmp___84 = __s2_len___6;
                                                                                                    }
                                                                                                    {
#line 679
                                                                                                    tmp___83 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                                                      (void const   *)"chmod",
                                                                                                                      tmp___84 +
                                                                                                                      1U);
                                                                                                    }
                                                                                                  } else {
                                                                                                    {
#line 679
                                                                                                    tmp___85 = strcmp((char const   *)(cmd),
                                                                                                                      "chmod");
#line 679
                                                                                                    tmp___83 = tmp___85;
                                                                                                    }
                                                                                                  }
                                                                                                } else {
                                                                                                  {
#line 679
                                                                                                  tmp___85 = strcmp((char const   *)(cmd),
                                                                                                                    "chmod");
#line 679
                                                                                                  tmp___83 = tmp___85;
                                                                                                  }
                                                                                                }
#line 679
                                                                                                if (tmp___83) {
#line 683
                                                                                                  if (0) {
                                                                                                    {
#line 683
                                                                                                    __s1_len___5 = strlen((char const   *)(cmd));
#line 683
                                                                                                    __s2_len___5 = strlen("rnfr");
                                                                                                    }
#line 683
                                                                                                    if (! ((unsigned int )((void const   *)(cmd +
                                                                                                                                            1)) -
                                                                                                           (unsigned int )((void const   *)(cmd)) ==
                                                                                                           1U)) {
                                                                                                      goto _L___15;
                                                                                                    } else {
#line 683
                                                                                                      if (__s1_len___5 >=
                                                                                                          4U) {
                                                                                                        _L___15: 
#line 683
                                                                                                        if (! ((unsigned int )((void const   *)("rnfr" +
                                                                                                                                                1)) -
                                                                                                               (unsigned int )((void const   *)"rnfr") ==
                                                                                                               1U)) {
#line 683
                                                                                                          tmp___78 = 1;
                                                                                                        } else {
#line 683
                                                                                                          if (__s2_len___5 >=
                                                                                                              4U) {
#line 683
                                                                                                            tmp___78 = 1;
                                                                                                          } else {
#line 683
                                                                                                            tmp___78 = 0;
                                                                                                          }
                                                                                                        }
                                                                                                      } else {
#line 683
                                                                                                        tmp___78 = 0;
                                                                                                      }
                                                                                                    }
#line 683
                                                                                                    if (tmp___78) {
#line 683
                                                                                                      if (__s1_len___5 <
                                                                                                          __s2_len___5) {
#line 683
                                                                                                        tmp___76 = __s1_len___5;
                                                                                                      } else {
#line 683
                                                                                                        tmp___76 = __s2_len___5;
                                                                                                      }
                                                                                                      {
#line 683
                                                                                                      tmp___75 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                                                        (void const   *)"rnfr",
                                                                                                                        tmp___76 +
                                                                                                                        1U);
                                                                                                      }
                                                                                                    } else {
                                                                                                      {
#line 683
                                                                                                      tmp___77 = strcmp((char const   *)(cmd),
                                                                                                                        "rnfr");
#line 683
                                                                                                      tmp___75 = tmp___77;
                                                                                                      }
                                                                                                    }
                                                                                                  } else {
                                                                                                    {
#line 683
                                                                                                    tmp___77 = strcmp((char const   *)(cmd),
                                                                                                                      "rnfr");
#line 683
                                                                                                    tmp___75 = tmp___77;
                                                                                                    }
                                                                                                  }
#line 683
                                                                                                  if (tmp___75) {
#line 689
                                                                                                    if (0) {
                                                                                                      {
#line 689
                                                                                                      __s1_len___4 = strlen((char const   *)(cmd));
#line 689
                                                                                                      __s2_len___4 = strlen("rnto");
                                                                                                      }
#line 689
                                                                                                      if (! ((unsigned int )((void const   *)(cmd +
                                                                                                                                              1)) -
                                                                                                             (unsigned int )((void const   *)(cmd)) ==
                                                                                                             1U)) {
                                                                                                        goto _L___13;
                                                                                                      } else {
#line 689
                                                                                                        if (__s1_len___4 >=
                                                                                                            4U) {
                                                                                                          _L___13: 
#line 689
                                                                                                          if (! ((unsigned int )((void const   *)("rnto" +
                                                                                                                                                  1)) -
                                                                                                                 (unsigned int )((void const   *)"rnto") ==
                                                                                                                 1U)) {
#line 689
                                                                                                            tmp___70 = 1;
                                                                                                          } else {
#line 689
                                                                                                            if (__s2_len___4 >=
                                                                                                                4U) {
#line 689
                                                                                                              tmp___70 = 1;
                                                                                                            } else {
#line 689
                                                                                                              tmp___70 = 0;
                                                                                                            }
                                                                                                          }
                                                                                                        } else {
#line 689
                                                                                                          tmp___70 = 0;
                                                                                                        }
                                                                                                      }
#line 689
                                                                                                      if (tmp___70) {
#line 689
                                                                                                        if (__s1_len___4 <
                                                                                                            __s2_len___4) {
#line 689
                                                                                                          tmp___68 = __s1_len___4;
                                                                                                        } else {
#line 689
                                                                                                          tmp___68 = __s2_len___4;
                                                                                                        }
                                                                                                        {
#line 689
                                                                                                        tmp___67 = memcmp((void const   *)((char const   *)(cmd)),
                                                                                                                          (void const   *)"rnto",
                                                                                                                          tmp___68 +
                                                                                                                          1U);
                                                                                                        }
                                                                                                      } else {
                                                                                                        {
#line 689
                                                                                                        tmp___69 = strcmp((char const   *)(cmd),
                                                                                                                          "rnto");
#line 689
                                                                                                        tmp___67 = tmp___69;
                                                                                                        }
                                                                                                      }
                                                                                                    } else {
                                                                                                      {
#line 689
                                                                                                      tmp___69 = strcmp((char const   *)(cmd),
                                                                                                                        "rnto");
#line 689
                                                                                                      tmp___67 = tmp___69;
                                                                                                      }
                                                                                                    }
#line 689
                                                                                                    if (tmp___67) {
                                                                                                      {
#line 697
                                                                                                      addreply_noformat(500,
                                                                                                                        "Unknown command");
                                                                                                      }
                                                                                                    } else {
                                                                                                      {
#line 690
                                                                                                      arg = revealextraspc(arg);
                                                                                                      }
#line 691
                                                                                                      if ((int )(*arg) !=
                                                                                                          0) {
                                                                                                        {
#line 692
                                                                                                        dornto(arg);
                                                                                                        }
                                                                                                      } else {
                                                                                                        {
#line 694
                                                                                                        addreply_noformat(550,
                                                                                                                          "No file name");
                                                                                                        }
                                                                                                      }
                                                                                                    }
                                                                                                  } else {
#line 684
                                                                                                    if ((int )(*arg) !=
                                                                                                        0) {
                                                                                                      {
#line 685
                                                                                                      dornfr(arg);
                                                                                                      }
                                                                                                    } else {
                                                                                                      {
#line 687
                                                                                                      addreply_noformat(550,
                                                                                                                        "No file name");
                                                                                                      }
                                                                                                    }
                                                                                                  }
                                                                                                } else {
#line 680
                                                                                                  sitearg = arg;
                                                                                                  goto parsechmod;
                                                                                                }
                                                                                              } else {
                                                                                                {
#line 677
                                                                                                dosize((char const   *)arg);
                                                                                                }
                                                                                              }
                                                                                            } else {
                                                                                              {
#line 675
                                                                                              domdtm((char const   *)arg);
                                                                                              }
                                                                                            }
                                                                                          } else {
#line 550
                                                                                            sitearg = arg;
#line 550
                                                                                            if ((unsigned int )sitearg !=
                                                                                                (unsigned int )((void *)0)) {
                                                                                              {
#line 551
                                                                                              while (1) {
                                                                                                while_197_continue: /* CIL Label */ ;
#line 551
                                                                                                if ((int )(*sitearg) !=
                                                                                                    0) {
                                                                                                  {
#line 551
                                                                                                  tmp___48 = __ctype_b_loc();
                                                                                                  }
#line 551
                                                                                                  if ((int const   )(*((*tmp___48) +
                                                                                                                       (int )((unsigned char )(*sitearg)))) &
                                                                                                      8192) {
                                                                                                    goto while_197_break;
                                                                                                  }
                                                                                                } else {
                                                                                                  goto while_197_break;
                                                                                                }
#line 552
                                                                                                sitearg ++;
                                                                                              }
                                                                                              while_197_break: /* CIL Label */ ;
                                                                                              }
#line 554
                                                                                              if ((int )(*sitearg) !=
                                                                                                  0) {
#line 555
                                                                                                tmp___49 = sitearg;
#line 555
                                                                                                sitearg ++;
#line 555
                                                                                                (*tmp___49) = 0;
                                                                                              }
                                                                                            }
                                                                                            {
#line 558
                                                                                            tmp___62 = strcasecmp((char const   *)arg,
                                                                                                                  "idle");
                                                                                            }
#line 558
                                                                                            if (tmp___62) {
                                                                                              {
#line 575
                                                                                              tmp___61 = strcasecmp((char const   *)arg,
                                                                                                                    "time");
                                                                                              }
#line 575
                                                                                              if (tmp___61) {
                                                                                                {
#line 577
                                                                                                tmp___60 = strcasecmp((char const   *)arg,
                                                                                                                      "help");
                                                                                                }
#line 577
                                                                                                if (tmp___60) {
                                                                                                  {
#line 586
                                                                                                  tmp___59 = strcasecmp((char const   *)arg,
                                                                                                                        "chmod");
                                                                                                  }
#line 586
                                                                                                  if (tmp___59) {
                                                                                                    {
#line 614
                                                                                                    tmp___58 = strcasecmp((char const   *)arg,
                                                                                                                          "utime");
                                                                                                    }
#line 614
                                                                                                    if (tmp___58) {
#line 668
                                                                                                      if ((int )(*arg) !=
                                                                                                          0) {
                                                                                                        {
#line 669
                                                                                                        addreply(500,
                                                                                                                 "SITE %s is an unknown extension",
                                                                                                                 arg);
                                                                                                        }
                                                                                                      } else {
                                                                                                        {
#line 671
                                                                                                        addreply_noformat(500,
                                                                                                                          "SITE: Missing argument");
                                                                                                        }
                                                                                                      }
                                                                                                    } else {
#line 617
                                                                                                      if ((unsigned int )sitearg ==
                                                                                                          (unsigned int )((void *)0)) {
                                                                                                        {
#line 618
                                                                                                        addreply_noformat(501,
                                                                                                                          "No file name");
                                                                                                        }
                                                                                                        goto utime_wayout;
                                                                                                      } else {
#line 617
                                                                                                        if ((int )(*sitearg) ==
                                                                                                            0) {
                                                                                                          {
#line 618
                                                                                                          addreply_noformat(501,
                                                                                                                            "No file name");
                                                                                                          }
                                                                                                          goto utime_wayout;
                                                                                                        }
                                                                                                      }
                                                                                                      {
#line 621
                                                                                                      sitearg2___0 = strrchr((char const   *)sitearg,
                                                                                                                             ' ');
                                                                                                      }
#line 621
                                                                                                      if ((unsigned int )sitearg2___0 ==
                                                                                                          (unsigned int )((void *)0)) {
                                                                                                        {
#line 623
                                                                                                        addreply_noformat(501,
                                                                                                                          "Missing argument");
                                                                                                        }
                                                                                                        goto utime_wayout;
                                                                                                      } else {
#line 621
                                                                                                        if ((unsigned int )sitearg2___0 ==
                                                                                                            (unsigned int )sitearg) {
                                                                                                          {
#line 623
                                                                                                          addreply_noformat(501,
                                                                                                                            "Missing argument");
                                                                                                          }
                                                                                                          goto utime_wayout;
                                                                                                        }
                                                                                                      }
                                                                                                      {
#line 626
                                                                                                      tmp___53 = strcasecmp((char const   *)sitearg2___0,
                                                                                                                            " UTC");
                                                                                                      }
#line 626
                                                                                                      if (tmp___53 !=
                                                                                                          0) {
                                                                                                        {
#line 627
                                                                                                        addreply_noformat(500,
                                                                                                                          "UTC Only");
                                                                                                        }
                                                                                                        goto utime_wayout;
                                                                                                      }
                                                                                                      {
#line 630
                                                                                                      tmp___54 = sitearg2___0;
#line 630
                                                                                                      sitearg2___0 --;
#line 630
                                                                                                      (*tmp___54) = 0;
#line 631
                                                                                                      sitearg2___0 = strrchr((char const   *)sitearg,
                                                                                                                             ' ');
                                                                                                      }
#line 631
                                                                                                      if ((unsigned int )sitearg2___0 ==
                                                                                                          (unsigned int )((void *)0)) {
                                                                                                        goto utime_no_arg;
                                                                                                      } else {
#line 631
                                                                                                        if ((unsigned int )sitearg2___0 ==
                                                                                                            (unsigned int )sitearg) {
                                                                                                          utime_no_arg: 
                                                                                                          {
#line 634
                                                                                                          addreply_noformat(501,
                                                                                                                            "Missing argument");
                                                                                                          }
                                                                                                          goto utime_wayout;
                                                                                                        }
                                                                                                      }
                                                                                                      {
#line 637
                                                                                                      tmp___55 = sitearg2___0;
#line 637
                                                                                                      sitearg2___0 --;
#line 637
                                                                                                      (*tmp___55) = 0;
#line 638
                                                                                                      sitearg2___0 = strrchr((char const   *)sitearg,
                                                                                                                             ' ');
                                                                                                      }
#line 638
                                                                                                      if ((unsigned int )sitearg2___0 ==
                                                                                                          (unsigned int )((void *)0)) {
                                                                                                        goto utime_no_arg;
                                                                                                      } else {
#line 638
                                                                                                        if ((unsigned int )sitearg2___0 ==
                                                                                                            (unsigned int )sitearg) {
                                                                                                          goto utime_no_arg;
                                                                                                        }
                                                                                                      }
                                                                                                      {
#line 642
                                                                                                      tmp___56 = sitearg2___0;
#line 642
                                                                                                      sitearg2___0 --;
#line 642
                                                                                                      (*tmp___56) = 0;
#line 643
                                                                                                      sitearg2___0 = strrchr((char const   *)sitearg,
                                                                                                                             ' ');
                                                                                                      }
#line 643
                                                                                                      if ((unsigned int )sitearg2___0 ==
                                                                                                          (unsigned int )((void *)0)) {
                                                                                                        goto utime_no_arg;
                                                                                                      } else {
#line 643
                                                                                                        if ((unsigned int )sitearg2___0 ==
                                                                                                            (unsigned int )sitearg) {
                                                                                                          goto utime_no_arg;
                                                                                                        }
                                                                                                      }
#line 647
                                                                                                      tmp___57 = sitearg2___0;
#line 647
                                                                                                      sitearg2___0 ++;
#line 647
                                                                                                      (*tmp___57) = 0;
#line 648
                                                                                                      if ((int )(*sitearg2___0) ==
                                                                                                          0) {
                                                                                                        goto utime_no_arg;
                                                                                                      }
                                                                                                      {
#line 651
                                                                                                      doutime(sitearg,
                                                                                                              (char const   *)sitearg2___0);
                                                                                                      }
                                                                                                      utime_wayout: ;
                                                                                                    }
                                                                                                  } else {
                                                                                                    parsechmod: 
#line 591
                                                                                                    if ((unsigned int )sitearg ==
                                                                                                        (unsigned int )((void *)0)) {
                                                                                                      {
#line 592
                                                                                                      addreply_noformat(501,
                                                                                                                        "Missing argument");
                                                                                                      }
                                                                                                      goto chmod_wayout;
                                                                                                    } else {
#line 591
                                                                                                      if ((int )(*sitearg) ==
                                                                                                          0) {
                                                                                                        {
#line 592
                                                                                                        addreply_noformat(501,
                                                                                                                          "Missing argument");
                                                                                                        }
                                                                                                        goto chmod_wayout;
                                                                                                      }
                                                                                                    }
#line 595
                                                                                                    sitearg2 = sitearg;
                                                                                                    {
#line 596
                                                                                                    while (1) {
                                                                                                      while_198_continue: /* CIL Label */ ;
#line 596
                                                                                                      if ((int )(*sitearg2) !=
                                                                                                          0) {
                                                                                                        {
#line 596
                                                                                                        tmp___50 = __ctype_b_loc();
                                                                                                        }
#line 596
                                                                                                        if ((int const   )(*((*tmp___50) +
                                                                                                                             (int )((unsigned char )(*sitearg2)))) &
                                                                                                            8192) {
                                                                                                          goto while_198_break;
                                                                                                        }
                                                                                                      } else {
                                                                                                        goto while_198_break;
                                                                                                      }
#line 597
                                                                                                      sitearg2 ++;
                                                                                                    }
                                                                                                    while_198_break: /* CIL Label */ ;
                                                                                                    }
                                                                                                    {
#line 599
                                                                                                    while (1) {
                                                                                                      while_199_continue: /* CIL Label */ ;
#line 599
                                                                                                      if ((int )(*sitearg2) !=
                                                                                                          0) {
                                                                                                        {
#line 599
                                                                                                        tmp___51 = __ctype_b_loc();
                                                                                                        }
#line 599
                                                                                                        if (! ((int const   )(*((*tmp___51) +
                                                                                                                                (int )((unsigned char )(*sitearg2)))) &
                                                                                                               8192)) {
                                                                                                          goto while_199_break;
                                                                                                        }
                                                                                                      } else {
                                                                                                        goto while_199_break;
                                                                                                      }
#line 600
                                                                                                      sitearg2 ++;
                                                                                                    }
                                                                                                    while_199_break: /* CIL Label */ ;
                                                                                                    }
#line 602
                                                                                                    if ((int )(*sitearg2) ==
                                                                                                        0) {
                                                                                                      {
#line 603
                                                                                                      addreply_noformat(550,
                                                                                                                        "No file name");
                                                                                                      }
                                                                                                      goto chmod_wayout;
                                                                                                    }
                                                                                                    {
#line 606
                                                                                                    mode = (mode_t )strtoul((char const   */* __restrict  */)sitearg,
                                                                                                                            (char **/* __restrict  */)((void *)0),
                                                                                                                            8);
                                                                                                    }
#line 607
                                                                                                    if (mode >
                                                                                                        4095U) {
                                                                                                      {
#line 608
                                                                                                      addreply_noformat(501,
                                                                                                                        "Invalid permissions");
                                                                                                      }
                                                                                                      goto chmod_wayout;
                                                                                                    }
                                                                                                    {
#line 611
                                                                                                    dochmod(sitearg2,
                                                                                                            mode);
                                                                                                    }
                                                                                                    chmod_wayout: ;
                                                                                                  }
                                                                                                } else {
                                                                                                  help_site: 
                                                                                                  {
#line 580
                                                                                                  addreply_noformat(214,
                                                                                                                    "The following SITE commands are recognized\r\n CHMOD\r\n IDLE\r\n UTIME");
#line 585
                                                                                                  addreply_noformat(214,
                                                                                                                    "Pure-FTPd - http://pureftpd.org/");
                                                                                                  }
                                                                                                }
                                                                                              } else {
                                                                                                {
#line 576
                                                                                                dositetime();
                                                                                                }
                                                                                              }
                                                                                            } else {
#line 559
                                                                                              if ((unsigned int )sitearg ==
                                                                                                  (unsigned int )((void *)0)) {
                                                                                                {
#line 560
                                                                                                addreply_noformat(501,
                                                                                                                  "SITE IDLE: Missing argument");
                                                                                                }
                                                                                              } else {
#line 559
                                                                                                if ((int )(*sitearg) ==
                                                                                                    0) {
                                                                                                  {
#line 560
                                                                                                  addreply_noformat(501,
                                                                                                                    "SITE IDLE: Missing argument");
                                                                                                  }
                                                                                                } else {
                                                                                                  {
#line 562
                                                                                                  i = 0UL;
#line 564
                                                                                                  i = strtoul((char const   */* __restrict  */)sitearg,
                                                                                                              (char **/* __restrict  */)(& sitearg),
                                                                                                              10);
                                                                                                  }
#line 565
                                                                                                  if (sitearg) {
#line 565
                                                                                                    if ((*sitearg)) {
                                                                                                      {
#line 566
                                                                                                      addreply(501,
                                                                                                               "Garbage found after value : %s",
                                                                                                               sitearg);
                                                                                                      }
                                                                                                    } else {
                                                                                                      goto _L___10;
                                                                                                    }
                                                                                                  } else {
                                                                                                    _L___10: 
#line 567
                                                                                                    if (i >
                                                                                                        2520UL) {
                                                                                                      {
#line 568
                                                                                                      addreply_noformat(501,
                                                                                                                        "Value too large");
                                                                                                      }
                                                                                                    } else {
                                                                                                      {
#line 570
                                                                                                      idletime = i;
#line 571
                                                                                                      addreply(200,
                                                                                                               "Idle time set to %lu seconds",
                                                                                                               idletime);
#line 572
                                                                                                      idletime_noop = (double )idletime *
                                                                                                                      2.0;
                                                                                                      }
                                                                                                    }
                                                                                                  }
                                                                                                }
                                                                                              }
                                                                                            }
                                                                                          }
                                                                                        } else {
                                                                                          {
#line 547
                                                                                          addreply_noformat(226,
                                                                                                            "Since you see this ABOR must\'ve succeeded");
                                                                                          }
                                                                                        }
                                                                                      } else {
                                                                                        {
#line 543
                                                                                        modern_listings = 1;
#line 544
                                                                                        donlist(arg,
                                                                                                0,
                                                                                                1,
                                                                                                0);
                                                                                        }
                                                                                      }
                                                                                    } else {
#line 541
                                                                                      if ((int )(*arg) !=
                                                                                          0) {
#line 541
                                                                                        tmp___47 = (char const   *)arg;
                                                                                      } else {
#line 541
                                                                                        tmp___47 = ".";
                                                                                      }
                                                                                      {
#line 541										     
                                                                                      domlst(tmp___47);
                                                                                      }
                                                                                    }
                                                                                  } else {
                                                                                    {
#line 536
                                                                                    modern_listings = 0;
#line 538
                                                                                    donlist(arg,
                                                                                            0,
                                                                                            0,
                                                                                            (int )broken_client_compat);
                                                                                    }
                                                                                  }
                                                                                } else {
                                                                                  {
#line 531
                                                                                  modern_listings = 0;
#line 533
                                                                                  donlist(arg,
                                                                                          0,
                                                                                          1,
                                                                                          1);
                                                                                  }
                                                                                }
                                                                              } else {
#line 515
                                                                                if ((int )(*arg) !=
                                                                                    0) {
                                                                                  {
#line 522
                                                                                  modern_listings = 0;
#line 523
                                                                                  donlist(arg,
                                                                                          1,
                                                                                          1,
                                                                                          1);
                                                                                  }
                                                                                } else {
                                                                                  {
#line 526
                                                                                  addreply_noformat(211,
                                                                                                    "http://www.pureftpd.org/");
                                                                                  }
                                                                                }
                                                                              }
                                                                            } else {
                                                                              _L___40: 
#line 507
                                                                              if ((int )(*arg) !=
                                                                                  0) {
                                                                                {
#line 508
                                                                                dormd(arg);
                                                                                }
                                                                              } else {
                                                                                {
#line 510
                                                                                addreply_noformat(550,
                                                                                                  "No directory name");
                                                                                }
                                                                              }
                                                                            }
                                                                          } else {
                                                                            goto _L___40;
                                                                          }
                                                                        } else {
                                                                          _L___45: 
                                                                          {
#line 500
                                                                          arg = revealextraspc(arg);
                                                                          }
#line 501
                                                                          if ((int )(*arg) !=
                                                                              0) {
                                                                            {
#line 502
                                                                            domkd(arg);
                                                                            }
                                                                          } else {
                                                                            {
#line 504
                                                                            addreply_noformat(501,
                                                                                              "No directory name");
                                                                            }
                                                                          }
                                                                        }
                                                                      } else {
                                                                        goto _L___45;
                                                                      }
                                                                    } else {
                                                                      {
#line 496
                                                                      dostou();
                                                                      }
                                                                    }
                                                                  } else {
                                                                    {
#line 488
                                                                    arg = revealextraspc(arg);
                                                                    }
#line 489
                                                                    if ((int )(*arg) !=
                                                                        0) {
                                                                      {
#line 490
                                                                      dostor(arg,
                                                                             1, 0);
                                                                      }
                                                                    } else {
                                                                      {
#line 492
                                                                      addreply_noformat(501,
                                                                                        "No file name");
                                                                      }
                                                                    }
                                                                  }
                                                                } else {
                                                                  {
#line 481
                                                                  arg = revealextraspc(arg);
                                                                  }
#line 482
                                                                  if ((int )(*arg) !=
                                                                      0) {
                                                                    {
#line 483
                                                                    dostor(arg, 0,
                                                                           (int )autorename);
                                                                    }
                                                                  } else {
                                                                    {
#line 485
                                                                    addreply_noformat(501,
                                                                                      "No file name");
                                                                    }
                                                                  }
                                                                }
                                                              } else {
#line 475
                                                                if ((int )(*arg) !=
                                                                    0) {
                                                                  {
#line 476
                                                                  dodele(arg);
                                                                  }
                                                                } else {
                                                                  {
#line 478
                                                                  addreply_noformat(501,
                                                                                    "No file name");
                                                                  }
                                                                }
                                                              }
                                                            } else {
                                                              {
#line 466
                                                              antiidle();
                                                              }
#line 467
                                                              if ((int )(*arg) !=
                                                                  0) {
                                                                {
#line 468
                                                                dorest((char const   *)arg);
                                                                }
                                                              } else {
                                                                {
#line 470
                                                                addreply_noformat(501,
                                                                                  "No restart point");
#line 471
                                                                restartat = 0LL;
                                                                }
                                                              }
                                                              goto wayout;
                                                            }
                                                          } else {
#line 460
                                                            if ((int )(*arg) != 0) {
                                                              {
#line 461
                                                              doretr(arg);
                                                              }
                                                            } else {
                                                              {
#line 463
                                                              addreply_noformat(501,
                                                                                "No file name");
                                                              }
                                                            }
                                                          }
                                                        } else {
                                                          {
#line 458
                                                          docwd("..");
                                                          }
                                                        }
                                                      } else {
                                                        {
#line 458
                                                        docwd("..");
                                                        }
                                                      }
                                                    } else {
                                                      {
#line 448
                                                      antiidle();
#line 454
                                                      addreply(257, "\"%s\" is your current location",
                                                               wd);
                                                      }
                                                      goto wayout;
                                                    }
                                                  } else {
                                                    {
#line 448
                                                    antiidle();
#line 454
                                                    addreply(257, "\"%s\" is your current location",
                                                             wd);
                                                    }
                                                    goto wayout;
                                                  }
                                                }
                                              }
                                            }
                                          } else {
                                            {
#line 423
                                            doestp();
                                            }
                                          }
                                        } else {
#line 418
                                          if ((int )disallow_passive == 0) {
#line 418
                                            if ((int )force_passive_ip.ss_family ==
                                                0) {
                                              {
#line 421
                                              doesta();
                                              }
                                            } else {
                                              goto _L___83;
                                            }
                                          } else {
                                            goto _L___83;
                                          }
                                        }
                                      } else {
                                        {
#line 417
                                        doeprt(arg);
                                        }
                                      }
                                    } else {
                                      {
#line 414
                                      doport((char const   *)arg);
                                      }
                                    }
                                  } else {
                                    {
#line 410
                                    antiidle();
#line 411
                                    docwd((char const   *)arg);
                                    }
                                    goto wayout;
                                  }
                                } else {
                                  {
#line 410
                                  antiidle();
#line 411
                                  docwd((char const   *)arg);
                                  }
                                  goto wayout;
                                }
                              }
                            } else {
                              goto help_site;
                            }
                          } else {
                            {
#line 392
                            dostru((char const   *)arg);
                            }
                            goto wayout;
                          }
                        } else {
                          {
#line 388
                          doopts(arg);
                          }
                          goto wayout;
                        }
                      } else {
                        {
#line 385
                        dofeat();
                        }
                        goto wayout;
                      }
                    } else {
                      {
#line 380
                      antiidle();
#line 381
                      domode((char const   *)arg);
                      }
                      goto wayout;
                    }
                  } else {
                    {
#line 376
                    antiidle();
#line 377
                    dotype((char const   *)arg);
                    }
                    goto wayout;
                  }
                } else {
                  {
#line 374
                  addreply_noformat(500, "This security scheme is not implemented");
                  }
                }
              } else {
                {
#line 374
                addreply_noformat(500, "This security scheme is not implemented");
                }
              }
            } else {
              {
#line 340
              antiidle();
#line 341
              addreply_noformat(215, "UNIX Type: L8");
              }
              goto wayout;
            }
          } else {
            {
#line 335
            addreply(221, "Goodbye. You uploaded %llu and downloaded %llu kbytes.",
                     (uploaded + 1023ULL) / 1024ULL, (downloaded + 1023ULL) / 1024ULL);
            }
#line 338
            return;
          }
        } else {
#line 330
          if ((int )guest == 0) {
            {
#line 331
            randomdelay();
            }
          }
          {
#line 333
          dopass(arg);
          }
        }
      } else {
        {
#line 328
        addreply(202, "Please tell me who you are");
        }
      }
    } else {
      {
#line 326
      douser((char const   *)arg);
      }
    }
#line 700
    noopidle = -1L;
    wayout: ;
    __Cont: ;
  }
  while_194_break: /* CIL Label */ ;
  }
#line 705
  return;
}
}
#line 1 "cil-urlkJ6Gu.o"
/* #pragma merger(0,"/tmp/cil-WYIvE9es.i","") */
#line 1 "src/pure_ftpd-dynamic.o_saved.c"
/* #pragma merger(112422806,"./dynamic.i","-g,-O2") */
#line 22 "dynamic.c"
static IPTrack *iptrack_list  ;
#line 24 "dynamic.c"
void iptrack_delete_pid(pid_t pid ) 
{ unsigned int c ;

  {
  if (0 <= pid) {
    INV8: /* CIL Label */ 
    assert(0);
  }
#line 26
  c = 0U;
#line 28
  if ((unsigned int )iptrack_list == (unsigned int )((void *)0)) {
#line 29
    return;
  }
  {
#line 31
  while (1) {
    while_200_continue: /* CIL Label */ ;
#line 32
    if ((iptrack_list + c)->pid == pid) {
#line 33
      (iptrack_list + c)->pid = 0;
#line 34
      return;
    }
#line 36
    c ++;
#line 31
    if (! (c < maxusers)) {
      goto while_200_break;
    }
  }
  while_200_break: /* CIL Label */ ;
  }
#line 38
  return;
}
}
#line 40 "dynamic.c"
void iptrack_free(void) 
{ 

  {
  {
#line 42
  free((void *)iptrack_list);
#line 43
  iptrack_list = (IPTrack *)((void *)0);
  }
#line 44
  return;
}
}
#line 46 "dynamic.c"
static unsigned int iptrack_find_ip_or_shift(struct sockaddr_storage  const  *ip ) 
{ unsigned int c ;

  {
#line 49
  c = 0U;
  {
#line 51
  while (1) {
    while_201_continue: /* CIL Label */ ;
#line 52
    if ((iptrack_list + c)->pid != 0) {
#line 52
      if ((int )(iptrack_list + c)->ip.ss_family != (int )ip->ss_family) {
#line 54
        if ((int )(iptrack_list + c)->ip.ss_family == 2) {
#line 54
          if (((struct sockaddr_in *)(& (iptrack_list + c)->ip))->sin_addr.s_addr ==
              ((struct sockaddr_in *)ip)->sin_addr.s_addr) {
#line 56
            return (c);
          } else {
            goto _L;
          }
        } else {
          _L: 
#line 57
          if ((int )(iptrack_list + c)->ip.ss_family == 10) {
#line 57
            if ((*((uint32_t const   *)(& ((struct sockaddr_in6 *)(& (iptrack_list +
                                                                      c)->ip))->sin6_addr) +
                   0)) == (*((uint32_t const   *)(& ((struct sockaddr_in6 *)ip)->sin6_addr) +
                             0))) {
#line 57
              if ((*((uint32_t const   *)(& ((struct sockaddr_in6 *)(& (iptrack_list +
                                                                        c)->ip))->sin6_addr) +
                     1)) == (*((uint32_t const   *)(& ((struct sockaddr_in6 *)ip)->sin6_addr) +
                               1))) {
#line 57
                if ((*((uint32_t const   *)(& ((struct sockaddr_in6 *)(& (iptrack_list +
                                                                          c)->ip))->sin6_addr) +
                       2)) == (*((uint32_t const   *)(& ((struct sockaddr_in6 *)ip)->sin6_addr) +
                                 2))) {
#line 57
                  if ((*((uint32_t const   *)(& ((struct sockaddr_in6 *)(& (iptrack_list +
                                                                            c)->ip))->sin6_addr) +
                         3)) == (*((uint32_t const   *)(& ((struct sockaddr_in6 *)ip)->sin6_addr) +
                                   3))) {
#line 61
                    return (c);
                  }
                }
              }
            }
          }
        }
      }
    }
#line 64
    c ++;
#line 51
    if (! (c < maxusers)) {
      goto while_201_break;
    }
  }
  while_201_break: /* CIL Label */ ;
  }
#line 66
  c --;
#line 67
  if (c != 0U) {
    {
#line 68
    memmove((void *)(iptrack_list + 0), (void const   *)(iptrack_list + 1), sizeof((*(iptrack_list +
                                                                                      0))) *
                                                                            c);
    }
  }
#line 71
  return (c);
}
}
#line 74 "dynamic.c"
unsigned int iptrack_get(struct sockaddr_storage  const  *ip ) 
{ unsigned int c ;
  unsigned int nb ;

  {
#line 76
  c = 0U;
#line 77
  nb = 0U;
#line 79
  if ((unsigned int )iptrack_list == (unsigned int )((void *)0)) {
#line 80
    return (0U);
  }
  {
#line 82
  while (1) {
    while_202_continue: /* CIL Label */ ;
#line 83
    if ((iptrack_list + c)->pid != 0) {
#line 83
      if ((int )(iptrack_list + c)->ip.ss_family == (int )ip->ss_family) {
#line 85
        if ((int )(iptrack_list + c)->ip.ss_family == 2) {
#line 85
          if (((struct sockaddr_in *)(& (iptrack_list + c)->ip))->sin_addr.s_addr ==
              ((struct sockaddr_in *)ip)->sin_addr.s_addr) {
#line 87
            nb ++;
          } else {
            goto _L;
          }
        } else {
          _L: 
#line 88
          if ((int )(iptrack_list + c)->ip.ss_family == 10) {
#line 88
            if ((*((uint32_t const   *)(& ((struct sockaddr_in6 *)(& (iptrack_list +
                                                                      c)->ip))->sin6_addr) +
                   0)) == (*((uint32_t const   *)(& ((struct sockaddr_in6 *)ip)->sin6_addr) +
                             0))) {
#line 88
              if ((*((uint32_t const   *)(& ((struct sockaddr_in6 *)(& (iptrack_list +
                                                                        c)->ip))->sin6_addr) +
                     1)) == (*((uint32_t const   *)(& ((struct sockaddr_in6 *)ip)->sin6_addr) +
                               1))) {
#line 88
                if ((*((uint32_t const   *)(& ((struct sockaddr_in6 *)(& (iptrack_list +
                                                                          c)->ip))->sin6_addr) +
                       2)) == (*((uint32_t const   *)(& ((struct sockaddr_in6 *)ip)->sin6_addr) +
                                 2))) {
#line 88
                  if ((*((uint32_t const   *)(& ((struct sockaddr_in6 *)(& (iptrack_list +
                                                                            c)->ip))->sin6_addr) +
                         3)) == (*((uint32_t const   *)(& ((struct sockaddr_in6 *)ip)->sin6_addr) +
                                   3))) {
#line 92
                    nb ++;
                  }
                }
              }
            }
          }
        }
      }
    }
#line 95
    c ++;
#line 82
    if (! (c < maxusers)) {
      goto while_202_break;
    }
  }
  while_202_break: /* CIL Label */ ;
  }
#line 98
  return (nb);
}
}
#line 101 "dynamic.c"
void iptrack_add(struct sockaddr_storage  const  *ip , pid_t pid ) 
{ unsigned int c ;
  unsigned int ci ;

  {
  if (0 != pid) {
    INV9: /* CIL Label */ 
    assert(0);
  }
#line 104
  c = 0U;
#line 106
  if ((unsigned int )iptrack_list == (unsigned int )((void *)0)) {
    {
#line 107
    ci = 0U;
#line 109
    iptrack_list = (IPTrack *)malloc(maxusers * sizeof((*iptrack_list)));
    }
#line 109
    if ((unsigned int )iptrack_list == (unsigned int )((void *)0)) {
#line 110
      return;
    }
    {
#line 112
    while (1) {
      while_203_continue: /* CIL Label */ ;
#line 113
      (iptrack_list + ci)->pid = 0;
#line 114
      ci ++;
#line 112
      if (! (ci < maxusers)) {
        goto while_203_break;
      }
    }
    while_203_break: /* CIL Label */ ;
    }
  }
  {
#line 117
  while (1) {
    while_204_continue: /* CIL Label */ ;
#line 118
    if ((iptrack_list + c)->pid == 0) {
      force: 
#line 120
      (iptrack_list + c)->pid = pid;
#line 121
      (iptrack_list + c)->ip = (*ip);
#line 122
      return;
    }
#line 124
    c ++;
#line 117
    if (! (c < maxusers)) {
      goto while_204_break;
    }
  }
  while_204_break: /* CIL Label */ ;
  }
  {
#line 126
  c = iptrack_find_ip_or_shift(ip);
  }
  goto force;
}
}
#line 1 "cil-oR6kmjVJ.o"
/* #pragma merger(0,"/tmp/cil-8qP15HeS.i","") */
#line 1 "src/pure_ftpd-ftpwho-update.o_saved.c"
/* #pragma merger(112422806,"./ftpwho-update.i","-g,-O2") */
#line 1 "cil-MTmvdets.o"
/* #pragma merger(0,"/tmp/cil-gvmKlEhO.i","") */
#line 1 "src/pure_ftpd-bsd-getopt_long.o_saved.c"
/* #pragma merger(112422806,"./bsd-getopt_long.i","-g,-O2") */
#line 1 "cil-xD18MYBE.o"
/* #pragma merger(0,"/tmp/cil-tG7Nf361.i","") */
#line 1 "src/pure_ftpd-upload-pipe.o_saved.c"
/* #pragma merger(112422806,"./upload-pipe.i","-g,-O2") */
#line 1 "cil-ZoKtlFRN.o"
/* #pragma merger(0,"/tmp/cil-e7HkHRiZ.i","") */
#line 1 "src/pure_ftpd-ipv4stack.o_saved.c"
/* #pragma merger(112422806,"./ipv4stack.i","-g,-O2") */
#line 1 "cil-Fe1lF46N.o"
/* #pragma merger(0,"/tmp/cil-uPlsp6iI.i","") */
#line 1 "src/pure_ftpd-crypto.o_saved.c"
/* #pragma merger(112422807,"./crypto.i","-g,-O2") */
#line 1 "cil-THTP0YMI.o"
/* #pragma merger(0,"/tmp/cil-tHrZhVak.i","") */
#line 1 "src/pure_ftpd-crypto-md5.o_saved.c"
/* #pragma merger(112422807,"./crypto-md5.i","-g,-O2") */
#line 1 "cil-eFD86qce.o"
/* #pragma merger(0,"/tmp/cil-XbwPEyq0.i","") */
#line 1 "src/pure_ftpd-crypto-sha1.o_saved.c"
/* #pragma merger(112422807,"./crypto-sha1.i","-g,-O2") */
#line 1 "cil-JqnAgsCE.o"
/* #pragma merger(0,"/tmp/cil-Exs2lB6Q.i","") */
#line 1 "src/pure_ftpd-quotas.o_saved.c"
/* #pragma merger(112422807,"./quotas.i","-g,-O2") */
#line 1 "cil-PzGdohFo.o"
/* #pragma merger(0,"/tmp/cil-xnN0sGSH.i","") */
#line 1 "src/pure_ftpd-fakechroot.o_saved.c"
/* #pragma merger(112422807,"./fakechroot.i","-g,-O2") */
#line 1 "cil-oWWCcFnG.o"
/* #pragma merger(0,"/tmp/cil-lv0STODq.i","") */
#line 1 "src/pure_ftpd-diraliases.o_saved.c"
/* #pragma merger(112422807,"./diraliases.i","-g,-O2") */
#line 1 "cil-HfzwmHJ8.o"
/* #pragma merger(0,"/tmp/cil-vfwC1XML.i","") */
#line 1 "src/pure_ftpd-ftpwho-read.o_saved.c"
/* #pragma merger(112422807,"./ftpwho-read.i","-g,-O2") */
#line 1 "cil-zdKVdg4Y.o"
/* #pragma merger(0,"/tmp/cil-Ctng5Kdd.i","") */
#line 1 "src/pure_ftpd-getloadavg.o_saved.c"
/* #pragma merger(112422807,"./getloadavg.i","-g,-O2") */
#line 1 "cil-lI55IxT6.o"
/* #pragma merger(0,"/tmp/cil-KAFv2nlI.i","") */
#line 1 "src/pure_ftpd-privsep.o_saved.c"
/* #pragma merger(112422808,"./privsep.i","-g,-O2") */
#line 1 "cil-QbbTdosC.o"
/* #pragma merger(0,"/tmp/cil-BizdP6Ex.i","") */
#line 1 "src/pure_ftpd-tls.o_saved.c"
/* #pragma merger(112422808,"./tls.i","-g,-O2") */
#line 1 "cil-sDSOwHej.o"
/* #pragma merger(0,"/tmp/cil-obSfeWyd.i","") */
#line 1 "src/pure_ftpd-osx-extensions.o_saved.c"
/* #pragma merger(112422808,"./osx-extensions.i","-g,-O2") */
#line 1 "cil-5QPelPZC.o"
/* #pragma merger(0,"/tmp/cil-pgN7jVUa.i","") */
#line 1 "src/ipv4stack.o_saved.c"
/* #pragma merger(112422809,"./ipv4stack.i","-g,-O2") */
#line 1 "cil-mGT5Ankv.o"
/* #pragma merger(0,"/tmp/cil-36oBGDR0.i","") */
#line 1 "puredb/src/puredb_read.o_saved.c"
/* #pragma merger(112422799,"./puredb_read.i","-g,-O2") */
#line 35 "puredb_read.h"
int puredb_open(PureDB *db , char const   *dbfile ) ;
#line 37
int puredb_close(PureDB *db ) ;
#line 39
int puredb_find(PureDB *db , char const   *tofind , size_t tofind_len , off_t *retpos ,
                size_t *retlen ) ;
#line 43
int puredb_find_s(PureDB *db , char const   *tofind , off_t *retpos , size_t *retlen ) ;
#line 46
void *puredb_read(PureDB *db , off_t offset , size_t len ) ;
#line 9 "puredb_read.c"
static puredb_u32_t puredb_hash(char const   *msg , size_t len ) 
{ puredb_u32_t j ;

  {
#line 11
  j = 5381U;
  {
#line 13
  while (1) {
    while_205_continue: /* CIL Label */ ;
#line 13
    if (! (len != 0U)) {
      goto while_205_break;
    }
#line 14
    len --;
#line 15
    j += j << 5;
#line 16
    j ^= (unsigned int )((unsigned char )(*(msg + len)));
  }
  while_205_break: /* CIL Label */ ;
  }
#line 18
  j &= 4294967295U;
#line 20
  return (j);
}
}
#line 23 "puredb_read.c"
static ssize_t safe_read(int fd , void *buf_ , size_t maxlen ) 
{ unsigned char *buf ;
  ssize_t readen ;
  int *tmp ;

  {
#line 25
  buf = (unsigned char *)buf_;
  {
#line 28
  while (1) {
    while_206_continue: /* CIL Label */ ;
    {
#line 29
    while (1) {
      while_207_continue: /* CIL Label */ ;
      {
#line 29
      readen = read(fd, (void *)buf, maxlen);
      }
#line 29
      if (readen < 0) {
        {
#line 29
        tmp = __errno_location();
        }
#line 29
        if (! ((*tmp) == 4)) {
          goto while_207_break;
        }
      } else {
        goto while_207_break;
      }
    }
    while_207_break: /* CIL Label */ ;
    }
#line 31
    if (readen < 0) {
#line 32
      return (readen);
    } else {
#line 31
      if (readen > (int )maxlen) {
#line 32
        return (readen);
      }
    }
#line 34
    if (readen == 0) {
      ret: 
#line 36
      return (buf - (unsigned char *)buf_);
    }
#line 38
    maxlen -= (unsigned int )readen;
#line 39
    buf += readen;
#line 28
    if (! (maxlen > 0U)) {
      goto while_206_break;
    }
  }
  while_206_break: /* CIL Label */ ;
  }
  goto ret;
}
}
#line 44 "puredb_read.c"
static int read_be_long(PureDB const   *db , puredb_u32_t offset , puredb_u32_t *result ) 
{ unsigned char mapoffsetbuf[4] ;
  unsigned char *mapoffset ;
  __off64_t tmp ;
  ssize_t tmp___0 ;

  {
#line 52
  if ((unsigned int )db->map != (unsigned int )((void *)0)) {
#line 53
    mapoffset = db->map + offset;
  } else {
    {
#line 57
    tmp = lseek(db->fd, (long long )offset, 0);
    }
#line 57
    if (tmp == -1LL) {
#line 58
      return (-1);
    }
    {
#line 60
    tmp___0 = safe_read(db->fd, (void *)(mapoffsetbuf), sizeof(mapoffsetbuf));
    }
#line 60
    if (tmp___0 != (int )sizeof(mapoffsetbuf)) {
#line 62
      return (-1);
    }
#line 64
    mapoffset = mapoffsetbuf;
  }
#line 66
  (*result) = (unsigned int )(((((int )(*(mapoffset + 0)) << 24) | ((int )(*(mapoffset +
                                                                             1)) <<
                                                                    16)) | ((int )(*(mapoffset +
                                                                                     2)) <<
                                                                            8)) |
                              (int )(*(mapoffset + 3)));
#line 69
  return (0);
}
}
#line 72 "puredb_read.c"
static int read_memcmp(PureDB const   *db , puredb_u32_t offset , unsigned char const   *str ,
                       puredb_u32_t len ) 
{ unsigned char *mapoffsetbuf ;
  int cmp___0 ;
  int tmp ;
  __off64_t tmp___1 ;
  ssize_t tmp___2 ;
  int tmp___3 ;

  {
#line 79
  if ((unsigned int )db->map != (unsigned int )((void *)0)) {
    {
#line 80
    tmp = memcmp((void const   *)(db->map + offset), (void const   *)str, len);
    }
#line 80
    return (tmp != 0);
  }
  {
#line 83
  mapoffsetbuf = (unsigned char *)__builtin_alloca(len);
  }
#line 83
  if ((unsigned int )mapoffsetbuf == (unsigned int )((void *)0)) {
#line 84
    return (-2);
  }
  {
#line 86
  tmp___1 = lseek(db->fd, (long long )offset, 0);
  }
#line 86
  if (tmp___1 == -1LL) {
    err: 
    {
#line 88
    while (1) {
      while_208_continue: /* CIL Label */ ;
      goto while_208_break;
    }
    while_208_break: /* CIL Label */ ;
    }
#line 89
    return (-2);
  }
  {
#line 91
  tmp___2 = safe_read(db->fd, (void *)mapoffsetbuf, len);
  }
#line 91
  if (tmp___2 != (int )len) {
    goto err;
  }
  {
#line 94
  tmp___3 = memcmp((void const   *)mapoffsetbuf, (void const   *)str, len);
#line 94
  cmp___0 = tmp___3 != 0;
  }
  {
#line 95
  while (1) {
    while_209_continue: /* CIL Label */ ;
    goto while_209_break;
  }
  while_209_break: /* CIL Label */ ;
  }
#line 97
  return (cmp___0);
}
}
#line 100 "puredb_read.c"
int puredb_open(PureDB *db , char const   *dbfile ) 
{ struct stat st ;
  int tmp ;
  int tmp___1 ;

  {
  {
#line 104
  db->map = (unsigned char *)((void *)0);
#line 105
  db->fd = open(dbfile, 0);
  }
#line 105
  if (db->fd == -1) {
#line 106
    return (-1);
  }
  {
#line 108
  tmp = fstat(db->fd, & st);
  }
#line 108
  if (tmp < 0) {
    {
#line 112
    close(db->fd);
    }
#line 114
    return (-2);
  } else {
#line 108
    db->size = (unsigned int )st.st_size;
#line 108
    if (db->size > 4294967295U) {
      {
#line 112
      close(db->fd);
      }
#line 114
      return (-2);
    } else {
#line 108
      if (db->size < (257U * sizeof(puredb_u32_t ) + sizeof("PDB2")) - 1U) {
        {
#line 112
        close(db->fd);
        }
#line 114
        return (-2);
      }
    }
  }
  {
#line 117
  db->map = (unsigned char *)mmap((void *)0, db->size, 1, 1, db->fd, 0LL);
  }
#line 117
  if ((unsigned int )((char *)db->map) == (unsigned int )((char *)((void *)-1))) {
#line 121
    db->map = (unsigned char *)((void *)0);
  }
  {
#line 139
  tmp___1 = read_memcmp((PureDB const   *)db, 0U, (unsigned char const   *)"PDB2",
                        sizeof("PDB2") - 1U);
  }
#line 139
  if (tmp___1 != 0) {
#line 143
    return (-3);
  }
#line 146
  return (0);
}
}
#line 149 "puredb_read.c"
int puredb_find(PureDB *db , char const   *tofind , size_t tofind_len , off_t *retpos ,
                size_t *retlen ) 
{ puredb_u32_t hash ;
  puredb_u32_t scanned_hash ;
  puredb_u32_t hash0 ;
  puredb_u32_t hash1 ;
  puredb_u32_t hash1e ;
  puredb_u32_t lastslot ;
  puredb_u32_t slotlo ;
  puredb_u32_t slothi ;
  puredb_u32_t sno ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  puredb_u32_t data ;
  puredb_u32_t key_size ;
  puredb_u32_t data_size ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;

  {
  {
#line 163
  (*retpos) = -1LL;
#line 164
  (*retlen) = 0U;
#line 165
  hash = puredb_hash(tofind, tofind_len);
#line 166
  hash0 = (sizeof("PDB2") - 1U) + (hash & 255U) * sizeof(puredb_u32_t );
  }
#line 169
  if (hash0 + sizeof(puredb_u32_t ) * 2U > db->size) {
#line 170
    return (-2);
  }
  {
#line 172
  tmp = read_be_long((PureDB const   *)db, hash0, & hash1);
  }
#line 172
  if (tmp < 0) {
#line 173
    return (-3);
  }
  {
#line 175
  tmp___0 = read_be_long((PureDB const   *)db, hash0 + sizeof(puredb_u32_t ), & hash1e);
  }
#line 175
  if (tmp___0 < 0) {
#line 176
    return (-3);
  }
#line 178
  if (hash1e <= hash1) {
#line 179
    return (-2);
  }
#line 181
  if (hash1 == 0U) {
#line 182
    return (-1);
  }
#line 184
  if (hash1 > db->size) {
#line 185
    return (-2);
  }
#line 187
  lastslot = (hash1e - hash1) / (sizeof(puredb_u32_t ) + sizeof(puredb_u32_t ));
#line 188
  if (lastslot <= 0U) {
#line 189
    return (-2);
  }
#line 191
  lastslot --;
#line 193
  slotlo = 0U;
#line 194
  slothi = lastslot;
#line 195
  sno = slothi / 2U;
  {
#line 196
  while (1) {
    while_210_continue: /* CIL Label */ ;
#line 196
    if (! (slotlo <= slothi)) {
      goto while_210_break;
    }
    {
#line 197
    tmp___1 = read_be_long((PureDB const   *)db, hash1 + sno * (sizeof(puredb_u32_t ) +
                                                                sizeof(puredb_u32_t )),
                           & scanned_hash);
    }
#line 197
    if (tmp___1 < 0) {
#line 200
      return (-3);
    }
#line 202
    if (scanned_hash == hash) {
      {
#line 203
      while (1) {
        while_211_continue: /* CIL Label */ ;
#line 203
        if (! (sno > 0U)) {
          goto while_211_break;
        }
        {
#line 204
        sno --;
#line 205
        tmp___2 = read_be_long((PureDB const   *)db, hash1 + sno * (sizeof(puredb_u32_t ) +
                                                                    sizeof(puredb_u32_t )),
                               & scanned_hash);
        }
#line 205
        if (tmp___2 < 0) {
#line 208
          return (-3);
        }
#line 210
        if (scanned_hash != hash) {
#line 211
          sno ++;
          goto while_211_break;
        }
      }
      while_211_break: /* CIL Label */ ;
      }
#line 215
      hash1 += sno * (sizeof(puredb_u32_t ) + sizeof(puredb_u32_t ));
      goto shortcut;
    }
#line 218
    if (scanned_hash > hash) {
#line 219
      if (sno <= 0U) {
        goto while_210_break;
      }
#line 222
      slothi = sno - 1U;
    } else {
#line 224
      if (sno >= lastslot) {
        goto while_210_break;
      }
#line 227
      slotlo = sno + 1U;
    }
#line 229
    sno = (slothi + slotlo) / 2U;
  }
  while_210_break: /* CIL Label */ ;
  }
#line 231
  hash1 += sno * (sizeof(puredb_u32_t ) + sizeof(puredb_u32_t ));
  {
#line 233
  while (1) {
    while_212_continue: /* CIL Label */ ;
    {
#line 234
    tmp___3 = read_be_long((PureDB const   *)db, hash1, & scanned_hash);
    }
#line 234
    if (tmp___3 < 0) {
#line 235
      return (-3);
    }
#line 237
    if (scanned_hash > hash) {
#line 238
      return (-1);
    }
#line 240
    if (scanned_hash == hash) {
      shortcut: 
      {
#line 246
      tmp___4 = read_be_long((PureDB const   *)db, hash1 + 4U, & data);
      }
#line 246
      if (tmp___4 < 0) {
#line 247
        return (-3);
      }
#line 249
      if (data > db->size) {
#line 250
        return (-2);
      }
      {
#line 252
      tmp___5 = read_be_long((PureDB const   *)db, data, & key_size);
      }
#line 252
      if (tmp___5 < 0) {
#line 253
        return (-3);
      }
#line 255
      if (key_size != tofind_len) {
        goto trynext;
      }
      {
#line 258
      tmp___6 = read_memcmp((PureDB const   *)db, data + sizeof(puredb_u32_t ), (unsigned char const   *)tofind,
                            tofind_len);
      }
#line 258
      if (tmp___6 != 0) {
        goto trynext;
      }
      {
#line 262
      data += sizeof(puredb_u32_t ) + tofind_len;
#line 263
      tmp___7 = read_be_long((PureDB const   *)db, data, & data_size);
      }
#line 263
      if (tmp___7 < 0) {
#line 264
        return (-3);
      }
#line 266
      data += sizeof(puredb_u32_t );
#line 267
      (*retpos) = (long long )data;
#line 268
      (*retlen) = data_size;
#line 270
      return (0);
    }
    trynext: 
#line 273
    hash1 += sizeof(puredb_u32_t ) + sizeof(puredb_u32_t );
#line 274
    if (lastslot == 0U) {
      goto while_212_break;
    }
#line 277
    lastslot --;
  }
  while_212_break: /* CIL Label */ ;
  }
#line 280
  return (-1);
}
}
#line 283 "puredb_read.c"
int puredb_find_s(PureDB *db , char const   *tofind , off_t *retpos , size_t *retlen ) 
{ size_t tmp ;
  int tmp___0 ;

  {
  {
#line 286
  tmp = strlen(tofind);
#line 286
  tmp___0 = puredb_find(db, tofind, tmp, retpos, retlen);
  }
#line 286
  return (tmp___0);
}
}
#line 289 "puredb_read.c"
void *puredb_read(PureDB *db , off_t offset , size_t len ) 
{ void *buf ;
  __off64_t tmp ;
  ssize_t tmp___0 ;

  {
  {
#line 293
  buf = malloc(len + 1U);
  }
#line 293
  if ((unsigned int )buf == (unsigned int )((void *)0)) {
#line 294
    return ((void *)0);
  }
#line 297
  if ((unsigned int )db->map != (unsigned int )((void *)0)) {
    {
#line 298
    memcpy((void */* __restrict  */)buf, (void const   */* __restrict  */)(db->map +
                                                                           offset),
           len);
    }
  } else {
    {
#line 302
    tmp = lseek(db->fd, offset, 0);
    }
#line 302
    if (tmp == -1LL) {
      {
#line 304
      free(buf);
      }
#line 305
      return ((void *)0);
    } else {
      {
#line 302
      tmp___0 = safe_read(db->fd, buf, len);
      }
#line 302
      if (tmp___0 != (int )len) {
        {
#line 304
        free(buf);
        }
#line 305
        return ((void *)0);
      }
    }
  }
#line 308
  (*((unsigned char *)buf + len)) = 0;
#line 310
  return (buf);
}
}
#line 313 "puredb_read.c"
int puredb_close(PureDB *db ) 
{ int ret ;

  {
#line 315
  ret = 0;
#line 318
  if ((unsigned int )db->map != (unsigned int )((void *)0)) {
    {
#line 320
    munmap((void *)db->map, db->size);
#line 322
    db->map = (unsigned char *)((void *)0);
    }
  }
#line 330
  if (db->fd != -1) {
    {
#line 331
    ret = close(db->fd);
#line 332
    db->fd = -1;
    }
  }
#line 335
  return (ret);
}
}
